var A3=Object.create;var c1=Object.defineProperty;var L3=Object.getOwnPropertyDescriptor;var D3=Object.getOwnPropertyNames;var R3=Object.getPrototypeOf,F3=Object.prototype.hasOwnProperty;var Ua=(i,n)=>()=>(n||i((n={exports:{}}).exports,n),n.exports),B3=(i,n)=>{for(var c in n)c1(i,c,{get:n[c],enumerable:!0})},O3=(i,n,c,p)=>{if(n&&typeof n=="object"||typeof n=="function")for(let f of D3(n))!F3.call(i,f)&&f!==c&&c1(i,f,{get:()=>n[f],enumerable:!(p=L3(n,f))||p.enumerable});return i};var Bt=(i,n,c)=>(c=i!=null?A3(R3(i)):{},O3(n||!i||!i.__esModule?c1(c,"default",{value:i,enumerable:!0}):c,i));var av=Ua(Et=>{"use strict";var Ku=Symbol.for("react.element"),N3=Symbol.for("react.portal"),j3=Symbol.for("react.fragment"),V3=Symbol.for("react.strict_mode"),U3=Symbol.for("react.profiler"),q3=Symbol.for("react.provider"),$3=Symbol.for("react.context"),Z3=Symbol.for("react.forward_ref"),H3=Symbol.for("react.suspense"),G3=Symbol.for("react.memo"),W3=Symbol.for("react.lazy"),X_=Symbol.iterator;function X3(i){return i===null||typeof i!="object"?null:(i=X_&&i[X_]||i["@@iterator"],typeof i=="function"?i:null)}var Y_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Q_=Object.assign,ev={};function rc(i,n,c){this.props=i,this.context=n,this.refs=ev,this.updater=c||Y_}rc.prototype.isReactComponent={};rc.prototype.setState=function(i,n){if(typeof i!="object"&&typeof i!="function"&&i!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,i,n,"setState")};rc.prototype.forceUpdate=function(i){this.updater.enqueueForceUpdate(this,i,"forceUpdate")};function tv(){}tv.prototype=rc.prototype;function h1(i,n,c){this.props=i,this.context=n,this.refs=ev,this.updater=c||Y_}var d1=h1.prototype=new tv;d1.constructor=h1;Q_(d1,rc.prototype);d1.isPureReactComponent=!0;var K_=Array.isArray,iv=Object.prototype.hasOwnProperty,p1={current:null},rv={key:!0,ref:!0,__self:!0,__source:!0};function nv(i,n,c){var p,f={},s=null,E=null;if(n!=null)for(p in n.ref!==void 0&&(E=n.ref),n.key!==void 0&&(s=""+n.key),n)iv.call(n,p)&&!rv.hasOwnProperty(p)&&(f[p]=n[p]);var A=arguments.length-2;if(A===1)f.children=c;else if(1<A){for(var N=Array(A),B=0;B<A;B++)N[B]=arguments[B+2];f.children=N}if(i&&i.defaultProps)for(p in A=i.defaultProps,A)f[p]===void 0&&(f[p]=A[p]);return{$$typeof:Ku,type:i,key:s,ref:E,props:f,_owner:p1.current}}function K3(i,n){return{$$typeof:Ku,type:i.type,key:n,ref:i.ref,props:i.props,_owner:i._owner}}function f1(i){return typeof i=="object"&&i!==null&&i.$$typeof===Ku}function J3(i){var n={"=":"=0",":":"=2"};return"$"+i.replace(/[=:]/g,function(c){return n[c]})}var J_=/\/+/g;function u1(i,n){return typeof i=="object"&&i!==null&&i.key!=null?J3(""+i.key):n.toString(36)}function np(i,n,c,p,f){var s=typeof i;(s==="undefined"||s==="boolean")&&(i=null);var E=!1;if(i===null)E=!0;else switch(s){case"string":case"number":E=!0;break;case"object":switch(i.$$typeof){case Ku:case N3:E=!0}}if(E)return E=i,f=f(E),i=p===""?"."+u1(E,0):p,K_(f)?(c="",i!=null&&(c=i.replace(J_,"$&/")+"/"),np(f,n,c,"",function(B){return B})):f!=null&&(f1(f)&&(f=K3(f,c+(!f.key||E&&E.key===f.key?"":(""+f.key).replace(J_,"$&/")+"/")+i)),n.push(f)),1;if(E=0,p=p===""?".":p+":",K_(i))for(var A=0;A<i.length;A++){s=i[A];var N=p+u1(s,A);E+=np(s,n,c,N,f)}else if(N=X3(i),typeof N=="function")for(i=N.call(i),A=0;!(s=i.next()).done;)s=s.value,N=p+u1(s,A++),E+=np(s,n,c,N,f);else if(s==="object")throw n=String(i),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return E}function rp(i,n,c){if(i==null)return i;var p=[],f=0;return np(i,p,"","",function(s){return n.call(c,s,f++)}),p}function Y3(i){if(i._status===-1){var n=i._result;n=n(),n.then(function(c){(i._status===0||i._status===-1)&&(i._status=1,i._result=c)},function(c){(i._status===0||i._status===-1)&&(i._status=2,i._result=c)}),i._status===-1&&(i._status=0,i._result=n)}if(i._status===1)return i._result.default;throw i._result}var kr={current:null},op={transition:null},Q3={ReactCurrentDispatcher:kr,ReactCurrentBatchConfig:op,ReactCurrentOwner:p1};function ov(){throw Error("act(...) is not supported in production builds of React.")}Et.Children={map:rp,forEach:function(i,n,c){rp(i,function(){n.apply(this,arguments)},c)},count:function(i){var n=0;return rp(i,function(){n++}),n},toArray:function(i){return rp(i,function(n){return n})||[]},only:function(i){if(!f1(i))throw Error("React.Children.only expected to receive a single React element child.");return i}};Et.Component=rc;Et.Fragment=j3;Et.Profiler=U3;Et.PureComponent=h1;Et.StrictMode=V3;Et.Suspense=H3;Et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q3;Et.act=ov;Et.cloneElement=function(i,n,c){if(i==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+i+".");var p=Q_({},i.props),f=i.key,s=i.ref,E=i._owner;if(n!=null){if(n.ref!==void 0&&(s=n.ref,E=p1.current),n.key!==void 0&&(f=""+n.key),i.type&&i.type.defaultProps)var A=i.type.defaultProps;for(N in n)iv.call(n,N)&&!rv.hasOwnProperty(N)&&(p[N]=n[N]===void 0&&A!==void 0?A[N]:n[N])}var N=arguments.length-2;if(N===1)p.children=c;else if(1<N){A=Array(N);for(var B=0;B<N;B++)A[B]=arguments[B+2];p.children=A}return{$$typeof:Ku,type:i.type,key:f,ref:s,props:p,_owner:E}};Et.createContext=function(i){return i={$$typeof:$3,_currentValue:i,_currentValue2:i,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},i.Provider={$$typeof:q3,_context:i},i.Consumer=i};Et.createElement=nv;Et.createFactory=function(i){var n=nv.bind(null,i);return n.type=i,n};Et.createRef=function(){return{current:null}};Et.forwardRef=function(i){return{$$typeof:Z3,render:i}};Et.isValidElement=f1;Et.lazy=function(i){return{$$typeof:W3,_payload:{_status:-1,_result:i},_init:Y3}};Et.memo=function(i,n){return{$$typeof:G3,type:i,compare:n===void 0?null:n}};Et.startTransition=function(i){var n=op.transition;op.transition={};try{i()}finally{op.transition=n}};Et.unstable_act=ov;Et.useCallback=function(i,n){return kr.current.useCallback(i,n)};Et.useContext=function(i){return kr.current.useContext(i)};Et.useDebugValue=function(){};Et.useDeferredValue=function(i){return kr.current.useDeferredValue(i)};Et.useEffect=function(i,n){return kr.current.useEffect(i,n)};Et.useId=function(){return kr.current.useId()};Et.useImperativeHandle=function(i,n,c){return kr.current.useImperativeHandle(i,n,c)};Et.useInsertionEffect=function(i,n){return kr.current.useInsertionEffect(i,n)};Et.useLayoutEffect=function(i,n){return kr.current.useLayoutEffect(i,n)};Et.useMemo=function(i,n){return kr.current.useMemo(i,n)};Et.useReducer=function(i,n,c){return kr.current.useReducer(i,n,c)};Et.useRef=function(i){return kr.current.useRef(i)};Et.useState=function(i){return kr.current.useState(i)};Et.useSyncExternalStore=function(i,n,c){return kr.current.useSyncExternalStore(i,n,c)};Et.useTransition=function(){return kr.current.useTransition()};Et.version="18.3.1"});var Gt=Ua((QS,sv)=>{"use strict";sv.exports=av()});var yv=Ua(Kt=>{"use strict";function _1(i,n){var c=i.length;i.push(n);e:for(;0<c;){var p=c-1>>>1,f=i[p];if(0<ap(f,n))i[p]=n,i[c]=f,c=p;else break e}}function $n(i){return i.length===0?null:i[0]}function lp(i){if(i.length===0)return null;var n=i[0],c=i.pop();if(c!==n){i[0]=c;e:for(var p=0,f=i.length,s=f>>>1;p<s;){var E=2*(p+1)-1,A=i[E],N=E+1,B=i[N];if(0>ap(A,c))N<f&&0>ap(B,A)?(i[p]=B,i[N]=c,p=N):(i[p]=A,i[E]=c,p=E);else if(N<f&&0>ap(B,c))i[p]=B,i[N]=c,p=N;else break e}}return n}function ap(i,n){var c=i.sortIndex-n.sortIndex;return c!==0?c:i.id-n.id}typeof performance=="object"&&typeof performance.now=="function"?(lv=performance,Kt.unstable_now=function(){return lv.now()}):(m1=Date,cv=m1.now(),Kt.unstable_now=function(){return m1.now()-cv});var lv,m1,cv,go=[],qa=[],e4=1,Tn=null,sr=3,cp=!1,$s=!1,Yu=!1,dv=typeof setTimeout=="function"?setTimeout:null,pv=typeof clearTimeout=="function"?clearTimeout:null,uv=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v1(i){for(var n=$n(qa);n!==null;){if(n.callback===null)lp(qa);else if(n.startTime<=i)lp(qa),n.sortIndex=n.expirationTime,_1(go,n);else break;n=$n(qa)}}function x1(i){if(Yu=!1,v1(i),!$s)if($n(go)!==null)$s=!0,b1(w1);else{var n=$n(qa);n!==null&&k1(x1,n.startTime-i)}}function w1(i,n){$s=!1,Yu&&(Yu=!1,pv(Qu),Qu=-1),cp=!0;var c=sr;try{for(v1(n),Tn=$n(go);Tn!==null&&(!(Tn.expirationTime>n)||i&&!gv());){var p=Tn.callback;if(typeof p=="function"){Tn.callback=null,sr=Tn.priorityLevel;var f=p(Tn.expirationTime<=n);n=Kt.unstable_now(),typeof f=="function"?Tn.callback=f:Tn===$n(go)&&lp(go),v1(n)}else lp(go);Tn=$n(go)}if(Tn!==null)var s=!0;else{var E=$n(qa);E!==null&&k1(x1,E.startTime-n),s=!1}return s}finally{Tn=null,sr=c,cp=!1}}var up=!1,sp=null,Qu=-1,fv=5,mv=-1;function gv(){return!(Kt.unstable_now()-mv<fv)}function g1(){if(sp!==null){var i=Kt.unstable_now();mv=i;var n=!0;try{n=sp(!0,i)}finally{n?Ju():(up=!1,sp=null)}}else up=!1}var Ju;typeof uv=="function"?Ju=function(){uv(g1)}:typeof MessageChannel<"u"?(y1=new MessageChannel,hv=y1.port2,y1.port1.onmessage=g1,Ju=function(){hv.postMessage(null)}):Ju=function(){dv(g1,0)};var y1,hv;function b1(i){sp=i,up||(up=!0,Ju())}function k1(i,n){Qu=dv(function(){i(Kt.unstable_now())},n)}Kt.unstable_IdlePriority=5;Kt.unstable_ImmediatePriority=1;Kt.unstable_LowPriority=4;Kt.unstable_NormalPriority=3;Kt.unstable_Profiling=null;Kt.unstable_UserBlockingPriority=2;Kt.unstable_cancelCallback=function(i){i.callback=null};Kt.unstable_continueExecution=function(){$s||cp||($s=!0,b1(w1))};Kt.unstable_forceFrameRate=function(i){0>i||125<i?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):fv=0<i?Math.floor(1e3/i):5};Kt.unstable_getCurrentPriorityLevel=function(){return sr};Kt.unstable_getFirstCallbackNode=function(){return $n(go)};Kt.unstable_next=function(i){switch(sr){case 1:case 2:case 3:var n=3;break;default:n=sr}var c=sr;sr=n;try{return i()}finally{sr=c}};Kt.unstable_pauseExecution=function(){};Kt.unstable_requestPaint=function(){};Kt.unstable_runWithPriority=function(i,n){switch(i){case 1:case 2:case 3:case 4:case 5:break;default:i=3}var c=sr;sr=i;try{return n()}finally{sr=c}};Kt.unstable_scheduleCallback=function(i,n,c){var p=Kt.unstable_now();switch(typeof c=="object"&&c!==null?(c=c.delay,c=typeof c=="number"&&0<c?p+c:p):c=p,i){case 1:var f=-1;break;case 2:f=250;break;case 5:f=1073741823;break;case 4:f=1e4;break;default:f=5e3}return f=c+f,i={id:e4++,callback:n,priorityLevel:i,startTime:c,expirationTime:f,sortIndex:-1},c>p?(i.sortIndex=c,_1(qa,i),$n(go)===null&&i===$n(qa)&&(Yu?(pv(Qu),Qu=-1):Yu=!0,k1(x1,c-p))):(i.sortIndex=f,_1(go,i),$s||cp||($s=!0,b1(w1))),i};Kt.unstable_shouldYield=gv;Kt.unstable_wrapCallback=function(i){var n=sr;return function(){var c=sr;sr=n;try{return i.apply(this,arguments)}finally{sr=c}}}});var vv=Ua((tE,_v)=>{"use strict";_v.exports=yv()});var kw=Ua(hn=>{"use strict";var t4=Gt(),cn=vv();function Me(i){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+i,c=1;c<arguments.length;c++)n+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+i+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Tx=new Set,wh={};function rl(i,n){Sc(i,n),Sc(i+"Capture",n)}function Sc(i,n){for(wh[i]=n,i=0;i<n.length;i++)Tx.add(n[i])}var Jo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),H1=Object.prototype.hasOwnProperty,i4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xv={},wv={};function r4(i){return H1.call(wv,i)?!0:H1.call(xv,i)?!1:i4.test(i)?wv[i]=!0:(xv[i]=!0,!1)}function n4(i,n,c,p){if(c!==null&&c.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return p?!1:c!==null?!c.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function o4(i,n,c,p){if(n===null||typeof n>"u"||n4(i,n,c,p))return!0;if(p)return!1;if(c!==null)switch(c.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function Tr(i,n,c,p,f,s,E){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=p,this.attributeNamespace=f,this.mustUseProperty=c,this.propertyName=i,this.type=n,this.sanitizeURL=s,this.removeEmptyString=E}var Ki={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){Ki[i]=new Tr(i,0,!1,i,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var n=i[0];Ki[n]=new Tr(n,1,!1,i[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(i){Ki[i]=new Tr(i,2,!1,i.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){Ki[i]=new Tr(i,2,!1,i,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){Ki[i]=new Tr(i,3,!1,i.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(i){Ki[i]=new Tr(i,3,!0,i,null,!1,!1)});["capture","download"].forEach(function(i){Ki[i]=new Tr(i,4,!1,i,null,!1,!1)});["cols","rows","size","span"].forEach(function(i){Ki[i]=new Tr(i,6,!1,i,null,!1,!1)});["rowSpan","start"].forEach(function(i){Ki[i]=new Tr(i,5,!1,i.toLowerCase(),null,!1,!1)});var Og=/[\-:]([a-z])/g;function Ng(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var n=i.replace(Og,Ng);Ki[n]=new Tr(n,1,!1,i,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var n=i.replace(Og,Ng);Ki[n]=new Tr(n,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(i){var n=i.replace(Og,Ng);Ki[n]=new Tr(n,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(i){Ki[i]=new Tr(i,1,!1,i.toLowerCase(),null,!1,!1)});Ki.xlinkHref=new Tr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(i){Ki[i]=new Tr(i,1,!1,i.toLowerCase(),null,!0,!0)});function jg(i,n,c,p){var f=Ki.hasOwnProperty(n)?Ki[n]:null;(f!==null?f.type!==0:p||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(o4(n,c,f,p)&&(c=null),p||f===null?r4(n)&&(c===null?i.removeAttribute(n):i.setAttribute(n,""+c)):f.mustUseProperty?i[f.propertyName]=c===null?f.type===3?!1:"":c:(n=f.attributeName,p=f.attributeNamespace,c===null?i.removeAttribute(n):(f=f.type,c=f===3||f===4&&c===!0?"":""+c,p?i.setAttributeNS(p,n,c):i.setAttribute(n,c))))}var ta=t4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,hp=Symbol.for("react.element"),ac=Symbol.for("react.portal"),sc=Symbol.for("react.fragment"),Vg=Symbol.for("react.strict_mode"),G1=Symbol.for("react.profiler"),Cx=Symbol.for("react.provider"),zx=Symbol.for("react.context"),Ug=Symbol.for("react.forward_ref"),W1=Symbol.for("react.suspense"),X1=Symbol.for("react.suspense_list"),qg=Symbol.for("react.memo"),Za=Symbol.for("react.lazy");Symbol.for("react.scope");Symbol.for("react.debug_trace_mode");var Ix=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden");Symbol.for("react.cache");Symbol.for("react.tracing_marker");var bv=Symbol.iterator;function eh(i){return i===null||typeof i!="object"?null:(i=bv&&i[bv]||i["@@iterator"],typeof i=="function"?i:null)}var hi=Object.assign,S1;function lh(i){if(S1===void 0)try{throw Error()}catch(c){var n=c.stack.trim().match(/\n( *(at )?)/);S1=n&&n[1]||""}return`
`+S1+i}var E1=!1;function T1(i,n){if(!i||E1)return"";E1=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(B){var p=B}Reflect.construct(i,[],n)}else{try{n.call()}catch(B){p=B}i.call(n.prototype)}else{try{throw Error()}catch(B){p=B}i()}}catch(B){if(B&&p&&typeof B.stack=="string"){for(var f=B.stack.split(`
`),s=p.stack.split(`
`),E=f.length-1,A=s.length-1;1<=E&&0<=A&&f[E]!==s[A];)A--;for(;1<=E&&0<=A;E--,A--)if(f[E]!==s[A]){if(E!==1||A!==1)do if(E--,A--,0>A||f[E]!==s[A]){var N=`
`+f[E].replace(" at new "," at ");return i.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",i.displayName)),N}while(1<=E&&0<=A);break}}}finally{E1=!1,Error.prepareStackTrace=c}return(i=i?i.displayName||i.name:"")?lh(i):""}function a4(i){switch(i.tag){case 5:return lh(i.type);case 16:return lh("Lazy");case 13:return lh("Suspense");case 19:return lh("SuspenseList");case 0:case 2:case 15:return i=T1(i.type,!1),i;case 11:return i=T1(i.type.render,!1),i;case 1:return i=T1(i.type,!0),i;default:return""}}function K1(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case sc:return"Fragment";case ac:return"Portal";case G1:return"Profiler";case Vg:return"StrictMode";case W1:return"Suspense";case X1:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case zx:return(i.displayName||"Context")+".Consumer";case Cx:return(i._context.displayName||"Context")+".Provider";case Ug:var n=i.render;return i=i.displayName,i||(i=n.displayName||n.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case qg:return n=i.displayName||null,n!==null?n:K1(i.type)||"Memo";case Za:n=i._payload,i=i._init;try{return K1(i(n))}catch{}}return null}function s4(i){var n=i.type;switch(i.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=n.render,i=i.displayName||i.name||"",n.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return K1(n);case 8:return n===Vg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function os(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Px(i){var n=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function l4(i){var n=Px(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,n),p=""+i[n];if(!i.hasOwnProperty(n)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var f=c.get,s=c.set;return Object.defineProperty(i,n,{configurable:!0,get:function(){return f.call(this)},set:function(E){p=""+E,s.call(this,E)}}),Object.defineProperty(i,n,{enumerable:c.enumerable}),{getValue:function(){return p},setValue:function(E){p=""+E},stopTracking:function(){i._valueTracker=null,delete i[n]}}}}function dp(i){i._valueTracker||(i._valueTracker=l4(i))}function Mx(i){if(!i)return!1;var n=i._valueTracker;if(!n)return!0;var c=n.getValue(),p="";return i&&(p=Px(i)?i.checked?"true":"false":i.value),i=p,i!==c?(n.setValue(i),!0):!1}function jp(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function J1(i,n){var c=n.checked;return hi({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??i._wrapperState.initialChecked})}function kv(i,n){var c=n.defaultValue==null?"":n.defaultValue,p=n.checked!=null?n.checked:n.defaultChecked;c=os(n.value!=null?n.value:c),i._wrapperState={initialChecked:p,initialValue:c,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function Ax(i,n){n=n.checked,n!=null&&jg(i,"checked",n,!1)}function Y1(i,n){Ax(i,n);var c=os(n.value),p=n.type;if(c!=null)p==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+c):i.value!==""+c&&(i.value=""+c);else if(p==="submit"||p==="reset"){i.removeAttribute("value");return}n.hasOwnProperty("value")?Q1(i,n.type,c):n.hasOwnProperty("defaultValue")&&Q1(i,n.type,os(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(i.defaultChecked=!!n.defaultChecked)}function Sv(i,n,c){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var p=n.type;if(!(p!=="submit"&&p!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+i._wrapperState.initialValue,c||n===i.value||(i.value=n),i.defaultValue=n}c=i.name,c!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,c!==""&&(i.name=c)}function Q1(i,n,c){(n!=="number"||jp(i.ownerDocument)!==i)&&(c==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+c&&(i.defaultValue=""+c))}var ch=Array.isArray;function _c(i,n,c,p){if(i=i.options,n){n={};for(var f=0;f<c.length;f++)n["$"+c[f]]=!0;for(c=0;c<i.length;c++)f=n.hasOwnProperty("$"+i[c].value),i[c].selected!==f&&(i[c].selected=f),f&&p&&(i[c].defaultSelected=!0)}else{for(c=""+os(c),n=null,f=0;f<i.length;f++){if(i[f].value===c){i[f].selected=!0,p&&(i[f].defaultSelected=!0);return}n!==null||i[f].disabled||(n=i[f])}n!==null&&(n.selected=!0)}}function eg(i,n){if(n.dangerouslySetInnerHTML!=null)throw Error(Me(91));return hi({},n,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Ev(i,n){var c=n.value;if(c==null){if(c=n.children,n=n.defaultValue,c!=null){if(n!=null)throw Error(Me(92));if(ch(c)){if(1<c.length)throw Error(Me(93));c=c[0]}n=c}n==null&&(n=""),c=n}i._wrapperState={initialValue:os(c)}}function Lx(i,n){var c=os(n.value),p=os(n.defaultValue);c!=null&&(c=""+c,c!==i.value&&(i.value=c),n.defaultValue==null&&i.defaultValue!==c&&(i.defaultValue=c)),p!=null&&(i.defaultValue=""+p)}function Tv(i){var n=i.textContent;n===i._wrapperState.initialValue&&n!==""&&n!==null&&(i.value=n)}function Dx(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tg(i,n){return i==null||i==="http://www.w3.org/1999/xhtml"?Dx(n):i==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var pp,Rx=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,c,p,f){MSApp.execUnsafeLocalFunction(function(){return i(n,c,p,f)})}:i}(function(i,n){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=n;else{for(pp=pp||document.createElement("div"),pp.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=pp.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;n.firstChild;)i.appendChild(n.firstChild)}});function bh(i,n){if(n){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=n;return}}i.textContent=n}var dh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},c4=["Webkit","ms","Moz","O"];Object.keys(dh).forEach(function(i){c4.forEach(function(n){n=n+i.charAt(0).toUpperCase()+i.substring(1),dh[n]=dh[i]})});function Fx(i,n,c){return n==null||typeof n=="boolean"||n===""?"":c||typeof n!="number"||n===0||dh.hasOwnProperty(i)&&dh[i]?(""+n).trim():n+"px"}function Bx(i,n){i=i.style;for(var c in n)if(n.hasOwnProperty(c)){var p=c.indexOf("--")===0,f=Fx(c,n[c],p);c==="float"&&(c="cssFloat"),p?i.setProperty(c,f):i[c]=f}}var u4=hi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ig(i,n){if(n){if(u4[i]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(Me(137,i));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(Me(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(Me(61))}if(n.style!=null&&typeof n.style!="object")throw Error(Me(62))}}function rg(i,n){if(i.indexOf("-")===-1)return typeof n.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ng=null;function $g(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var og=null,vc=null,xc=null;function Cv(i){if(i=jh(i)){if(typeof og!="function")throw Error(Me(280));var n=i.stateNode;n&&(n=mf(n),og(i.stateNode,i.type,n))}}function Ox(i){vc?xc?xc.push(i):xc=[i]:vc=i}function Nx(){if(vc){var i=vc,n=xc;if(xc=vc=null,Cv(i),n)for(i=0;i<n.length;i++)Cv(n[i])}}function jx(i,n){return i(n)}function Vx(){}var C1=!1;function Ux(i,n,c){if(C1)return i(n,c);C1=!0;try{return jx(i,n,c)}finally{C1=!1,(vc!==null||xc!==null)&&(Vx(),Nx())}}function kh(i,n){var c=i.stateNode;if(c===null)return null;var p=mf(c);if(p===null)return null;c=p[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(Me(231,n,typeof c));return c}var ag=!1;if(Jo)try{nc={},Object.defineProperty(nc,"passive",{get:function(){ag=!0}}),window.addEventListener("test",nc,nc),window.removeEventListener("test",nc,nc)}catch{ag=!1}var nc;function h4(i,n,c,p,f,s,E,A,N){var B=Array.prototype.slice.call(arguments,3);try{n.apply(c,B)}catch(j){this.onError(j)}}var ph=!1,Vp=null,Up=!1,sg=null,d4={onError:function(i){ph=!0,Vp=i}};function p4(i,n,c,p,f,s,E,A,N){ph=!1,Vp=null,h4.apply(d4,arguments)}function f4(i,n,c,p,f,s,E,A,N){if(p4.apply(this,arguments),ph){if(ph){var B=Vp;ph=!1,Vp=null}else throw Error(Me(198));Up||(Up=!0,sg=B)}}function nl(i){var n=i,c=i;if(i.alternate)for(;n.return;)n=n.return;else{i=n;do n=i,n.flags&4098&&(c=n.return),i=n.return;while(i)}return n.tag===3?c:null}function qx(i){if(i.tag===13){var n=i.memoizedState;if(n===null&&(i=i.alternate,i!==null&&(n=i.memoizedState)),n!==null)return n.dehydrated}return null}function zv(i){if(nl(i)!==i)throw Error(Me(188))}function m4(i){var n=i.alternate;if(!n){if(n=nl(i),n===null)throw Error(Me(188));return n!==i?null:i}for(var c=i,p=n;;){var f=c.return;if(f===null)break;var s=f.alternate;if(s===null){if(p=f.return,p!==null){c=p;continue}break}if(f.child===s.child){for(s=f.child;s;){if(s===c)return zv(f),i;if(s===p)return zv(f),n;s=s.sibling}throw Error(Me(188))}if(c.return!==p.return)c=f,p=s;else{for(var E=!1,A=f.child;A;){if(A===c){E=!0,c=f,p=s;break}if(A===p){E=!0,p=f,c=s;break}A=A.sibling}if(!E){for(A=s.child;A;){if(A===c){E=!0,c=s,p=f;break}if(A===p){E=!0,p=s,c=f;break}A=A.sibling}if(!E)throw Error(Me(189))}}if(c.alternate!==p)throw Error(Me(190))}if(c.tag!==3)throw Error(Me(188));return c.stateNode.current===c?i:n}function $x(i){return i=m4(i),i!==null?Zx(i):null}function Zx(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var n=Zx(i);if(n!==null)return n;i=i.sibling}return null}var Hx=cn.unstable_scheduleCallback,Iv=cn.unstable_cancelCallback,g4=cn.unstable_shouldYield,y4=cn.unstable_requestPaint,yi=cn.unstable_now,_4=cn.unstable_getCurrentPriorityLevel,Zg=cn.unstable_ImmediatePriority,Gx=cn.unstable_UserBlockingPriority,qp=cn.unstable_NormalPriority,v4=cn.unstable_LowPriority,Wx=cn.unstable_IdlePriority,hf=null,xo=null;function x4(i){if(xo&&typeof xo.onCommitFiberRoot=="function")try{xo.onCommitFiberRoot(hf,i,void 0,(i.current.flags&128)===128)}catch{}}var Xn=Math.clz32?Math.clz32:k4,w4=Math.log,b4=Math.LN2;function k4(i){return i>>>=0,i===0?32:31-(w4(i)/b4|0)|0}var fp=64,mp=4194304;function uh(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function $p(i,n){var c=i.pendingLanes;if(c===0)return 0;var p=0,f=i.suspendedLanes,s=i.pingedLanes,E=c&268435455;if(E!==0){var A=E&~f;A!==0?p=uh(A):(s&=E,s!==0&&(p=uh(s)))}else E=c&~f,E!==0?p=uh(E):s!==0&&(p=uh(s));if(p===0)return 0;if(n!==0&&n!==p&&!(n&f)&&(f=p&-p,s=n&-n,f>=s||f===16&&(s&4194240)!==0))return n;if(p&4&&(p|=c&16),n=i.entangledLanes,n!==0)for(i=i.entanglements,n&=p;0<n;)c=31-Xn(n),f=1<<c,p|=i[c],n&=~f;return p}function S4(i,n){switch(i){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function E4(i,n){for(var c=i.suspendedLanes,p=i.pingedLanes,f=i.expirationTimes,s=i.pendingLanes;0<s;){var E=31-Xn(s),A=1<<E,N=f[E];N===-1?(!(A&c)||A&p)&&(f[E]=S4(A,n)):N<=n&&(i.expiredLanes|=A),s&=~A}}function lg(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Xx(){var i=fp;return fp<<=1,!(fp&4194240)&&(fp=64),i}function z1(i){for(var n=[],c=0;31>c;c++)n.push(i);return n}function Oh(i,n,c){i.pendingLanes|=n,n!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,n=31-Xn(n),i[n]=c}function T4(i,n){var c=i.pendingLanes&~n;i.pendingLanes=n,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=n,i.mutableReadLanes&=n,i.entangledLanes&=n,n=i.entanglements;var p=i.eventTimes;for(i=i.expirationTimes;0<c;){var f=31-Xn(c),s=1<<f;n[f]=0,p[f]=-1,i[f]=-1,c&=~s}}function Hg(i,n){var c=i.entangledLanes|=n;for(i=i.entanglements;c;){var p=31-Xn(c),f=1<<p;f&n|i[p]&n&&(i[p]|=n),c&=~f}}var Vt=0;function Kx(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var Jx,Gg,Yx,Qx,e2,cg=!1,gp=[],Ja=null,Ya=null,Qa=null,Sh=new Map,Eh=new Map,Ga=[],C4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pv(i,n){switch(i){case"focusin":case"focusout":Ja=null;break;case"dragenter":case"dragleave":Ya=null;break;case"mouseover":case"mouseout":Qa=null;break;case"pointerover":case"pointerout":Sh.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":Eh.delete(n.pointerId)}}function th(i,n,c,p,f,s){return i===null||i.nativeEvent!==s?(i={blockedOn:n,domEventName:c,eventSystemFlags:p,nativeEvent:s,targetContainers:[f]},n!==null&&(n=jh(n),n!==null&&Gg(n)),i):(i.eventSystemFlags|=p,n=i.targetContainers,f!==null&&n.indexOf(f)===-1&&n.push(f),i)}function z4(i,n,c,p,f){switch(n){case"focusin":return Ja=th(Ja,i,n,c,p,f),!0;case"dragenter":return Ya=th(Ya,i,n,c,p,f),!0;case"mouseover":return Qa=th(Qa,i,n,c,p,f),!0;case"pointerover":var s=f.pointerId;return Sh.set(s,th(Sh.get(s)||null,i,n,c,p,f)),!0;case"gotpointercapture":return s=f.pointerId,Eh.set(s,th(Eh.get(s)||null,i,n,c,p,f)),!0}return!1}function t2(i){var n=Gs(i.target);if(n!==null){var c=nl(n);if(c!==null){if(n=c.tag,n===13){if(n=qx(c),n!==null){i.blockedOn=n,e2(i.priority,function(){Yx(c)});return}}else if(n===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Pp(i){if(i.blockedOn!==null)return!1;for(var n=i.targetContainers;0<n.length;){var c=ug(i.domEventName,i.eventSystemFlags,n[0],i.nativeEvent);if(c===null){c=i.nativeEvent;var p=new c.constructor(c.type,c);ng=p,c.target.dispatchEvent(p),ng=null}else return n=jh(c),n!==null&&Gg(n),i.blockedOn=c,!1;n.shift()}return!0}function Mv(i,n,c){Pp(i)&&c.delete(n)}function I4(){cg=!1,Ja!==null&&Pp(Ja)&&(Ja=null),Ya!==null&&Pp(Ya)&&(Ya=null),Qa!==null&&Pp(Qa)&&(Qa=null),Sh.forEach(Mv),Eh.forEach(Mv)}function ih(i,n){i.blockedOn===n&&(i.blockedOn=null,cg||(cg=!0,cn.unstable_scheduleCallback(cn.unstable_NormalPriority,I4)))}function Th(i){function n(f){return ih(f,i)}if(0<gp.length){ih(gp[0],i);for(var c=1;c<gp.length;c++){var p=gp[c];p.blockedOn===i&&(p.blockedOn=null)}}for(Ja!==null&&ih(Ja,i),Ya!==null&&ih(Ya,i),Qa!==null&&ih(Qa,i),Sh.forEach(n),Eh.forEach(n),c=0;c<Ga.length;c++)p=Ga[c],p.blockedOn===i&&(p.blockedOn=null);for(;0<Ga.length&&(c=Ga[0],c.blockedOn===null);)t2(c),c.blockedOn===null&&Ga.shift()}var wc=ta.ReactCurrentBatchConfig,Zp=!0;function P4(i,n,c,p){var f=Vt,s=wc.transition;wc.transition=null;try{Vt=1,Wg(i,n,c,p)}finally{Vt=f,wc.transition=s}}function M4(i,n,c,p){var f=Vt,s=wc.transition;wc.transition=null;try{Vt=4,Wg(i,n,c,p)}finally{Vt=f,wc.transition=s}}function Wg(i,n,c,p){if(Zp){var f=ug(i,n,c,p);if(f===null)R1(i,n,p,Hp,c),Pv(i,p);else if(z4(f,i,n,c,p))p.stopPropagation();else if(Pv(i,p),n&4&&-1<C4.indexOf(i)){for(;f!==null;){var s=jh(f);if(s!==null&&Jx(s),s=ug(i,n,c,p),s===null&&R1(i,n,p,Hp,c),s===f)break;f=s}f!==null&&p.stopPropagation()}else R1(i,n,p,null,c)}}var Hp=null;function ug(i,n,c,p){if(Hp=null,i=$g(p),i=Gs(i),i!==null)if(n=nl(i),n===null)i=null;else if(c=n.tag,c===13){if(i=qx(n),i!==null)return i;i=null}else if(c===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;i=null}else n!==i&&(i=null);return Hp=i,null}function i2(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_4()){case Zg:return 1;case Gx:return 4;case qp:case v4:return 16;case Wx:return 536870912;default:return 16}default:return 16}}var Xa=null,Xg=null,Mp=null;function r2(){if(Mp)return Mp;var i,n=Xg,c=n.length,p,f="value"in Xa?Xa.value:Xa.textContent,s=f.length;for(i=0;i<c&&n[i]===f[i];i++);var E=c-i;for(p=1;p<=E&&n[c-p]===f[s-p];p++);return Mp=f.slice(i,1<p?1-p:void 0)}function Ap(i){var n=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&n===13&&(i=13)):i=n,i===10&&(i=13),32<=i||i===13?i:0}function yp(){return!0}function Av(){return!1}function un(i){function n(c,p,f,s,E){this._reactName=c,this._targetInst=f,this.type=p,this.nativeEvent=s,this.target=E,this.currentTarget=null;for(var A in i)i.hasOwnProperty(A)&&(c=i[A],this[A]=c?c(s):s[A]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?yp:Av,this.isPropagationStopped=Av,this}return hi(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=yp)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=yp)},persist:function(){},isPersistent:yp}),n}var Mc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Kg=un(Mc),Nh=hi({},Mc,{view:0,detail:0}),A4=un(Nh),I1,P1,rh,df=hi({},Nh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jg,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==rh&&(rh&&i.type==="mousemove"?(I1=i.screenX-rh.screenX,P1=i.screenY-rh.screenY):P1=I1=0,rh=i),I1)},movementY:function(i){return"movementY"in i?i.movementY:P1}}),Lv=un(df),L4=hi({},df,{dataTransfer:0}),D4=un(L4),R4=hi({},Nh,{relatedTarget:0}),M1=un(R4),F4=hi({},Mc,{animationName:0,elapsedTime:0,pseudoElement:0}),B4=un(F4),O4=hi({},Mc,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),N4=un(O4),j4=hi({},Mc,{data:0}),Dv=un(j4),V4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},U4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},q4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $4(i){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(i):(i=q4[i])?!!n[i]:!1}function Jg(){return $4}var Z4=hi({},Nh,{key:function(i){if(i.key){var n=V4[i.key]||i.key;if(n!=="Unidentified")return n}return i.type==="keypress"?(i=Ap(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?U4[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jg,charCode:function(i){return i.type==="keypress"?Ap(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ap(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),H4=un(Z4),G4=hi({},df,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rv=un(G4),W4=hi({},Nh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jg}),X4=un(W4),K4=hi({},Mc,{propertyName:0,elapsedTime:0,pseudoElement:0}),J4=un(K4),Y4=hi({},df,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Q4=un(Y4),ek=[9,13,27,32],Yg=Jo&&"CompositionEvent"in window,fh=null;Jo&&"documentMode"in document&&(fh=document.documentMode);var tk=Jo&&"TextEvent"in window&&!fh,n2=Jo&&(!Yg||fh&&8<fh&&11>=fh),Fv=" ",Bv=!1;function o2(i,n){switch(i){case"keyup":return ek.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function a2(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var lc=!1;function ik(i,n){switch(i){case"compositionend":return a2(n);case"keypress":return n.which!==32?null:(Bv=!0,Fv);case"textInput":return i=n.data,i===Fv&&Bv?null:i;default:return null}}function rk(i,n){if(lc)return i==="compositionend"||!Yg&&o2(i,n)?(i=r2(),Mp=Xg=Xa=null,lc=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return n2&&n.locale!=="ko"?null:n.data;default:return null}}var nk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ov(i){var n=i&&i.nodeName&&i.nodeName.toLowerCase();return n==="input"?!!nk[i.type]:n==="textarea"}function s2(i,n,c,p){Ox(p),n=Gp(n,"onChange"),0<n.length&&(c=new Kg("onChange","change",null,c,p),i.push({event:c,listeners:n}))}var mh=null,Ch=null;function ok(i){_2(i,0)}function pf(i){var n=hc(i);if(Mx(n))return i}function ak(i,n){if(i==="change")return n}var l2=!1;Jo&&(Jo?(vp="oninput"in document,vp||(A1=document.createElement("div"),A1.setAttribute("oninput","return;"),vp=typeof A1.oninput=="function"),_p=vp):_p=!1,l2=_p&&(!document.documentMode||9<document.documentMode));var _p,vp,A1;function Nv(){mh&&(mh.detachEvent("onpropertychange",c2),Ch=mh=null)}function c2(i){if(i.propertyName==="value"&&pf(Ch)){var n=[];s2(n,Ch,i,$g(i)),Ux(ok,n)}}function sk(i,n,c){i==="focusin"?(Nv(),mh=n,Ch=c,mh.attachEvent("onpropertychange",c2)):i==="focusout"&&Nv()}function lk(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return pf(Ch)}function ck(i,n){if(i==="click")return pf(n)}function uk(i,n){if(i==="input"||i==="change")return pf(n)}function hk(i,n){return i===n&&(i!==0||1/i===1/n)||i!==i&&n!==n}var Jn=typeof Object.is=="function"?Object.is:hk;function zh(i,n){if(Jn(i,n))return!0;if(typeof i!="object"||i===null||typeof n!="object"||n===null)return!1;var c=Object.keys(i),p=Object.keys(n);if(c.length!==p.length)return!1;for(p=0;p<c.length;p++){var f=c[p];if(!H1.call(n,f)||!Jn(i[f],n[f]))return!1}return!0}function jv(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Vv(i,n){var c=jv(i);i=0;for(var p;c;){if(c.nodeType===3){if(p=i+c.textContent.length,i<=n&&p>=n)return{node:c,offset:n-i};i=p}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=jv(c)}}function u2(i,n){return i&&n?i===n?!0:i&&i.nodeType===3?!1:n&&n.nodeType===3?u2(i,n.parentNode):"contains"in i?i.contains(n):i.compareDocumentPosition?!!(i.compareDocumentPosition(n)&16):!1:!1}function h2(){for(var i=window,n=jp();n instanceof i.HTMLIFrameElement;){try{var c=typeof n.contentWindow.location.href=="string"}catch{c=!1}if(c)i=n.contentWindow;else break;n=jp(i.document)}return n}function Qg(i){var n=i&&i.nodeName&&i.nodeName.toLowerCase();return n&&(n==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||n==="textarea"||i.contentEditable==="true")}function dk(i){var n=h2(),c=i.focusedElem,p=i.selectionRange;if(n!==c&&c&&c.ownerDocument&&u2(c.ownerDocument.documentElement,c)){if(p!==null&&Qg(c)){if(n=p.start,i=p.end,i===void 0&&(i=n),"selectionStart"in c)c.selectionStart=n,c.selectionEnd=Math.min(i,c.value.length);else if(i=(n=c.ownerDocument||document)&&n.defaultView||window,i.getSelection){i=i.getSelection();var f=c.textContent.length,s=Math.min(p.start,f);p=p.end===void 0?s:Math.min(p.end,f),!i.extend&&s>p&&(f=p,p=s,s=f),f=Vv(c,s);var E=Vv(c,p);f&&E&&(i.rangeCount!==1||i.anchorNode!==f.node||i.anchorOffset!==f.offset||i.focusNode!==E.node||i.focusOffset!==E.offset)&&(n=n.createRange(),n.setStart(f.node,f.offset),i.removeAllRanges(),s>p?(i.addRange(n),i.extend(E.node,E.offset)):(n.setEnd(E.node,E.offset),i.addRange(n)))}}for(n=[],i=c;i=i.parentNode;)i.nodeType===1&&n.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<n.length;c++)i=n[c],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var pk=Jo&&"documentMode"in document&&11>=document.documentMode,cc=null,hg=null,gh=null,dg=!1;function Uv(i,n,c){var p=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;dg||cc==null||cc!==jp(p)||(p=cc,"selectionStart"in p&&Qg(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),gh&&zh(gh,p)||(gh=p,p=Gp(hg,"onSelect"),0<p.length&&(n=new Kg("onSelect","select",null,n,c),i.push({event:n,listeners:p}),n.target=cc)))}function xp(i,n){var c={};return c[i.toLowerCase()]=n.toLowerCase(),c["Webkit"+i]="webkit"+n,c["Moz"+i]="moz"+n,c}var uc={animationend:xp("Animation","AnimationEnd"),animationiteration:xp("Animation","AnimationIteration"),animationstart:xp("Animation","AnimationStart"),transitionend:xp("Transition","TransitionEnd")},L1={},d2={};Jo&&(d2=document.createElement("div").style,"AnimationEvent"in window||(delete uc.animationend.animation,delete uc.animationiteration.animation,delete uc.animationstart.animation),"TransitionEvent"in window||delete uc.transitionend.transition);function ff(i){if(L1[i])return L1[i];if(!uc[i])return i;var n=uc[i],c;for(c in n)if(n.hasOwnProperty(c)&&c in d2)return L1[i]=n[c];return i}var p2=ff("animationend"),f2=ff("animationiteration"),m2=ff("animationstart"),g2=ff("transitionend"),y2=new Map,qv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ss(i,n){y2.set(i,n),rl(n,[i])}for(wp=0;wp<qv.length;wp++)bp=qv[wp],$v=bp.toLowerCase(),Zv=bp[0].toUpperCase()+bp.slice(1),ss($v,"on"+Zv);var bp,$v,Zv,wp;ss(p2,"onAnimationEnd");ss(f2,"onAnimationIteration");ss(m2,"onAnimationStart");ss("dblclick","onDoubleClick");ss("focusin","onFocus");ss("focusout","onBlur");ss(g2,"onTransitionEnd");Sc("onMouseEnter",["mouseout","mouseover"]);Sc("onMouseLeave",["mouseout","mouseover"]);Sc("onPointerEnter",["pointerout","pointerover"]);Sc("onPointerLeave",["pointerout","pointerover"]);rl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));rl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));rl("onBeforeInput",["compositionend","keypress","textInput","paste"]);rl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));rl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));rl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),fk=new Set("cancel close invalid load scroll toggle".split(" ").concat(hh));function Hv(i,n,c){var p=i.type||"unknown-event";i.currentTarget=c,f4(p,n,void 0,i),i.currentTarget=null}function _2(i,n){n=(n&4)!==0;for(var c=0;c<i.length;c++){var p=i[c],f=p.event;p=p.listeners;e:{var s=void 0;if(n)for(var E=p.length-1;0<=E;E--){var A=p[E],N=A.instance,B=A.currentTarget;if(A=A.listener,N!==s&&f.isPropagationStopped())break e;Hv(f,A,B),s=N}else for(E=0;E<p.length;E++){if(A=p[E],N=A.instance,B=A.currentTarget,A=A.listener,N!==s&&f.isPropagationStopped())break e;Hv(f,A,B),s=N}}}if(Up)throw i=sg,Up=!1,sg=null,i}function ti(i,n){var c=n[yg];c===void 0&&(c=n[yg]=new Set);var p=i+"__bubble";c.has(p)||(v2(n,i,2,!1),c.add(p))}function D1(i,n,c){var p=0;n&&(p|=4),v2(c,i,p,n)}var kp="_reactListening"+Math.random().toString(36).slice(2);function Ih(i){if(!i[kp]){i[kp]=!0,Tx.forEach(function(c){c!=="selectionchange"&&(fk.has(c)||D1(c,!1,i),D1(c,!0,i))});var n=i.nodeType===9?i:i.ownerDocument;n===null||n[kp]||(n[kp]=!0,D1("selectionchange",!1,n))}}function v2(i,n,c,p){switch(i2(n)){case 1:var f=P4;break;case 4:f=M4;break;default:f=Wg}c=f.bind(null,n,c,i),f=void 0,!ag||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(f=!0),p?f!==void 0?i.addEventListener(n,c,{capture:!0,passive:f}):i.addEventListener(n,c,!0):f!==void 0?i.addEventListener(n,c,{passive:f}):i.addEventListener(n,c,!1)}function R1(i,n,c,p,f){var s=p;if(!(n&1)&&!(n&2)&&p!==null)e:for(;;){if(p===null)return;var E=p.tag;if(E===3||E===4){var A=p.stateNode.containerInfo;if(A===f||A.nodeType===8&&A.parentNode===f)break;if(E===4)for(E=p.return;E!==null;){var N=E.tag;if((N===3||N===4)&&(N=E.stateNode.containerInfo,N===f||N.nodeType===8&&N.parentNode===f))return;E=E.return}for(;A!==null;){if(E=Gs(A),E===null)return;if(N=E.tag,N===5||N===6){p=s=E;continue e}A=A.parentNode}}p=p.return}Ux(function(){var B=s,j=$g(c),de=[];e:{var ge=y2.get(i);if(ge!==void 0){var Te=Kg,xe=i;switch(i){case"keypress":if(Ap(c)===0)break e;case"keydown":case"keyup":Te=H4;break;case"focusin":xe="focus",Te=M1;break;case"focusout":xe="blur",Te=M1;break;case"beforeblur":case"afterblur":Te=M1;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Te=Lv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Te=D4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Te=X4;break;case p2:case f2:case m2:Te=B4;break;case g2:Te=J4;break;case"scroll":Te=A4;break;case"wheel":Te=Q4;break;case"copy":case"cut":case"paste":Te=N4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Te=Rv}var Se=(n&4)!==0,Ae=!Se&&i==="scroll",ne=Se?ge!==null?ge+"Capture":null:ge;Se=[];for(var ee=B,ae;ee!==null;){ae=ee;var be=ae.stateNode;if(ae.tag===5&&be!==null&&(ae=be,ne!==null&&(be=kh(ee,ne),be!=null&&Se.push(Ph(ee,be,ae)))),Ae)break;ee=ee.return}0<Se.length&&(ge=new Te(ge,xe,null,c,j),de.push({event:ge,listeners:Se}))}}if(!(n&7)){e:{if(ge=i==="mouseover"||i==="pointerover",Te=i==="mouseout"||i==="pointerout",ge&&c!==ng&&(xe=c.relatedTarget||c.fromElement)&&(Gs(xe)||xe[Yo]))break e;if((Te||ge)&&(ge=j.window===j?j:(ge=j.ownerDocument)?ge.defaultView||ge.parentWindow:window,Te?(xe=c.relatedTarget||c.toElement,Te=B,xe=xe?Gs(xe):null,xe!==null&&(Ae=nl(xe),xe!==Ae||xe.tag!==5&&xe.tag!==6)&&(xe=null)):(Te=null,xe=B),Te!==xe)){if(Se=Lv,be="onMouseLeave",ne="onMouseEnter",ee="mouse",(i==="pointerout"||i==="pointerover")&&(Se=Rv,be="onPointerLeave",ne="onPointerEnter",ee="pointer"),Ae=Te==null?ge:hc(Te),ae=xe==null?ge:hc(xe),ge=new Se(be,ee+"leave",Te,c,j),ge.target=Ae,ge.relatedTarget=ae,be=null,Gs(j)===B&&(Se=new Se(ne,ee+"enter",xe,c,j),Se.target=ae,Se.relatedTarget=Ae,be=Se),Ae=be,Te&&xe)t:{for(Se=Te,ne=xe,ee=0,ae=Se;ae;ae=oc(ae))ee++;for(ae=0,be=ne;be;be=oc(be))ae++;for(;0<ee-ae;)Se=oc(Se),ee--;for(;0<ae-ee;)ne=oc(ne),ae--;for(;ee--;){if(Se===ne||ne!==null&&Se===ne.alternate)break t;Se=oc(Se),ne=oc(ne)}Se=null}else Se=null;Te!==null&&Gv(de,ge,Te,Se,!1),xe!==null&&Ae!==null&&Gv(de,Ae,xe,Se,!0)}}e:{if(ge=B?hc(B):window,Te=ge.nodeName&&ge.nodeName.toLowerCase(),Te==="select"||Te==="input"&&ge.type==="file")var Ie=ak;else if(Ov(ge))if(l2)Ie=uk;else{Ie=lk;var Ye=sk}else(Te=ge.nodeName)&&Te.toLowerCase()==="input"&&(ge.type==="checkbox"||ge.type==="radio")&&(Ie=ck);if(Ie&&(Ie=Ie(i,B))){s2(de,Ie,c,j);break e}Ye&&Ye(i,ge,B),i==="focusout"&&(Ye=ge._wrapperState)&&Ye.controlled&&ge.type==="number"&&Q1(ge,"number",ge.value)}switch(Ye=B?hc(B):window,i){case"focusin":(Ov(Ye)||Ye.contentEditable==="true")&&(cc=Ye,hg=B,gh=null);break;case"focusout":gh=hg=cc=null;break;case"mousedown":dg=!0;break;case"contextmenu":case"mouseup":case"dragend":dg=!1,Uv(de,c,j);break;case"selectionchange":if(pk)break;case"keydown":case"keyup":Uv(de,c,j)}var Ge;if(Yg)e:{switch(i){case"compositionstart":var rt="onCompositionStart";break e;case"compositionend":rt="onCompositionEnd";break e;case"compositionupdate":rt="onCompositionUpdate";break e}rt=void 0}else lc?o2(i,c)&&(rt="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(rt="onCompositionStart");rt&&(n2&&c.locale!=="ko"&&(lc||rt!=="onCompositionStart"?rt==="onCompositionEnd"&&lc&&(Ge=r2()):(Xa=j,Xg="value"in Xa?Xa.value:Xa.textContent,lc=!0)),Ye=Gp(B,rt),0<Ye.length&&(rt=new Dv(rt,i,null,c,j),de.push({event:rt,listeners:Ye}),Ge?rt.data=Ge:(Ge=a2(c),Ge!==null&&(rt.data=Ge)))),(Ge=tk?ik(i,c):rk(i,c))&&(B=Gp(B,"onBeforeInput"),0<B.length&&(j=new Dv("onBeforeInput","beforeinput",null,c,j),de.push({event:j,listeners:B}),j.data=Ge))}_2(de,n)})}function Ph(i,n,c){return{instance:i,listener:n,currentTarget:c}}function Gp(i,n){for(var c=n+"Capture",p=[];i!==null;){var f=i,s=f.stateNode;f.tag===5&&s!==null&&(f=s,s=kh(i,c),s!=null&&p.unshift(Ph(i,s,f)),s=kh(i,n),s!=null&&p.push(Ph(i,s,f))),i=i.return}return p}function oc(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Gv(i,n,c,p,f){for(var s=n._reactName,E=[];c!==null&&c!==p;){var A=c,N=A.alternate,B=A.stateNode;if(N!==null&&N===p)break;A.tag===5&&B!==null&&(A=B,f?(N=kh(c,s),N!=null&&E.unshift(Ph(c,N,A))):f||(N=kh(c,s),N!=null&&E.push(Ph(c,N,A)))),c=c.return}E.length!==0&&i.push({event:n,listeners:E})}var mk=/\r\n?/g,gk=/\u0000|\uFFFD/g;function Wv(i){return(typeof i=="string"?i:""+i).replace(mk,`
`).replace(gk,"")}function Sp(i,n,c){if(n=Wv(n),Wv(i)!==n&&c)throw Error(Me(425))}function Wp(){}var pg=null,fg=null;function mg(i,n){return i==="textarea"||i==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var gg=typeof setTimeout=="function"?setTimeout:void 0,yk=typeof clearTimeout=="function"?clearTimeout:void 0,Xv=typeof Promise=="function"?Promise:void 0,_k=typeof queueMicrotask=="function"?queueMicrotask:typeof Xv<"u"?function(i){return Xv.resolve(null).then(i).catch(vk)}:gg;function vk(i){setTimeout(function(){throw i})}function F1(i,n){var c=n,p=0;do{var f=c.nextSibling;if(i.removeChild(c),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(p===0){i.removeChild(f),Th(n);return}p--}else c!=="$"&&c!=="$?"&&c!=="$!"||p++;c=f}while(c);Th(n)}function es(i){for(;i!=null;i=i.nextSibling){var n=i.nodeType;if(n===1||n===3)break;if(n===8){if(n=i.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return i}function Kv(i){i=i.previousSibling;for(var n=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(n===0)return i;n--}else c==="/$"&&n++}i=i.previousSibling}return null}var Ac=Math.random().toString(36).slice(2),vo="__reactFiber$"+Ac,Mh="__reactProps$"+Ac,Yo="__reactContainer$"+Ac,yg="__reactEvents$"+Ac,xk="__reactListeners$"+Ac,wk="__reactHandles$"+Ac;function Gs(i){var n=i[vo];if(n)return n;for(var c=i.parentNode;c;){if(n=c[Yo]||c[vo]){if(c=n.alternate,n.child!==null||c!==null&&c.child!==null)for(i=Kv(i);i!==null;){if(c=i[vo])return c;i=Kv(i)}return n}i=c,c=i.parentNode}return null}function jh(i){return i=i[vo]||i[Yo],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function hc(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(Me(33))}function mf(i){return i[Mh]||null}var _g=[],dc=-1;function ls(i){return{current:i}}function ii(i){0>dc||(i.current=_g[dc],_g[dc]=null,dc--)}function Jt(i,n){dc++,_g[dc]=i.current,i.current=n}var as={},hr=ls(as),Nr=ls(!1),Ys=as;function Ec(i,n){var c=i.type.contextTypes;if(!c)return as;var p=i.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===n)return p.__reactInternalMemoizedMaskedChildContext;var f={},s;for(s in c)f[s]=n[s];return p&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=n,i.__reactInternalMemoizedMaskedChildContext=f),f}function jr(i){return i=i.childContextTypes,i!=null}function Xp(){ii(Nr),ii(hr)}function Jv(i,n,c){if(hr.current!==as)throw Error(Me(168));Jt(hr,n),Jt(Nr,c)}function x2(i,n,c){var p=i.stateNode;if(n=n.childContextTypes,typeof p.getChildContext!="function")return c;p=p.getChildContext();for(var f in p)if(!(f in n))throw Error(Me(108,s4(i)||"Unknown",f));return hi({},c,p)}function Kp(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||as,Ys=hr.current,Jt(hr,i),Jt(Nr,Nr.current),!0}function Yv(i,n,c){var p=i.stateNode;if(!p)throw Error(Me(169));c?(i=x2(i,n,Ys),p.__reactInternalMemoizedMergedChildContext=i,ii(Nr),ii(hr),Jt(hr,i)):ii(Nr),Jt(Nr,c)}var Go=null,gf=!1,B1=!1;function w2(i){Go===null?Go=[i]:Go.push(i)}function bk(i){gf=!0,w2(i)}function cs(){if(!B1&&Go!==null){B1=!0;var i=0,n=Vt;try{var c=Go;for(Vt=1;i<c.length;i++){var p=c[i];do p=p(!0);while(p!==null)}Go=null,gf=!1}catch(f){throw Go!==null&&(Go=Go.slice(i+1)),Hx(Zg,cs),f}finally{Vt=n,B1=!1}}return null}var pc=[],fc=0,Jp=null,Yp=0,Cn=[],zn=0,Qs=null,Wo=1,Xo="";function Zs(i,n){pc[fc++]=Yp,pc[fc++]=Jp,Jp=i,Yp=n}function b2(i,n,c){Cn[zn++]=Wo,Cn[zn++]=Xo,Cn[zn++]=Qs,Qs=i;var p=Wo;i=Xo;var f=32-Xn(p)-1;p&=~(1<<f),c+=1;var s=32-Xn(n)+f;if(30<s){var E=f-f%5;s=(p&(1<<E)-1).toString(32),p>>=E,f-=E,Wo=1<<32-Xn(n)+f|c<<f|p,Xo=s+i}else Wo=1<<s|c<<f|p,Xo=i}function e0(i){i.return!==null&&(Zs(i,1),b2(i,1,0))}function t0(i){for(;i===Jp;)Jp=pc[--fc],pc[fc]=null,Yp=pc[--fc],pc[fc]=null;for(;i===Qs;)Qs=Cn[--zn],Cn[zn]=null,Xo=Cn[--zn],Cn[zn]=null,Wo=Cn[--zn],Cn[zn]=null}var ln=null,sn=null,ai=!1,Wn=null;function k2(i,n){var c=In(5,null,null,0);c.elementType="DELETED",c.stateNode=n,c.return=i,n=i.deletions,n===null?(i.deletions=[c],i.flags|=16):n.push(c)}function Qv(i,n){switch(i.tag){case 5:var c=i.type;return n=n.nodeType!==1||c.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(i.stateNode=n,ln=i,sn=es(n.firstChild),!0):!1;case 6:return n=i.pendingProps===""||n.nodeType!==3?null:n,n!==null?(i.stateNode=n,ln=i,sn=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(c=Qs!==null?{id:Wo,overflow:Xo}:null,i.memoizedState={dehydrated:n,treeContext:c,retryLane:1073741824},c=In(18,null,null,0),c.stateNode=n,c.return=i,i.child=c,ln=i,sn=null,!0):!1;default:return!1}}function vg(i){return(i.mode&1)!==0&&(i.flags&128)===0}function xg(i){if(ai){var n=sn;if(n){var c=n;if(!Qv(i,n)){if(vg(i))throw Error(Me(418));n=es(c.nextSibling);var p=ln;n&&Qv(i,n)?k2(p,c):(i.flags=i.flags&-4097|2,ai=!1,ln=i)}}else{if(vg(i))throw Error(Me(418));i.flags=i.flags&-4097|2,ai=!1,ln=i}}}function ex(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;ln=i}function Ep(i){if(i!==ln)return!1;if(!ai)return ex(i),ai=!0,!1;var n;if((n=i.tag!==3)&&!(n=i.tag!==5)&&(n=i.type,n=n!=="head"&&n!=="body"&&!mg(i.type,i.memoizedProps)),n&&(n=sn)){if(vg(i))throw S2(),Error(Me(418));for(;n;)k2(i,n),n=es(n.nextSibling)}if(ex(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Me(317));e:{for(i=i.nextSibling,n=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"){if(n===0){sn=es(i.nextSibling);break e}n--}else c!=="$"&&c!=="$!"&&c!=="$?"||n++}i=i.nextSibling}sn=null}}else sn=ln?es(i.stateNode.nextSibling):null;return!0}function S2(){for(var i=sn;i;)i=es(i.nextSibling)}function Tc(){sn=ln=null,ai=!1}function i0(i){Wn===null?Wn=[i]:Wn.push(i)}var kk=ta.ReactCurrentBatchConfig;function nh(i,n,c){if(i=c.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(Me(309));var p=c.stateNode}if(!p)throw Error(Me(147,i));var f=p,s=""+i;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===s?n.ref:(n=function(E){var A=f.refs;E===null?delete A[s]:A[s]=E},n._stringRef=s,n)}if(typeof i!="string")throw Error(Me(284));if(!c._owner)throw Error(Me(290,i))}return i}function Tp(i,n){throw i=Object.prototype.toString.call(n),Error(Me(31,i==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":i))}function tx(i){var n=i._init;return n(i._payload)}function E2(i){function n(ne,ee){if(i){var ae=ne.deletions;ae===null?(ne.deletions=[ee],ne.flags|=16):ae.push(ee)}}function c(ne,ee){if(!i)return null;for(;ee!==null;)n(ne,ee),ee=ee.sibling;return null}function p(ne,ee){for(ne=new Map;ee!==null;)ee.key!==null?ne.set(ee.key,ee):ne.set(ee.index,ee),ee=ee.sibling;return ne}function f(ne,ee){return ne=ns(ne,ee),ne.index=0,ne.sibling=null,ne}function s(ne,ee,ae){return ne.index=ae,i?(ae=ne.alternate,ae!==null?(ae=ae.index,ae<ee?(ne.flags|=2,ee):ae):(ne.flags|=2,ee)):(ne.flags|=1048576,ee)}function E(ne){return i&&ne.alternate===null&&(ne.flags|=2),ne}function A(ne,ee,ae,be){return ee===null||ee.tag!==6?(ee=$1(ae,ne.mode,be),ee.return=ne,ee):(ee=f(ee,ae),ee.return=ne,ee)}function N(ne,ee,ae,be){var Ie=ae.type;return Ie===sc?j(ne,ee,ae.props.children,be,ae.key):ee!==null&&(ee.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===Za&&tx(Ie)===ee.type)?(be=f(ee,ae.props),be.ref=nh(ne,ee,ae),be.return=ne,be):(be=Np(ae.type,ae.key,ae.props,null,ne.mode,be),be.ref=nh(ne,ee,ae),be.return=ne,be)}function B(ne,ee,ae,be){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ae.containerInfo||ee.stateNode.implementation!==ae.implementation?(ee=Z1(ae,ne.mode,be),ee.return=ne,ee):(ee=f(ee,ae.children||[]),ee.return=ne,ee)}function j(ne,ee,ae,be,Ie){return ee===null||ee.tag!==7?(ee=Js(ae,ne.mode,be,Ie),ee.return=ne,ee):(ee=f(ee,ae),ee.return=ne,ee)}function de(ne,ee,ae){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return ee=$1(""+ee,ne.mode,ae),ee.return=ne,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case hp:return ae=Np(ee.type,ee.key,ee.props,null,ne.mode,ae),ae.ref=nh(ne,null,ee),ae.return=ne,ae;case ac:return ee=Z1(ee,ne.mode,ae),ee.return=ne,ee;case Za:var be=ee._init;return de(ne,be(ee._payload),ae)}if(ch(ee)||eh(ee))return ee=Js(ee,ne.mode,ae,null),ee.return=ne,ee;Tp(ne,ee)}return null}function ge(ne,ee,ae,be){var Ie=ee!==null?ee.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number")return Ie!==null?null:A(ne,ee,""+ae,be);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case hp:return ae.key===Ie?N(ne,ee,ae,be):null;case ac:return ae.key===Ie?B(ne,ee,ae,be):null;case Za:return Ie=ae._init,ge(ne,ee,Ie(ae._payload),be)}if(ch(ae)||eh(ae))return Ie!==null?null:j(ne,ee,ae,be,null);Tp(ne,ae)}return null}function Te(ne,ee,ae,be,Ie){if(typeof be=="string"&&be!==""||typeof be=="number")return ne=ne.get(ae)||null,A(ee,ne,""+be,Ie);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case hp:return ne=ne.get(be.key===null?ae:be.key)||null,N(ee,ne,be,Ie);case ac:return ne=ne.get(be.key===null?ae:be.key)||null,B(ee,ne,be,Ie);case Za:var Ye=be._init;return Te(ne,ee,ae,Ye(be._payload),Ie)}if(ch(be)||eh(be))return ne=ne.get(ae)||null,j(ee,ne,be,Ie,null);Tp(ee,be)}return null}function xe(ne,ee,ae,be){for(var Ie=null,Ye=null,Ge=ee,rt=ee=0,ct=null;Ge!==null&&rt<ae.length;rt++){Ge.index>rt?(ct=Ge,Ge=null):ct=Ge.sibling;var bt=ge(ne,Ge,ae[rt],be);if(bt===null){Ge===null&&(Ge=ct);break}i&&Ge&&bt.alternate===null&&n(ne,Ge),ee=s(bt,ee,rt),Ye===null?Ie=bt:Ye.sibling=bt,Ye=bt,Ge=ct}if(rt===ae.length)return c(ne,Ge),ai&&Zs(ne,rt),Ie;if(Ge===null){for(;rt<ae.length;rt++)Ge=de(ne,ae[rt],be),Ge!==null&&(ee=s(Ge,ee,rt),Ye===null?Ie=Ge:Ye.sibling=Ge,Ye=Ge);return ai&&Zs(ne,rt),Ie}for(Ge=p(ne,Ge);rt<ae.length;rt++)ct=Te(Ge,ne,rt,ae[rt],be),ct!==null&&(i&&ct.alternate!==null&&Ge.delete(ct.key===null?rt:ct.key),ee=s(ct,ee,rt),Ye===null?Ie=ct:Ye.sibling=ct,Ye=ct);return i&&Ge.forEach(function(Wt){return n(ne,Wt)}),ai&&Zs(ne,rt),Ie}function Se(ne,ee,ae,be){var Ie=eh(ae);if(typeof Ie!="function")throw Error(Me(150));if(ae=Ie.call(ae),ae==null)throw Error(Me(151));for(var Ye=Ie=null,Ge=ee,rt=ee=0,ct=null,bt=ae.next();Ge!==null&&!bt.done;rt++,bt=ae.next()){Ge.index>rt?(ct=Ge,Ge=null):ct=Ge.sibling;var Wt=ge(ne,Ge,bt.value,be);if(Wt===null){Ge===null&&(Ge=ct);break}i&&Ge&&Wt.alternate===null&&n(ne,Ge),ee=s(Wt,ee,rt),Ye===null?Ie=Wt:Ye.sibling=Wt,Ye=Wt,Ge=ct}if(bt.done)return c(ne,Ge),ai&&Zs(ne,rt),Ie;if(Ge===null){for(;!bt.done;rt++,bt=ae.next())bt=de(ne,bt.value,be),bt!==null&&(ee=s(bt,ee,rt),Ye===null?Ie=bt:Ye.sibling=bt,Ye=bt);return ai&&Zs(ne,rt),Ie}for(Ge=p(ne,Ge);!bt.done;rt++,bt=ae.next())bt=Te(Ge,ne,rt,bt.value,be),bt!==null&&(i&&bt.alternate!==null&&Ge.delete(bt.key===null?rt:bt.key),ee=s(bt,ee,rt),Ye===null?Ie=bt:Ye.sibling=bt,Ye=bt);return i&&Ge.forEach(function(Ei){return n(ne,Ei)}),ai&&Zs(ne,rt),Ie}function Ae(ne,ee,ae,be){if(typeof ae=="object"&&ae!==null&&ae.type===sc&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case hp:e:{for(var Ie=ae.key,Ye=ee;Ye!==null;){if(Ye.key===Ie){if(Ie=ae.type,Ie===sc){if(Ye.tag===7){c(ne,Ye.sibling),ee=f(Ye,ae.props.children),ee.return=ne,ne=ee;break e}}else if(Ye.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===Za&&tx(Ie)===Ye.type){c(ne,Ye.sibling),ee=f(Ye,ae.props),ee.ref=nh(ne,Ye,ae),ee.return=ne,ne=ee;break e}c(ne,Ye);break}else n(ne,Ye);Ye=Ye.sibling}ae.type===sc?(ee=Js(ae.props.children,ne.mode,be,ae.key),ee.return=ne,ne=ee):(be=Np(ae.type,ae.key,ae.props,null,ne.mode,be),be.ref=nh(ne,ee,ae),be.return=ne,ne=be)}return E(ne);case ac:e:{for(Ye=ae.key;ee!==null;){if(ee.key===Ye)if(ee.tag===4&&ee.stateNode.containerInfo===ae.containerInfo&&ee.stateNode.implementation===ae.implementation){c(ne,ee.sibling),ee=f(ee,ae.children||[]),ee.return=ne,ne=ee;break e}else{c(ne,ee);break}else n(ne,ee);ee=ee.sibling}ee=Z1(ae,ne.mode,be),ee.return=ne,ne=ee}return E(ne);case Za:return Ye=ae._init,Ae(ne,ee,Ye(ae._payload),be)}if(ch(ae))return xe(ne,ee,ae,be);if(eh(ae))return Se(ne,ee,ae,be);Tp(ne,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"?(ae=""+ae,ee!==null&&ee.tag===6?(c(ne,ee.sibling),ee=f(ee,ae),ee.return=ne,ne=ee):(c(ne,ee),ee=$1(ae,ne.mode,be),ee.return=ne,ne=ee),E(ne)):c(ne,ee)}return Ae}var Cc=E2(!0),T2=E2(!1),Qp=ls(null),ef=null,mc=null,r0=null;function n0(){r0=mc=ef=null}function o0(i){var n=Qp.current;ii(Qp),i._currentValue=n}function wg(i,n,c){for(;i!==null;){var p=i.alternate;if((i.childLanes&n)!==n?(i.childLanes|=n,p!==null&&(p.childLanes|=n)):p!==null&&(p.childLanes&n)!==n&&(p.childLanes|=n),i===c)break;i=i.return}}function bc(i,n){ef=i,r0=mc=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&n&&(Or=!0),i.firstContext=null)}function Mn(i){var n=i._currentValue;if(r0!==i)if(i={context:i,memoizedValue:n,next:null},mc===null){if(ef===null)throw Error(Me(308));mc=i,ef.dependencies={lanes:0,firstContext:i}}else mc=mc.next=i;return n}var Ws=null;function a0(i){Ws===null?Ws=[i]:Ws.push(i)}function C2(i,n,c,p){var f=n.interleaved;return f===null?(c.next=c,a0(n)):(c.next=f.next,f.next=c),n.interleaved=c,Qo(i,p)}function Qo(i,n){i.lanes|=n;var c=i.alternate;for(c!==null&&(c.lanes|=n),c=i,i=i.return;i!==null;)i.childLanes|=n,c=i.alternate,c!==null&&(c.childLanes|=n),c=i,i=i.return;return c.tag===3?c.stateNode:null}var Ha=!1;function s0(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function z2(i,n){i=i.updateQueue,n.updateQueue===i&&(n.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Ko(i,n){return{eventTime:i,lane:n,tag:0,payload:null,callback:null,next:null}}function ts(i,n,c){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,Mt&2){var f=p.pending;return f===null?n.next=n:(n.next=f.next,f.next=n),p.pending=n,Qo(i,c)}return f=p.interleaved,f===null?(n.next=n,a0(p)):(n.next=f.next,f.next=n),p.interleaved=n,Qo(i,c)}function Lp(i,n,c){if(n=n.updateQueue,n!==null&&(n=n.shared,(c&4194240)!==0)){var p=n.lanes;p&=i.pendingLanes,c|=p,n.lanes=c,Hg(i,c)}}function ix(i,n){var c=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,c===p)){var f=null,s=null;if(c=c.firstBaseUpdate,c!==null){do{var E={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};s===null?f=s=E:s=s.next=E,c=c.next}while(c!==null);s===null?f=s=n:s=s.next=n}else f=s=n;c={baseState:p.baseState,firstBaseUpdate:f,lastBaseUpdate:s,shared:p.shared,effects:p.effects},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=n:i.next=n,c.lastBaseUpdate=n}function tf(i,n,c,p){var f=i.updateQueue;Ha=!1;var s=f.firstBaseUpdate,E=f.lastBaseUpdate,A=f.shared.pending;if(A!==null){f.shared.pending=null;var N=A,B=N.next;N.next=null,E===null?s=B:E.next=B,E=N;var j=i.alternate;j!==null&&(j=j.updateQueue,A=j.lastBaseUpdate,A!==E&&(A===null?j.firstBaseUpdate=B:A.next=B,j.lastBaseUpdate=N))}if(s!==null){var de=f.baseState;E=0,j=B=N=null,A=s;do{var ge=A.lane,Te=A.eventTime;if((p&ge)===ge){j!==null&&(j=j.next={eventTime:Te,lane:0,tag:A.tag,payload:A.payload,callback:A.callback,next:null});e:{var xe=i,Se=A;switch(ge=n,Te=c,Se.tag){case 1:if(xe=Se.payload,typeof xe=="function"){de=xe.call(Te,de,ge);break e}de=xe;break e;case 3:xe.flags=xe.flags&-65537|128;case 0:if(xe=Se.payload,ge=typeof xe=="function"?xe.call(Te,de,ge):xe,ge==null)break e;de=hi({},de,ge);break e;case 2:Ha=!0}}A.callback!==null&&A.lane!==0&&(i.flags|=64,ge=f.effects,ge===null?f.effects=[A]:ge.push(A))}else Te={eventTime:Te,lane:ge,tag:A.tag,payload:A.payload,callback:A.callback,next:null},j===null?(B=j=Te,N=de):j=j.next=Te,E|=ge;if(A=A.next,A===null){if(A=f.shared.pending,A===null)break;ge=A,A=ge.next,ge.next=null,f.lastBaseUpdate=ge,f.shared.pending=null}}while(!0);if(j===null&&(N=de),f.baseState=N,f.firstBaseUpdate=B,f.lastBaseUpdate=j,n=f.shared.interleaved,n!==null){f=n;do E|=f.lane,f=f.next;while(f!==n)}else s===null&&(f.shared.lanes=0);tl|=E,i.lanes=E,i.memoizedState=de}}function rx(i,n,c){if(i=n.effects,n.effects=null,i!==null)for(n=0;n<i.length;n++){var p=i[n],f=p.callback;if(f!==null){if(p.callback=null,p=c,typeof f!="function")throw Error(Me(191,f));f.call(p)}}}var Vh={},wo=ls(Vh),Ah=ls(Vh),Lh=ls(Vh);function Xs(i){if(i===Vh)throw Error(Me(174));return i}function l0(i,n){switch(Jt(Lh,n),Jt(Ah,i),Jt(wo,Vh),i=n.nodeType,i){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:tg(null,"");break;default:i=i===8?n.parentNode:n,n=i.namespaceURI||null,i=i.tagName,n=tg(n,i)}ii(wo),Jt(wo,n)}function zc(){ii(wo),ii(Ah),ii(Lh)}function I2(i){Xs(Lh.current);var n=Xs(wo.current),c=tg(n,i.type);n!==c&&(Jt(Ah,i),Jt(wo,c))}function c0(i){Ah.current===i&&(ii(wo),ii(Ah))}var ci=ls(0);function rf(i){for(var n=i;n!==null;){if(n.tag===13){var c=n.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if(n.flags&128)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break;for(;n.sibling===null;){if(n.return===null||n.return===i)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var O1=[];function u0(){for(var i=0;i<O1.length;i++)O1[i]._workInProgressVersionPrimary=null;O1.length=0}var Dp=ta.ReactCurrentDispatcher,N1=ta.ReactCurrentBatchConfig,el=0,ui=null,Ii=null,ji=null,nf=!1,yh=!1,Dh=0,Sk=0;function lr(){throw Error(Me(321))}function h0(i,n){if(n===null)return!1;for(var c=0;c<n.length&&c<i.length;c++)if(!Jn(i[c],n[c]))return!1;return!0}function d0(i,n,c,p,f,s){if(el=s,ui=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,Dp.current=i===null||i.memoizedState===null?zk:Ik,i=c(p,f),yh){s=0;do{if(yh=!1,Dh=0,25<=s)throw Error(Me(301));s+=1,ji=Ii=null,n.updateQueue=null,Dp.current=Pk,i=c(p,f)}while(yh)}if(Dp.current=of,n=Ii!==null&&Ii.next!==null,el=0,ji=Ii=ui=null,nf=!1,n)throw Error(Me(300));return i}function p0(){var i=Dh!==0;return Dh=0,i}function _o(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ji===null?ui.memoizedState=ji=i:ji=ji.next=i,ji}function An(){if(Ii===null){var i=ui.alternate;i=i!==null?i.memoizedState:null}else i=Ii.next;var n=ji===null?ui.memoizedState:ji.next;if(n!==null)ji=n,Ii=i;else{if(i===null)throw Error(Me(310));Ii=i,i={memoizedState:Ii.memoizedState,baseState:Ii.baseState,baseQueue:Ii.baseQueue,queue:Ii.queue,next:null},ji===null?ui.memoizedState=ji=i:ji=ji.next=i}return ji}function Rh(i,n){return typeof n=="function"?n(i):n}function j1(i){var n=An(),c=n.queue;if(c===null)throw Error(Me(311));c.lastRenderedReducer=i;var p=Ii,f=p.baseQueue,s=c.pending;if(s!==null){if(f!==null){var E=f.next;f.next=s.next,s.next=E}p.baseQueue=f=s,c.pending=null}if(f!==null){s=f.next,p=p.baseState;var A=E=null,N=null,B=s;do{var j=B.lane;if((el&j)===j)N!==null&&(N=N.next={lane:0,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null}),p=B.hasEagerState?B.eagerState:i(p,B.action);else{var de={lane:j,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null};N===null?(A=N=de,E=p):N=N.next=de,ui.lanes|=j,tl|=j}B=B.next}while(B!==null&&B!==s);N===null?E=p:N.next=A,Jn(p,n.memoizedState)||(Or=!0),n.memoizedState=p,n.baseState=E,n.baseQueue=N,c.lastRenderedState=p}if(i=c.interleaved,i!==null){f=i;do s=f.lane,ui.lanes|=s,tl|=s,f=f.next;while(f!==i)}else f===null&&(c.lanes=0);return[n.memoizedState,c.dispatch]}function V1(i){var n=An(),c=n.queue;if(c===null)throw Error(Me(311));c.lastRenderedReducer=i;var p=c.dispatch,f=c.pending,s=n.memoizedState;if(f!==null){c.pending=null;var E=f=f.next;do s=i(s,E.action),E=E.next;while(E!==f);Jn(s,n.memoizedState)||(Or=!0),n.memoizedState=s,n.baseQueue===null&&(n.baseState=s),c.lastRenderedState=s}return[s,p]}function P2(){}function M2(i,n){var c=ui,p=An(),f=n(),s=!Jn(p.memoizedState,f);if(s&&(p.memoizedState=f,Or=!0),p=p.queue,f0(D2.bind(null,c,p,i),[i]),p.getSnapshot!==n||s||ji!==null&&ji.memoizedState.tag&1){if(c.flags|=2048,Fh(9,L2.bind(null,c,p,f,n),void 0,null),Vi===null)throw Error(Me(349));el&30||A2(c,n,f)}return f}function A2(i,n,c){i.flags|=16384,i={getSnapshot:n,value:c},n=ui.updateQueue,n===null?(n={lastEffect:null,stores:null},ui.updateQueue=n,n.stores=[i]):(c=n.stores,c===null?n.stores=[i]:c.push(i))}function L2(i,n,c,p){n.value=c,n.getSnapshot=p,R2(n)&&F2(i)}function D2(i,n,c){return c(function(){R2(n)&&F2(i)})}function R2(i){var n=i.getSnapshot;i=i.value;try{var c=n();return!Jn(i,c)}catch{return!0}}function F2(i){var n=Qo(i,1);n!==null&&Kn(n,i,1,-1)}function nx(i){var n=_o();return typeof i=="function"&&(i=i()),n.memoizedState=n.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rh,lastRenderedState:i},n.queue=i,i=i.dispatch=Ck.bind(null,ui,i),[n.memoizedState,i]}function Fh(i,n,c,p){return i={tag:i,create:n,destroy:c,deps:p,next:null},n=ui.updateQueue,n===null?(n={lastEffect:null,stores:null},ui.updateQueue=n,n.lastEffect=i.next=i):(c=n.lastEffect,c===null?n.lastEffect=i.next=i:(p=c.next,c.next=i,i.next=p,n.lastEffect=i)),i}function B2(){return An().memoizedState}function Rp(i,n,c,p){var f=_o();ui.flags|=i,f.memoizedState=Fh(1|n,c,void 0,p===void 0?null:p)}function yf(i,n,c,p){var f=An();p=p===void 0?null:p;var s=void 0;if(Ii!==null){var E=Ii.memoizedState;if(s=E.destroy,p!==null&&h0(p,E.deps)){f.memoizedState=Fh(n,c,s,p);return}}ui.flags|=i,f.memoizedState=Fh(1|n,c,s,p)}function ox(i,n){return Rp(8390656,8,i,n)}function f0(i,n){return yf(2048,8,i,n)}function O2(i,n){return yf(4,2,i,n)}function N2(i,n){return yf(4,4,i,n)}function j2(i,n){if(typeof n=="function")return i=i(),n(i),function(){n(null)};if(n!=null)return i=i(),n.current=i,function(){n.current=null}}function V2(i,n,c){return c=c!=null?c.concat([i]):null,yf(4,4,j2.bind(null,n,i),c)}function m0(){}function U2(i,n){var c=An();n=n===void 0?null:n;var p=c.memoizedState;return p!==null&&n!==null&&h0(n,p[1])?p[0]:(c.memoizedState=[i,n],i)}function q2(i,n){var c=An();n=n===void 0?null:n;var p=c.memoizedState;return p!==null&&n!==null&&h0(n,p[1])?p[0]:(i=i(),c.memoizedState=[i,n],i)}function $2(i,n,c){return el&21?(Jn(c,n)||(c=Xx(),ui.lanes|=c,tl|=c,i.baseState=!0),n):(i.baseState&&(i.baseState=!1,Or=!0),i.memoizedState=c)}function Ek(i,n){var c=Vt;Vt=c!==0&&4>c?c:4,i(!0);var p=N1.transition;N1.transition={};try{i(!1),n()}finally{Vt=c,N1.transition=p}}function Z2(){return An().memoizedState}function Tk(i,n,c){var p=rs(i);if(c={lane:p,action:c,hasEagerState:!1,eagerState:null,next:null},H2(i))G2(n,c);else if(c=C2(i,n,c,p),c!==null){var f=Er();Kn(c,i,p,f),W2(c,n,p)}}function Ck(i,n,c){var p=rs(i),f={lane:p,action:c,hasEagerState:!1,eagerState:null,next:null};if(H2(i))G2(n,f);else{var s=i.alternate;if(i.lanes===0&&(s===null||s.lanes===0)&&(s=n.lastRenderedReducer,s!==null))try{var E=n.lastRenderedState,A=s(E,c);if(f.hasEagerState=!0,f.eagerState=A,Jn(A,E)){var N=n.interleaved;N===null?(f.next=f,a0(n)):(f.next=N.next,N.next=f),n.interleaved=f;return}}catch{}finally{}c=C2(i,n,f,p),c!==null&&(f=Er(),Kn(c,i,p,f),W2(c,n,p))}}function H2(i){var n=i.alternate;return i===ui||n!==null&&n===ui}function G2(i,n){yh=nf=!0;var c=i.pending;c===null?n.next=n:(n.next=c.next,c.next=n),i.pending=n}function W2(i,n,c){if(c&4194240){var p=n.lanes;p&=i.pendingLanes,c|=p,n.lanes=c,Hg(i,c)}}var of={readContext:Mn,useCallback:lr,useContext:lr,useEffect:lr,useImperativeHandle:lr,useInsertionEffect:lr,useLayoutEffect:lr,useMemo:lr,useReducer:lr,useRef:lr,useState:lr,useDebugValue:lr,useDeferredValue:lr,useTransition:lr,useMutableSource:lr,useSyncExternalStore:lr,useId:lr,unstable_isNewReconciler:!1},zk={readContext:Mn,useCallback:function(i,n){return _o().memoizedState=[i,n===void 0?null:n],i},useContext:Mn,useEffect:ox,useImperativeHandle:function(i,n,c){return c=c!=null?c.concat([i]):null,Rp(4194308,4,j2.bind(null,n,i),c)},useLayoutEffect:function(i,n){return Rp(4194308,4,i,n)},useInsertionEffect:function(i,n){return Rp(4,2,i,n)},useMemo:function(i,n){var c=_o();return n=n===void 0?null:n,i=i(),c.memoizedState=[i,n],i},useReducer:function(i,n,c){var p=_o();return n=c!==void 0?c(n):n,p.memoizedState=p.baseState=n,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:n},p.queue=i,i=i.dispatch=Tk.bind(null,ui,i),[p.memoizedState,i]},useRef:function(i){var n=_o();return i={current:i},n.memoizedState=i},useState:nx,useDebugValue:m0,useDeferredValue:function(i){return _o().memoizedState=i},useTransition:function(){var i=nx(!1),n=i[0];return i=Ek.bind(null,i[1]),_o().memoizedState=i,[n,i]},useMutableSource:function(){},useSyncExternalStore:function(i,n,c){var p=ui,f=_o();if(ai){if(c===void 0)throw Error(Me(407));c=c()}else{if(c=n(),Vi===null)throw Error(Me(349));el&30||A2(p,n,c)}f.memoizedState=c;var s={value:c,getSnapshot:n};return f.queue=s,ox(D2.bind(null,p,s,i),[i]),p.flags|=2048,Fh(9,L2.bind(null,p,s,c,n),void 0,null),c},useId:function(){var i=_o(),n=Vi.identifierPrefix;if(ai){var c=Xo,p=Wo;c=(p&~(1<<32-Xn(p)-1)).toString(32)+c,n=":"+n+"R"+c,c=Dh++,0<c&&(n+="H"+c.toString(32)),n+=":"}else c=Sk++,n=":"+n+"r"+c.toString(32)+":";return i.memoizedState=n},unstable_isNewReconciler:!1},Ik={readContext:Mn,useCallback:U2,useContext:Mn,useEffect:f0,useImperativeHandle:V2,useInsertionEffect:O2,useLayoutEffect:N2,useMemo:q2,useReducer:j1,useRef:B2,useState:function(){return j1(Rh)},useDebugValue:m0,useDeferredValue:function(i){var n=An();return $2(n,Ii.memoizedState,i)},useTransition:function(){var i=j1(Rh)[0],n=An().memoizedState;return[i,n]},useMutableSource:P2,useSyncExternalStore:M2,useId:Z2,unstable_isNewReconciler:!1},Pk={readContext:Mn,useCallback:U2,useContext:Mn,useEffect:f0,useImperativeHandle:V2,useInsertionEffect:O2,useLayoutEffect:N2,useMemo:q2,useReducer:V1,useRef:B2,useState:function(){return V1(Rh)},useDebugValue:m0,useDeferredValue:function(i){var n=An();return Ii===null?n.memoizedState=i:$2(n,Ii.memoizedState,i)},useTransition:function(){var i=V1(Rh)[0],n=An().memoizedState;return[i,n]},useMutableSource:P2,useSyncExternalStore:M2,useId:Z2,unstable_isNewReconciler:!1};function Hn(i,n){if(i&&i.defaultProps){n=hi({},n),i=i.defaultProps;for(var c in i)n[c]===void 0&&(n[c]=i[c]);return n}return n}function bg(i,n,c,p){n=i.memoizedState,c=c(p,n),c=c==null?n:hi({},n,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var _f={isMounted:function(i){return(i=i._reactInternals)?nl(i)===i:!1},enqueueSetState:function(i,n,c){i=i._reactInternals;var p=Er(),f=rs(i),s=Ko(p,f);s.payload=n,c!=null&&(s.callback=c),n=ts(i,s,f),n!==null&&(Kn(n,i,f,p),Lp(n,i,f))},enqueueReplaceState:function(i,n,c){i=i._reactInternals;var p=Er(),f=rs(i),s=Ko(p,f);s.tag=1,s.payload=n,c!=null&&(s.callback=c),n=ts(i,s,f),n!==null&&(Kn(n,i,f,p),Lp(n,i,f))},enqueueForceUpdate:function(i,n){i=i._reactInternals;var c=Er(),p=rs(i),f=Ko(c,p);f.tag=2,n!=null&&(f.callback=n),n=ts(i,f,p),n!==null&&(Kn(n,i,p,c),Lp(n,i,p))}};function ax(i,n,c,p,f,s,E){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,s,E):n.prototype&&n.prototype.isPureReactComponent?!zh(c,p)||!zh(f,s):!0}function X2(i,n,c){var p=!1,f=as,s=n.contextType;return typeof s=="object"&&s!==null?s=Mn(s):(f=jr(n)?Ys:hr.current,p=n.contextTypes,s=(p=p!=null)?Ec(i,f):as),n=new n(c,s),i.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=_f,i.stateNode=n,n._reactInternals=i,p&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=f,i.__reactInternalMemoizedMaskedChildContext=s),n}function sx(i,n,c,p){i=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(c,p),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(c,p),n.state!==i&&_f.enqueueReplaceState(n,n.state,null)}function kg(i,n,c,p){var f=i.stateNode;f.props=c,f.state=i.memoizedState,f.refs={},s0(i);var s=n.contextType;typeof s=="object"&&s!==null?f.context=Mn(s):(s=jr(n)?Ys:hr.current,f.context=Ec(i,s)),f.state=i.memoizedState,s=n.getDerivedStateFromProps,typeof s=="function"&&(bg(i,n,s,c),f.state=i.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(n=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),n!==f.state&&_f.enqueueReplaceState(f,f.state,null),tf(i,c,f,p),f.state=i.memoizedState),typeof f.componentDidMount=="function"&&(i.flags|=4194308)}function Ic(i,n){try{var c="",p=n;do c+=a4(p),p=p.return;while(p);var f=c}catch(s){f=`
Error generating stack: `+s.message+`
`+s.stack}return{value:i,source:n,stack:f,digest:null}}function U1(i,n,c){return{value:i,source:null,stack:c??null,digest:n??null}}function Sg(i,n){try{console.error(n.value)}catch(c){setTimeout(function(){throw c})}}var Mk=typeof WeakMap=="function"?WeakMap:Map;function K2(i,n,c){c=Ko(-1,c),c.tag=3,c.payload={element:null};var p=n.value;return c.callback=function(){sf||(sf=!0,Dg=p),Sg(i,n)},c}function J2(i,n,c){c=Ko(-1,c),c.tag=3;var p=i.type.getDerivedStateFromError;if(typeof p=="function"){var f=n.value;c.payload=function(){return p(f)},c.callback=function(){Sg(i,n)}}var s=i.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(c.callback=function(){Sg(i,n),typeof p!="function"&&(is===null?is=new Set([this]):is.add(this));var E=n.stack;this.componentDidCatch(n.value,{componentStack:E!==null?E:""})}),c}function lx(i,n,c){var p=i.pingCache;if(p===null){p=i.pingCache=new Mk;var f=new Set;p.set(n,f)}else f=p.get(n),f===void 0&&(f=new Set,p.set(n,f));f.has(c)||(f.add(c),i=Zk.bind(null,i,n,c),n.then(i,i))}function cx(i){do{var n;if((n=i.tag===13)&&(n=i.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return i;i=i.return}while(i!==null);return null}function ux(i,n,c,p,f){return i.mode&1?(i.flags|=65536,i.lanes=f,i):(i===n?i.flags|=65536:(i.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(n=Ko(-1,1),n.tag=2,ts(c,n,1))),c.lanes|=1),i)}var Ak=ta.ReactCurrentOwner,Or=!1;function Sr(i,n,c,p){n.child=i===null?T2(n,null,c,p):Cc(n,i.child,c,p)}function hx(i,n,c,p,f){c=c.render;var s=n.ref;return bc(n,f),p=d0(i,n,c,p,s,f),c=p0(),i!==null&&!Or?(n.updateQueue=i.updateQueue,n.flags&=-2053,i.lanes&=~f,ea(i,n,f)):(ai&&c&&e0(n),n.flags|=1,Sr(i,n,p,f),n.child)}function dx(i,n,c,p,f){if(i===null){var s=c.type;return typeof s=="function"&&!k0(s)&&s.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(n.tag=15,n.type=s,Y2(i,n,s,p,f)):(i=Np(c.type,null,p,n,n.mode,f),i.ref=n.ref,i.return=n,n.child=i)}if(s=i.child,!(i.lanes&f)){var E=s.memoizedProps;if(c=c.compare,c=c!==null?c:zh,c(E,p)&&i.ref===n.ref)return ea(i,n,f)}return n.flags|=1,i=ns(s,p),i.ref=n.ref,i.return=n,n.child=i}function Y2(i,n,c,p,f){if(i!==null){var s=i.memoizedProps;if(zh(s,p)&&i.ref===n.ref)if(Or=!1,n.pendingProps=p=s,(i.lanes&f)!==0)i.flags&131072&&(Or=!0);else return n.lanes=i.lanes,ea(i,n,f)}return Eg(i,n,c,p,f)}function Q2(i,n,c){var p=n.pendingProps,f=p.children,s=i!==null?i.memoizedState:null;if(p.mode==="hidden")if(!(n.mode&1))n.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jt(yc,an),an|=c;else{if(!(c&1073741824))return i=s!==null?s.baseLanes|c:c,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:i,cachePool:null,transitions:null},n.updateQueue=null,Jt(yc,an),an|=i,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=s!==null?s.baseLanes:c,Jt(yc,an),an|=p}else s!==null?(p=s.baseLanes|c,n.memoizedState=null):p=c,Jt(yc,an),an|=p;return Sr(i,n,f,c),n.child}function ew(i,n){var c=n.ref;(i===null&&c!==null||i!==null&&i.ref!==c)&&(n.flags|=512,n.flags|=2097152)}function Eg(i,n,c,p,f){var s=jr(c)?Ys:hr.current;return s=Ec(n,s),bc(n,f),c=d0(i,n,c,p,s,f),p=p0(),i!==null&&!Or?(n.updateQueue=i.updateQueue,n.flags&=-2053,i.lanes&=~f,ea(i,n,f)):(ai&&p&&e0(n),n.flags|=1,Sr(i,n,c,f),n.child)}function px(i,n,c,p,f){if(jr(c)){var s=!0;Kp(n)}else s=!1;if(bc(n,f),n.stateNode===null)Fp(i,n),X2(n,c,p),kg(n,c,p,f),p=!0;else if(i===null){var E=n.stateNode,A=n.memoizedProps;E.props=A;var N=E.context,B=c.contextType;typeof B=="object"&&B!==null?B=Mn(B):(B=jr(c)?Ys:hr.current,B=Ec(n,B));var j=c.getDerivedStateFromProps,de=typeof j=="function"||typeof E.getSnapshotBeforeUpdate=="function";de||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(A!==p||N!==B)&&sx(n,E,p,B),Ha=!1;var ge=n.memoizedState;E.state=ge,tf(n,p,E,f),N=n.memoizedState,A!==p||ge!==N||Nr.current||Ha?(typeof j=="function"&&(bg(n,c,j,p),N=n.memoizedState),(A=Ha||ax(n,c,A,p,ge,N,B))?(de||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(n.flags|=4194308)):(typeof E.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=p,n.memoizedState=N),E.props=p,E.state=N,E.context=B,p=A):(typeof E.componentDidMount=="function"&&(n.flags|=4194308),p=!1)}else{E=n.stateNode,z2(i,n),A=n.memoizedProps,B=n.type===n.elementType?A:Hn(n.type,A),E.props=B,de=n.pendingProps,ge=E.context,N=c.contextType,typeof N=="object"&&N!==null?N=Mn(N):(N=jr(c)?Ys:hr.current,N=Ec(n,N));var Te=c.getDerivedStateFromProps;(j=typeof Te=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(A!==de||ge!==N)&&sx(n,E,p,N),Ha=!1,ge=n.memoizedState,E.state=ge,tf(n,p,E,f);var xe=n.memoizedState;A!==de||ge!==xe||Nr.current||Ha?(typeof Te=="function"&&(bg(n,c,Te,p),xe=n.memoizedState),(B=Ha||ax(n,c,B,p,ge,xe,N)||!1)?(j||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(p,xe,N),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(p,xe,N)),typeof E.componentDidUpdate=="function"&&(n.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof E.componentDidUpdate!="function"||A===i.memoizedProps&&ge===i.memoizedState||(n.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&ge===i.memoizedState||(n.flags|=1024),n.memoizedProps=p,n.memoizedState=xe),E.props=p,E.state=xe,E.context=N,p=B):(typeof E.componentDidUpdate!="function"||A===i.memoizedProps&&ge===i.memoizedState||(n.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&ge===i.memoizedState||(n.flags|=1024),p=!1)}return Tg(i,n,c,p,s,f)}function Tg(i,n,c,p,f,s){ew(i,n);var E=(n.flags&128)!==0;if(!p&&!E)return f&&Yv(n,c,!1),ea(i,n,s);p=n.stateNode,Ak.current=n;var A=E&&typeof c.getDerivedStateFromError!="function"?null:p.render();return n.flags|=1,i!==null&&E?(n.child=Cc(n,i.child,null,s),n.child=Cc(n,null,A,s)):Sr(i,n,A,s),n.memoizedState=p.state,f&&Yv(n,c,!0),n.child}function tw(i){var n=i.stateNode;n.pendingContext?Jv(i,n.pendingContext,n.pendingContext!==n.context):n.context&&Jv(i,n.context,!1),l0(i,n.containerInfo)}function fx(i,n,c,p,f){return Tc(),i0(f),n.flags|=256,Sr(i,n,c,p),n.child}var Cg={dehydrated:null,treeContext:null,retryLane:0};function zg(i){return{baseLanes:i,cachePool:null,transitions:null}}function iw(i,n,c){var p=n.pendingProps,f=ci.current,s=!1,E=(n.flags&128)!==0,A;if((A=E)||(A=i!==null&&i.memoizedState===null?!1:(f&2)!==0),A?(s=!0,n.flags&=-129):(i===null||i.memoizedState!==null)&&(f|=1),Jt(ci,f&1),i===null)return xg(n),i=n.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(n.mode&1?i.data==="$!"?n.lanes=8:n.lanes=1073741824:n.lanes=1,null):(E=p.children,i=p.fallback,s?(p=n.mode,s=n.child,E={mode:"hidden",children:E},!(p&1)&&s!==null?(s.childLanes=0,s.pendingProps=E):s=wf(E,p,0,null),i=Js(i,p,c,null),s.return=n,i.return=n,s.sibling=i,n.child=s,n.child.memoizedState=zg(c),n.memoizedState=Cg,i):g0(n,E));if(f=i.memoizedState,f!==null&&(A=f.dehydrated,A!==null))return Lk(i,n,E,p,A,f,c);if(s){s=p.fallback,E=n.mode,f=i.child,A=f.sibling;var N={mode:"hidden",children:p.children};return!(E&1)&&n.child!==f?(p=n.child,p.childLanes=0,p.pendingProps=N,n.deletions=null):(p=ns(f,N),p.subtreeFlags=f.subtreeFlags&14680064),A!==null?s=ns(A,s):(s=Js(s,E,c,null),s.flags|=2),s.return=n,p.return=n,p.sibling=s,n.child=p,p=s,s=n.child,E=i.child.memoizedState,E=E===null?zg(c):{baseLanes:E.baseLanes|c,cachePool:null,transitions:E.transitions},s.memoizedState=E,s.childLanes=i.childLanes&~c,n.memoizedState=Cg,p}return s=i.child,i=s.sibling,p=ns(s,{mode:"visible",children:p.children}),!(n.mode&1)&&(p.lanes=c),p.return=n,p.sibling=null,i!==null&&(c=n.deletions,c===null?(n.deletions=[i],n.flags|=16):c.push(i)),n.child=p,n.memoizedState=null,p}function g0(i,n){return n=wf({mode:"visible",children:n},i.mode,0,null),n.return=i,i.child=n}function Cp(i,n,c,p){return p!==null&&i0(p),Cc(n,i.child,null,c),i=g0(n,n.pendingProps.children),i.flags|=2,n.memoizedState=null,i}function Lk(i,n,c,p,f,s,E){if(c)return n.flags&256?(n.flags&=-257,p=U1(Error(Me(422))),Cp(i,n,E,p)):n.memoizedState!==null?(n.child=i.child,n.flags|=128,null):(s=p.fallback,f=n.mode,p=wf({mode:"visible",children:p.children},f,0,null),s=Js(s,f,E,null),s.flags|=2,p.return=n,s.return=n,p.sibling=s,n.child=p,n.mode&1&&Cc(n,i.child,null,E),n.child.memoizedState=zg(E),n.memoizedState=Cg,s);if(!(n.mode&1))return Cp(i,n,E,null);if(f.data==="$!"){if(p=f.nextSibling&&f.nextSibling.dataset,p)var A=p.dgst;return p=A,s=Error(Me(419)),p=U1(s,p,void 0),Cp(i,n,E,p)}if(A=(E&i.childLanes)!==0,Or||A){if(p=Vi,p!==null){switch(E&-E){case 4:f=2;break;case 16:f=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:f=32;break;case 536870912:f=268435456;break;default:f=0}f=f&(p.suspendedLanes|E)?0:f,f!==0&&f!==s.retryLane&&(s.retryLane=f,Qo(i,f),Kn(p,i,f,-1))}return b0(),p=U1(Error(Me(421))),Cp(i,n,E,p)}return f.data==="$?"?(n.flags|=128,n.child=i.child,n=Hk.bind(null,i),f._reactRetry=n,null):(i=s.treeContext,sn=es(f.nextSibling),ln=n,ai=!0,Wn=null,i!==null&&(Cn[zn++]=Wo,Cn[zn++]=Xo,Cn[zn++]=Qs,Wo=i.id,Xo=i.overflow,Qs=n),n=g0(n,p.children),n.flags|=4096,n)}function mx(i,n,c){i.lanes|=n;var p=i.alternate;p!==null&&(p.lanes|=n),wg(i.return,n,c)}function q1(i,n,c,p,f){var s=i.memoizedState;s===null?i.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:p,tail:c,tailMode:f}:(s.isBackwards=n,s.rendering=null,s.renderingStartTime=0,s.last=p,s.tail=c,s.tailMode=f)}function rw(i,n,c){var p=n.pendingProps,f=p.revealOrder,s=p.tail;if(Sr(i,n,p.children,c),p=ci.current,p&2)p=p&1|2,n.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=n.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&mx(i,c,n);else if(i.tag===19)mx(i,c,n);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}p&=1}if(Jt(ci,p),!(n.mode&1))n.memoizedState=null;else switch(f){case"forwards":for(c=n.child,f=null;c!==null;)i=c.alternate,i!==null&&rf(i)===null&&(f=c),c=c.sibling;c=f,c===null?(f=n.child,n.child=null):(f=c.sibling,c.sibling=null),q1(n,!1,f,c,s);break;case"backwards":for(c=null,f=n.child,n.child=null;f!==null;){if(i=f.alternate,i!==null&&rf(i)===null){n.child=f;break}i=f.sibling,f.sibling=c,c=f,f=i}q1(n,!0,c,null,s);break;case"together":q1(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function Fp(i,n){!(n.mode&1)&&i!==null&&(i.alternate=null,n.alternate=null,n.flags|=2)}function ea(i,n,c){if(i!==null&&(n.dependencies=i.dependencies),tl|=n.lanes,!(c&n.childLanes))return null;if(i!==null&&n.child!==i.child)throw Error(Me(153));if(n.child!==null){for(i=n.child,c=ns(i,i.pendingProps),n.child=c,c.return=n;i.sibling!==null;)i=i.sibling,c=c.sibling=ns(i,i.pendingProps),c.return=n;c.sibling=null}return n.child}function Dk(i,n,c){switch(n.tag){case 3:tw(n),Tc();break;case 5:I2(n);break;case 1:jr(n.type)&&Kp(n);break;case 4:l0(n,n.stateNode.containerInfo);break;case 10:var p=n.type._context,f=n.memoizedProps.value;Jt(Qp,p._currentValue),p._currentValue=f;break;case 13:if(p=n.memoizedState,p!==null)return p.dehydrated!==null?(Jt(ci,ci.current&1),n.flags|=128,null):c&n.child.childLanes?iw(i,n,c):(Jt(ci,ci.current&1),i=ea(i,n,c),i!==null?i.sibling:null);Jt(ci,ci.current&1);break;case 19:if(p=(c&n.childLanes)!==0,i.flags&128){if(p)return rw(i,n,c);n.flags|=128}if(f=n.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),Jt(ci,ci.current),p)break;return null;case 22:case 23:return n.lanes=0,Q2(i,n,c)}return ea(i,n,c)}var nw,Ig,ow,aw;nw=function(i,n){for(var c=n.child;c!==null;){if(c.tag===5||c.tag===6)i.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===n)break;for(;c.sibling===null;){if(c.return===null||c.return===n)return;c=c.return}c.sibling.return=c.return,c=c.sibling}};Ig=function(){};ow=function(i,n,c,p){var f=i.memoizedProps;if(f!==p){i=n.stateNode,Xs(wo.current);var s=null;switch(c){case"input":f=J1(i,f),p=J1(i,p),s=[];break;case"select":f=hi({},f,{value:void 0}),p=hi({},p,{value:void 0}),s=[];break;case"textarea":f=eg(i,f),p=eg(i,p),s=[];break;default:typeof f.onClick!="function"&&typeof p.onClick=="function"&&(i.onclick=Wp)}ig(c,p);var E;c=null;for(B in f)if(!p.hasOwnProperty(B)&&f.hasOwnProperty(B)&&f[B]!=null)if(B==="style"){var A=f[B];for(E in A)A.hasOwnProperty(E)&&(c||(c={}),c[E]="")}else B!=="dangerouslySetInnerHTML"&&B!=="children"&&B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&B!=="autoFocus"&&(wh.hasOwnProperty(B)?s||(s=[]):(s=s||[]).push(B,null));for(B in p){var N=p[B];if(A=f?.[B],p.hasOwnProperty(B)&&N!==A&&(N!=null||A!=null))if(B==="style")if(A){for(E in A)!A.hasOwnProperty(E)||N&&N.hasOwnProperty(E)||(c||(c={}),c[E]="");for(E in N)N.hasOwnProperty(E)&&A[E]!==N[E]&&(c||(c={}),c[E]=N[E])}else c||(s||(s=[]),s.push(B,c)),c=N;else B==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,A=A?A.__html:void 0,N!=null&&A!==N&&(s=s||[]).push(B,N)):B==="children"?typeof N!="string"&&typeof N!="number"||(s=s||[]).push(B,""+N):B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&(wh.hasOwnProperty(B)?(N!=null&&B==="onScroll"&&ti("scroll",i),s||A===N||(s=[])):(s=s||[]).push(B,N))}c&&(s=s||[]).push("style",c);var B=s;(n.updateQueue=B)&&(n.flags|=4)}};aw=function(i,n,c,p){c!==p&&(n.flags|=4)};function oh(i,n){if(!ai)switch(i.tailMode){case"hidden":n=i.tail;for(var c=null;n!==null;)n.alternate!==null&&(c=n),n=n.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var p=null;c!==null;)c.alternate!==null&&(p=c),c=c.sibling;p===null?n||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function cr(i){var n=i.alternate!==null&&i.alternate.child===i.child,c=0,p=0;if(n)for(var f=i.child;f!==null;)c|=f.lanes|f.childLanes,p|=f.subtreeFlags&14680064,p|=f.flags&14680064,f.return=i,f=f.sibling;else for(f=i.child;f!==null;)c|=f.lanes|f.childLanes,p|=f.subtreeFlags,p|=f.flags,f.return=i,f=f.sibling;return i.subtreeFlags|=p,i.childLanes=c,n}function Rk(i,n,c){var p=n.pendingProps;switch(t0(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cr(n),null;case 1:return jr(n.type)&&Xp(),cr(n),null;case 3:return p=n.stateNode,zc(),ii(Nr),ii(hr),u0(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(i===null||i.child===null)&&(Ep(n)?n.flags|=4:i===null||i.memoizedState.isDehydrated&&!(n.flags&256)||(n.flags|=1024,Wn!==null&&(Bg(Wn),Wn=null))),Ig(i,n),cr(n),null;case 5:c0(n);var f=Xs(Lh.current);if(c=n.type,i!==null&&n.stateNode!=null)ow(i,n,c,p,f),i.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!p){if(n.stateNode===null)throw Error(Me(166));return cr(n),null}if(i=Xs(wo.current),Ep(n)){p=n.stateNode,c=n.type;var s=n.memoizedProps;switch(p[vo]=n,p[Mh]=s,i=(n.mode&1)!==0,c){case"dialog":ti("cancel",p),ti("close",p);break;case"iframe":case"object":case"embed":ti("load",p);break;case"video":case"audio":for(f=0;f<hh.length;f++)ti(hh[f],p);break;case"source":ti("error",p);break;case"img":case"image":case"link":ti("error",p),ti("load",p);break;case"details":ti("toggle",p);break;case"input":kv(p,s),ti("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!s.multiple},ti("invalid",p);break;case"textarea":Ev(p,s),ti("invalid",p)}ig(c,s),f=null;for(var E in s)if(s.hasOwnProperty(E)){var A=s[E];E==="children"?typeof A=="string"?p.textContent!==A&&(s.suppressHydrationWarning!==!0&&Sp(p.textContent,A,i),f=["children",A]):typeof A=="number"&&p.textContent!==""+A&&(s.suppressHydrationWarning!==!0&&Sp(p.textContent,A,i),f=["children",""+A]):wh.hasOwnProperty(E)&&A!=null&&E==="onScroll"&&ti("scroll",p)}switch(c){case"input":dp(p),Sv(p,s,!0);break;case"textarea":dp(p),Tv(p);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(p.onclick=Wp)}p=f,n.updateQueue=p,p!==null&&(n.flags|=4)}else{E=f.nodeType===9?f:f.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Dx(c)),i==="http://www.w3.org/1999/xhtml"?c==="script"?(i=E.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof p.is=="string"?i=E.createElement(c,{is:p.is}):(i=E.createElement(c),c==="select"&&(E=i,p.multiple?E.multiple=!0:p.size&&(E.size=p.size))):i=E.createElementNS(i,c),i[vo]=n,i[Mh]=p,nw(i,n,!1,!1),n.stateNode=i;e:{switch(E=rg(c,p),c){case"dialog":ti("cancel",i),ti("close",i),f=p;break;case"iframe":case"object":case"embed":ti("load",i),f=p;break;case"video":case"audio":for(f=0;f<hh.length;f++)ti(hh[f],i);f=p;break;case"source":ti("error",i),f=p;break;case"img":case"image":case"link":ti("error",i),ti("load",i),f=p;break;case"details":ti("toggle",i),f=p;break;case"input":kv(i,p),f=J1(i,p),ti("invalid",i);break;case"option":f=p;break;case"select":i._wrapperState={wasMultiple:!!p.multiple},f=hi({},p,{value:void 0}),ti("invalid",i);break;case"textarea":Ev(i,p),f=eg(i,p),ti("invalid",i);break;default:f=p}ig(c,f),A=f;for(s in A)if(A.hasOwnProperty(s)){var N=A[s];s==="style"?Bx(i,N):s==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,N!=null&&Rx(i,N)):s==="children"?typeof N=="string"?(c!=="textarea"||N!=="")&&bh(i,N):typeof N=="number"&&bh(i,""+N):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(wh.hasOwnProperty(s)?N!=null&&s==="onScroll"&&ti("scroll",i):N!=null&&jg(i,s,N,E))}switch(c){case"input":dp(i),Sv(i,p,!1);break;case"textarea":dp(i),Tv(i);break;case"option":p.value!=null&&i.setAttribute("value",""+os(p.value));break;case"select":i.multiple=!!p.multiple,s=p.value,s!=null?_c(i,!!p.multiple,s,!1):p.defaultValue!=null&&_c(i,!!p.multiple,p.defaultValue,!0);break;default:typeof f.onClick=="function"&&(i.onclick=Wp)}switch(c){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return cr(n),null;case 6:if(i&&n.stateNode!=null)aw(i,n,i.memoizedProps,p);else{if(typeof p!="string"&&n.stateNode===null)throw Error(Me(166));if(c=Xs(Lh.current),Xs(wo.current),Ep(n)){if(p=n.stateNode,c=n.memoizedProps,p[vo]=n,(s=p.nodeValue!==c)&&(i=ln,i!==null))switch(i.tag){case 3:Sp(p.nodeValue,c,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Sp(p.nodeValue,c,(i.mode&1)!==0)}s&&(n.flags|=4)}else p=(c.nodeType===9?c:c.ownerDocument).createTextNode(p),p[vo]=n,n.stateNode=p}return cr(n),null;case 13:if(ii(ci),p=n.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(ai&&sn!==null&&n.mode&1&&!(n.flags&128))S2(),Tc(),n.flags|=98560,s=!1;else if(s=Ep(n),p!==null&&p.dehydrated!==null){if(i===null){if(!s)throw Error(Me(318));if(s=n.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Me(317));s[vo]=n}else Tc(),!(n.flags&128)&&(n.memoizedState=null),n.flags|=4;cr(n),s=!1}else Wn!==null&&(Bg(Wn),Wn=null),s=!0;if(!s)return n.flags&65536?n:null}return n.flags&128?(n.lanes=c,n):(p=p!==null,p!==(i!==null&&i.memoizedState!==null)&&p&&(n.child.flags|=8192,n.mode&1&&(i===null||ci.current&1?Pi===0&&(Pi=3):b0())),n.updateQueue!==null&&(n.flags|=4),cr(n),null);case 4:return zc(),Ig(i,n),i===null&&Ih(n.stateNode.containerInfo),cr(n),null;case 10:return o0(n.type._context),cr(n),null;case 17:return jr(n.type)&&Xp(),cr(n),null;case 19:if(ii(ci),s=n.memoizedState,s===null)return cr(n),null;if(p=(n.flags&128)!==0,E=s.rendering,E===null)if(p)oh(s,!1);else{if(Pi!==0||i!==null&&i.flags&128)for(i=n.child;i!==null;){if(E=rf(i),E!==null){for(n.flags|=128,oh(s,!1),p=E.updateQueue,p!==null&&(n.updateQueue=p,n.flags|=4),n.subtreeFlags=0,p=c,c=n.child;c!==null;)s=c,i=p,s.flags&=14680066,E=s.alternate,E===null?(s.childLanes=0,s.lanes=i,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=E.childLanes,s.lanes=E.lanes,s.child=E.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=E.memoizedProps,s.memoizedState=E.memoizedState,s.updateQueue=E.updateQueue,s.type=E.type,i=E.dependencies,s.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),c=c.sibling;return Jt(ci,ci.current&1|2),n.child}i=i.sibling}s.tail!==null&&yi()>Pc&&(n.flags|=128,p=!0,oh(s,!1),n.lanes=4194304)}else{if(!p)if(i=rf(E),i!==null){if(n.flags|=128,p=!0,c=i.updateQueue,c!==null&&(n.updateQueue=c,n.flags|=4),oh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!E.alternate&&!ai)return cr(n),null}else 2*yi()-s.renderingStartTime>Pc&&c!==1073741824&&(n.flags|=128,p=!0,oh(s,!1),n.lanes=4194304);s.isBackwards?(E.sibling=n.child,n.child=E):(c=s.last,c!==null?c.sibling=E:n.child=E,s.last=E)}return s.tail!==null?(n=s.tail,s.rendering=n,s.tail=n.sibling,s.renderingStartTime=yi(),n.sibling=null,c=ci.current,Jt(ci,p?c&1|2:c&1),n):(cr(n),null);case 22:case 23:return w0(),p=n.memoizedState!==null,i!==null&&i.memoizedState!==null!==p&&(n.flags|=8192),p&&n.mode&1?an&1073741824&&(cr(n),n.subtreeFlags&6&&(n.flags|=8192)):cr(n),null;case 24:return null;case 25:return null}throw Error(Me(156,n.tag))}function Fk(i,n){switch(t0(n),n.tag){case 1:return jr(n.type)&&Xp(),i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 3:return zc(),ii(Nr),ii(hr),u0(),i=n.flags,i&65536&&!(i&128)?(n.flags=i&-65537|128,n):null;case 5:return c0(n),null;case 13:if(ii(ci),i=n.memoizedState,i!==null&&i.dehydrated!==null){if(n.alternate===null)throw Error(Me(340));Tc()}return i=n.flags,i&65536?(n.flags=i&-65537|128,n):null;case 19:return ii(ci),null;case 4:return zc(),null;case 10:return o0(n.type._context),null;case 22:case 23:return w0(),null;case 24:return null;default:return null}}var zp=!1,ur=!1,Bk=typeof WeakSet=="function"?WeakSet:Set,tt=null;function gc(i,n){var c=i.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(p){mi(i,n,p)}else c.current=null}function Pg(i,n,c){try{c()}catch(p){mi(i,n,p)}}var gx=!1;function Ok(i,n){if(pg=Zp,i=h2(),Qg(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var p=c.getSelection&&c.getSelection();if(p&&p.rangeCount!==0){c=p.anchorNode;var f=p.anchorOffset,s=p.focusNode;p=p.focusOffset;try{c.nodeType,s.nodeType}catch{c=null;break e}var E=0,A=-1,N=-1,B=0,j=0,de=i,ge=null;t:for(;;){for(var Te;de!==c||f!==0&&de.nodeType!==3||(A=E+f),de!==s||p!==0&&de.nodeType!==3||(N=E+p),de.nodeType===3&&(E+=de.nodeValue.length),(Te=de.firstChild)!==null;)ge=de,de=Te;for(;;){if(de===i)break t;if(ge===c&&++B===f&&(A=E),ge===s&&++j===p&&(N=E),(Te=de.nextSibling)!==null)break;de=ge,ge=de.parentNode}de=Te}c=A===-1||N===-1?null:{start:A,end:N}}else c=null}c=c||{start:0,end:0}}else c=null;for(fg={focusedElem:i,selectionRange:c},Zp=!1,tt=n;tt!==null;)if(n=tt,i=n.child,(n.subtreeFlags&1028)!==0&&i!==null)i.return=n,tt=i;else for(;tt!==null;){n=tt;try{var xe=n.alternate;if(n.flags&1024)switch(n.tag){case 0:case 11:case 15:break;case 1:if(xe!==null){var Se=xe.memoizedProps,Ae=xe.memoizedState,ne=n.stateNode,ee=ne.getSnapshotBeforeUpdate(n.elementType===n.type?Se:Hn(n.type,Se),Ae);ne.__reactInternalSnapshotBeforeUpdate=ee}break;case 3:var ae=n.stateNode.containerInfo;ae.nodeType===1?ae.textContent="":ae.nodeType===9&&ae.documentElement&&ae.removeChild(ae.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Me(163))}}catch(be){mi(n,n.return,be)}if(i=n.sibling,i!==null){i.return=n.return,tt=i;break}tt=n.return}return xe=gx,gx=!1,xe}function _h(i,n,c){var p=n.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var f=p=p.next;do{if((f.tag&i)===i){var s=f.destroy;f.destroy=void 0,s!==void 0&&Pg(n,c,s)}f=f.next}while(f!==p)}}function vf(i,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var c=n=n.next;do{if((c.tag&i)===i){var p=c.create;c.destroy=p()}c=c.next}while(c!==n)}}function Mg(i){var n=i.ref;if(n!==null){var c=i.stateNode;switch(i.tag){case 5:i=c;break;default:i=c}typeof n=="function"?n(i):n.current=i}}function sw(i){var n=i.alternate;n!==null&&(i.alternate=null,sw(n)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(n=i.stateNode,n!==null&&(delete n[vo],delete n[Mh],delete n[yg],delete n[xk],delete n[wk])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function lw(i){return i.tag===5||i.tag===3||i.tag===4}function yx(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||lw(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Ag(i,n,c){var p=i.tag;if(p===5||p===6)i=i.stateNode,n?c.nodeType===8?c.parentNode.insertBefore(i,n):c.insertBefore(i,n):(c.nodeType===8?(n=c.parentNode,n.insertBefore(i,c)):(n=c,n.appendChild(i)),c=c._reactRootContainer,c!=null||n.onclick!==null||(n.onclick=Wp));else if(p!==4&&(i=i.child,i!==null))for(Ag(i,n,c),i=i.sibling;i!==null;)Ag(i,n,c),i=i.sibling}function Lg(i,n,c){var p=i.tag;if(p===5||p===6)i=i.stateNode,n?c.insertBefore(i,n):c.appendChild(i);else if(p!==4&&(i=i.child,i!==null))for(Lg(i,n,c),i=i.sibling;i!==null;)Lg(i,n,c),i=i.sibling}var Wi=null,Gn=!1;function $a(i,n,c){for(c=c.child;c!==null;)cw(i,n,c),c=c.sibling}function cw(i,n,c){if(xo&&typeof xo.onCommitFiberUnmount=="function")try{xo.onCommitFiberUnmount(hf,c)}catch{}switch(c.tag){case 5:ur||gc(c,n);case 6:var p=Wi,f=Gn;Wi=null,$a(i,n,c),Wi=p,Gn=f,Wi!==null&&(Gn?(i=Wi,c=c.stateNode,i.nodeType===8?i.parentNode.removeChild(c):i.removeChild(c)):Wi.removeChild(c.stateNode));break;case 18:Wi!==null&&(Gn?(i=Wi,c=c.stateNode,i.nodeType===8?F1(i.parentNode,c):i.nodeType===1&&F1(i,c),Th(i)):F1(Wi,c.stateNode));break;case 4:p=Wi,f=Gn,Wi=c.stateNode.containerInfo,Gn=!0,$a(i,n,c),Wi=p,Gn=f;break;case 0:case 11:case 14:case 15:if(!ur&&(p=c.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){f=p=p.next;do{var s=f,E=s.destroy;s=s.tag,E!==void 0&&(s&2||s&4)&&Pg(c,n,E),f=f.next}while(f!==p)}$a(i,n,c);break;case 1:if(!ur&&(gc(c,n),p=c.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=c.memoizedProps,p.state=c.memoizedState,p.componentWillUnmount()}catch(A){mi(c,n,A)}$a(i,n,c);break;case 21:$a(i,n,c);break;case 22:c.mode&1?(ur=(p=ur)||c.memoizedState!==null,$a(i,n,c),ur=p):$a(i,n,c);break;default:$a(i,n,c)}}function _x(i){var n=i.updateQueue;if(n!==null){i.updateQueue=null;var c=i.stateNode;c===null&&(c=i.stateNode=new Bk),n.forEach(function(p){var f=Gk.bind(null,i,p);c.has(p)||(c.add(p),p.then(f,f))})}}function Zn(i,n){var c=n.deletions;if(c!==null)for(var p=0;p<c.length;p++){var f=c[p];try{var s=i,E=n,A=E;e:for(;A!==null;){switch(A.tag){case 5:Wi=A.stateNode,Gn=!1;break e;case 3:Wi=A.stateNode.containerInfo,Gn=!0;break e;case 4:Wi=A.stateNode.containerInfo,Gn=!0;break e}A=A.return}if(Wi===null)throw Error(Me(160));cw(s,E,f),Wi=null,Gn=!1;var N=f.alternate;N!==null&&(N.return=null),f.return=null}catch(B){mi(f,n,B)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)uw(n,i),n=n.sibling}function uw(i,n){var c=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(Zn(n,i),yo(i),p&4){try{_h(3,i,i.return),vf(3,i)}catch(Se){mi(i,i.return,Se)}try{_h(5,i,i.return)}catch(Se){mi(i,i.return,Se)}}break;case 1:Zn(n,i),yo(i),p&512&&c!==null&&gc(c,c.return);break;case 5:if(Zn(n,i),yo(i),p&512&&c!==null&&gc(c,c.return),i.flags&32){var f=i.stateNode;try{bh(f,"")}catch(Se){mi(i,i.return,Se)}}if(p&4&&(f=i.stateNode,f!=null)){var s=i.memoizedProps,E=c!==null?c.memoizedProps:s,A=i.type,N=i.updateQueue;if(i.updateQueue=null,N!==null)try{A==="input"&&s.type==="radio"&&s.name!=null&&Ax(f,s),rg(A,E);var B=rg(A,s);for(E=0;E<N.length;E+=2){var j=N[E],de=N[E+1];j==="style"?Bx(f,de):j==="dangerouslySetInnerHTML"?Rx(f,de):j==="children"?bh(f,de):jg(f,j,de,B)}switch(A){case"input":Y1(f,s);break;case"textarea":Lx(f,s);break;case"select":var ge=f._wrapperState.wasMultiple;f._wrapperState.wasMultiple=!!s.multiple;var Te=s.value;Te!=null?_c(f,!!s.multiple,Te,!1):ge!==!!s.multiple&&(s.defaultValue!=null?_c(f,!!s.multiple,s.defaultValue,!0):_c(f,!!s.multiple,s.multiple?[]:"",!1))}f[Mh]=s}catch(Se){mi(i,i.return,Se)}}break;case 6:if(Zn(n,i),yo(i),p&4){if(i.stateNode===null)throw Error(Me(162));f=i.stateNode,s=i.memoizedProps;try{f.nodeValue=s}catch(Se){mi(i,i.return,Se)}}break;case 3:if(Zn(n,i),yo(i),p&4&&c!==null&&c.memoizedState.isDehydrated)try{Th(n.containerInfo)}catch(Se){mi(i,i.return,Se)}break;case 4:Zn(n,i),yo(i);break;case 13:Zn(n,i),yo(i),f=i.child,f.flags&8192&&(s=f.memoizedState!==null,f.stateNode.isHidden=s,!s||f.alternate!==null&&f.alternate.memoizedState!==null||(v0=yi())),p&4&&_x(i);break;case 22:if(j=c!==null&&c.memoizedState!==null,i.mode&1?(ur=(B=ur)||j,Zn(n,i),ur=B):Zn(n,i),yo(i),p&8192){if(B=i.memoizedState!==null,(i.stateNode.isHidden=B)&&!j&&i.mode&1)for(tt=i,j=i.child;j!==null;){for(de=tt=j;tt!==null;){switch(ge=tt,Te=ge.child,ge.tag){case 0:case 11:case 14:case 15:_h(4,ge,ge.return);break;case 1:gc(ge,ge.return);var xe=ge.stateNode;if(typeof xe.componentWillUnmount=="function"){p=ge,c=ge.return;try{n=p,xe.props=n.memoizedProps,xe.state=n.memoizedState,xe.componentWillUnmount()}catch(Se){mi(p,c,Se)}}break;case 5:gc(ge,ge.return);break;case 22:if(ge.memoizedState!==null){xx(de);continue}}Te!==null?(Te.return=ge,tt=Te):xx(de)}j=j.sibling}e:for(j=null,de=i;;){if(de.tag===5){if(j===null){j=de;try{f=de.stateNode,B?(s=f.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(A=de.stateNode,N=de.memoizedProps.style,E=N!=null&&N.hasOwnProperty("display")?N.display:null,A.style.display=Fx("display",E))}catch(Se){mi(i,i.return,Se)}}}else if(de.tag===6){if(j===null)try{de.stateNode.nodeValue=B?"":de.memoizedProps}catch(Se){mi(i,i.return,Se)}}else if((de.tag!==22&&de.tag!==23||de.memoizedState===null||de===i)&&de.child!==null){de.child.return=de,de=de.child;continue}if(de===i)break e;for(;de.sibling===null;){if(de.return===null||de.return===i)break e;j===de&&(j=null),de=de.return}j===de&&(j=null),de.sibling.return=de.return,de=de.sibling}}break;case 19:Zn(n,i),yo(i),p&4&&_x(i);break;case 21:break;default:Zn(n,i),yo(i)}}function yo(i){var n=i.flags;if(n&2){try{e:{for(var c=i.return;c!==null;){if(lw(c)){var p=c;break e}c=c.return}throw Error(Me(160))}switch(p.tag){case 5:var f=p.stateNode;p.flags&32&&(bh(f,""),p.flags&=-33);var s=yx(i);Lg(i,s,f);break;case 3:case 4:var E=p.stateNode.containerInfo,A=yx(i);Ag(i,A,E);break;default:throw Error(Me(161))}}catch(N){mi(i,i.return,N)}i.flags&=-3}n&4096&&(i.flags&=-4097)}function Nk(i,n,c){tt=i,hw(i,n,c)}function hw(i,n,c){for(var p=(i.mode&1)!==0;tt!==null;){var f=tt,s=f.child;if(f.tag===22&&p){var E=f.memoizedState!==null||zp;if(!E){var A=f.alternate,N=A!==null&&A.memoizedState!==null||ur;A=zp;var B=ur;if(zp=E,(ur=N)&&!B)for(tt=f;tt!==null;)E=tt,N=E.child,E.tag===22&&E.memoizedState!==null?wx(f):N!==null?(N.return=E,tt=N):wx(f);for(;s!==null;)tt=s,hw(s,n,c),s=s.sibling;tt=f,zp=A,ur=B}vx(i,n,c)}else f.subtreeFlags&8772&&s!==null?(s.return=f,tt=s):vx(i,n,c)}}function vx(i){for(;tt!==null;){var n=tt;if(n.flags&8772){var c=n.alternate;try{if(n.flags&8772)switch(n.tag){case 0:case 11:case 15:ur||vf(5,n);break;case 1:var p=n.stateNode;if(n.flags&4&&!ur)if(c===null)p.componentDidMount();else{var f=n.elementType===n.type?c.memoizedProps:Hn(n.type,c.memoizedProps);p.componentDidUpdate(f,c.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var s=n.updateQueue;s!==null&&rx(n,s,p);break;case 3:var E=n.updateQueue;if(E!==null){if(c=null,n.child!==null)switch(n.child.tag){case 5:c=n.child.stateNode;break;case 1:c=n.child.stateNode}rx(n,E,c)}break;case 5:var A=n.stateNode;if(c===null&&n.flags&4){c=A;var N=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":N.autoFocus&&c.focus();break;case"img":N.src&&(c.src=N.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var B=n.alternate;if(B!==null){var j=B.memoizedState;if(j!==null){var de=j.dehydrated;de!==null&&Th(de)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Me(163))}ur||n.flags&512&&Mg(n)}catch(ge){mi(n,n.return,ge)}}if(n===i){tt=null;break}if(c=n.sibling,c!==null){c.return=n.return,tt=c;break}tt=n.return}}function xx(i){for(;tt!==null;){var n=tt;if(n===i){tt=null;break}var c=n.sibling;if(c!==null){c.return=n.return,tt=c;break}tt=n.return}}function wx(i){for(;tt!==null;){var n=tt;try{switch(n.tag){case 0:case 11:case 15:var c=n.return;try{vf(4,n)}catch(N){mi(n,c,N)}break;case 1:var p=n.stateNode;if(typeof p.componentDidMount=="function"){var f=n.return;try{p.componentDidMount()}catch(N){mi(n,f,N)}}var s=n.return;try{Mg(n)}catch(N){mi(n,s,N)}break;case 5:var E=n.return;try{Mg(n)}catch(N){mi(n,E,N)}}}catch(N){mi(n,n.return,N)}if(n===i){tt=null;break}var A=n.sibling;if(A!==null){A.return=n.return,tt=A;break}tt=n.return}}var jk=Math.ceil,af=ta.ReactCurrentDispatcher,y0=ta.ReactCurrentOwner,Pn=ta.ReactCurrentBatchConfig,Mt=0,Vi=null,ki=null,Xi=0,an=0,yc=ls(0),Pi=0,Bh=null,tl=0,xf=0,_0=0,vh=null,Br=null,v0=0,Pc=1/0,Ho=null,sf=!1,Dg=null,is=null,Ip=!1,Ka=null,lf=0,xh=0,Rg=null,Bp=-1,Op=0;function Er(){return Mt&6?yi():Bp!==-1?Bp:Bp=yi()}function rs(i){return i.mode&1?Mt&2&&Xi!==0?Xi&-Xi:kk.transition!==null?(Op===0&&(Op=Xx()),Op):(i=Vt,i!==0||(i=window.event,i=i===void 0?16:i2(i.type)),i):1}function Kn(i,n,c,p){if(50<xh)throw xh=0,Rg=null,Error(Me(185));Oh(i,c,p),(!(Mt&2)||i!==Vi)&&(i===Vi&&(!(Mt&2)&&(xf|=c),Pi===4&&Wa(i,Xi)),Vr(i,p),c===1&&Mt===0&&!(n.mode&1)&&(Pc=yi()+500,gf&&cs()))}function Vr(i,n){var c=i.callbackNode;E4(i,n);var p=$p(i,i===Vi?Xi:0);if(p===0)c!==null&&Iv(c),i.callbackNode=null,i.callbackPriority=0;else if(n=p&-p,i.callbackPriority!==n){if(c!=null&&Iv(c),n===1)i.tag===0?bk(bx.bind(null,i)):w2(bx.bind(null,i)),_k(function(){!(Mt&6)&&cs()}),c=null;else{switch(Kx(p)){case 1:c=Zg;break;case 4:c=Gx;break;case 16:c=qp;break;case 536870912:c=Wx;break;default:c=qp}c=vw(c,dw.bind(null,i))}i.callbackPriority=n,i.callbackNode=c}}function dw(i,n){if(Bp=-1,Op=0,Mt&6)throw Error(Me(327));var c=i.callbackNode;if(kc()&&i.callbackNode!==c)return null;var p=$p(i,i===Vi?Xi:0);if(p===0)return null;if(p&30||p&i.expiredLanes||n)n=cf(i,p);else{n=p;var f=Mt;Mt|=2;var s=fw();(Vi!==i||Xi!==n)&&(Ho=null,Pc=yi()+500,Ks(i,n));do try{qk();break}catch(A){pw(i,A)}while(!0);n0(),af.current=s,Mt=f,ki!==null?n=0:(Vi=null,Xi=0,n=Pi)}if(n!==0){if(n===2&&(f=lg(i),f!==0&&(p=f,n=Fg(i,f))),n===1)throw c=Bh,Ks(i,0),Wa(i,p),Vr(i,yi()),c;if(n===6)Wa(i,p);else{if(f=i.current.alternate,!(p&30)&&!Vk(f)&&(n=cf(i,p),n===2&&(s=lg(i),s!==0&&(p=s,n=Fg(i,s))),n===1))throw c=Bh,Ks(i,0),Wa(i,p),Vr(i,yi()),c;switch(i.finishedWork=f,i.finishedLanes=p,n){case 0:case 1:throw Error(Me(345));case 2:Hs(i,Br,Ho);break;case 3:if(Wa(i,p),(p&130023424)===p&&(n=v0+500-yi(),10<n)){if($p(i,0)!==0)break;if(f=i.suspendedLanes,(f&p)!==p){Er(),i.pingedLanes|=i.suspendedLanes&f;break}i.timeoutHandle=gg(Hs.bind(null,i,Br,Ho),n);break}Hs(i,Br,Ho);break;case 4:if(Wa(i,p),(p&4194240)===p)break;for(n=i.eventTimes,f=-1;0<p;){var E=31-Xn(p);s=1<<E,E=n[E],E>f&&(f=E),p&=~s}if(p=f,p=yi()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*jk(p/1960))-p,10<p){i.timeoutHandle=gg(Hs.bind(null,i,Br,Ho),p);break}Hs(i,Br,Ho);break;case 5:Hs(i,Br,Ho);break;default:throw Error(Me(329))}}}return Vr(i,yi()),i.callbackNode===c?dw.bind(null,i):null}function Fg(i,n){var c=vh;return i.current.memoizedState.isDehydrated&&(Ks(i,n).flags|=256),i=cf(i,n),i!==2&&(n=Br,Br=c,n!==null&&Bg(n)),i}function Bg(i){Br===null?Br=i:Br.push.apply(Br,i)}function Vk(i){for(var n=i;;){if(n.flags&16384){var c=n.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var p=0;p<c.length;p++){var f=c[p],s=f.getSnapshot;f=f.value;try{if(!Jn(s(),f))return!1}catch{return!1}}}if(c=n.child,n.subtreeFlags&16384&&c!==null)c.return=n,n=c;else{if(n===i)break;for(;n.sibling===null;){if(n.return===null||n.return===i)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function Wa(i,n){for(n&=~_0,n&=~xf,i.suspendedLanes|=n,i.pingedLanes&=~n,i=i.expirationTimes;0<n;){var c=31-Xn(n),p=1<<c;i[c]=-1,n&=~p}}function bx(i){if(Mt&6)throw Error(Me(327));kc();var n=$p(i,0);if(!(n&1))return Vr(i,yi()),null;var c=cf(i,n);if(i.tag!==0&&c===2){var p=lg(i);p!==0&&(n=p,c=Fg(i,p))}if(c===1)throw c=Bh,Ks(i,0),Wa(i,n),Vr(i,yi()),c;if(c===6)throw Error(Me(345));return i.finishedWork=i.current.alternate,i.finishedLanes=n,Hs(i,Br,Ho),Vr(i,yi()),null}function x0(i,n){var c=Mt;Mt|=1;try{return i(n)}finally{Mt=c,Mt===0&&(Pc=yi()+500,gf&&cs())}}function il(i){Ka!==null&&Ka.tag===0&&!(Mt&6)&&kc();var n=Mt;Mt|=1;var c=Pn.transition,p=Vt;try{if(Pn.transition=null,Vt=1,i)return i()}finally{Vt=p,Pn.transition=c,Mt=n,!(Mt&6)&&cs()}}function w0(){an=yc.current,ii(yc)}function Ks(i,n){i.finishedWork=null,i.finishedLanes=0;var c=i.timeoutHandle;if(c!==-1&&(i.timeoutHandle=-1,yk(c)),ki!==null)for(c=ki.return;c!==null;){var p=c;switch(t0(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&Xp();break;case 3:zc(),ii(Nr),ii(hr),u0();break;case 5:c0(p);break;case 4:zc();break;case 13:ii(ci);break;case 19:ii(ci);break;case 10:o0(p.type._context);break;case 22:case 23:w0()}c=c.return}if(Vi=i,ki=i=ns(i.current,null),Xi=an=n,Pi=0,Bh=null,_0=xf=tl=0,Br=vh=null,Ws!==null){for(n=0;n<Ws.length;n++)if(c=Ws[n],p=c.interleaved,p!==null){c.interleaved=null;var f=p.next,s=c.pending;if(s!==null){var E=s.next;s.next=f,p.next=E}c.pending=p}Ws=null}return i}function pw(i,n){do{var c=ki;try{if(n0(),Dp.current=of,nf){for(var p=ui.memoizedState;p!==null;){var f=p.queue;f!==null&&(f.pending=null),p=p.next}nf=!1}if(el=0,ji=Ii=ui=null,yh=!1,Dh=0,y0.current=null,c===null||c.return===null){Pi=1,Bh=n,ki=null;break}e:{var s=i,E=c.return,A=c,N=n;if(n=Xi,A.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){var B=N,j=A,de=j.tag;if(!(j.mode&1)&&(de===0||de===11||de===15)){var ge=j.alternate;ge?(j.updateQueue=ge.updateQueue,j.memoizedState=ge.memoizedState,j.lanes=ge.lanes):(j.updateQueue=null,j.memoizedState=null)}var Te=cx(E);if(Te!==null){Te.flags&=-257,ux(Te,E,A,s,n),Te.mode&1&&lx(s,B,n),n=Te,N=B;var xe=n.updateQueue;if(xe===null){var Se=new Set;Se.add(N),n.updateQueue=Se}else xe.add(N);break e}else{if(!(n&1)){lx(s,B,n),b0();break e}N=Error(Me(426))}}else if(ai&&A.mode&1){var Ae=cx(E);if(Ae!==null){!(Ae.flags&65536)&&(Ae.flags|=256),ux(Ae,E,A,s,n),i0(Ic(N,A));break e}}s=N=Ic(N,A),Pi!==4&&(Pi=2),vh===null?vh=[s]:vh.push(s),s=E;do{switch(s.tag){case 3:s.flags|=65536,n&=-n,s.lanes|=n;var ne=K2(s,N,n);ix(s,ne);break e;case 1:A=N;var ee=s.type,ae=s.stateNode;if(!(s.flags&128)&&(typeof ee.getDerivedStateFromError=="function"||ae!==null&&typeof ae.componentDidCatch=="function"&&(is===null||!is.has(ae)))){s.flags|=65536,n&=-n,s.lanes|=n;var be=J2(s,A,n);ix(s,be);break e}}s=s.return}while(s!==null)}gw(c)}catch(Ie){n=Ie,ki===c&&c!==null&&(ki=c=c.return);continue}break}while(!0)}function fw(){var i=af.current;return af.current=of,i===null?of:i}function b0(){(Pi===0||Pi===3||Pi===2)&&(Pi=4),Vi===null||!(tl&268435455)&&!(xf&268435455)||Wa(Vi,Xi)}function cf(i,n){var c=Mt;Mt|=2;var p=fw();(Vi!==i||Xi!==n)&&(Ho=null,Ks(i,n));do try{Uk();break}catch(f){pw(i,f)}while(!0);if(n0(),Mt=c,af.current=p,ki!==null)throw Error(Me(261));return Vi=null,Xi=0,Pi}function Uk(){for(;ki!==null;)mw(ki)}function qk(){for(;ki!==null&&!g4();)mw(ki)}function mw(i){var n=_w(i.alternate,i,an);i.memoizedProps=i.pendingProps,n===null?gw(i):ki=n,y0.current=null}function gw(i){var n=i;do{var c=n.alternate;if(i=n.return,n.flags&32768){if(c=Fk(c,n),c!==null){c.flags&=32767,ki=c;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Pi=6,ki=null;return}}else if(c=Rk(c,n,an),c!==null){ki=c;return}if(n=n.sibling,n!==null){ki=n;return}ki=n=i}while(n!==null);Pi===0&&(Pi=5)}function Hs(i,n,c){var p=Vt,f=Pn.transition;try{Pn.transition=null,Vt=1,$k(i,n,c,p)}finally{Pn.transition=f,Vt=p}return null}function $k(i,n,c,p){do kc();while(Ka!==null);if(Mt&6)throw Error(Me(327));c=i.finishedWork;var f=i.finishedLanes;if(c===null)return null;if(i.finishedWork=null,i.finishedLanes=0,c===i.current)throw Error(Me(177));i.callbackNode=null,i.callbackPriority=0;var s=c.lanes|c.childLanes;if(T4(i,s),i===Vi&&(ki=Vi=null,Xi=0),!(c.subtreeFlags&2064)&&!(c.flags&2064)||Ip||(Ip=!0,vw(qp,function(){return kc(),null})),s=(c.flags&15990)!==0,c.subtreeFlags&15990||s){s=Pn.transition,Pn.transition=null;var E=Vt;Vt=1;var A=Mt;Mt|=4,y0.current=null,Ok(i,c),uw(c,i),dk(fg),Zp=!!pg,fg=pg=null,i.current=c,Nk(c,i,f),y4(),Mt=A,Vt=E,Pn.transition=s}else i.current=c;if(Ip&&(Ip=!1,Ka=i,lf=f),s=i.pendingLanes,s===0&&(is=null),x4(c.stateNode,p),Vr(i,yi()),n!==null)for(p=i.onRecoverableError,c=0;c<n.length;c++)f=n[c],p(f.value,{componentStack:f.stack,digest:f.digest});if(sf)throw sf=!1,i=Dg,Dg=null,i;return lf&1&&i.tag!==0&&kc(),s=i.pendingLanes,s&1?i===Rg?xh++:(xh=0,Rg=i):xh=0,cs(),null}function kc(){if(Ka!==null){var i=Kx(lf),n=Pn.transition,c=Vt;try{if(Pn.transition=null,Vt=16>i?16:i,Ka===null)var p=!1;else{if(i=Ka,Ka=null,lf=0,Mt&6)throw Error(Me(331));var f=Mt;for(Mt|=4,tt=i.current;tt!==null;){var s=tt,E=s.child;if(tt.flags&16){var A=s.deletions;if(A!==null){for(var N=0;N<A.length;N++){var B=A[N];for(tt=B;tt!==null;){var j=tt;switch(j.tag){case 0:case 11:case 15:_h(8,j,s)}var de=j.child;if(de!==null)de.return=j,tt=de;else for(;tt!==null;){j=tt;var ge=j.sibling,Te=j.return;if(sw(j),j===B){tt=null;break}if(ge!==null){ge.return=Te,tt=ge;break}tt=Te}}}var xe=s.alternate;if(xe!==null){var Se=xe.child;if(Se!==null){xe.child=null;do{var Ae=Se.sibling;Se.sibling=null,Se=Ae}while(Se!==null)}}tt=s}}if(s.subtreeFlags&2064&&E!==null)E.return=s,tt=E;else e:for(;tt!==null;){if(s=tt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:_h(9,s,s.return)}var ne=s.sibling;if(ne!==null){ne.return=s.return,tt=ne;break e}tt=s.return}}var ee=i.current;for(tt=ee;tt!==null;){E=tt;var ae=E.child;if(E.subtreeFlags&2064&&ae!==null)ae.return=E,tt=ae;else e:for(E=ee;tt!==null;){if(A=tt,A.flags&2048)try{switch(A.tag){case 0:case 11:case 15:vf(9,A)}}catch(Ie){mi(A,A.return,Ie)}if(A===E){tt=null;break e}var be=A.sibling;if(be!==null){be.return=A.return,tt=be;break e}tt=A.return}}if(Mt=f,cs(),xo&&typeof xo.onPostCommitFiberRoot=="function")try{xo.onPostCommitFiberRoot(hf,i)}catch{}p=!0}return p}finally{Vt=c,Pn.transition=n}}return!1}function kx(i,n,c){n=Ic(c,n),n=K2(i,n,1),i=ts(i,n,1),n=Er(),i!==null&&(Oh(i,1,n),Vr(i,n))}function mi(i,n,c){if(i.tag===3)kx(i,i,c);else for(;n!==null;){if(n.tag===3){kx(n,i,c);break}else if(n.tag===1){var p=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(is===null||!is.has(p))){i=Ic(c,i),i=J2(n,i,1),n=ts(n,i,1),i=Er(),n!==null&&(Oh(n,1,i),Vr(n,i));break}}n=n.return}}function Zk(i,n,c){var p=i.pingCache;p!==null&&p.delete(n),n=Er(),i.pingedLanes|=i.suspendedLanes&c,Vi===i&&(Xi&c)===c&&(Pi===4||Pi===3&&(Xi&130023424)===Xi&&500>yi()-v0?Ks(i,0):_0|=c),Vr(i,n)}function yw(i,n){n===0&&(i.mode&1?(n=mp,mp<<=1,!(mp&130023424)&&(mp=4194304)):n=1);var c=Er();i=Qo(i,n),i!==null&&(Oh(i,n,c),Vr(i,c))}function Hk(i){var n=i.memoizedState,c=0;n!==null&&(c=n.retryLane),yw(i,c)}function Gk(i,n){var c=0;switch(i.tag){case 13:var p=i.stateNode,f=i.memoizedState;f!==null&&(c=f.retryLane);break;case 19:p=i.stateNode;break;default:throw Error(Me(314))}p!==null&&p.delete(n),yw(i,c)}var _w;_w=function(i,n,c){if(i!==null)if(i.memoizedProps!==n.pendingProps||Nr.current)Or=!0;else{if(!(i.lanes&c)&&!(n.flags&128))return Or=!1,Dk(i,n,c);Or=!!(i.flags&131072)}else Or=!1,ai&&n.flags&1048576&&b2(n,Yp,n.index);switch(n.lanes=0,n.tag){case 2:var p=n.type;Fp(i,n),i=n.pendingProps;var f=Ec(n,hr.current);bc(n,c),f=d0(null,n,p,i,f,c);var s=p0();return n.flags|=1,typeof f=="object"&&f!==null&&typeof f.render=="function"&&f.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,jr(p)?(s=!0,Kp(n)):s=!1,n.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,s0(n),f.updater=_f,n.stateNode=f,f._reactInternals=n,kg(n,p,i,c),n=Tg(null,n,p,!0,s,c)):(n.tag=0,ai&&s&&e0(n),Sr(null,n,f,c),n=n.child),n;case 16:p=n.elementType;e:{switch(Fp(i,n),i=n.pendingProps,f=p._init,p=f(p._payload),n.type=p,f=n.tag=Xk(p),i=Hn(p,i),f){case 0:n=Eg(null,n,p,i,c);break e;case 1:n=px(null,n,p,i,c);break e;case 11:n=hx(null,n,p,i,c);break e;case 14:n=dx(null,n,p,Hn(p.type,i),c);break e}throw Error(Me(306,p,""))}return n;case 0:return p=n.type,f=n.pendingProps,f=n.elementType===p?f:Hn(p,f),Eg(i,n,p,f,c);case 1:return p=n.type,f=n.pendingProps,f=n.elementType===p?f:Hn(p,f),px(i,n,p,f,c);case 3:e:{if(tw(n),i===null)throw Error(Me(387));p=n.pendingProps,s=n.memoizedState,f=s.element,z2(i,n),tf(n,p,null,c);var E=n.memoizedState;if(p=E.element,s.isDehydrated)if(s={element:p,isDehydrated:!1,cache:E.cache,pendingSuspenseBoundaries:E.pendingSuspenseBoundaries,transitions:E.transitions},n.updateQueue.baseState=s,n.memoizedState=s,n.flags&256){f=Ic(Error(Me(423)),n),n=fx(i,n,p,c,f);break e}else if(p!==f){f=Ic(Error(Me(424)),n),n=fx(i,n,p,c,f);break e}else for(sn=es(n.stateNode.containerInfo.firstChild),ln=n,ai=!0,Wn=null,c=T2(n,null,p,c),n.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(Tc(),p===f){n=ea(i,n,c);break e}Sr(i,n,p,c)}n=n.child}return n;case 5:return I2(n),i===null&&xg(n),p=n.type,f=n.pendingProps,s=i!==null?i.memoizedProps:null,E=f.children,mg(p,f)?E=null:s!==null&&mg(p,s)&&(n.flags|=32),ew(i,n),Sr(i,n,E,c),n.child;case 6:return i===null&&xg(n),null;case 13:return iw(i,n,c);case 4:return l0(n,n.stateNode.containerInfo),p=n.pendingProps,i===null?n.child=Cc(n,null,p,c):Sr(i,n,p,c),n.child;case 11:return p=n.type,f=n.pendingProps,f=n.elementType===p?f:Hn(p,f),hx(i,n,p,f,c);case 7:return Sr(i,n,n.pendingProps,c),n.child;case 8:return Sr(i,n,n.pendingProps.children,c),n.child;case 12:return Sr(i,n,n.pendingProps.children,c),n.child;case 10:e:{if(p=n.type._context,f=n.pendingProps,s=n.memoizedProps,E=f.value,Jt(Qp,p._currentValue),p._currentValue=E,s!==null)if(Jn(s.value,E)){if(s.children===f.children&&!Nr.current){n=ea(i,n,c);break e}}else for(s=n.child,s!==null&&(s.return=n);s!==null;){var A=s.dependencies;if(A!==null){E=s.child;for(var N=A.firstContext;N!==null;){if(N.context===p){if(s.tag===1){N=Ko(-1,c&-c),N.tag=2;var B=s.updateQueue;if(B!==null){B=B.shared;var j=B.pending;j===null?N.next=N:(N.next=j.next,j.next=N),B.pending=N}}s.lanes|=c,N=s.alternate,N!==null&&(N.lanes|=c),wg(s.return,c,n),A.lanes|=c;break}N=N.next}}else if(s.tag===10)E=s.type===n.type?null:s.child;else if(s.tag===18){if(E=s.return,E===null)throw Error(Me(341));E.lanes|=c,A=E.alternate,A!==null&&(A.lanes|=c),wg(E,c,n),E=s.sibling}else E=s.child;if(E!==null)E.return=s;else for(E=s;E!==null;){if(E===n){E=null;break}if(s=E.sibling,s!==null){s.return=E.return,E=s;break}E=E.return}s=E}Sr(i,n,f.children,c),n=n.child}return n;case 9:return f=n.type,p=n.pendingProps.children,bc(n,c),f=Mn(f),p=p(f),n.flags|=1,Sr(i,n,p,c),n.child;case 14:return p=n.type,f=Hn(p,n.pendingProps),f=Hn(p.type,f),dx(i,n,p,f,c);case 15:return Y2(i,n,n.type,n.pendingProps,c);case 17:return p=n.type,f=n.pendingProps,f=n.elementType===p?f:Hn(p,f),Fp(i,n),n.tag=1,jr(p)?(i=!0,Kp(n)):i=!1,bc(n,c),X2(n,p,f),kg(n,p,f,c),Tg(null,n,p,!0,i,c);case 19:return rw(i,n,c);case 22:return Q2(i,n,c)}throw Error(Me(156,n.tag))};function vw(i,n){return Hx(i,n)}function Wk(i,n,c,p){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function In(i,n,c,p){return new Wk(i,n,c,p)}function k0(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Xk(i){if(typeof i=="function")return k0(i)?1:0;if(i!=null){if(i=i.$$typeof,i===Ug)return 11;if(i===qg)return 14}return 2}function ns(i,n){var c=i.alternate;return c===null?(c=In(i.tag,n,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=n,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&14680064,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,n=i.dependencies,c.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c}function Np(i,n,c,p,f,s){var E=2;if(p=i,typeof i=="function")k0(i)&&(E=1);else if(typeof i=="string")E=5;else e:switch(i){case sc:return Js(c.children,f,s,n);case Vg:E=8,f|=8;break;case G1:return i=In(12,c,n,f|2),i.elementType=G1,i.lanes=s,i;case W1:return i=In(13,c,n,f),i.elementType=W1,i.lanes=s,i;case X1:return i=In(19,c,n,f),i.elementType=X1,i.lanes=s,i;case Ix:return wf(c,f,s,n);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Cx:E=10;break e;case zx:E=9;break e;case Ug:E=11;break e;case qg:E=14;break e;case Za:E=16,p=null;break e}throw Error(Me(130,i==null?i:typeof i,""))}return n=In(E,c,n,f),n.elementType=i,n.type=p,n.lanes=s,n}function Js(i,n,c,p){return i=In(7,i,p,n),i.lanes=c,i}function wf(i,n,c,p){return i=In(22,i,p,n),i.elementType=Ix,i.lanes=c,i.stateNode={isHidden:!1},i}function $1(i,n,c){return i=In(6,i,null,n),i.lanes=c,i}function Z1(i,n,c){return n=In(4,i.children!==null?i.children:[],i.key,n),n.lanes=c,n.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},n}function Kk(i,n,c,p,f){this.tag=n,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=z1(0),this.expirationTimes=z1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=z1(0),this.identifierPrefix=p,this.onRecoverableError=f,this.mutableSourceEagerHydrationData=null}function S0(i,n,c,p,f,s,E,A,N){return i=new Kk(i,n,c,A,N),n===1?(n=1,s===!0&&(n|=8)):n=0,s=In(3,null,null,n),i.current=s,s.stateNode=i,s.memoizedState={element:p,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},s0(s),i}function Jk(i,n,c){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ac,key:p==null?null:""+p,children:i,containerInfo:n,implementation:c}}function xw(i){if(!i)return as;i=i._reactInternals;e:{if(nl(i)!==i||i.tag!==1)throw Error(Me(170));var n=i;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(jr(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(Me(171))}if(i.tag===1){var c=i.type;if(jr(c))return x2(i,c,n)}return n}function ww(i,n,c,p,f,s,E,A,N){return i=S0(c,p,!0,i,f,s,E,A,N),i.context=xw(null),c=i.current,p=Er(),f=rs(c),s=Ko(p,f),s.callback=n??null,ts(c,s,f),i.current.lanes=f,Oh(i,f,p),Vr(i,p),i}function bf(i,n,c,p){var f=n.current,s=Er(),E=rs(f);return c=xw(c),n.context===null?n.context=c:n.pendingContext=c,n=Ko(s,E),n.payload={element:i},p=p===void 0?null:p,p!==null&&(n.callback=p),i=ts(f,n,E),i!==null&&(Kn(i,f,E,s),Lp(i,f,E)),E}function uf(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Sx(i,n){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<n?c:n}}function E0(i,n){Sx(i,n),(i=i.alternate)&&Sx(i,n)}function Yk(){return null}var bw=typeof reportError=="function"?reportError:function(i){console.error(i)};function T0(i){this._internalRoot=i}kf.prototype.render=T0.prototype.render=function(i){var n=this._internalRoot;if(n===null)throw Error(Me(409));bf(i,n,null,null)};kf.prototype.unmount=T0.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var n=i.containerInfo;il(function(){bf(null,i,null,null)}),n[Yo]=null}};function kf(i){this._internalRoot=i}kf.prototype.unstable_scheduleHydration=function(i){if(i){var n=Qx();i={blockedOn:null,target:i,priority:n};for(var c=0;c<Ga.length&&n!==0&&n<Ga[c].priority;c++);Ga.splice(c,0,i),c===0&&t2(i)}};function C0(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Sf(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Ex(){}function Qk(i,n,c,p,f){if(f){if(typeof p=="function"){var s=p;p=function(){var B=uf(E);s.call(B)}}var E=ww(n,p,i,0,null,!1,!1,"",Ex);return i._reactRootContainer=E,i[Yo]=E.current,Ih(i.nodeType===8?i.parentNode:i),il(),E}for(;f=i.lastChild;)i.removeChild(f);if(typeof p=="function"){var A=p;p=function(){var B=uf(N);A.call(B)}}var N=S0(i,0,!1,null,null,!1,!1,"",Ex);return i._reactRootContainer=N,i[Yo]=N.current,Ih(i.nodeType===8?i.parentNode:i),il(function(){bf(n,N,c,p)}),N}function Ef(i,n,c,p,f){var s=c._reactRootContainer;if(s){var E=s;if(typeof f=="function"){var A=f;f=function(){var N=uf(E);A.call(N)}}bf(n,E,i,f)}else E=Qk(c,n,i,f,p);return uf(E)}Jx=function(i){switch(i.tag){case 3:var n=i.stateNode;if(n.current.memoizedState.isDehydrated){var c=uh(n.pendingLanes);c!==0&&(Hg(n,c|1),Vr(n,yi()),!(Mt&6)&&(Pc=yi()+500,cs()))}break;case 13:il(function(){var p=Qo(i,1);if(p!==null){var f=Er();Kn(p,i,1,f)}}),E0(i,1)}};Gg=function(i){if(i.tag===13){var n=Qo(i,134217728);if(n!==null){var c=Er();Kn(n,i,134217728,c)}E0(i,134217728)}};Yx=function(i){if(i.tag===13){var n=rs(i),c=Qo(i,n);if(c!==null){var p=Er();Kn(c,i,n,p)}E0(i,n)}};Qx=function(){return Vt};e2=function(i,n){var c=Vt;try{return Vt=i,n()}finally{Vt=c}};og=function(i,n,c){switch(n){case"input":if(Y1(i,c),n=c.name,c.type==="radio"&&n!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<c.length;n++){var p=c[n];if(p!==i&&p.form===i.form){var f=mf(p);if(!f)throw Error(Me(90));Mx(p),Y1(p,f)}}}break;case"textarea":Lx(i,c);break;case"select":n=c.value,n!=null&&_c(i,!!c.multiple,n,!1)}};jx=x0;Vx=il;var e6={usingClientEntryPoint:!1,Events:[jh,hc,mf,Ox,Nx,x0]},ah={findFiberByHostInstance:Gs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},t6={bundleType:ah.bundleType,version:ah.version,rendererPackageName:ah.rendererPackageName,rendererConfig:ah.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ta.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=$x(i),i===null?null:i.stateNode},findFiberByHostInstance:ah.findFiberByHostInstance||Yk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&(sh=__REACT_DEVTOOLS_GLOBAL_HOOK__,!sh.isDisabled&&sh.supportsFiber))try{hf=sh.inject(t6),xo=sh}catch{}var sh;hn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=e6;hn.createPortal=function(i,n){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!C0(n))throw Error(Me(200));return Jk(i,n,null,c)};hn.createRoot=function(i,n){if(!C0(i))throw Error(Me(299));var c=!1,p="",f=bw;return n!=null&&(n.unstable_strictMode===!0&&(c=!0),n.identifierPrefix!==void 0&&(p=n.identifierPrefix),n.onRecoverableError!==void 0&&(f=n.onRecoverableError)),n=S0(i,1,!1,null,null,c,!1,p,f),i[Yo]=n.current,Ih(i.nodeType===8?i.parentNode:i),new T0(n)};hn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var n=i._reactInternals;if(n===void 0)throw typeof i.render=="function"?Error(Me(188)):(i=Object.keys(i).join(","),Error(Me(268,i)));return i=$x(n),i=i===null?null:i.stateNode,i};hn.flushSync=function(i){return il(i)};hn.hydrate=function(i,n,c){if(!Sf(n))throw Error(Me(200));return Ef(null,i,n,!0,c)};hn.hydrateRoot=function(i,n,c){if(!C0(i))throw Error(Me(405));var p=c!=null&&c.hydratedSources||null,f=!1,s="",E=bw;if(c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(s=c.identifierPrefix),c.onRecoverableError!==void 0&&(E=c.onRecoverableError)),n=ww(n,null,i,1,c??null,f,!1,s,E),i[Yo]=n.current,Ih(i),p)for(i=0;i<p.length;i++)c=p[i],f=c._getVersion,f=f(c._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[c,f]:n.mutableSourceEagerHydrationData.push(c,f);return new kf(n)};hn.render=function(i,n,c){if(!Sf(n))throw Error(Me(200));return Ef(null,i,n,!1,c)};hn.unmountComponentAtNode=function(i){if(!Sf(i))throw Error(Me(40));return i._reactRootContainer?(il(function(){Ef(null,null,i,!1,function(){i._reactRootContainer=null,i[Yo]=null})}),!0):!1};hn.unstable_batchedUpdates=x0;hn.unstable_renderSubtreeIntoContainer=function(i,n,c,p){if(!Sf(c))throw Error(Me(200));if(i==null||i._reactInternals===void 0)throw Error(Me(38));return Ef(i,n,c,!1,p)};hn.version="18.3.1-next-f1338f8080-20240426"});var Uh=Ua((rE,Ew)=>{"use strict";function Sw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Sw)}catch(i){console.error(i)}}Sw(),Ew.exports=kw()});var Cw=Ua(z0=>{"use strict";var Tw=Uh();z0.createRoot=Tw.createRoot,z0.hydrateRoot=Tw.hydrateRoot;var nE});var Ib=Ua((uy,hy)=>{(function(i,n){typeof uy=="object"&&typeof hy<"u"?hy.exports=n():typeof define=="function"&&define.amd?define(n):(i=typeof globalThis<"u"?globalThis:i||self,i.maplibregl=n())})(uy,function(){"use strict";var i={},n={};function c(f,s,E){if(n[f]=E,f==="index"){var A="var sharedModule = {}; ("+n.shared+")(sharedModule); ("+n.worker+")(sharedModule);",N={};return n.shared(N),n.index(i,N),typeof window<"u"&&i.setWorkerUrl(window.URL.createObjectURL(new Blob([A],{type:"text/javascript"}))),i}}c("shared",["exports"],function(f){"use strict";function s(r,t,o,l){return new(o||(o=Promise))(function(d,y){function _(S){try{w(l.next(S))}catch(T){y(T)}}function v(S){try{w(l.throw(S))}catch(T){y(T)}}function w(S){var T;S.done?d(S.value):(T=S.value,T instanceof o?T:new o(function(z){z(T)})).then(_,v)}w((l=l.apply(r,t||[])).next())})}function E(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}typeof SuppressedError=="function"&&SuppressedError;var A=N;function N(r,t){this.x=r,this.y=t}N.prototype={clone:function(){return new N(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,t){return this.clone()._rotateAround(r,t)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var t=r.x-this.x,o=r.y-this.y;return t*t+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,t){return Math.atan2(this.x*t-this.y*r,this.x*r+this.y*t)},_matMult:function(r){var t=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=t,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var t=Math.cos(r),o=Math.sin(r),l=o*this.x+t*this.y;return this.x=t*this.x-o*this.y,this.y=l,this},_rotateAround:function(r,t){var o=Math.cos(r),l=Math.sin(r),d=t.y+l*(this.x-t.x)+o*(this.y-t.y);return this.x=t.x+o*(this.x-t.x)-l*(this.y-t.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},N.convert=function(r){return r instanceof N?r:Array.isArray(r)?new N(r[0],r[1]):r};var B=E(A),j=de;function de(r,t,o,l){this.cx=3*r,this.bx=3*(o-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=o,this.p2y=l}de.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var o=r,l=0;l<8;l++){var d=this.sampleCurveX(o)-r;if(Math.abs(d)<t)return o;var y=this.sampleCurveDerivativeX(o);if(Math.abs(y)<1e-6)break;o-=d/y}var _=0,v=1;for(o=r,l=0;l<20&&(d=this.sampleCurveX(o),!(Math.abs(d-r)<t));l++)r>d?_=o:v=o,o=.5*(v-_)+_;return o},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var ge=E(j);let Te,xe;function Se(){return Te==null&&(Te=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),Te}function Ae(){if(xe==null&&(xe=!1,Se())){let t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let l=0;l<5*5;l++){let d=4*l;t.fillStyle=`rgb(${d},${d+1},${d+2})`,t.fillRect(l%5,Math.floor(l/5),1,1)}let o=t.getImageData(0,0,5,5).data;for(let l=0;l<5*5*4;l++)if(l%4!=3&&o[l]!==l){xe=!0;break}}}return xe||!1}function ne(r,t,o,l){let d=new ge(r,t,o,l);return y=>d.solve(y)}let ee=ne(.25,.1,.25,1);function ae(r,t,o){return Math.min(o,Math.max(t,r))}function be(r,t,o){let l=o-t,d=((r-t)%l+l)%l+t;return d===t?o:d}function Ie(r,...t){for(let o of t)for(let l in o)r[l]=o[l];return r}let Ye=1;function Ge(r,t,o){let l={};for(let d in r)l[d]=t.call(this,r[d],d,r);return l}function rt(r,t,o){let l={};for(let d in r)t.call(this,r[d],d,r)&&(l[d]=r[d]);return l}function ct(r){return Array.isArray(r)?r.map(ct):typeof r=="object"&&r?Ge(r,ct):r}let bt={};function Wt(r){bt[r]||(typeof console<"u"&&console.warn(r),bt[r]=!0)}function Ei(r,t,o){return(o.y-r.y)*(t.x-r.x)>(t.y-r.y)*(o.x-r.x)}function Dn(r){return typeof WorkerGlobalScope<"u"&&r!==void 0&&r instanceof WorkerGlobalScope}let ra=null;function fn(r){return typeof ImageBitmap<"u"&&r instanceof ImageBitmap}let ll="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Eo(r,t,o,l,d){return s(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let y=new VideoFrame(r,{timestamp:0});try{let _=y?.format;if(!_||!_.startsWith("BGR")&&!_.startsWith("RGB"))throw new Error(`Unrecognized format ${_}`);let v=_.startsWith("BGR"),w=new Uint8ClampedArray(l*d*4);if(yield y.copyTo(w,function(S,T,z,M,R){let O=4*Math.max(-T,0),V=(Math.max(0,z)-z)*M*4+O,H=4*M,K=Math.max(0,T),he=Math.max(0,z);return{rect:{x:K,y:he,width:Math.min(S.width,T+M)-K,height:Math.min(S.height,z+R)-he},layout:[{offset:V,stride:H}]}}(r,t,o,l,d)),v)for(let S=0;S<w.length;S+=4){let T=w[S];w[S]=w[S+2],w[S+2]=T}return w}finally{y.close()}})}let Rn,Ji,$r="AbortError";function na(){return new Error($r)}let to={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function mn(r){return to.REGISTERED_PROTOCOLS[r.substring(0,r.indexOf("://"))]}let oa="global-dispatcher";class fr extends Error{constructor(t,o,l,d){super(`AJAXError: ${o} (${t}): ${l}`),this.status=t,this.statusText=o,this.url=l,this.body=d}}let Zr=()=>Dn(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,To=function(r,t){if(/:\/\//.test(r.url)&&!/^https?:|^file:/.test(r.url)){let l=mn(r.url);if(l)return l(r,t);if(Dn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,targetMapId:oa},t)}if(!(/^file:/.test(o=r.url)||/^file:/.test(Zr())&&!/^\w+:/.test(o))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(l,d){return s(this,void 0,void 0,function*(){let y=new Request(l.url,{method:l.method||"GET",body:l.body,credentials:l.credentials,headers:l.headers,cache:l.cache,referrer:Zr(),signal:d.signal});l.type!=="json"||y.headers.has("Accept")||y.headers.set("Accept","application/json");let _=yield fetch(y);if(!_.ok){let S=yield _.blob();throw new fr(_.status,_.statusText,l.url,S)}let v;v=l.type==="arrayBuffer"||l.type==="image"?_.arrayBuffer():l.type==="json"?_.json():_.text();let w=yield v;if(d.signal.aborted)throw na();return{data:w,cacheControl:_.headers.get("Cache-Control"),expires:_.headers.get("Expires")}})}(r,t);if(Dn(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:r,mustQueue:!0,targetMapId:oa},t)}var o;return function(l,d){return new Promise((y,_)=>{var v;let w=new XMLHttpRequest;w.open(l.method||"GET",l.url,!0),l.type!=="arrayBuffer"&&l.type!=="image"||(w.responseType="arraybuffer");for(let S in l.headers)w.setRequestHeader(S,l.headers[S]);l.type==="json"&&(w.responseType="text",!((v=l.headers)===null||v===void 0)&&v.Accept||w.setRequestHeader("Accept","application/json")),w.withCredentials=l.credentials==="include",w.onerror=()=>{_(new Error(w.statusText))},w.onload=()=>{if(!d.signal.aborted)if((w.status>=200&&w.status<300||w.status===0)&&w.response!==null){let S=w.response;if(l.type==="json")try{S=JSON.parse(w.response)}catch(T){return void _(T)}y({data:S,cacheControl:w.getResponseHeader("Cache-Control"),expires:w.getResponseHeader("Expires")})}else{let S=new Blob([w.response],{type:w.getResponseHeader("Content-Type")});_(new fr(w.status,w.statusText,l.url,S))}},d.signal.addEventListener("abort",()=>{w.abort(),_(na())}),w.send(l.body)})}(r,t)};function Co(r){if(!r||r.indexOf("://")<=0||r.indexOf("data:image/")===0||r.indexOf("blob:")===0)return!0;let t=new URL(r),o=window.location;return t.protocol===o.protocol&&t.host===o.host}function ps(r,t,o){o[r]&&o[r].indexOf(t)!==-1||(o[r]=o[r]||[],o[r].push(t))}function Fn(r,t,o){if(o&&o[r]){let l=o[r].indexOf(t);l!==-1&&o[r].splice(l,1)}}class io{constructor(t,o={}){Ie(this,o),this.type=t}}class ro extends io{constructor(t,o={}){super("error",Ie({error:t},o))}}class aa{on(t,o){return this._listeners=this._listeners||{},ps(t,o,this._listeners),this}off(t,o){return Fn(t,o,this._listeners),Fn(t,o,this._oneTimeListeners),this}once(t,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},ps(t,o,this._oneTimeListeners),this):new Promise(l=>this.once(t,l))}fire(t,o){typeof t=="string"&&(t=new io(t,o||{}));let l=t.type;if(this.listens(l)){t.target=this;let d=this._listeners&&this._listeners[l]?this._listeners[l].slice():[];for(let v of d)v.call(this,t);let y=this._oneTimeListeners&&this._oneTimeListeners[l]?this._oneTimeListeners[l].slice():[];for(let v of y)Fn(l,v,this._oneTimeListeners),v.call(this,t);let _=this._eventedParent;_&&(Ie(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),_.fire(t))}else t instanceof ro&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,o){return this._eventedParent=t,this._eventedParentData=o,this}}var ye={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};let zo=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function fs(r,t){let o={};for(let l in r)l!=="ref"&&(o[l]=r[l]);return zo.forEach(l=>{l in t&&(o[l]=t[l])}),o}function zt(r,t){if(Array.isArray(r)){if(!Array.isArray(t)||r.length!==t.length)return!1;for(let o=0;o<r.length;o++)if(!zt(r[o],t[o]))return!1;return!0}if(typeof r=="object"&&r!==null&&t!==null){if(typeof t!="object"||Object.keys(r).length!==Object.keys(t).length)return!1;for(let o in r)if(!zt(r[o],t[o]))return!1;return!0}return r===t}function Yt(r,t){r.push(t)}function ms(r,t,o){Yt(o,{command:"addSource",args:[r,t[r]]})}function no(r,t,o){Yt(t,{command:"removeSource",args:[r]}),o[r]=!0}function Bn(r,t,o,l){no(r,o,l),ms(r,t,o)}function sa(r,t,o){let l;for(l in r[o])if(Object.prototype.hasOwnProperty.call(r[o],l)&&l!=="data"&&!zt(r[o][l],t[o][l]))return!1;for(l in t[o])if(Object.prototype.hasOwnProperty.call(t[o],l)&&l!=="data"&&!zt(r[o][l],t[o][l]))return!1;return!0}function zr(r,t,o,l,d,y){r=r||{},t=t||{};for(let _ in r)Object.prototype.hasOwnProperty.call(r,_)&&(zt(r[_],t[_])||o.push({command:y,args:[l,_,t[_],d]}));for(let _ in t)Object.prototype.hasOwnProperty.call(t,_)&&!Object.prototype.hasOwnProperty.call(r,_)&&(zt(r[_],t[_])||o.push({command:y,args:[l,_,t[_],d]}))}function gs(r){return r.id}function ys(r,t){return r[t.id]=t,r}class Pe{constructor(t,o,l,d){this.message=(t?`${t}: `:"")+l,d&&(this.identifier=d),o!=null&&o.__line__&&(this.line=o.__line__)}}function gn(r,...t){for(let o of t)for(let l in o)r[l]=o[l];return r}class Ui extends Error{constructor(t,o){super(o),this.message=o,this.key=t}}class yn{constructor(t,o=[]){this.parent=t,this.bindings={};for(let[l,d]of o)this.bindings[l]=d}concat(t){return new yn(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}let oo={kind:"null"},Fe={kind:"number"},mt={kind:"string"},at={kind:"boolean"},Yi={kind:"color"},Hr={kind:"object"},ht={kind:"value"},_n={kind:"collator"},On={kind:"formatted"},ao={kind:"padding"},vn={kind:"resolvedImage"},X={kind:"variableAnchorOffsetCollection"};function D(r,t){return{kind:"array",itemType:r,N:t}}function L(r){if(r.kind==="array"){let t=L(r.itemType);return typeof r.N=="number"?`array<${t}, ${r.N}>`:r.itemType.kind==="value"?"array":`array<${t}>`}return r.kind}let q=[oo,Fe,mt,at,Yi,On,Hr,D(ht),ao,vn,X];function G(r,t){if(t.kind==="error")return null;if(r.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!G(r.itemType,t.itemType))&&(typeof r.N!="number"||r.N===t.N))return null}else{if(r.kind===t.kind)return null;if(r.kind==="value"){for(let o of q)if(!G(o,t))return null}}return`Expected ${L(r)} but found ${L(t)} instead.`}function re(r,t){return t.some(o=>o.kind===r.kind)}function se(r,t){return t.some(o=>o==="null"?r===null:o==="array"?Array.isArray(r):o==="object"?r&&!Array.isArray(r)&&typeof r=="object":o===typeof r)}function ue(r,t){return r.kind==="array"&&t.kind==="array"?r.itemType.kind===t.itemType.kind&&typeof r.N=="number":r.kind===t.kind}let Q=.96422,ve=.82521,Ee=4/29,me=6/29,Le=3*me*me,et=me*me*me,it=Math.PI/180,kt=180/Math.PI;function dt(r){return(r%=360)<0&&(r+=360),r}function St([r,t,o,l]){let d,y,_=di((.2225045*(r=_t(r))+.7168786*(t=_t(t))+.0606169*(o=_t(o)))/1);r===t&&t===o?d=y=_:(d=di((.4360747*r+.3850649*t+.1430804*o)/Q),y=di((.0139322*r+.0971045*t+.7141733*o)/ve));let v=116*_-16;return[v<0?0:v,500*(d-_),200*(_-y),l]}function _t(r){return r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function di(r){return r>et?Math.pow(r,1/3):r/Le+Ee}function Qt([r,t,o,l]){let d=(r+16)/116,y=isNaN(t)?d:d+t/500,_=isNaN(o)?d:d-o/200;return d=1*At(d),y=Q*At(y),_=ve*At(_),[gt(3.1338561*y-1.6168667*d-.4906146*_),gt(-.9787684*y+1.9161415*d+.033454*_),gt(.0719453*y-.2289914*d+1.4052427*_),l]}function gt(r){return(r=r<=.00304?12.92*r:1.055*Math.pow(r,1/2.4)-.055)<0?0:r>1?1:r}function At(r){return r>me?r*r*r:Le*(r-Ee)}function Xt(r){return parseInt(r.padEnd(2,r),16)/255}function vi(r,t){return Ti(t?r/100:r,0,1)}function Ti(r,t,o){return Math.min(Math.max(t,r),o)}function qi(r){return!r.some(Number.isNaN)}let la={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Lt{constructor(t,o,l,d=1,y=!0){this.r=t,this.g=o,this.b=l,this.a=d,y||(this.r*=d,this.g*=d,this.b*=d,d||this.overwriteGetter("rgb",[t,o,l,d]))}static parse(t){if(t instanceof Lt)return t;if(typeof t!="string")return;let o=function(l){if((l=l.toLowerCase().trim())==="transparent")return[0,0,0,0];let d=la[l];if(d){let[_,v,w]=d;return[_/255,v/255,w/255,1]}if(l.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(l)){let _=l.length<6?1:2,v=1;return[Xt(l.slice(v,v+=_)),Xt(l.slice(v,v+=_)),Xt(l.slice(v,v+=_)),Xt(l.slice(v,v+_)||"ff")]}if(l.startsWith("rgb")){let _=l.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(_){let[v,w,S,T,z,M,R,O,V,H,K,he]=_,ie=[T||" ",R||" ",H].join("");if(ie==="  "||ie==="  /"||ie===",,"||ie===",,,"){let ce=[S,M,V].join(""),_e=ce==="%%%"?100:ce===""?255:0;if(_e){let Ce=[Ti(+w/_e,0,1),Ti(+z/_e,0,1),Ti(+O/_e,0,1),K?vi(+K,he):1];if(qi(Ce))return Ce}}return}}let y=l.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){let[_,v,w,S,T,z,M,R,O]=y,V=[w||" ",T||" ",M].join("");if(V==="  "||V==="  /"||V===",,"||V===",,,"){let H=[+v,Ti(+S,0,100),Ti(+z,0,100),R?vi(+R,O):1];if(qi(H))return function([K,he,ie,ce]){function _e(Ce){let Ue=(Ce+K/30)%12,nt=he*Math.min(ie,1-ie);return ie-nt*Math.max(-1,Math.min(Ue-3,9-Ue,1))}return K=dt(K),he/=100,ie/=100,[_e(0),_e(8),_e(4),ce]}(H)}}}(t);return o?new Lt(...o,!1):void 0}get rgb(){let{r:t,g:o,b:l,a:d}=this,y=d||1/0;return this.overwriteGetter("rgb",[t/y,o/y,l/y,d])}get hcl(){return this.overwriteGetter("hcl",function(t){let[o,l,d,y]=St(t),_=Math.sqrt(l*l+d*d);return[Math.round(1e4*_)?dt(Math.atan2(d,l)*kt):NaN,_,o,y]}(this.rgb))}get lab(){return this.overwriteGetter("lab",St(this.rgb))}overwriteGetter(t,o){return Object.defineProperty(this,t,{value:o}),o}toString(){let[t,o,l,d]=this.rgb;return`rgba(${[t,o,l].map(y=>Math.round(255*y)).join(",")},${d})`}}Lt.black=new Lt(0,0,0,1),Lt.white=new Lt(1,1,1,1),Lt.transparent=new Lt(0,0,0,0),Lt.red=new Lt(1,0,0,1);class Uc{constructor(t,o,l){this.sensitivity=t?o?"variant":"case":o?"accent":"base",this.locale=l,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,o){return this.collator.compare(t,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class qc{constructor(t,o,l,d,y){this.text=t,this.image=o,this.scale=l,this.fontStack=d,this.textColor=y}}class mr{constructor(t){this.sections=t}static fromString(t){return new mr([new qc(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof mr?t:mr.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class gr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof gr)return t;if(typeof t=="number")return new gr([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(let o of t)if(typeof o!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new gr(t)}}toString(){return JSON.stringify(this.values)}}let Wf=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Ir{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof Ir)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let o=0;o<t.length;o+=2){let l=t[o],d=t[o+1];if(typeof l!="string"||!Wf.has(l)||!Array.isArray(d)||d.length!==2||typeof d[0]!="number"||typeof d[1]!="number")return}return new Ir(t)}}toString(){return JSON.stringify(this.values)}}class yr{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new yr({name:t,available:!1}):null}}function ca(r,t,o,l){return typeof r=="number"&&r>=0&&r<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof o=="number"&&o>=0&&o<=255?l===void 0||typeof l=="number"&&l>=0&&l<=1?null:`Invalid rgba value [${[r,t,o,l].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof l=="number"?[r,t,o,l]:[r,t,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Io(r){if(r===null||typeof r=="string"||typeof r=="boolean"||typeof r=="number"||r instanceof Lt||r instanceof Uc||r instanceof mr||r instanceof gr||r instanceof Ir||r instanceof yr)return!0;if(Array.isArray(r)){for(let t of r)if(!Io(t))return!1;return!0}if(typeof r=="object"){for(let t in r)if(!Io(r[t]))return!1;return!0}return!1}function pi(r){if(r===null)return oo;if(typeof r=="string")return mt;if(typeof r=="boolean")return at;if(typeof r=="number")return Fe;if(r instanceof Lt)return Yi;if(r instanceof Uc)return _n;if(r instanceof mr)return On;if(r instanceof gr)return ao;if(r instanceof Ir)return X;if(r instanceof yr)return vn;if(Array.isArray(r)){let t=r.length,o;for(let l of r){let d=pi(l);if(o){if(o===d)continue;o=ht;break}o=d}return D(o||ht,t)}return Hr}function _s(r){let t=typeof r;return r===null?"":t==="string"||t==="number"||t==="boolean"?String(r):r instanceof Lt||r instanceof mr||r instanceof gr||r instanceof Ir||r instanceof yr?r.toString():JSON.stringify(r)}class Gr{constructor(t,o){this.type=t,this.value=o}static parse(t,o){if(t.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Io(t[1]))return o.error("invalid value");let l=t[1],d=pi(l),y=o.expectedType;return d.kind!=="array"||d.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(d=y),new Gr(d,l)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class si{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}let cl={string:mt,number:Fe,boolean:at,object:Hr};class Wr{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");let l,d=1,y=t[0];if(y==="array"){let v,w;if(t.length>2){let S=t[1];if(typeof S!="string"||!(S in cl)||S==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);v=cl[S],d++}else v=ht;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return o.error('The length argument to "array" must be a positive integer literal',2);w=t[2],d++}l=D(v,w)}else{if(!cl[y])throw new Error(`Types doesn't contain name = ${y}`);l=cl[y]}let _=[];for(;d<t.length;d++){let v=o.parse(t[d],d,ht);if(!v)return null;_.push(v)}return new Wr(l,_)}evaluate(t){for(let o=0;o<this.args.length;o++){let l=this.args[o].evaluate(t);if(!G(this.type,pi(l)))return l;if(o===this.args.length-1)throw new si(`Expected value to be of type ${L(this.type)}, but found ${L(pi(l))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}let $c={"to-boolean":at,"to-color":Yi,"to-number":Fe,"to-string":mt};class Xr{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");let l=t[0];if(!$c[l])throw new Error(`Can't parse ${l} as it is not part of the known types`);if((l==="to-boolean"||l==="to-string")&&t.length!==2)return o.error("Expected one argument.");let d=$c[l],y=[];for(let _=1;_<t.length;_++){let v=o.parse(t[_],_,ht);if(!v)return null;y.push(v)}return new Xr(d,y)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let o,l;for(let d of this.args){if(o=d.evaluate(t),l=null,o instanceof Lt)return o;if(typeof o=="string"){let y=t.parseColor(o);if(y)return y}else if(Array.isArray(o)&&(l=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:ca(o[0],o[1],o[2],o[3]),!l))return new Lt(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new si(l||`Could not parse color from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"padding":{let o;for(let l of this.args){o=l.evaluate(t);let d=gr.parse(o);if(d)return d}throw new si(`Could not parse padding from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"variableAnchorOffsetCollection":{let o;for(let l of this.args){o=l.evaluate(t);let d=Ir.parse(o);if(d)return d}throw new si(`Could not parse variableAnchorOffsetCollection from value '${typeof o=="string"?o:JSON.stringify(o)}'`)}case"number":{let o=null;for(let l of this.args){if(o=l.evaluate(t),o===null)return 0;let d=Number(o);if(!isNaN(d))return d}throw new si(`Could not convert ${JSON.stringify(o)} to number.`)}case"formatted":return mr.fromString(_s(this.args[0].evaluate(t)));case"resolvedImage":return yr.fromString(_s(this.args[0].evaluate(t)));default:return _s(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}let Xf=["Unknown","Point","LineString","Polygon"];class ul{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Xf[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let o=this._parseColorCache[t];return o||(o=this._parseColorCache[t]=Lt.parse(t)),o}}class Po{constructor(t,o,l=[],d,y=new yn,_=[]){this.registry=t,this.path=l,this.key=l.map(v=>`[${v}]`).join(""),this.scope=y,this.errors=_,this.expectedType=d,this._isConstant=o}parse(t,o,l,d,y={}){return o?this.concat(o,l,d)._parse(t,y):this._parse(t,y)}_parse(t,o){function l(d,y,_){return _==="assert"?new Wr(y,[d]):_==="coerce"?new Xr(y,[d]):d}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let d=t[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let y=this.registry[d];if(y){let _=y.parse(t,this);if(!_)return null;if(this.expectedType){let v=this.expectedType,w=_.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||w.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||w.kind!=="value"&&w.kind!=="string")if(v.kind!=="padding"||w.kind!=="value"&&w.kind!=="number"&&w.kind!=="array")if(v.kind!=="variableAnchorOffsetCollection"||w.kind!=="value"&&w.kind!=="array"){if(this.checkSubtype(v,w))return null}else _=l(_,v,o.typeAnnotation||"coerce");else _=l(_,v,o.typeAnnotation||"coerce");else _=l(_,v,o.typeAnnotation||"coerce");else _=l(_,v,o.typeAnnotation||"assert")}if(!(_ instanceof Gr)&&_.type.kind!=="resolvedImage"&&this._isConstant(_)){let v=new ul;try{_=new Gr(_.type,_.evaluate(v))}catch(w){return this.error(w.message),null}}return _}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,o,l){let d=typeof t=="number"?this.path.concat(t):this.path,y=l?this.scope.concat(l):this.scope;return new Po(this.registry,this._isConstant,d,o||null,y,this.errors)}error(t,...o){let l=`${this.key}${o.map(d=>`[${d}]`).join("")}`;this.errors.push(new Ui(l,t))}checkSubtype(t,o){let l=G(t,o);return l&&this.error(l),l}}class so{constructor(t,o){this.type=o.type,this.bindings=[].concat(t),this.result=o}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(let o of this.bindings)t(o[1]);t(this.result)}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);let l=[];for(let y=1;y<t.length-1;y+=2){let _=t[y];if(typeof _!="string")return o.error(`Expected string, but found ${typeof _} instead.`,y);if(/[^a-zA-Z0-9_]/.test(_))return o.error("Variable names must contain only alphanumeric characters or '_'.",y);let v=o.parse(t[y+1],y+1);if(!v)return null;l.push([_,v])}let d=o.parse(t[t.length-1],t.length-1,o.expectedType,l);return d?new so(l,d):null}outputDefined(){return this.result.outputDefined()}}class It{constructor(t,o){this.type=o.type,this.name=t,this.boundExpression=o}static parse(t,o){if(t.length!==2||typeof t[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");let l=t[1];return o.scope.has(l)?new It(l,o.scope.get(l)):o.error(`Unknown variable "${l}". Make sure "${l}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class Zc{constructor(t,o,l){this.type=t,this.index=o,this.input=l}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);let l=o.parse(t[1],1,Fe),d=o.parse(t[2],2,D(o.expectedType||ht));return l&&d?new Zc(d.type.itemType,l,d):null}evaluate(t){let o=this.index.evaluate(t),l=this.input.evaluate(t);if(o<0)throw new si(`Array index out of bounds: ${o} < 0.`);if(o>=l.length)throw new si(`Array index out of bounds: ${o} > ${l.length-1}.`);if(o!==Math.floor(o))throw new si(`Array index must be an integer, but found ${o} instead.`);return l[o]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Hc{constructor(t,o){this.type=at,this.needle=t,this.haystack=o}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);let l=o.parse(t[1],1,ht),d=o.parse(t[2],2,ht);return l&&d?re(l.type,[at,mt,Fe,oo,ht])?new Hc(l,d):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${L(l.type)} instead`):null}evaluate(t){let o=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!l)return!1;if(!se(o,["boolean","string","number","null"]))throw new si(`Expected first argument to be of type boolean, string, number or null, but found ${L(pi(o))} instead.`);if(!se(l,["string","array"]))throw new si(`Expected second argument to be of type array or string, but found ${L(pi(l))} instead.`);return l.indexOf(o)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class ua{constructor(t,o,l){this.type=Fe,this.needle=t,this.haystack=o,this.fromIndex=l}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);let l=o.parse(t[1],1,ht),d=o.parse(t[2],2,ht);if(!l||!d)return null;if(!re(l.type,[at,mt,Fe,oo,ht]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${L(l.type)} instead`);if(t.length===4){let y=o.parse(t[3],3,Fe);return y?new ua(l,d,y):null}return new ua(l,d)}evaluate(t){let o=this.needle.evaluate(t),l=this.haystack.evaluate(t);if(!se(o,["boolean","string","number","null"]))throw new si(`Expected first argument to be of type boolean, string, number or null, but found ${L(pi(o))} instead.`);let d;if(this.fromIndex&&(d=this.fromIndex.evaluate(t)),se(l,["string"])){let y=l.indexOf(o,d);return y===-1?-1:[...l.slice(0,y)].length}if(se(l,["array"]))return l.indexOf(o,d);throw new si(`Expected second argument to be of type array or string, but found ${L(pi(l))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Gc{constructor(t,o,l,d,y,_){this.inputType=t,this.type=o,this.input=l,this.cases=d,this.outputs=y,this.otherwise=_}static parse(t,o){if(t.length<5)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return o.error("Expected an even number of arguments.");let l,d;o.expectedType&&o.expectedType.kind!=="value"&&(d=o.expectedType);let y={},_=[];for(let S=2;S<t.length-1;S+=2){let T=t[S],z=t[S+1];Array.isArray(T)||(T=[T]);let M=o.concat(S);if(T.length===0)return M.error("Expected at least one branch label.");for(let O of T){if(typeof O!="number"&&typeof O!="string")return M.error("Branch labels must be numbers or strings.");if(typeof O=="number"&&Math.abs(O)>Number.MAX_SAFE_INTEGER)return M.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof O=="number"&&Math.floor(O)!==O)return M.error("Numeric branch labels must be integer values.");if(l){if(M.checkSubtype(l,pi(O)))return null}else l=pi(O);if(y[String(O)]!==void 0)return M.error("Branch labels must be unique.");y[String(O)]=_.length}let R=o.parse(z,S,d);if(!R)return null;d=d||R.type,_.push(R)}let v=o.parse(t[1],1,ht);if(!v)return null;let w=o.parse(t[t.length-1],t.length-1,d);return w?v.type.kind!=="value"&&o.concat(1).checkSubtype(l,v.type)?null:new Gc(l,d,v,y,_,w):null}evaluate(t){let o=this.input.evaluate(t);return(pi(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class hl{constructor(t,o,l){this.type=t,this.branches=o,this.otherwise=l}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return o.error("Expected an odd number of arguments.");let l;o.expectedType&&o.expectedType.kind!=="value"&&(l=o.expectedType);let d=[];for(let _=1;_<t.length-1;_+=2){let v=o.parse(t[_],_,at);if(!v)return null;let w=o.parse(t[_+1],_+1,l);if(!w)return null;d.push([v,w]),l=l||w.type}let y=o.parse(t[t.length-1],t.length-1,l);if(!y)return null;if(!l)throw new Error("Can't infer output type");return new hl(l,d,y)}evaluate(t){for(let[o,l]of this.branches)if(o.evaluate(t))return l.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(let[o,l]of this.branches)t(o),t(l);t(this.otherwise)}outputDefined(){return this.branches.every(([t,o])=>o.outputDefined())&&this.otherwise.outputDefined()}}class vs{constructor(t,o,l,d){this.type=t,this.input=o,this.beginIndex=l,this.endIndex=d}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);let l=o.parse(t[1],1,ht),d=o.parse(t[2],2,Fe);if(!l||!d)return null;if(!re(l.type,[D(ht),mt,ht]))return o.error(`Expected first argument to be of type array or string, but found ${L(l.type)} instead`);if(t.length===4){let y=o.parse(t[3],3,Fe);return y?new vs(l.type,l,d,y):null}return new vs(l.type,l,d)}evaluate(t){let o=this.input.evaluate(t),l=this.beginIndex.evaluate(t),d;if(this.endIndex&&(d=this.endIndex.evaluate(t)),se(o,["string"]))return[...o].slice(l,d).join("");if(se(o,["array"]))return o.slice(l,d);throw new si(`Expected first argument to be of type array or string, but found ${L(pi(o))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function dl(r,t){let o=r.length-1,l,d,y=0,_=o,v=0;for(;y<=_;)if(v=Math.floor((y+_)/2),l=r[v],d=r[v+1],l<=t){if(v===o||t<d)return v;y=v+1}else{if(!(l>t))throw new si("Input is not a number.");_=v-1}return 0}class ha{constructor(t,o,l){this.type=t,this.input=o,this.labels=[],this.outputs=[];for(let[d,y]of l)this.labels.push(d),this.outputs.push(y)}static parse(t,o){if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");let l=o.parse(t[1],1,Fe);if(!l)return null;let d=[],y=null;o.expectedType&&o.expectedType.kind!=="value"&&(y=o.expectedType);for(let _=1;_<t.length;_+=2){let v=_===1?-1/0:t[_],w=t[_+1],S=_,T=_+1;if(typeof v!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',S);if(d.length&&d[d.length-1][0]>=v)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',S);let z=o.parse(w,T,y);if(!z)return null;y=y||z.type,d.push([v,z])}return new ha(y,l,d)}evaluate(t){let o=this.labels,l=this.outputs;if(o.length===1)return l[0].evaluate(t);let d=this.input.evaluate(t);if(d<=o[0])return l[0].evaluate(t);let y=o.length;return d>=o[y-1]?l[y-1].evaluate(t):l[dl(o,d)].evaluate(t)}eachChild(t){t(this.input);for(let o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function td(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Kf=id;function id(r,t,o,l){this.cx=3*r,this.bx=3*(o-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(l-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=t,this.p2x=o,this.p2y=l}id.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,t){if(t===void 0&&(t=1e-6),r<0)return 0;if(r>1)return 1;for(var o=r,l=0;l<8;l++){var d=this.sampleCurveX(o)-r;if(Math.abs(d)<t)return o;var y=this.sampleCurveDerivativeX(o);if(Math.abs(y)<1e-6)break;o-=d/y}var _=0,v=1;for(o=r,l=0;l<20&&(d=this.sampleCurveX(o),!(Math.abs(d-r)<t));l++)r>d?_=o:v=o,o=.5*(v-_)+_;return o},solve:function(r,t){return this.sampleCurveY(this.solveCurveX(r,t))}};var Jf=td(Kf);function Mo(r,t,o){return r+o*(t-r)}function xs(r,t,o){return r.map((l,d)=>Mo(l,t[d],o))}let Qi={number:Mo,color:function(r,t,o,l="rgb"){switch(l){case"rgb":{let[d,y,_,v]=xs(r.rgb,t.rgb,o);return new Lt(d,y,_,v,!1)}case"hcl":{let[d,y,_,v]=r.hcl,[w,S,T,z]=t.hcl,M,R;if(isNaN(d)||isNaN(w))isNaN(d)?isNaN(w)?M=NaN:(M=w,_!==1&&_!==0||(R=S)):(M=d,T!==1&&T!==0||(R=y));else{let he=w-d;w>d&&he>180?he-=360:w<d&&d-w>180&&(he+=360),M=d+o*he}let[O,V,H,K]=function([he,ie,ce,_e]){return he=isNaN(he)?0:he*it,Qt([ce,Math.cos(he)*ie,Math.sin(he)*ie,_e])}([M,R??Mo(y,S,o),Mo(_,T,o),Mo(v,z,o)]);return new Lt(O,V,H,K,!1)}case"lab":{let[d,y,_,v]=Qt(xs(r.lab,t.lab,o));return new Lt(d,y,_,v,!1)}}},array:xs,padding:function(r,t,o){return new gr(xs(r.values,t.values,o))},variableAnchorOffsetCollection:function(r,t,o){let l=r.values,d=t.values;if(l.length!==d.length)throw new si(`Cannot interpolate values of different length. from: ${r.toString()}, to: ${t.toString()}`);let y=[];for(let _=0;_<l.length;_+=2){if(l[_]!==d[_])throw new si(`Cannot interpolate values containing mismatched anchors. from[${_}]: ${l[_]}, to[${_}]: ${d[_]}`);y.push(l[_]);let[v,w]=l[_+1],[S,T]=d[_+1];y.push([Mo(v,S,o),Mo(w,T,o)])}return new Ir(y)}};class er{constructor(t,o,l,d,y){this.type=t,this.operator=o,this.interpolation=l,this.input=d,this.labels=[],this.outputs=[];for(let[_,v]of y)this.labels.push(_),this.outputs.push(v)}static interpolationFactor(t,o,l,d){let y=0;if(t.name==="exponential")y=pl(o,t.base,l,d);else if(t.name==="linear")y=pl(o,1,l,d);else if(t.name==="cubic-bezier"){let _=t.controlPoints;y=new Jf(_[0],_[1],_[2],_[3]).solve(pl(o,1,l,d))}return y}static parse(t,o){let[l,d,y,..._]=t;if(!Array.isArray(d)||d.length===0)return o.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){let S=d[1];if(typeof S!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:S}}else{if(d[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(d[0])}`,1,0);{let S=d.slice(1);if(S.length!==4||S.some(T=>typeof T!="number"||T<0||T>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:S}}}if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(y=o.parse(y,2,Fe),!y)return null;let v=[],w=null;l==="interpolate-hcl"||l==="interpolate-lab"?w=Yi:o.expectedType&&o.expectedType.kind!=="value"&&(w=o.expectedType);for(let S=0;S<_.length;S+=2){let T=_[S],z=_[S+1],M=S+3,R=S+4;if(typeof T!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(v.length&&v[v.length-1][0]>=T)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',M);let O=o.parse(z,R,w);if(!O)return null;w=w||O.type,v.push([T,O])}return ue(w,Fe)||ue(w,Yi)||ue(w,ao)||ue(w,X)||ue(w,D(Fe))?new er(w,l,d,y,v):o.error(`Type ${L(w)} is not interpolatable.`)}evaluate(t){let o=this.labels,l=this.outputs;if(o.length===1)return l[0].evaluate(t);let d=this.input.evaluate(t);if(d<=o[0])return l[0].evaluate(t);let y=o.length;if(d>=o[y-1])return l[y-1].evaluate(t);let _=dl(o,d),v=er.interpolationFactor(this.interpolation,d,o[_],o[_+1]),w=l[_].evaluate(t),S=l[_+1].evaluate(t);switch(this.operator){case"interpolate":return Qi[this.type.kind](w,S,v);case"interpolate-hcl":return Qi.color(w,S,v,"hcl");case"interpolate-lab":return Qi.color(w,S,v,"lab")}}eachChild(t){t(this.input);for(let o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function pl(r,t,o,l){let d=l-o,y=r-o;return d===0?0:t===1?y/d:(Math.pow(t,y)-1)/(Math.pow(t,d)-1)}class fl{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expectected at least one argument.");let l=null,d=o.expectedType;d&&d.kind!=="value"&&(l=d);let y=[];for(let v of t.slice(1)){let w=o.parse(v,1+y.length,l,void 0,{typeAnnotation:"omit"});if(!w)return null;l=l||w.type,y.push(w)}if(!l)throw new Error("No output type");let _=d&&y.some(v=>G(d,v.type));return new fl(_?ht:l,y)}evaluate(t){let o,l=null,d=0;for(let y of this.args)if(d++,l=y.evaluate(t),l&&l instanceof yr&&!l.available&&(o||(o=l.name),l=null,d===this.args.length&&(l=o)),l!==null)break;return l}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function ml(r,t){return r==="=="||r==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function rd(r,t,o,l){return l.compare(t,o)===0}function da(r,t,o){let l=r!=="=="&&r!=="!=";return class zb{constructor(y,_,v){this.type=at,this.lhs=y,this.rhs=_,this.collator=v,this.hasUntypedArgument=y.type.kind==="value"||_.type.kind==="value"}static parse(y,_){if(y.length!==3&&y.length!==4)return _.error("Expected two or three arguments.");let v=y[0],w=_.parse(y[1],1,ht);if(!w)return null;if(!ml(v,w.type))return _.concat(1).error(`"${v}" comparisons are not supported for type '${L(w.type)}'.`);let S=_.parse(y[2],2,ht);if(!S)return null;if(!ml(v,S.type))return _.concat(2).error(`"${v}" comparisons are not supported for type '${L(S.type)}'.`);if(w.type.kind!==S.type.kind&&w.type.kind!=="value"&&S.type.kind!=="value")return _.error(`Cannot compare types '${L(w.type)}' and '${L(S.type)}'.`);l&&(w.type.kind==="value"&&S.type.kind!=="value"?w=new Wr(S.type,[w]):w.type.kind!=="value"&&S.type.kind==="value"&&(S=new Wr(w.type,[S])));let T=null;if(y.length===4){if(w.type.kind!=="string"&&S.type.kind!=="string"&&w.type.kind!=="value"&&S.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(T=_.parse(y[3],3,_n),!T)return null}return new zb(w,S,T)}evaluate(y){let _=this.lhs.evaluate(y),v=this.rhs.evaluate(y);if(l&&this.hasUntypedArgument){let w=pi(_),S=pi(v);if(w.kind!==S.kind||w.kind!=="string"&&w.kind!=="number")throw new si(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${w.kind}, ${S.kind}) instead.`)}if(this.collator&&!l&&this.hasUntypedArgument){let w=pi(_),S=pi(v);if(w.kind!=="string"||S.kind!=="string")return t(y,_,v)}return this.collator?o(y,_,v,this.collator.evaluate(y)):t(y,_,v)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}}}let Yf=da("==",function(r,t,o){return t===o},rd),nd=da("!=",function(r,t,o){return t!==o},function(r,t,o,l){return!rd(0,t,o,l)}),od=da("<",function(r,t,o){return t<o},function(r,t,o,l){return l.compare(t,o)<0}),Qf=da(">",function(r,t,o){return t>o},function(r,t,o,l){return l.compare(t,o)>0}),em=da("<=",function(r,t,o){return t<=o},function(r,t,o,l){return l.compare(t,o)<=0}),ad=da(">=",function(r,t,o){return t>=o},function(r,t,o,l){return l.compare(t,o)>=0});class ws{constructor(t,o,l){this.type=_n,this.locale=l,this.caseSensitive=t,this.diacriticSensitive=o}static parse(t,o){if(t.length!==2)return o.error("Expected one argument.");let l=t[1];if(typeof l!="object"||Array.isArray(l))return o.error("Collator options argument must be an object.");let d=o.parse(l["case-sensitive"]!==void 0&&l["case-sensitive"],1,at);if(!d)return null;let y=o.parse(l["diacritic-sensitive"]!==void 0&&l["diacritic-sensitive"],1,at);if(!y)return null;let _=null;return l.locale&&(_=o.parse(l.locale,1,mt),!_)?null:new ws(d,y,_)}evaluate(t){return new Uc(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class Wc{constructor(t,o,l,d,y){this.type=mt,this.number=t,this.locale=o,this.currency=l,this.minFractionDigits=d,this.maxFractionDigits=y}static parse(t,o){if(t.length!==3)return o.error("Expected two arguments.");let l=o.parse(t[1],1,Fe);if(!l)return null;let d=t[2];if(typeof d!="object"||Array.isArray(d))return o.error("NumberFormat options argument must be an object.");let y=null;if(d.locale&&(y=o.parse(d.locale,1,mt),!y))return null;let _=null;if(d.currency&&(_=o.parse(d.currency,1,mt),!_))return null;let v=null;if(d["min-fraction-digits"]&&(v=o.parse(d["min-fraction-digits"],1,Fe),!v))return null;let w=null;return d["max-fraction-digits"]&&(w=o.parse(d["max-fraction-digits"],1,Fe),!w)?null:new Wc(l,y,_,v,w)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class gl{constructor(t){this.type=On,this.sections=t}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");let l=t[1];if(!Array.isArray(l)&&typeof l=="object")return o.error("First argument must be an image or text section.");let d=[],y=!1;for(let _=1;_<=t.length-1;++_){let v=t[_];if(y&&typeof v=="object"&&!Array.isArray(v)){y=!1;let w=null;if(v["font-scale"]&&(w=o.parse(v["font-scale"],1,Fe),!w))return null;let S=null;if(v["text-font"]&&(S=o.parse(v["text-font"],1,D(mt)),!S))return null;let T=null;if(v["text-color"]&&(T=o.parse(v["text-color"],1,Yi),!T))return null;let z=d[d.length-1];z.scale=w,z.font=S,z.textColor=T}else{let w=o.parse(t[_],1,ht);if(!w)return null;let S=w.type.kind;if(S!=="string"&&S!=="value"&&S!=="null"&&S!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,d.push({content:w,scale:null,font:null,textColor:null})}}return new gl(d)}evaluate(t){return new mr(this.sections.map(o=>{let l=o.content.evaluate(t);return pi(l)===vn?new qc("",l,null,null,null):new qc(_s(l),null,o.scale?o.scale.evaluate(t):null,o.font?o.font.evaluate(t).join(","):null,o.textColor?o.textColor.evaluate(t):null)}))}eachChild(t){for(let o of this.sections)t(o.content),o.scale&&t(o.scale),o.font&&t(o.font),o.textColor&&t(o.textColor)}outputDefined(){return!1}}class Xc{constructor(t){this.type=vn,this.input=t}static parse(t,o){if(t.length!==2)return o.error("Expected two arguments.");let l=o.parse(t[1],1,mt);return l?new Xc(l):o.error("No image name provided.")}evaluate(t){let o=this.input.evaluate(t),l=yr.fromString(o);return l&&t.availableImages&&(l.available=t.availableImages.indexOf(o)>-1),l}eachChild(t){t(this.input)}outputDefined(){return!1}}class Kc{constructor(t){this.type=Fe,this.input=t}static parse(t,o){if(t.length!==2)return o.error(`Expected 1 argument, but found ${t.length-1} instead.`);let l=o.parse(t[1],1);return l?l.type.kind!=="array"&&l.type.kind!=="string"&&l.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${L(l.type)} instead.`):new Kc(l):null}evaluate(t){let o=this.input.evaluate(t);if(typeof o=="string")return[...o].length;if(Array.isArray(o))return o.length;throw new si(`Expected value to be of type string or array, but found ${L(pi(o))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}let xn=8192;function tm(r,t){let o=(180+r[0])/360,l=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,d=Math.pow(2,t.z);return[Math.round(o*d*xn),Math.round(l*d*xn)]}function Jc(r,t){let o=Math.pow(2,t.z);return[(d=(r[0]/xn+t.x)/o,360*d-180),(l=(r[1]/xn+t.y)/o,360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90)];var l,d}function Ao(r,t){r[0]=Math.min(r[0],t[0]),r[1]=Math.min(r[1],t[1]),r[2]=Math.max(r[2],t[0]),r[3]=Math.max(r[3],t[1])}function lo(r,t){return!(r[0]<=t[0]||r[2]>=t[2]||r[1]<=t[1]||r[3]>=t[3])}function Pt(r,t,o){let l=r[0]-t[0],d=r[1]-t[1],y=r[0]-o[0],_=r[1]-o[1];return l*_-y*d==0&&l*y<=0&&d*_<=0}function yl(r,t,o,l){return(d=[l[0]-o[0],l[1]-o[1]])[0]*(y=[t[0]-r[0],t[1]-r[1]])[1]-d[1]*y[0]!=0&&!(!ld(r,t,o,l)||!ld(o,l,r,t));var d,y}function im(r,t,o){for(let l of o)for(let d=0;d<l.length-1;++d)if(yl(r,t,l[d],l[d+1]))return!0;return!1}function pa(r,t,o=!1){let l=!1;for(let v of t)for(let w=0;w<v.length-1;w++){if(Pt(r,v[w],v[w+1]))return o;(y=v[w])[1]>(d=r)[1]!=(_=v[w+1])[1]>d[1]&&d[0]<(_[0]-y[0])*(d[1]-y[1])/(_[1]-y[1])+y[0]&&(l=!l)}var d,y,_;return l}function rm(r,t){for(let o of t)if(pa(r,o))return!0;return!1}function sd(r,t){for(let o of r)if(!pa(o,t))return!1;for(let o=0;o<r.length-1;++o)if(im(r[o],r[o+1],t))return!1;return!0}function nm(r,t){for(let o of t)if(sd(r,o))return!0;return!1}function ld(r,t,o,l){let d=l[0]-o[0],y=l[1]-o[1],_=(r[0]-o[0])*y-d*(r[1]-o[1]),v=(t[0]-o[0])*y-d*(t[1]-o[1]);return _>0&&v<0||_<0&&v>0}function Yc(r,t,o){let l=[];for(let d=0;d<r.length;d++){let y=[];for(let _=0;_<r[d].length;_++){let v=tm(r[d][_],o);Ao(t,v),y.push(v)}l.push(y)}return l}function cd(r,t,o){let l=[];for(let d=0;d<r.length;d++){let y=Yc(r[d],t,o);l.push(y)}return l}function ud(r,t,o,l){if(r[0]<o[0]||r[0]>o[2]){let d=.5*l,y=r[0]-o[0]>d?-l:o[0]-r[0]>d?l:0;y===0&&(y=r[0]-o[2]>d?-l:o[2]-r[0]>d?l:0),r[0]+=y}Ao(t,r)}function hd(r,t,o,l){let d=Math.pow(2,l.z)*xn,y=[l.x*xn,l.y*xn],_=[];for(let v of r)for(let w of v){let S=[w.x+y[0],w.y+y[1]];ud(S,t,o,d),_.push(S)}return _}function dd(r,t,o,l){let d=Math.pow(2,l.z)*xn,y=[l.x*xn,l.y*xn],_=[];for(let w of r){let S=[];for(let T of w){let z=[T.x+y[0],T.y+y[1]];Ao(t,z),S.push(z)}_.push(S)}if(t[2]-t[0]<=d/2){(v=t)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(let w of _)for(let S of w)ud(S,t,o,d)}var v;return _}class Lo{constructor(t,o){this.type=at,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Io(t[1])){let l=t[1];if(l.type==="FeatureCollection"){let d=[];for(let y of l.features){let{type:_,coordinates:v}=y.geometry;_==="Polygon"&&d.push(v),_==="MultiPolygon"&&d.push(...v)}if(d.length)return new Lo(l,{type:"MultiPolygon",coordinates:d})}else if(l.type==="Feature"){let d=l.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new Lo(l,l.geometry)}else if(l.type==="Polygon"||l.type==="MultiPolygon")return new Lo(l,l)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,l){let d=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],_=o.canonicalID();if(l.type==="Polygon"){let v=Yc(l.coordinates,y,_),w=hd(o.geometry(),d,y,_);if(!lo(d,y))return!1;for(let S of w)if(!pa(S,v))return!1}if(l.type==="MultiPolygon"){let v=cd(l.coordinates,y,_),w=hd(o.geometry(),d,y,_);if(!lo(d,y))return!1;for(let S of w)if(!rm(S,v))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,l){let d=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],_=o.canonicalID();if(l.type==="Polygon"){let v=Yc(l.coordinates,y,_),w=dd(o.geometry(),d,y,_);if(!lo(d,y))return!1;for(let S of w)if(!sd(S,v))return!1}if(l.type==="MultiPolygon"){let v=cd(l.coordinates,y,_),w=dd(o.geometry(),d,y,_);if(!lo(d,y))return!1;for(let S of w)if(!nm(S,v))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let pd=class{constructor(r=[],t=(o,l)=>o<l?-1:o>l?1:0){if(this.data=r,this.length=this.data.length,this.compare=t,this.length>0)for(let o=(this.length>>1)-1;o>=0;o--)this._down(o)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;let r=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),r}peek(){return this.data[0]}_up(r){let{data:t,compare:o}=this,l=t[r];for(;r>0;){let d=r-1>>1,y=t[d];if(o(l,y)>=0)break;t[r]=y,r=d}t[r]=l}_down(r){let{data:t,compare:o}=this,l=this.length>>1,d=t[r];for(;r<l;){let y=1+(r<<1),_=y+1;if(_<this.length&&o(t[_],t[y])<0&&(y=_),o(t[y],d)>=0)break;t[r]=t[y],r=y}t[r]=d}};function om(r,t,o,l,d){fd(r,t,o,l||r.length-1,d||am)}function fd(r,t,o,l,d){for(;l>o;){if(l-o>600){var y=l-o+1,_=t-o+1,v=Math.log(y),w=.5*Math.exp(2*v/3),S=.5*Math.sqrt(v*w*(y-w)/y)*(_-y/2<0?-1:1);fd(r,t,Math.max(o,Math.floor(t-_*w/y+S)),Math.min(l,Math.floor(t+(y-_)*w/y+S)),d)}var T=r[t],z=o,M=l;for(bs(r,o,t),d(r[l],T)>0&&bs(r,o,l);z<M;){for(bs(r,z,M),z++,M--;d(r[z],T)<0;)z++;for(;d(r[M],T)>0;)M--}d(r[o],T)===0?bs(r,o,M):bs(r,++M,l),M<=t&&(o=M+1),t<=M&&(l=M-1)}}function bs(r,t,o){var l=r[t];r[t]=r[o],r[o]=l}function am(r,t){return r<t?-1:r>t?1:0}function _l(r,t){if(r.length<=1)return[r];let o=[],l,d;for(let y of r){let _=lm(y);_!==0&&(y.area=Math.abs(_),d===void 0&&(d=_<0),d===_<0?(l&&o.push(l),l=[y]):l.push(y))}if(l&&o.push(l),t>1)for(let y=0;y<o.length;y++)o[y].length<=t||(om(o[y],t,1,o[y].length-1,sm),o[y]=o[y].slice(0,t));return o}function sm(r,t){return t.area-r.area}function lm(r){let t=0;for(let o,l,d=0,y=r.length,_=y-1;d<y;_=d++)o=r[d],l=r[_],t+=(l.x-o.x)*(o.y+l.y);return t}let md=1/298.257223563,gd=md*(2-md),yd=Math.PI/180;class Qc{constructor(t){let o=6378.137*yd*1e3,l=Math.cos(t*yd),d=1/(1-gd*(1-l*l)),y=Math.sqrt(d);this.kx=o*y*l,this.ky=o*y*d*(1-gd)}distance(t,o){let l=this.wrap(t[0]-o[0])*this.kx,d=(t[1]-o[1])*this.ky;return Math.sqrt(l*l+d*d)}pointOnLine(t,o){let l,d,y,_,v=1/0;for(let w=0;w<t.length-1;w++){let S=t[w][0],T=t[w][1],z=this.wrap(t[w+1][0]-S)*this.kx,M=(t[w+1][1]-T)*this.ky,R=0;z===0&&M===0||(R=(this.wrap(o[0]-S)*this.kx*z+(o[1]-T)*this.ky*M)/(z*z+M*M),R>1?(S=t[w+1][0],T=t[w+1][1]):R>0&&(S+=z/this.kx*R,T+=M/this.ky*R)),z=this.wrap(o[0]-S)*this.kx,M=(o[1]-T)*this.ky;let O=z*z+M*M;O<v&&(v=O,l=S,d=T,y=w,_=R)}return{point:[l,d],index:y,t:Math.max(0,Math.min(1,_))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function _d(r,t){return t[0]-r[0]}function vl(r){return r[1]-r[0]+1}function Nn(r,t){return r[1]>=r[0]&&r[1]<t}function eu(r,t){if(r[0]>r[1])return[null,null];let o=vl(r);if(t){if(o===2)return[r,null];let d=Math.floor(o/2);return[[r[0],r[0]+d],[r[0]+d,r[1]]]}if(o===1)return[r,null];let l=Math.floor(o/2)-1;return[[r[0],r[0]+l],[r[0]+l+1,r[1]]]}function tu(r,t){if(!Nn(t,r.length))return[1/0,1/0,-1/0,-1/0];let o=[1/0,1/0,-1/0,-1/0];for(let l=t[0];l<=t[1];++l)Ao(o,r[l]);return o}function iu(r){let t=[1/0,1/0,-1/0,-1/0];for(let o of r)for(let l of o)Ao(t,l);return t}function xl(r){return r[0]!==-1/0&&r[1]!==-1/0&&r[2]!==1/0&&r[3]!==1/0}function ru(r,t,o){if(!xl(r)||!xl(t))return NaN;let l=0,d=0;return r[2]<t[0]&&(l=t[0]-r[2]),r[0]>t[2]&&(l=r[0]-t[2]),r[1]>t[3]&&(d=r[1]-t[3]),r[3]<t[1]&&(d=t[1]-r[3]),o.distance([0,0],[l,d])}function Do(r,t,o){let l=o.pointOnLine(t,r);return o.distance(r,l.point)}function nu(r,t,o,l,d){let y=Math.min(Do(r,[o,l],d),Do(t,[o,l],d)),_=Math.min(Do(o,[r,t],d),Do(l,[r,t],d));return Math.min(y,_)}function cm(r,t,o,l,d){if(!Nn(t,r.length)||!Nn(l,o.length))return 1/0;let y=1/0;for(let _=t[0];_<t[1];++_){let v=r[_],w=r[_+1];for(let S=l[0];S<l[1];++S){let T=o[S],z=o[S+1];if(yl(v,w,T,z))return 0;y=Math.min(y,nu(v,w,T,z,d))}}return y}function ri(r,t,o,l,d){if(!Nn(t,r.length)||!Nn(l,o.length))return NaN;let y=1/0;for(let _=t[0];_<=t[1];++_)for(let v=l[0];v<=l[1];++v)if(y=Math.min(y,d.distance(r[_],o[v])),y===0)return y;return y}function um(r,t,o){if(pa(r,t,!0))return 0;let l=1/0;for(let d of t){let y=d[0],_=d[d.length-1];if(y!==_&&(l=Math.min(l,Do(r,[_,y],o)),l===0))return l;let v=o.pointOnLine(d,r);if(l=Math.min(l,o.distance(r,v.point)),l===0)return l}return l}function yt(r,t,o,l){if(!Nn(t,r.length))return NaN;for(let y=t[0];y<=t[1];++y)if(pa(r[y],o,!0))return 0;let d=1/0;for(let y=t[0];y<t[1];++y){let _=r[y],v=r[y+1];for(let w of o)for(let S=0,T=w.length,z=T-1;S<T;z=S++){let M=w[z],R=w[S];if(yl(_,v,M,R))return 0;d=Math.min(d,nu(_,v,M,R,l))}}return d}function wl(r,t){for(let o of r)for(let l of o)if(pa(l,t,!0))return!0;return!1}function Nt(r,t,o,l=1/0){let d=iu(r),y=iu(t);if(l!==1/0&&ru(d,y,o)>=l)return l;if(lo(d,y)){if(wl(r,t))return 0}else if(wl(t,r))return 0;let _=1/0;for(let v of r)for(let w=0,S=v.length,T=S-1;w<S;T=w++){let z=v[T],M=v[w];for(let R of t)for(let O=0,V=R.length,H=V-1;O<V;H=O++){let K=R[H],he=R[O];if(yl(z,M,K,he))return 0;_=Math.min(_,nu(z,M,K,he,o))}}return _}function Dt(r,t,o,l,d,y){if(!y)return;let _=ru(tu(l,y),d,o);_<t&&r.push([_,y,[0,0]])}function Ro(r,t,o,l,d,y,_){if(!y||!_)return;let v=ru(tu(l,y),tu(d,_),o);v<t&&r.push([v,y,_])}function ks(r,t,o,l,d=1/0){let y=Math.min(l.distance(r[0],o[0][0]),d);if(y===0)return y;let _=new pd([[0,[0,r.length-1],[0,0]]],_d),v=iu(o);for(;_.length>0;){let w=_.pop();if(w[0]>=y)continue;let S=w[1],T=t?50:100;if(vl(S)<=T){if(!Nn(S,r.length))return NaN;if(t){let z=yt(r,S,o,l);if(isNaN(z)||z===0)return z;y=Math.min(y,z)}else for(let z=S[0];z<=S[1];++z){let M=um(r[z],o,l);if(y=Math.min(y,M),y===0)return 0}}else{let z=eu(S,t);Dt(_,y,l,r,v,z[0]),Dt(_,y,l,r,v,z[1])}}return y}function Ss(r,t,o,l,d,y=1/0){let _=Math.min(y,d.distance(r[0],o[0]));if(_===0)return _;let v=new pd([[0,[0,r.length-1],[0,o.length-1]]],_d);for(;v.length>0;){let w=v.pop();if(w[0]>=_)continue;let S=w[1],T=w[2],z=t?50:100,M=l?50:100;if(vl(S)<=z&&vl(T)<=M){if(!Nn(S,r.length)&&Nn(T,o.length))return NaN;let R;if(t&&l)R=cm(r,S,o,T,d),_=Math.min(_,R);else if(t&&!l){let O=r.slice(S[0],S[1]+1);for(let V=T[0];V<=T[1];++V)if(R=Do(o[V],O,d),_=Math.min(_,R),_===0)return _}else if(!t&&l){let O=o.slice(T[0],T[1]+1);for(let V=S[0];V<=S[1];++V)if(R=Do(r[V],O,d),_=Math.min(_,R),_===0)return _}else R=ri(r,S,o,T,d),_=Math.min(_,R)}else{let R=eu(S,t),O=eu(T,l);Ro(v,_,d,r,o,R[0],O[0]),Ro(v,_,d,r,o,R[0],O[1]),Ro(v,_,d,r,o,R[1],O[0]),Ro(v,_,d,r,o,R[1],O[1])}}return _}function ou(r){return r.type==="MultiPolygon"?r.coordinates.map(t=>({type:"Polygon",coordinates:t})):r.type==="MultiLineString"?r.coordinates.map(t=>({type:"LineString",coordinates:t})):r.type==="MultiPoint"?r.coordinates.map(t=>({type:"Point",coordinates:t})):[r]}class Fo{constructor(t,o){this.type=Fe,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Io(t[1])){let l=t[1];if(l.type==="FeatureCollection")return new Fo(l,l.features.map(d=>ou(d.geometry)).flat());if(l.type==="Feature")return new Fo(l,ou(l.geometry));if("type"in l&&"coordinates"in l)return new Fo(l,ou(l))}return o.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,l){let d=o.geometry(),y=d.flat().map(w=>Jc([w.x,w.y],o.canonical));if(d.length===0)return NaN;let _=new Qc(y[0][1]),v=1/0;for(let w of l){switch(w.type){case"Point":v=Math.min(v,Ss(y,!1,[w.coordinates],!1,_,v));break;case"LineString":v=Math.min(v,Ss(y,!1,w.coordinates,!0,_,v));break;case"Polygon":v=Math.min(v,ks(y,!1,w.coordinates,_,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,l){let d=o.geometry(),y=d.flat().map(w=>Jc([w.x,w.y],o.canonical));if(d.length===0)return NaN;let _=new Qc(y[0][1]),v=1/0;for(let w of l){switch(w.type){case"Point":v=Math.min(v,Ss(y,!0,[w.coordinates],!1,_,v));break;case"LineString":v=Math.min(v,Ss(y,!0,w.coordinates,!0,_,v));break;case"Polygon":v=Math.min(v,ks(y,!0,w.coordinates,_,v))}if(v===0)return v}return v}(t,this.geometries);if(t.geometryType()==="Polygon")return function(o,l){let d=o.geometry();if(d.length===0||d[0].length===0)return NaN;let y=_l(d,0).map(w=>w.map(S=>S.map(T=>Jc([T.x,T.y],o.canonical)))),_=new Qc(y[0][0][0][1]),v=1/0;for(let w of l)for(let S of y){switch(w.type){case"Point":v=Math.min(v,ks([w.coordinates],!1,S,_,v));break;case"LineString":v=Math.min(v,ks(w.coordinates,!0,S,_,v));break;case"Polygon":v=Math.min(v,Nt(S,w.coordinates,_,v))}if(v===0)return v}return v}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}let fa={"==":Yf,"!=":nd,">":Qf,"<":od,">=":ad,"<=":em,array:Wr,at:Zc,boolean:Wr,case:hl,coalesce:fl,collator:ws,format:gl,image:Xc,in:Hc,"index-of":ua,interpolate:er,"interpolate-hcl":er,"interpolate-lab":er,length:Kc,let:so,literal:Gr,match:Gc,number:Wr,"number-format":Wc,object:Wr,slice:vs,step:ha,string:Wr,"to-boolean":Xr,"to-color":Xr,"to-number":Xr,"to-string":Xr,var:It,within:Lo,distance:Fo};class Pr{constructor(t,o,l,d){this.name=t,this.type=o,this._evaluate=l,this.args=d}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,o){let l=t[0],d=Pr.definitions[l];if(!d)return o.error(`Unknown expression "${l}". If you wanted a literal array, use ["literal", [...]].`,0);let y=Array.isArray(d)?d[0]:d.type,_=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,v=_.filter(([S])=>!Array.isArray(S)||S.length===t.length-1),w=null;for(let[S,T]of v){w=new Po(o.registry,Es,o.path,null,o.scope);let z=[],M=!1;for(let R=1;R<t.length;R++){let O=t[R],V=Array.isArray(S)?S[R-1]:S.type,H=w.parse(O,1+z.length,V);if(!H){M=!0;break}z.push(H)}if(!M)if(Array.isArray(S)&&S.length!==z.length)w.error(`Expected ${S.length} arguments, but found ${z.length} instead.`);else{for(let R=0;R<z.length;R++){let O=Array.isArray(S)?S[R]:S.type,V=z[R];w.concat(R+1).checkSubtype(O,V.type)}if(w.errors.length===0)return new Pr(l,y,T,z)}}if(v.length===1)o.errors.push(...w.errors);else{let S=(v.length?v:_).map(([z])=>{return M=z,Array.isArray(M)?`(${M.map(L).join(", ")})`:`(${L(M.type)}...)`;var M}).join(" | "),T=[];for(let z=1;z<t.length;z++){let M=o.parse(t[z],1+T.length);if(!M)return null;T.push(L(M.type))}o.error(`Expected arguments of type ${S}, but found (${T.join(", ")}) instead.`)}return null}static register(t,o){Pr.definitions=o;for(let l in o)t[l]=Pr}}function au(r,[t,o,l,d]){t=t.evaluate(r),o=o.evaluate(r),l=l.evaluate(r);let y=d?d.evaluate(r):1,_=ca(t,o,l,y);if(_)throw new si(_);return new Lt(t/255,o/255,l/255,y,!1)}function su(r,t){return r in t}function lu(r,t){let o=t[r];return o===void 0?null:o}function Bo(r){return{type:r}}function Es(r){if(r instanceof It)return Es(r.boundExpression);if(r instanceof Pr&&r.name==="error"||r instanceof ws||r instanceof Lo||r instanceof Fo)return!1;let t=r instanceof Xr||r instanceof Wr,o=!0;return r.eachChild(l=>{o=t?o&&Es(l):o&&l instanceof Gr}),!!o&&Ts(r)&&Cs(r,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ts(r){if(r instanceof Pr&&(r.name==="get"&&r.args.length===1||r.name==="feature-state"||r.name==="has"&&r.args.length===1||r.name==="properties"||r.name==="geometry-type"||r.name==="id"||/^filter-/.test(r.name))||r instanceof Lo||r instanceof Fo)return!1;let t=!0;return r.eachChild(o=>{t&&!Ts(o)&&(t=!1)}),t}function ma(r){if(r instanceof Pr&&r.name==="feature-state")return!1;let t=!0;return r.eachChild(o=>{t&&!ma(o)&&(t=!1)}),t}function Cs(r,t){if(r instanceof Pr&&t.indexOf(r.name)>=0)return!1;let o=!0;return r.eachChild(l=>{o&&!Cs(l,t)&&(o=!1)}),o}function bl(r){return{result:"success",value:r}}function ga(r){return{result:"error",value:r}}function ya(r){return r["property-type"]==="data-driven"||r["property-type"]==="cross-faded-data-driven"}function vd(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function cu(r){return!!r.expression&&r.expression.interpolated}function Tt(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":r===null?"null":typeof r}function kl(r){return typeof r=="object"&&r!==null&&!Array.isArray(r)}function hm(r){return r}function xd(r,t){let o=t.type==="color",l=r.stops&&typeof r.stops[0][0]=="object",d=l||!(l||r.property!==void 0),y=r.type||(cu(t)?"exponential":"interval");if(o||t.type==="padding"){let T=o?Lt.parse:gr.parse;(r=gn({},r)).stops&&(r.stops=r.stops.map(z=>[z[0],T(z[1])])),r.default=T(r.default?r.default:t.default)}if(r.colorSpace&&(_=r.colorSpace)!=="rgb"&&_!=="hcl"&&_!=="lab")throw new Error(`Unknown color space: "${r.colorSpace}"`);var _;let v,w,S;if(y==="exponential")v=bd;else if(y==="interval")v=Sl;else if(y==="categorical"){v=wd,w=Object.create(null);for(let T of r.stops)w[T[0]]=T[1];S=typeof r.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);v=kd}if(l){let T={},z=[];for(let O=0;O<r.stops.length;O++){let V=r.stops[O],H=V[0].zoom;T[H]===void 0&&(T[H]={zoom:H,type:r.type,property:r.property,default:r.default,stops:[]},z.push(H)),T[H].stops.push([V[0].value,V[1]])}let M=[];for(let O of z)M.push([T[O].zoom,xd(T[O],t)]);let R={name:"linear"};return{kind:"composite",interpolationType:R,interpolationFactor:er.interpolationFactor.bind(void 0,R),zoomStops:M.map(O=>O[0]),evaluate:({zoom:O},V)=>bd({stops:M,base:r.base},t,O).evaluate(O,V)}}if(d){let T=y==="exponential"?{name:"exponential",base:r.base!==void 0?r.base:1}:null;return{kind:"camera",interpolationType:T,interpolationFactor:er.interpolationFactor.bind(void 0,T),zoomStops:r.stops.map(z=>z[0]),evaluate:({zoom:z})=>v(r,t,z,w,S)}}return{kind:"source",evaluate(T,z){let M=z&&z.properties?z.properties[r.property]:void 0;return M===void 0?_a(r.default,t.default):v(r,t,M,w,S)}}}function _a(r,t,o){return r!==void 0?r:t!==void 0?t:o!==void 0?o:void 0}function wd(r,t,o,l,d){return _a(typeof o===d?l[o]:void 0,r.default,t.default)}function Sl(r,t,o){if(Tt(o)!=="number")return _a(r.default,t.default);let l=r.stops.length;if(l===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[l-1][0])return r.stops[l-1][1];let d=dl(r.stops.map(y=>y[0]),o);return r.stops[d][1]}function bd(r,t,o){let l=r.base!==void 0?r.base:1;if(Tt(o)!=="number")return _a(r.default,t.default);let d=r.stops.length;if(d===1||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[d-1][0])return r.stops[d-1][1];let y=dl(r.stops.map(T=>T[0]),o),_=function(T,z,M,R){let O=R-M,V=T-M;return O===0?0:z===1?V/O:(Math.pow(z,V)-1)/(Math.pow(z,O)-1)}(o,l,r.stops[y][0],r.stops[y+1][0]),v=r.stops[y][1],w=r.stops[y+1][1],S=Qi[t.type]||hm;return typeof v.evaluate=="function"?{evaluate(...T){let z=v.evaluate.apply(void 0,T),M=w.evaluate.apply(void 0,T);if(z!==void 0&&M!==void 0)return S(z,M,_,r.colorSpace)}}:S(v,w,_,r.colorSpace)}function kd(r,t,o){switch(t.type){case"color":o=Lt.parse(o);break;case"formatted":o=mr.fromString(o.toString());break;case"resolvedImage":o=yr.fromString(o.toString());break;case"padding":o=gr.parse(o);break;default:Tt(o)===t.type||t.type==="enum"&&t.values[o]||(o=void 0)}return _a(o,r.default,t.default)}Pr.register(fa,{error:[{kind:"error"},[mt],(r,[t])=>{throw new si(t.evaluate(r))}],typeof:[mt,[ht],(r,[t])=>L(pi(t.evaluate(r)))],"to-rgba":[D(Fe,4),[Yi],(r,[t])=>{let[o,l,d,y]=t.evaluate(r).rgb;return[255*o,255*l,255*d,y]}],rgb:[Yi,[Fe,Fe,Fe],au],rgba:[Yi,[Fe,Fe,Fe,Fe],au],has:{type:at,overloads:[[[mt],(r,[t])=>su(t.evaluate(r),r.properties())],[[mt,Hr],(r,[t,o])=>su(t.evaluate(r),o.evaluate(r))]]},get:{type:ht,overloads:[[[mt],(r,[t])=>lu(t.evaluate(r),r.properties())],[[mt,Hr],(r,[t,o])=>lu(t.evaluate(r),o.evaluate(r))]]},"feature-state":[ht,[mt],(r,[t])=>lu(t.evaluate(r),r.featureState||{})],properties:[Hr,[],r=>r.properties()],"geometry-type":[mt,[],r=>r.geometryType()],id:[ht,[],r=>r.id()],zoom:[Fe,[],r=>r.globals.zoom],"heatmap-density":[Fe,[],r=>r.globals.heatmapDensity||0],"line-progress":[Fe,[],r=>r.globals.lineProgress||0],accumulated:[ht,[],r=>r.globals.accumulated===void 0?null:r.globals.accumulated],"+":[Fe,Bo(Fe),(r,t)=>{let o=0;for(let l of t)o+=l.evaluate(r);return o}],"*":[Fe,Bo(Fe),(r,t)=>{let o=1;for(let l of t)o*=l.evaluate(r);return o}],"-":{type:Fe,overloads:[[[Fe,Fe],(r,[t,o])=>t.evaluate(r)-o.evaluate(r)],[[Fe],(r,[t])=>-t.evaluate(r)]]},"/":[Fe,[Fe,Fe],(r,[t,o])=>t.evaluate(r)/o.evaluate(r)],"%":[Fe,[Fe,Fe],(r,[t,o])=>t.evaluate(r)%o.evaluate(r)],ln2:[Fe,[],()=>Math.LN2],pi:[Fe,[],()=>Math.PI],e:[Fe,[],()=>Math.E],"^":[Fe,[Fe,Fe],(r,[t,o])=>Math.pow(t.evaluate(r),o.evaluate(r))],sqrt:[Fe,[Fe],(r,[t])=>Math.sqrt(t.evaluate(r))],log10:[Fe,[Fe],(r,[t])=>Math.log(t.evaluate(r))/Math.LN10],ln:[Fe,[Fe],(r,[t])=>Math.log(t.evaluate(r))],log2:[Fe,[Fe],(r,[t])=>Math.log(t.evaluate(r))/Math.LN2],sin:[Fe,[Fe],(r,[t])=>Math.sin(t.evaluate(r))],cos:[Fe,[Fe],(r,[t])=>Math.cos(t.evaluate(r))],tan:[Fe,[Fe],(r,[t])=>Math.tan(t.evaluate(r))],asin:[Fe,[Fe],(r,[t])=>Math.asin(t.evaluate(r))],acos:[Fe,[Fe],(r,[t])=>Math.acos(t.evaluate(r))],atan:[Fe,[Fe],(r,[t])=>Math.atan(t.evaluate(r))],min:[Fe,Bo(Fe),(r,t)=>Math.min(...t.map(o=>o.evaluate(r)))],max:[Fe,Bo(Fe),(r,t)=>Math.max(...t.map(o=>o.evaluate(r)))],abs:[Fe,[Fe],(r,[t])=>Math.abs(t.evaluate(r))],round:[Fe,[Fe],(r,[t])=>{let o=t.evaluate(r);return o<0?-Math.round(-o):Math.round(o)}],floor:[Fe,[Fe],(r,[t])=>Math.floor(t.evaluate(r))],ceil:[Fe,[Fe],(r,[t])=>Math.ceil(t.evaluate(r))],"filter-==":[at,[mt,ht],(r,[t,o])=>r.properties()[t.value]===o.value],"filter-id-==":[at,[ht],(r,[t])=>r.id()===t.value],"filter-type-==":[at,[mt],(r,[t])=>r.geometryType()===t.value],"filter-<":[at,[mt,ht],(r,[t,o])=>{let l=r.properties()[t.value],d=o.value;return typeof l==typeof d&&l<d}],"filter-id-<":[at,[ht],(r,[t])=>{let o=r.id(),l=t.value;return typeof o==typeof l&&o<l}],"filter->":[at,[mt,ht],(r,[t,o])=>{let l=r.properties()[t.value],d=o.value;return typeof l==typeof d&&l>d}],"filter-id->":[at,[ht],(r,[t])=>{let o=r.id(),l=t.value;return typeof o==typeof l&&o>l}],"filter-<=":[at,[mt,ht],(r,[t,o])=>{let l=r.properties()[t.value],d=o.value;return typeof l==typeof d&&l<=d}],"filter-id-<=":[at,[ht],(r,[t])=>{let o=r.id(),l=t.value;return typeof o==typeof l&&o<=l}],"filter->=":[at,[mt,ht],(r,[t,o])=>{let l=r.properties()[t.value],d=o.value;return typeof l==typeof d&&l>=d}],"filter-id->=":[at,[ht],(r,[t])=>{let o=r.id(),l=t.value;return typeof o==typeof l&&o>=l}],"filter-has":[at,[ht],(r,[t])=>t.value in r.properties()],"filter-has-id":[at,[],r=>r.id()!==null&&r.id()!==void 0],"filter-type-in":[at,[D(mt)],(r,[t])=>t.value.indexOf(r.geometryType())>=0],"filter-id-in":[at,[D(ht)],(r,[t])=>t.value.indexOf(r.id())>=0],"filter-in-small":[at,[mt,D(ht)],(r,[t,o])=>o.value.indexOf(r.properties()[t.value])>=0],"filter-in-large":[at,[mt,D(ht)],(r,[t,o])=>function(l,d,y,_){for(;y<=_;){let v=y+_>>1;if(d[v]===l)return!0;d[v]>l?_=v-1:y=v+1}return!1}(r.properties()[t.value],o.value,0,o.value.length-1)],all:{type:at,overloads:[[[at,at],(r,[t,o])=>t.evaluate(r)&&o.evaluate(r)],[Bo(at),(r,t)=>{for(let o of t)if(!o.evaluate(r))return!1;return!0}]]},any:{type:at,overloads:[[[at,at],(r,[t,o])=>t.evaluate(r)||o.evaluate(r)],[Bo(at),(r,t)=>{for(let o of t)if(o.evaluate(r))return!0;return!1}]]},"!":[at,[at],(r,[t])=>!t.evaluate(r)],"is-supported-script":[at,[mt],(r,[t])=>{let o=r.globals&&r.globals.isSupportedScript;return!o||o(t.evaluate(r))}],upcase:[mt,[mt],(r,[t])=>t.evaluate(r).toUpperCase()],downcase:[mt,[mt],(r,[t])=>t.evaluate(r).toLowerCase()],concat:[mt,Bo(ht),(r,t)=>t.map(o=>_s(o.evaluate(r))).join("")],"resolved-locale":[mt,[_n],(r,[t])=>t.evaluate(r).resolvedLocale()]});class El{constructor(t,o){var l;this.expression=t,this._warningHistory={},this._evaluator=new ul,this._defaultValue=o?(l=o).type==="color"&&kl(l.default)?new Lt(0,0,0,0):l.type==="color"?Lt.parse(l.default)||null:l.type==="padding"?gr.parse(l.default)||null:l.type==="variableAnchorOffsetCollection"?Ir.parse(l.default)||null:l.default===void 0?null:l.default:null,this._enumValues=o&&o.type==="enum"?o.values:null}evaluateWithoutErrorHandling(t,o,l,d,y,_){return this._evaluator.globals=t,this._evaluator.feature=o,this._evaluator.featureState=l,this._evaluator.canonical=d,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=_,this.expression.evaluate(this._evaluator)}evaluate(t,o,l,d,y,_){this._evaluator.globals=t,this._evaluator.feature=o||null,this._evaluator.featureState=l||null,this._evaluator.canonical=d,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=_||null;try{let v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new si(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function Tl(r){return Array.isArray(r)&&r.length>0&&typeof r[0]=="string"&&r[0]in fa}function va(r,t){let o=new Po(fa,Es,[],t?function(d){let y={color:Yi,string:mt,number:Fe,enum:mt,boolean:at,formatted:On,padding:ao,resolvedImage:vn,variableAnchorOffsetCollection:X};return d.type==="array"?D(y[d.value]||ht,d.length):y[d.type]}(t):void 0),l=o.parse(r,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return l?bl(new El(l,t)):ga(o.errors)}class xa{constructor(t,o){this.kind=t,this._styleExpression=o,this.isStateDependent=t!=="constant"&&!ma(o.expression)}evaluateWithoutErrorHandling(t,o,l,d,y,_){return this._styleExpression.evaluateWithoutErrorHandling(t,o,l,d,y,_)}evaluate(t,o,l,d,y,_){return this._styleExpression.evaluate(t,o,l,d,y,_)}}class wa{constructor(t,o,l,d){this.kind=t,this.zoomStops=l,this._styleExpression=o,this.isStateDependent=t!=="camera"&&!ma(o.expression),this.interpolationType=d}evaluateWithoutErrorHandling(t,o,l,d,y,_){return this._styleExpression.evaluateWithoutErrorHandling(t,o,l,d,y,_)}evaluate(t,o,l,d,y,_){return this._styleExpression.evaluate(t,o,l,d,y,_)}interpolationFactor(t,o,l){return this.interpolationType?er.interpolationFactor(this.interpolationType,t,o,l):0}}function uu(r,t){let o=va(r,t);if(o.result==="error")return o;let l=o.value.expression,d=Ts(l);if(!d&&!ya(t))return ga([new Ui("","data expressions not supported")]);let y=Cs(l,["zoom"]);if(!y&&!vd(t))return ga([new Ui("","zoom expressions not supported")]);let _=zs(l);return _||y?_ instanceof Ui?ga([_]):_ instanceof er&&!cu(t)?ga([new Ui("",'"interpolate" expressions cannot be used with this property')]):bl(_?new wa(d?"camera":"composite",o.value,_.labels,_ instanceof er?_.interpolation:void 0):new xa(d?"constant":"source",o.value)):ga([new Ui("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ba{constructor(t,o){this._parameters=t,this._specification=o,gn(this,xd(this._parameters,this._specification))}static deserialize(t){return new ba(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function zs(r){let t=null;if(r instanceof so)t=zs(r.result);else if(r instanceof fl){for(let o of r.args)if(t=zs(o),t)break}else(r instanceof ha||r instanceof er)&&r.input instanceof Pr&&r.input.name==="zoom"&&(t=r);return t instanceof Ui||r.eachChild(o=>{let l=zs(o);l instanceof Ui?t=l:!t&&l?t=new Ui("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&l&&t!==l&&(t=new Ui("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Cl(r){if(r===!0||r===!1)return!0;if(!Array.isArray(r)||r.length===0)return!1;switch(r[0]){case"has":return r.length>=2&&r[1]!=="$id"&&r[1]!=="$type";case"in":return r.length>=3&&(typeof r[1]!="string"||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return r.length!==3||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(let t of r.slice(1))if(!Cl(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}let zl={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function hu(r){if(r==null)return{filter:()=>!0,needGeometry:!1};Cl(r)||(r=Il(r));let t=va(r,zl);if(t.result==="error")throw new Error(t.value.map(o=>`${o.key}: ${o.message}`).join(", "));return{filter:(o,l,d)=>t.value.evaluate(o,l,{},d),needGeometry:Sd(r)}}function dm(r,t){return r<t?-1:r>t?1:0}function Sd(r){if(!Array.isArray(r))return!1;if(r[0]==="within"||r[0]==="distance")return!0;for(let t=1;t<r.length;t++)if(Sd(r[t]))return!0;return!1}function Il(r){if(!r)return!0;let t=r[0];return r.length<=1?t!=="any":t==="=="?du(r[1],r[2],"=="):t==="!="?Ai(du(r[1],r[2],"==")):t==="<"||t===">"||t==="<="||t===">="?du(r[1],r[2],t):t==="any"?(o=r.slice(1),["any"].concat(o.map(Il))):t==="all"?["all"].concat(r.slice(1).map(Il)):t==="none"?["all"].concat(r.slice(1).map(Il).map(Ai)):t==="in"?Is(r[1],r.slice(2)):t==="!in"?Ai(Is(r[1],r.slice(2))):t==="has"?Ps(r[1]):t!=="!has"||Ai(Ps(r[1]));var o}function du(r,t,o){switch(r){case"$type":return[`filter-type-${o}`,t];case"$id":return[`filter-id-${o}`,t];default:return[`filter-${o}`,r,t]}}function Is(r,t){if(t.length===0)return!1;switch(r){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(o=>typeof o!=typeof t[0])?["filter-in-large",r,["literal",t.sort(dm)]]:["filter-in-small",r,["literal",t]]}}function Ps(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Ai(r){return["!",r]}function Oo(r){let t=typeof r;if(t==="number"||t==="boolean"||t==="string"||r==null)return JSON.stringify(r);if(Array.isArray(r)){let d="[";for(let y of r)d+=`${Oo(y)},`;return`${d}]`}let o=Object.keys(r).sort(),l="{";for(let d=0;d<o.length;d++)l+=`${JSON.stringify(o[d])}:${Oo(r[o[d]])},`;return`${l}}`}function Ed(r){let t="";for(let o of zo)t+=`/${Oo(r[o])}`;return t}function Td(r){let t=r.value;return t?[new Pe(r.key,t,"constants have been deprecated as of v8")]:[]}function ni(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Kr(r){if(Array.isArray(r))return r.map(Kr);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){let t={};for(let o in r)t[o]=Kr(r[o]);return t}return ni(r)}function _r(r){let t=r.key,o=r.value,l=r.valueSpec||{},d=r.objectElementValidators||{},y=r.style,_=r.styleSpec,v=r.validateSpec,w=[],S=Tt(o);if(S!=="object")return[new Pe(t,o,`object expected, ${S} found`)];for(let T in o){let z=T.split(".")[0],M=l[z]||l["*"],R;if(d[z])R=d[z];else if(l[z])R=v;else if(d["*"])R=d["*"];else{if(!l["*"]){w.push(new Pe(t,o[T],`unknown property "${T}"`));continue}R=v}w=w.concat(R({key:(t&&`${t}.`)+T,value:o[T],valueSpec:M,style:y,styleSpec:_,object:o,objectKey:T,validateSpec:v},o))}for(let T in l)d[T]||l[T].required&&l[T].default===void 0&&o[T]===void 0&&w.push(new Pe(t,o,`missing required property "${T}"`));return w}function Ms(r){let t=r.value,o=r.valueSpec,l=r.style,d=r.styleSpec,y=r.key,_=r.arrayElementValidator||r.validateSpec;if(Tt(t)!=="array")return[new Pe(y,t,`array expected, ${Tt(t)} found`)];if(o.length&&t.length!==o.length)return[new Pe(y,t,`array length ${o.length} expected, length ${t.length} found`)];if(o["min-length"]&&t.length<o["min-length"])return[new Pe(y,t,`array length at least ${o["min-length"]} expected, length ${t.length} found`)];let v={type:o.value,values:o.values};d.$version<7&&(v.function=o.function),Tt(o.value)==="object"&&(v=o.value);let w=[];for(let S=0;S<t.length;S++)w=w.concat(_({array:t,arrayIndex:S,value:t[S],valueSpec:v,validateSpec:r.validateSpec,style:l,styleSpec:d,key:`${y}[${S}]`}));return w}function pu(r){let t=r.key,o=r.value,l=r.valueSpec,d=Tt(o);return d==="number"&&o!=o&&(d="NaN"),d!=="number"?[new Pe(t,o,`number expected, ${d} found`)]:"minimum"in l&&o<l.minimum?[new Pe(t,o,`${o} is less than the minimum value ${l.minimum}`)]:"maximum"in l&&o>l.maximum?[new Pe(t,o,`${o} is greater than the maximum value ${l.maximum}`)]:[]}function Pl(r){let t=r.valueSpec,o=ni(r.value.type),l,d,y,_={},v=o!=="categorical"&&r.value.property===void 0,w=!v,S=Tt(r.value.stops)==="array"&&Tt(r.value.stops[0])==="array"&&Tt(r.value.stops[0][0])==="object",T=_r({key:r.key,value:r.value,valueSpec:r.styleSpec.function,validateSpec:r.validateSpec,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(R){if(o==="identity")return[new Pe(R.key,R.value,'identity function may not have a "stops" property')];let O=[],V=R.value;return O=O.concat(Ms({key:R.key,value:V,valueSpec:R.valueSpec,validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec,arrayElementValidator:z})),Tt(V)==="array"&&V.length===0&&O.push(new Pe(R.key,V,"array must have at least one stop")),O},default:function(R){return R.validateSpec({key:R.key,value:R.value,valueSpec:t,validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec})}}});return o==="identity"&&v&&T.push(new Pe(r.key,r.value,'missing required property "property"')),o==="identity"||r.value.stops||T.push(new Pe(r.key,r.value,'missing required property "stops"')),o==="exponential"&&r.valueSpec.expression&&!cu(r.valueSpec)&&T.push(new Pe(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(w&&!ya(r.valueSpec)?T.push(new Pe(r.key,r.value,"property functions not supported")):v&&!vd(r.valueSpec)&&T.push(new Pe(r.key,r.value,"zoom functions not supported"))),o!=="categorical"&&!S||r.value.property!==void 0||T.push(new Pe(r.key,r.value,'"property" property is required')),T;function z(R){let O=[],V=R.value,H=R.key;if(Tt(V)!=="array")return[new Pe(H,V,`array expected, ${Tt(V)} found`)];if(V.length!==2)return[new Pe(H,V,`array length 2 expected, length ${V.length} found`)];if(S){if(Tt(V[0])!=="object")return[new Pe(H,V,`object expected, ${Tt(V[0])} found`)];if(V[0].zoom===void 0)return[new Pe(H,V,"object stop key must have zoom")];if(V[0].value===void 0)return[new Pe(H,V,"object stop key must have value")];if(y&&y>ni(V[0].zoom))return[new Pe(H,V[0].zoom,"stop zoom values must appear in ascending order")];ni(V[0].zoom)!==y&&(y=ni(V[0].zoom),d=void 0,_={}),O=O.concat(_r({key:`${H}[0]`,value:V[0],valueSpec:{zoom:{}},validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec,objectElementValidators:{zoom:pu,value:M}}))}else O=O.concat(M({key:`${H}[0]`,value:V[0],valueSpec:{},validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec},V));return Tl(Kr(V[1]))?O.concat([new Pe(`${H}[1]`,V[1],"expressions are not allowed in function stops.")]):O.concat(R.validateSpec({key:`${H}[1]`,value:V[1],valueSpec:t,validateSpec:R.validateSpec,style:R.style,styleSpec:R.styleSpec}))}function M(R,O){let V=Tt(R.value),H=ni(R.value),K=R.value!==null?R.value:O;if(l){if(V!==l)return[new Pe(R.key,K,`${V} stop domain type must match previous stop domain type ${l}`)]}else l=V;if(V!=="number"&&V!=="string"&&V!=="boolean")return[new Pe(R.key,K,"stop domain value must be a number, string, or boolean")];if(V!=="number"&&o!=="categorical"){let he=`number expected, ${V} found`;return ya(t)&&o===void 0&&(he+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Pe(R.key,K,he)]}return o!=="categorical"||V!=="number"||isFinite(H)&&Math.floor(H)===H?o!=="categorical"&&V==="number"&&d!==void 0&&H<d?[new Pe(R.key,K,"stop domain values must appear in ascending order")]:(d=H,o==="categorical"&&H in _?[new Pe(R.key,K,"stop domain values must be unique")]:(_[H]=!0,[])):[new Pe(R.key,K,`integer expected, found ${H}`)]}}function ka(r){let t=(r.expressionContext==="property"?uu:va)(Kr(r.value),r.valueSpec);if(t.result==="error")return t.value.map(l=>new Pe(`${r.key}${l.key}`,r.value,l.message));let o=t.value.expression||t.value._styleExpression.expression;if(r.expressionContext==="property"&&r.propertyKey==="text-font"&&!o.outputDefined())return[new Pe(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if(r.expressionContext==="property"&&r.propertyType==="layout"&&!ma(o))return[new Pe(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if(r.expressionContext==="filter"&&!ma(o))return[new Pe(r.key,r.value,'"feature-state" data expressions are not supported with filters.')];if(r.expressionContext&&r.expressionContext.indexOf("cluster")===0){if(!Cs(o,["zoom","feature-state"]))return[new Pe(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(r.expressionContext==="cluster-initial"&&!Ts(o))return[new Pe(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function jn(r){let t=r.key,o=r.value,l=r.valueSpec,d=[];return Array.isArray(l.values)?l.values.indexOf(ni(o))===-1&&d.push(new Pe(t,o,`expected one of [${l.values.join(", ")}], ${JSON.stringify(o)} found`)):Object.keys(l.values).indexOf(ni(o))===-1&&d.push(new Pe(t,o,`expected one of [${Object.keys(l.values).join(", ")}], ${JSON.stringify(o)} found`)),d}function fu(r){return Cl(Kr(r.value))?ka(gn({},r,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ml(r)}function Ml(r){let t=r.value,o=r.key;if(Tt(t)!=="array")return[new Pe(o,t,`array expected, ${Tt(t)} found`)];let l=r.styleSpec,d,y=[];if(t.length<1)return[new Pe(o,t,"filter array must have at least 1 element")];switch(y=y.concat(jn({key:`${o}[0]`,value:t[0],valueSpec:l.filter_operator,style:r.style,styleSpec:r.styleSpec})),ni(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&ni(t[1])==="$type"&&y.push(new Pe(o,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&y.push(new Pe(o,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(d=Tt(t[1]),d!=="string"&&y.push(new Pe(`${o}[1]`,t[1],`string expected, ${d} found`)));for(let _=2;_<t.length;_++)d=Tt(t[_]),ni(t[1])==="$type"?y=y.concat(jn({key:`${o}[${_}]`,value:t[_],valueSpec:l.geometry_type,style:r.style,styleSpec:r.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&y.push(new Pe(`${o}[${_}]`,t[_],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let _=1;_<t.length;_++)y=y.concat(Ml({key:`${o}[${_}]`,value:t[_],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":d=Tt(t[1]),t.length!==2?y.push(new Pe(o,t,`filter array for "${t[0]}" operator must have 2 elements`)):d!=="string"&&y.push(new Pe(`${o}[1]`,t[1],`string expected, ${d} found`))}return y}function mu(r,t){let o=r.key,l=r.validateSpec,d=r.style,y=r.styleSpec,_=r.value,v=r.objectKey,w=y[`${t}_${r.layerType}`];if(!w)return[];let S=v.match(/^(.*)-transition$/);if(t==="paint"&&S&&w[S[1]]&&w[S[1]].transition)return l({key:o,value:_,valueSpec:y.transition,style:d,styleSpec:y});let T=r.valueSpec||w[v];if(!T)return[new Pe(o,_,`unknown property "${v}"`)];let z;if(Tt(_)==="string"&&ya(T)&&!T.tokens&&(z=/^{([^}]+)}$/.exec(_)))return[new Pe(o,_,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(z[1])} }\`.`)];let M=[];return r.layerType==="symbol"&&(v==="text-field"&&d&&!d.glyphs&&M.push(new Pe(o,_,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&kl(Kr(_))&&ni(_.type)==="identity"&&M.push(new Pe(o,_,'"text-font" does not support identity functions'))),M.concat(l({key:r.key,value:_,valueSpec:T,style:d,styleSpec:y,expressionContext:"property",propertyType:t,propertyKey:v}))}function Al(r){return mu(r,"paint")}function gu(r){return mu(r,"layout")}function yu(r){let t=[],o=r.value,l=r.key,d=r.style,y=r.styleSpec;o.type||o.ref||t.push(new Pe(l,o,'either "type" or "ref" is required'));let _=ni(o.type),v=ni(o.ref);if(o.id){let w=ni(o.id);for(let S=0;S<r.arrayIndex;S++){let T=d.layers[S];ni(T.id)===w&&t.push(new Pe(l,o.id,`duplicate layer id "${o.id}", previously used at line ${T.id.__line__}`))}}if("ref"in o){let w;["type","source","source-layer","filter","layout"].forEach(S=>{S in o&&t.push(new Pe(l,o[S],`"${S}" is prohibited for ref layers`))}),d.layers.forEach(S=>{ni(S.id)===v&&(w=S)}),w?w.ref?t.push(new Pe(l,o.ref,"ref cannot reference another ref layer")):_=ni(w.type):t.push(new Pe(l,o.ref,`ref layer "${v}" not found`))}else if(_!=="background")if(o.source){let w=d.sources&&d.sources[o.source],S=w&&ni(w.type);w?S==="vector"&&_==="raster"?t.push(new Pe(l,o.source,`layer "${o.id}" requires a raster source`)):S!=="raster-dem"&&_==="hillshade"?t.push(new Pe(l,o.source,`layer "${o.id}" requires a raster-dem source`)):S==="raster"&&_!=="raster"?t.push(new Pe(l,o.source,`layer "${o.id}" requires a vector source`)):S!=="vector"||o["source-layer"]?S==="raster-dem"&&_!=="hillshade"?t.push(new Pe(l,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):_!=="line"||!o.paint||!o.paint["line-gradient"]||S==="geojson"&&w.lineMetrics||t.push(new Pe(l,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Pe(l,o,`layer "${o.id}" must specify a "source-layer"`)):t.push(new Pe(l,o.source,`source "${o.source}" not found`))}else t.push(new Pe(l,o,'missing required property "source"'));return t=t.concat(_r({key:l,value:o,valueSpec:y.layer,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,objectElementValidators:{"*":()=>[],type:()=>r.validateSpec({key:`${l}.type`,value:o.type,valueSpec:y.layer.type,style:r.style,styleSpec:r.styleSpec,validateSpec:r.validateSpec,object:o,objectKey:"type"}),filter:fu,layout:w=>_r({layer:o,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":S=>gu(gn({layerType:_},S))}}),paint:w=>_r({layer:o,key:w.key,value:w.value,style:w.style,styleSpec:w.styleSpec,validateSpec:w.validateSpec,objectElementValidators:{"*":S=>Al(gn({layerType:_},S))}})}})),t}function No(r){let t=r.value,o=r.key,l=Tt(t);return l!=="string"?[new Pe(o,t,`string expected, ${l} found`)]:[]}let Ll={promoteId:function({key:r,value:t}){if(Tt(t)==="string")return No({key:r,value:t});{let o=[];for(let l in t)o.push(...No({key:`${r}.${l}`,value:t[l]}));return o}}};function As(r){let t=r.value,o=r.key,l=r.styleSpec,d=r.style,y=r.validateSpec;if(!t.type)return[new Pe(o,t,'"type" is required')];let _=ni(t.type),v;switch(_){case"vector":case"raster":return v=_r({key:o,value:t,valueSpec:l[`source_${_.replace("-","_")}`],style:r.style,styleSpec:l,objectElementValidators:Ll,validateSpec:y}),v;case"raster-dem":return v=function(w){var S;let T=(S=w.sourceName)!==null&&S!==void 0?S:"",z=w.value,M=w.styleSpec,R=M.source_raster_dem,O=w.style,V=[],H=Tt(z);if(z===void 0)return V;if(H!=="object")return V.push(new Pe("source_raster_dem",z,`object expected, ${H} found`)),V;let K=ni(z.encoding)==="custom",he=["redFactor","greenFactor","blueFactor","baseShift"],ie=w.value.encoding?`"${w.value.encoding}"`:"Default";for(let ce in z)!K&&he.includes(ce)?V.push(new Pe(ce,z[ce],`In "${T}": "${ce}" is only valid when "encoding" is set to "custom". ${ie} encoding found`)):R[ce]?V=V.concat(w.validateSpec({key:ce,value:z[ce],valueSpec:R[ce],validateSpec:w.validateSpec,style:O,styleSpec:M})):V.push(new Pe(ce,z[ce],`unknown property "${ce}"`));return V}({sourceName:o,value:t,style:r.style,styleSpec:l,validateSpec:y}),v;case"geojson":if(v=_r({key:o,value:t,valueSpec:l.source_geojson,style:d,styleSpec:l,validateSpec:y,objectElementValidators:Ll}),t.cluster)for(let w in t.clusterProperties){let[S,T]=t.clusterProperties[w],z=typeof S=="string"?[S,["accumulated"],["get",w]]:S;v.push(...ka({key:`${o}.${w}.map`,value:T,validateSpec:y,expressionContext:"cluster-map"})),v.push(...ka({key:`${o}.${w}.reduce`,value:z,validateSpec:y,expressionContext:"cluster-reduce"}))}return v;case"video":return _r({key:o,value:t,valueSpec:l.source_video,style:d,validateSpec:y,styleSpec:l});case"image":return _r({key:o,value:t,valueSpec:l.source_image,style:d,validateSpec:y,styleSpec:l});case"canvas":return[new Pe(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return jn({key:`${o}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:d,validateSpec:y,styleSpec:l})}}function _u(r){let t=r.value,o=r.styleSpec,l=o.light,d=r.style,y=[],_=Tt(t);if(t===void 0)return y;if(_!=="object")return y=y.concat([new Pe("light",t,`object expected, ${_} found`)]),y;for(let v in t){let w=v.match(/^(.*)-transition$/);y=y.concat(w&&l[w[1]]&&l[w[1]].transition?r.validateSpec({key:v,value:t[v],valueSpec:o.transition,validateSpec:r.validateSpec,style:d,styleSpec:o}):l[v]?r.validateSpec({key:v,value:t[v],valueSpec:l[v],validateSpec:r.validateSpec,style:d,styleSpec:o}):[new Pe(v,t[v],`unknown property "${v}"`)])}return y}function vu(r){let t=r.value,o=r.styleSpec,l=o.sky,d=r.style,y=Tt(t);if(t===void 0)return[];if(y!=="object")return[new Pe("sky",t,`object expected, ${y} found`)];let _=[];for(let v in t)_=_.concat(l[v]?r.validateSpec({key:v,value:t[v],valueSpec:l[v],style:d,styleSpec:o}):[new Pe(v,t[v],`unknown property "${v}"`)]);return _}function xu(r){let t=r.value,o=r.styleSpec,l=o.terrain,d=r.style,y=[],_=Tt(t);if(t===void 0)return y;if(_!=="object")return y=y.concat([new Pe("terrain",t,`object expected, ${_} found`)]),y;for(let v in t)y=y.concat(l[v]?r.validateSpec({key:v,value:t[v],valueSpec:l[v],validateSpec:r.validateSpec,style:d,styleSpec:o}):[new Pe(v,t[v],`unknown property "${v}"`)]);return y}function wu(r){let t=[],o=r.value,l=r.key;if(Array.isArray(o)){let d=[],y=[];for(let _ in o)o[_].id&&d.includes(o[_].id)&&t.push(new Pe(l,o,`all the sprites' ids must be unique, but ${o[_].id} is duplicated`)),d.push(o[_].id),o[_].url&&y.includes(o[_].url)&&t.push(new Pe(l,o,`all the sprites' URLs must be unique, but ${o[_].url} is duplicated`)),y.push(o[_].url),t=t.concat(_r({key:`${l}[${_}]`,value:o[_],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:r.validateSpec}));return t}return No({key:l,value:o})}let Dl={"*":()=>[],array:Ms,boolean:function(r){let t=r.value,o=r.key,l=Tt(t);return l!=="boolean"?[new Pe(o,t,`boolean expected, ${l} found`)]:[]},number:pu,color:function(r){let t=r.key,o=r.value,l=Tt(o);return l!=="string"?[new Pe(t,o,`color expected, ${l} found`)]:Lt.parse(String(o))?[]:[new Pe(t,o,`color expected, "${o}" found`)]},constants:Td,enum:jn,filter:fu,function:Pl,layer:yu,object:_r,source:As,light:_u,sky:vu,terrain:xu,projection:function(r){let t=r.value,o=r.styleSpec,l=o.projection,d=r.style,y=Tt(t);if(t===void 0)return[];if(y!=="object")return[new Pe("projection",t,`object expected, ${y} found`)];let _=[];for(let v in t)_=_.concat(l[v]?r.validateSpec({key:v,value:t[v],valueSpec:l[v],style:d,styleSpec:o}):[new Pe(v,t[v],`unknown property "${v}"`)]);return _},string:No,formatted:function(r){return No(r).length===0?[]:ka(r)},resolvedImage:function(r){return No(r).length===0?[]:ka(r)},padding:function(r){let t=r.key,o=r.value;if(Tt(o)==="array"){if(o.length<1||o.length>4)return[new Pe(t,o,`padding requires 1 to 4 values; ${o.length} values found`)];let l={type:"number"},d=[];for(let y=0;y<o.length;y++)d=d.concat(r.validateSpec({key:`${t}[${y}]`,value:o[y],validateSpec:r.validateSpec,valueSpec:l}));return d}return pu({key:t,value:o,valueSpec:{}})},variableAnchorOffsetCollection:function(r){let t=r.key,o=r.value,l=Tt(o),d=r.styleSpec;if(l!=="array"||o.length<1||o.length%2!=0)return[new Pe(t,o,"variableAnchorOffsetCollection requires a non-empty array of even length")];let y=[];for(let _=0;_<o.length;_+=2)y=y.concat(jn({key:`${t}[${_}]`,value:o[_],valueSpec:d.layout_symbol["text-anchor"]})),y=y.concat(Ms({key:`${t}[${_+1}]`,value:o[_+1],valueSpec:{length:2,value:"number"},validateSpec:r.validateSpec,style:r.style,styleSpec:d}));return y},sprite:wu};function Sa(r){let t=r.value,o=r.valueSpec,l=r.styleSpec;return r.validateSpec=Sa,o.expression&&kl(ni(t))?Pl(r):o.expression&&Tl(Kr(t))?ka(r):o.type&&Dl[o.type]?Dl[o.type](r):_r(gn({},r,{valueSpec:o.type?l[o.type]:o}))}function Cd(r){let t=r.value,o=r.key,l=No(r);return l.length||(t.indexOf("{fontstack}")===-1&&l.push(new Pe(o,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&l.push(new Pe(o,t,'"glyphs" url must include a "{range}" token'))),l}function Mr(r,t=ye){let o=[];return o=o.concat(Sa({key:"",value:r,valueSpec:t.$root,styleSpec:t,style:r,validateSpec:Sa,objectElementValidators:{glyphs:Cd,"*":()=>[]}})),r.constants&&(o=o.concat(Td({key:"constants",value:r.constants,style:r,styleSpec:t,validateSpec:Sa}))),bu(o)}function wn(r){return function(t){return r({...t,validateSpec:Sa})}}function bu(r){return[].concat(r).sort((t,o)=>t.line-o.line)}function Jr(r){return function(...t){return bu(r.apply(this,t))}}Mr.source=Jr(wn(As)),Mr.sprite=Jr(wn(wu)),Mr.glyphs=Jr(wn(Cd)),Mr.light=Jr(wn(_u)),Mr.sky=Jr(wn(vu)),Mr.terrain=Jr(wn(xu)),Mr.layer=Jr(wn(yu)),Mr.filter=Jr(wn(fu)),Mr.paintProperty=Jr(wn(Al)),Mr.layoutProperty=Jr(wn(gu));let jo=Mr,pm=jo.light,fm=jo.sky,zd=jo.paintProperty,Id=jo.layoutProperty;function ku(r,t){let o=!1;if(t&&t.length)for(let l of t)r.fire(new ro(new Error(l.message))),o=!0;return o}class Ea{constructor(t,o,l){let d=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;let _=new Int32Array(this.arrayBuffer);t=_[0],this.d=(o=_[1])+2*(l=_[2]);for(let w=0;w<this.d*this.d;w++){let S=_[3+w],T=_[3+w+1];d.push(S===T?null:_.subarray(S,T))}let v=_[3+d.length+1];this.keys=_.subarray(_[3+d.length],v),this.bboxes=_.subarray(v),this.insert=this._insertReadonly}else{this.d=o+2*l;for(let _=0;_<this.d*this.d;_++)d.push([]);this.keys=[],this.bboxes=[]}this.n=o,this.extent=t,this.padding=l,this.scale=o/t,this.uid=0;let y=l/o*t;this.min=-y,this.max=t+y}insert(t,o,l,d,y){this._forEachCell(o,l,d,y,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(d),this.bboxes.push(y)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,o,l,d,y,_){this.cells[y].push(_)}query(t,o,l,d,y){let _=this.min,v=this.max;if(t<=_&&o<=_&&v<=l&&v<=d&&!y)return Array.prototype.slice.call(this.keys);{let w=[];return this._forEachCell(t,o,l,d,this._queryCell,w,{},y),w}}_queryCell(t,o,l,d,y,_,v,w){let S=this.cells[y];if(S!==null){let T=this.keys,z=this.bboxes;for(let M=0;M<S.length;M++){let R=S[M];if(v[R]===void 0){let O=4*R;(w?w(z[O+0],z[O+1],z[O+2],z[O+3]):t<=z[O+2]&&o<=z[O+3]&&l>=z[O+0]&&d>=z[O+1])?(v[R]=!0,_.push(T[R])):v[R]=!1}}}}_forEachCell(t,o,l,d,y,_,v,w){let S=this._convertToCellCoord(t),T=this._convertToCellCoord(o),z=this._convertToCellCoord(l),M=this._convertToCellCoord(d);for(let R=S;R<=z;R++)for(let O=T;O<=M;O++){let V=this.d*O+R;if((!w||w(this._convertFromCellCoord(R),this._convertFromCellCoord(O),this._convertFromCellCoord(R+1),this._convertFromCellCoord(O+1)))&&y.call(this,t,o,l,d,V,_,v,w))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let t=this.cells,o=3+this.cells.length+1+1,l=0;for(let _=0;_<this.cells.length;_++)l+=this.cells[_].length;let d=new Int32Array(o+l+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let y=o;for(let _=0;_<t.length;_++){let v=t[_];d[3+_]=y,d.set(v,y),y+=v.length}return d[3+t.length]=y,d.set(this.keys,y),y+=this.keys.length,d[3+t.length+1]=y,d.set(this.bboxes,y),y+=this.bboxes.length,d.buffer}static serialize(t,o){let l=t.toArrayBuffer();return o&&o.push(l),{buffer:l}}static deserialize(t){return new Ea(t.buffer)}}let Ar={};function Ze(r,t,o={}){if(Ar[r])throw new Error(`${r} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:r,writeable:!1}),Ar[r]={klass:t,omit:o.omit||[],shallow:o.shallow||[]}}Ze("Object",Object),Ze("TransferableGridIndex",Ea),Ze("Color",Lt),Ze("Error",Error),Ze("AJAXError",fr),Ze("ResolvedImage",yr),Ze("StylePropertyFunction",ba),Ze("StyleExpression",El,{omit:["_evaluator"]}),Ze("ZoomDependentExpression",wa),Ze("ZoomConstantExpression",xa),Ze("CompoundExpression",Pr,{omit:["_evaluate"]});for(let r in fa)fa[r]._classRegistryKey||Ze(`Expression_${r}`,fa[r]);function Rl(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&r.constructor.name==="ArrayBuffer")}function Su(r){return r.$name||r.constructor._classRegistryKey}function Pd(r){return!function(t){if(t===null||typeof t!="object")return!1;let o=Su(t);return!(!o||o==="Object")}(r)&&(r==null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||r instanceof Blob||r instanceof Error||Rl(r)||fn(r)||ArrayBuffer.isView(r)||r instanceof ImageData)}function Ta(r,t){if(Pd(r))return(Rl(r)||fn(r))&&t&&t.push(r),ArrayBuffer.isView(r)&&t&&t.push(r.buffer),r instanceof ImageData&&t&&t.push(r.data.buffer),r;if(Array.isArray(r)){let y=[];for(let _ of r)y.push(Ta(_,t));return y}if(typeof r!="object")throw new Error("can't serialize object of type "+typeof r);let o=Su(r);if(!o)throw new Error(`can't serialize object of unregistered class ${r.constructor.name}`);if(!Ar[o])throw new Error(`${o} is not registered.`);let{klass:l}=Ar[o],d=l.serialize?l.serialize(r,t):{};if(l.serialize){if(t&&d===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let y in r){if(!r.hasOwnProperty(y)||Ar[o].omit.indexOf(y)>=0)continue;let _=r[y];d[y]=Ar[o].shallow.indexOf(y)>=0?_:Ta(_,t)}r instanceof Error&&(d.message=r.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return o!=="Object"&&(d.$name=o),d}function Ca(r){if(Pd(r))return r;if(Array.isArray(r))return r.map(Ca);if(typeof r!="object")throw new Error("can't deserialize object of type "+typeof r);let t=Su(r)||"Object";if(!Ar[t])throw new Error(`can't deserialize unregistered class ${t}`);let{klass:o}=Ar[t];if(!o)throw new Error(`can't deserialize unregistered class ${t}`);if(o.deserialize)return o.deserialize(r);let l=Object.create(o.prototype);for(let d of Object.keys(r)){if(d==="$name")continue;let y=r[d];l[d]=Ar[t].shallow.indexOf(d)>=0?y:Ca(y)}return l}class Eu{constructor(){this.first=!0}update(t,o){let l=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=l,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=l,!0):(this.lastFloorZoom>l?(this.lastIntegerZoom=l+1,this.lastIntegerZoomTime=o):this.lastFloorZoom<l&&(this.lastIntegerZoom=l,this.lastIntegerZoomTime=o),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=l,!0))}}let xt={"Latin-1 Supplement":r=>r>=128&&r<=255,"Hangul Jamo":r=>r>=4352&&r<=4607,Khmer:r=>r>=6016&&r<=6143,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Katakana:r=>r>=12448&&r<=12543,Kanbun:r=>r>=12688&&r<=12703,"CJK Strokes":r=>r>=12736&&r<=12783,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"Private Use Area":r=>r>=57344&&r<=63743,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function Tu(r){for(let t of r)if(zu(t.charCodeAt(0)))return!0;return!1}function mm(r){for(let t of r)if(!za(t.charCodeAt(0)))return!1;return!0}function Cu(r){let t=r.map(o=>{try{return new RegExp(`\\p{sc=${o}}`,"u").source}catch{return null}}).filter(o=>o);return new RegExp(t.join("|"),"u")}let gm=Cu(["Arab","Dupl","Mong","Ougr","Syrc"]);function za(r){return!gm.test(String.fromCodePoint(r))}let Md=Cu(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function zu(r){return!(r!==746&&r!==747&&(r<4352||!(xt["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||xt["CJK Compatibility"](r)||xt["CJK Strokes"](r)||!(!xt["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||r===12336)||xt["Enclosed CJK Letters and Months"](r)||xt["Ideographic Description Characters"](r)||xt.Kanbun(r)||xt.Katakana(r)&&r!==12540||!(!xt["Halfwidth and Fullwidth Forms"](r)||r===65288||r===65289||r===65293||r>=65306&&r<=65310||r===65339||r===65341||r===65343||r>=65371&&r<=65503||r===65507||r>=65512&&r<=65519)||!(!xt["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||xt["Vertical Forms"](r)||xt["Yijing Hexagram Symbols"](r)||/\p{sc=Cans}/u.test(String.fromCodePoint(r))||/\p{sc=Hang}/u.test(String.fromCodePoint(r))||Md.test(String.fromCodePoint(r)))))}function Ad(r){return!(zu(r)||function(t){return!!(xt["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||xt["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||xt["Letterlike Symbols"](t)||xt["Number Forms"](t)||xt["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||xt["Control Pictures"](t)&&t!==9251||xt["Optical Character Recognition"](t)||xt["Enclosed Alphanumerics"](t)||xt["Geometric Shapes"](t)||xt["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||xt["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||xt["CJK Symbols and Punctuation"](t)||xt.Katakana(t)||xt["Private Use Area"](t)||xt["CJK Compatibility Forms"](t)||xt["Small Form Variants"](t)||xt["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(r))}let ym=Cu(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Iu(r){return ym.test(String.fromCodePoint(r))}function _m(r,t){return!(!t&&Iu(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||xt.Khmer(r))}function vm(r){for(let t of r)if(Iu(t.charCodeAt(0)))return!0;return!1}let vr=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(r){this.pluginStatus=r.pluginStatus,this.pluginURL=r.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(r){this.applyArabicShaping=r.applyArabicShaping,this.processBidirectionalText=r.processBidirectionalText,this.processStyledBidirectionalText=r.processStyledBidirectionalText}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class Ut{constructor(t,o){this.zoom=t,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.zoomHistory=o.zoomHistory,this.transition=o.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Eu,this.transition={})}isSupportedScript(t){return function(o,l){for(let d of o)if(!_m(d.charCodeAt(0),l))return!1;return!0}(t,vr.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let t=this.zoom,o=t-Math.floor(t),l=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:o+(1-o)*l}:{fromScale:.5,toScale:1,t:1-(1-l)*o}}}class Ia{constructor(t,o){this.property=t,this.value=o,this.expression=function(l,d){if(kl(l))return new ba(l,d);if(Tl(l)){let y=uu(l,d);if(y.result==="error")throw new Error(y.value.map(_=>`${_.key}: ${_.message}`).join(", "));return y.value}{let y=l;return d.type==="color"&&typeof l=="string"?y=Lt.parse(l):d.type!=="padding"||typeof l!="number"&&!Array.isArray(l)?d.type==="variableAnchorOffsetCollection"&&Array.isArray(l)&&(y=Ir.parse(l)):y=gr.parse(l),{kind:"constant",evaluate:()=>y}}}(o===void 0?t.specification.default:o,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,o,l){return this.property.possiblyEvaluate(this,t,o,l)}}class Fl{constructor(t){this.property=t,this.value=new Ia(t,void 0)}transitioned(t,o){return new Ld(this.property,this.value,o,Ie({},t.transition,this.transition),t.now)}untransitioned(){return new Ld(this.property,this.value,null,{},0)}}class Bl{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return ct(this._values[t].value.value)}setValue(t,o){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Fl(this._values[t].property)),this._values[t].value=new Ia(this._values[t].property,o===null?void 0:ct(o))}getTransition(t){return ct(this._values[t].transition)}setTransition(t,o){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new Fl(this._values[t].property)),this._values[t].transition=ct(o)||void 0}serialize(){let t={};for(let o of Object.keys(this._values)){let l=this.getValue(o);l!==void 0&&(t[o]=l);let d=this.getTransition(o);d!==void 0&&(t[`${o}-transition`]=d)}return t}transitioned(t,o){let l=new Ls(this._properties);for(let d of Object.keys(this._values))l._values[d]=this._values[d].transitioned(t,o._values[d]);return l}untransitioned(){let t=new Ls(this._properties);for(let o of Object.keys(this._values))t._values[o]=this._values[o].untransitioned();return t}}class Ld{constructor(t,o,l,d,y){this.property=t,this.value=o,this.begin=y+d.delay||0,this.end=this.begin+d.duration||0,t.specification.transition&&(d.delay||d.duration)&&(this.prior=l)}possiblyEvaluate(t,o,l){let d=t.now||0,y=this.value.possiblyEvaluate(t,o,l),_=this.prior;if(_){if(d>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(d<this.begin)return _.possiblyEvaluate(t,o,l);{let v=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(t,o,l),y,function(w){if(w<=0)return 0;if(w>=1)return 1;let S=w*w,T=S*w;return 4*(w<.5?T:3*(w-S)+T-.75)}(v))}}return y}}class Ls{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,o,l){let d=new Rs(this._properties);for(let y of Object.keys(this._values))d._values[y]=this._values[y].possiblyEvaluate(t,o,l);return d}hasTransition(){for(let t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Ds{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return ct(this._values[t].value)}setValue(t,o){this._values[t]=new Ia(this._values[t].property,o===null?void 0:ct(o))}serialize(){let t={};for(let o of Object.keys(this._values)){let l=this.getValue(o);l!==void 0&&(t[o]=l)}return t}possiblyEvaluate(t,o,l){let d=new Rs(this._properties);for(let y of Object.keys(this._values))d._values[y]=this._values[y].possiblyEvaluate(t,o,l);return d}}class bn{constructor(t,o,l){this.property=t,this.value=o,this.parameters=l}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,o,l,d){return this.property.evaluate(this.value,this.parameters,t,o,l,d)}}class Rs{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class We{constructor(t){this.specification=t}possiblyEvaluate(t,o){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(o)}interpolate(t,o,l){let d=Qi[this.specification.type];return d?d(t,o,l):t}}class ot{constructor(t,o){this.specification=t,this.overrides=o}possiblyEvaluate(t,o,l,d){return new bn(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(o,null,{},l,d)}:t.expression,o)}interpolate(t,o,l){if(t.value.kind!=="constant"||o.value.kind!=="constant")return t;if(t.value.value===void 0||o.value.value===void 0)return new bn(this,{kind:"constant",value:void 0},t.parameters);let d=Qi[this.specification.type];if(d){let y=d(t.value.value,o.value.value,l);return new bn(this,{kind:"constant",value:y},t.parameters)}return t}evaluate(t,o,l,d,y,_){return t.kind==="constant"?t.value:t.evaluate(o,l,d,y,_)}}class Ol extends ot{possiblyEvaluate(t,o,l,d){if(t.value===void 0)return new bn(this,{kind:"constant",value:void 0},o);if(t.expression.kind==="constant"){let y=t.expression.evaluate(o,null,{},l,d),_=t.property.specification.type==="resolvedImage"&&typeof y!="string"?y.name:y,v=this._calculate(_,_,_,o);return new bn(this,{kind:"constant",value:v},o)}if(t.expression.kind==="camera"){let y=this._calculate(t.expression.evaluate({zoom:o.zoom-1}),t.expression.evaluate({zoom:o.zoom}),t.expression.evaluate({zoom:o.zoom+1}),o);return new bn(this,{kind:"constant",value:y},o)}return new bn(this,t.expression,o)}evaluate(t,o,l,d,y,_){if(t.kind==="source"){let v=t.evaluate(o,l,d,y,_);return this._calculate(v,v,v,o)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(o.zoom)-1},l,d),t.evaluate({zoom:Math.floor(o.zoom)},l,d),t.evaluate({zoom:Math.floor(o.zoom)+1},l,d),o):t.value}_calculate(t,o,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:o}:{from:l,to:o}}interpolate(t){return t}}class Nl{constructor(t){this.specification=t}possiblyEvaluate(t,o,l,d){if(t.value!==void 0){if(t.expression.kind==="constant"){let y=t.expression.evaluate(o,null,{},l,d);return this._calculate(y,y,y,o)}return this._calculate(t.expression.evaluate(new Ut(Math.floor(o.zoom-1),o)),t.expression.evaluate(new Ut(Math.floor(o.zoom),o)),t.expression.evaluate(new Ut(Math.floor(o.zoom+1),o)),o)}}_calculate(t,o,l,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:t,to:o}:{from:l,to:o}}interpolate(t){return t}}class Pu{constructor(t){this.specification=t}possiblyEvaluate(t,o,l,d){return!!t.expression.evaluate(o,null,{},l,d)}interpolate(){return!1}}class g{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let o in t){let l=t[o];l.specification.overridable&&this.overridableProperties.push(o);let d=this.defaultPropertyValues[o]=new Ia(l,void 0),y=this.defaultTransitionablePropertyValues[o]=new Fl(l);this.defaultTransitioningPropertyValues[o]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[o]=d.possiblyEvaluate({})}}}Ze("DataDrivenProperty",ot),Ze("DataConstantProperty",We),Ze("CrossFadedDataDrivenProperty",Ol),Ze("CrossFadedProperty",Nl),Ze("ColorRampProperty",Pu);let e="-transition";class a extends aa{constructor(t,o){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),o.layout&&(this._unevaluatedLayout=new Ds(o.layout)),o.paint)){this._transitionablePaint=new Bl(o.paint);for(let l in t.paint)this.setPaintProperty(l,t.paint[l],{validate:!1});for(let l in t.layout)this.setLayoutProperty(l,t.layout[l],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Rs(o.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,o,l={}){o!=null&&this._validate(Id,`layers.${this.id}.layout.${t}`,t,o,l)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,o):this.visibility=o)}getPaintProperty(t){return t.endsWith(e)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,o,l={}){if(o!=null&&this._validate(zd,`layers.${this.id}.paint.${t}`,t,o,l))return!1;if(t.endsWith(e))return this._transitionablePaint.setTransition(t.slice(0,-11),o||void 0),!1;{let d=this._transitionablePaint._values[t],y=d.property.specification["property-type"]==="cross-faded-data-driven",_=d.value.isDataDriven(),v=d.value;this._transitionablePaint.setValue(t,o),this._handleSpecialPaintPropertyUpdate(t);let w=this._transitionablePaint._values[t].value;return w.isDataDriven()||_||y||this._handleOverridablePaintPropertyUpdate(t,v,w)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,o,l){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,o){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,o)}serialize(){let t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),rt(t,(o,l)=>!(o===void 0||l==="layout"&&!Object.keys(o).length||l==="paint"&&!Object.keys(o).length))}_validate(t,o,l,d,y={}){return(!y||y.validate!==!1)&&ku(this,t.call(jo,{key:o,layerType:this.type,objectKey:l,value:d,styleSpec:ye,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let t in this.paint._values){let o=this.paint.get(t);if(o instanceof bn&&ya(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}}let u={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class h{constructor(t,o){this._structArray=t,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class m{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,o){return t._trim(),o&&(t.isTransferred=!0,o.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){let o=Object.create(this.prototype);return o.arrayBuffer=t.arrayBuffer,o.length=t.length,o.capacity=t.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function x(r,t=1){let o=0,l=0;return{members:r.map(d=>{let y=u[d.type].BYTES_PER_ELEMENT,_=o=b(o,Math.max(t,y)),v=d.components||1;return l=Math.max(l,y),o+=y*v,{name:d.name,type:d.type,components:v,offset:_}}),size:b(o,Math.max(l,t)),alignment:t}}function b(r,t){return Math.ceil(r/t)*t}class k extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o){let l=this.length;return this.resize(l+1),this.emplace(l,t,o)}emplace(t,o,l){let d=2*t;return this.int16[d+0]=o,this.int16[d+1]=l,t}}k.prototype.bytesPerElement=4,Ze("StructArrayLayout2i4",k);class C extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l){let d=this.length;return this.resize(d+1),this.emplace(d,t,o,l)}emplace(t,o,l,d){let y=3*t;return this.int16[y+0]=o,this.int16[y+1]=l,this.int16[y+2]=d,t}}C.prototype.bytesPerElement=6,Ze("StructArrayLayout3i6",C);class I extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,d){let y=this.length;return this.resize(y+1),this.emplace(y,t,o,l,d)}emplace(t,o,l,d,y){let _=4*t;return this.int16[_+0]=o,this.int16[_+1]=l,this.int16[_+2]=d,this.int16[_+3]=y,t}}I.prototype.bytesPerElement=8,Ze("StructArrayLayout4i8",I);class P extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,d,y,_){let v=this.length;return this.resize(v+1),this.emplace(v,t,o,l,d,y,_)}emplace(t,o,l,d,y,_,v){let w=6*t;return this.int16[w+0]=o,this.int16[w+1]=l,this.int16[w+2]=d,this.int16[w+3]=y,this.int16[w+4]=_,this.int16[w+5]=v,t}}P.prototype.bytesPerElement=12,Ze("StructArrayLayout2i4i12",P);class F extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,d,y,_){let v=this.length;return this.resize(v+1),this.emplace(v,t,o,l,d,y,_)}emplace(t,o,l,d,y,_,v){let w=4*t,S=8*t;return this.int16[w+0]=o,this.int16[w+1]=l,this.uint8[S+4]=d,this.uint8[S+5]=y,this.uint8[S+6]=_,this.uint8[S+7]=v,t}}F.prototype.bytesPerElement=8,Ze("StructArrayLayout2i4ub8",F);class U extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o){let l=this.length;return this.resize(l+1),this.emplace(l,t,o)}emplace(t,o,l){let d=2*t;return this.float32[d+0]=o,this.float32[d+1]=l,t}}U.prototype.bytesPerElement=8,Ze("StructArrayLayout2f8",U);class $ extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,l,d,y,_,v,w,S,T){let z=this.length;return this.resize(z+1),this.emplace(z,t,o,l,d,y,_,v,w,S,T)}emplace(t,o,l,d,y,_,v,w,S,T,z){let M=10*t;return this.uint16[M+0]=o,this.uint16[M+1]=l,this.uint16[M+2]=d,this.uint16[M+3]=y,this.uint16[M+4]=_,this.uint16[M+5]=v,this.uint16[M+6]=w,this.uint16[M+7]=S,this.uint16[M+8]=T,this.uint16[M+9]=z,t}}$.prototype.bytesPerElement=20,Ze("StructArrayLayout10ui20",$);class W extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,l,d,y,_,v,w,S,T,z,M){let R=this.length;return this.resize(R+1),this.emplace(R,t,o,l,d,y,_,v,w,S,T,z,M)}emplace(t,o,l,d,y,_,v,w,S,T,z,M,R){let O=12*t;return this.int16[O+0]=o,this.int16[O+1]=l,this.int16[O+2]=d,this.int16[O+3]=y,this.uint16[O+4]=_,this.uint16[O+5]=v,this.uint16[O+6]=w,this.uint16[O+7]=S,this.int16[O+8]=T,this.int16[O+9]=z,this.int16[O+10]=M,this.int16[O+11]=R,t}}W.prototype.bytesPerElement=24,Ze("StructArrayLayout4i4ui4i24",W);class J extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,l){let d=this.length;return this.resize(d+1),this.emplace(d,t,o,l)}emplace(t,o,l,d){let y=3*t;return this.float32[y+0]=o,this.float32[y+1]=l,this.float32[y+2]=d,t}}J.prototype.bytesPerElement=12,Ze("StructArrayLayout3f12",J);class Y extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){let o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint32[1*t+0]=o,t}}Y.prototype.bytesPerElement=4,Ze("StructArrayLayout1ul4",Y);class te extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,l,d,y,_,v,w,S){let T=this.length;return this.resize(T+1),this.emplace(T,t,o,l,d,y,_,v,w,S)}emplace(t,o,l,d,y,_,v,w,S,T){let z=10*t,M=5*t;return this.int16[z+0]=o,this.int16[z+1]=l,this.int16[z+2]=d,this.int16[z+3]=y,this.int16[z+4]=_,this.int16[z+5]=v,this.uint32[M+3]=w,this.uint16[z+8]=S,this.uint16[z+9]=T,t}}te.prototype.bytesPerElement=20,Ze("StructArrayLayout6i1ul2ui20",te);class Z extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,d,y,_){let v=this.length;return this.resize(v+1),this.emplace(v,t,o,l,d,y,_)}emplace(t,o,l,d,y,_,v){let w=6*t;return this.int16[w+0]=o,this.int16[w+1]=l,this.int16[w+2]=d,this.int16[w+3]=y,this.int16[w+4]=_,this.int16[w+5]=v,t}}Z.prototype.bytesPerElement=12,Ze("StructArrayLayout2i2i2i12",Z);class oe extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,d,y){let _=this.length;return this.resize(_+1),this.emplace(_,t,o,l,d,y)}emplace(t,o,l,d,y,_){let v=4*t,w=8*t;return this.float32[v+0]=o,this.float32[v+1]=l,this.float32[v+2]=d,this.int16[w+6]=y,this.int16[w+7]=_,t}}oe.prototype.bytesPerElement=16,Ze("StructArrayLayout2f1f2i16",oe);class le extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,l,d,y,_){let v=this.length;return this.resize(v+1),this.emplace(v,t,o,l,d,y,_)}emplace(t,o,l,d,y,_,v){let w=16*t,S=4*t,T=8*t;return this.uint8[w+0]=o,this.uint8[w+1]=l,this.float32[S+1]=d,this.float32[S+2]=y,this.int16[T+6]=_,this.int16[T+7]=v,t}}le.prototype.bytesPerElement=16,Ze("StructArrayLayout2ub2f2i16",le);class pe extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,l){let d=this.length;return this.resize(d+1),this.emplace(d,t,o,l)}emplace(t,o,l,d){let y=3*t;return this.uint16[y+0]=o,this.uint16[y+1]=l,this.uint16[y+2]=d,t}}pe.prototype.bytesPerElement=6,Ze("StructArrayLayout3ui6",pe);class ke extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,l,d,y,_,v,w,S,T,z,M,R,O,V,H,K){let he=this.length;return this.resize(he+1),this.emplace(he,t,o,l,d,y,_,v,w,S,T,z,M,R,O,V,H,K)}emplace(t,o,l,d,y,_,v,w,S,T,z,M,R,O,V,H,K,he){let ie=24*t,ce=12*t,_e=48*t;return this.int16[ie+0]=o,this.int16[ie+1]=l,this.uint16[ie+2]=d,this.uint16[ie+3]=y,this.uint32[ce+2]=_,this.uint32[ce+3]=v,this.uint32[ce+4]=w,this.uint16[ie+10]=S,this.uint16[ie+11]=T,this.uint16[ie+12]=z,this.float32[ce+7]=M,this.float32[ce+8]=R,this.uint8[_e+36]=O,this.uint8[_e+37]=V,this.uint8[_e+38]=H,this.uint32[ce+10]=K,this.int16[ie+22]=he,t}}ke.prototype.bytesPerElement=48,Ze("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ke);class ze extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,l,d,y,_,v,w,S,T,z,M,R,O,V,H,K,he,ie,ce,_e,Ce,Ue,nt,je,Oe,Je,He){let $e=this.length;return this.resize($e+1),this.emplace($e,t,o,l,d,y,_,v,w,S,T,z,M,R,O,V,H,K,he,ie,ce,_e,Ce,Ue,nt,je,Oe,Je,He)}emplace(t,o,l,d,y,_,v,w,S,T,z,M,R,O,V,H,K,he,ie,ce,_e,Ce,Ue,nt,je,Oe,Je,He,$e){let we=32*t,Qe=16*t;return this.int16[we+0]=o,this.int16[we+1]=l,this.int16[we+2]=d,this.int16[we+3]=y,this.int16[we+4]=_,this.int16[we+5]=v,this.int16[we+6]=w,this.int16[we+7]=S,this.uint16[we+8]=T,this.uint16[we+9]=z,this.uint16[we+10]=M,this.uint16[we+11]=R,this.uint16[we+12]=O,this.uint16[we+13]=V,this.uint16[we+14]=H,this.uint16[we+15]=K,this.uint16[we+16]=he,this.uint16[we+17]=ie,this.uint16[we+18]=ce,this.uint16[we+19]=_e,this.uint16[we+20]=Ce,this.uint16[we+21]=Ue,this.uint16[we+22]=nt,this.uint32[Qe+12]=je,this.float32[Qe+13]=Oe,this.float32[Qe+14]=Je,this.uint16[we+30]=He,this.uint16[we+31]=$e,t}}ze.prototype.bytesPerElement=64,Ze("StructArrayLayout8i15ui1ul2f2ui64",ze);class Ne extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){let o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.float32[1*t+0]=o,t}}Ne.prototype.bytesPerElement=4,Ze("StructArrayLayout1f4",Ne);class qe extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,l){let d=this.length;return this.resize(d+1),this.emplace(d,t,o,l)}emplace(t,o,l,d){let y=3*t;return this.uint16[6*t+0]=o,this.float32[y+1]=l,this.float32[y+2]=d,t}}qe.prototype.bytesPerElement=12,Ze("StructArrayLayout1ui2f12",qe);class Re extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,l){let d=this.length;return this.resize(d+1),this.emplace(d,t,o,l)}emplace(t,o,l,d){let y=4*t;return this.uint32[2*t+0]=o,this.uint16[y+2]=l,this.uint16[y+3]=d,t}}Re.prototype.bytesPerElement=8,Ze("StructArrayLayout1ul2ui8",Re);class De extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o){let l=this.length;return this.resize(l+1),this.emplace(l,t,o)}emplace(t,o,l){let d=2*t;return this.uint16[d+0]=o,this.uint16[d+1]=l,t}}De.prototype.bytesPerElement=4,Ze("StructArrayLayout2ui4",De);class Xe extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){let o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint16[1*t+0]=o,t}}Xe.prototype.bytesPerElement=2,Ze("StructArrayLayout1ui2",Xe);class ut extends m{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,l,d){let y=this.length;return this.resize(y+1),this.emplace(y,t,o,l,d)}emplace(t,o,l,d,y){let _=4*t;return this.float32[_+0]=o,this.float32[_+1]=l,this.float32[_+2]=d,this.float32[_+3]=y,t}}ut.prototype.bytesPerElement=16,Ze("StructArrayLayout4f16",ut);class Be extends h{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new B(this.anchorPointX,this.anchorPointY)}}Be.prototype.size=20;class Ve extends te{get(t){return new Be(this,t)}}Ze("CollisionBoxArray",Ve);class st extends h{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}st.prototype.size=48;class qt extends ke{get(t){return new st(this,t)}}Ze("PlacedSymbolArray",qt);class ft extends h{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ft.prototype.size=64;class vt extends ze{get(t){return new ft(this,t)}}Ze("SymbolInstanceArray",vt);class $t extends Ne{getoffsetX(t){return this.float32[1*t+0]}}Ze("GlyphOffsetArray",$t);class Li extends C{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Ze("SymbolLineVertexArray",Li);class Yr extends h{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Yr.prototype.size=12;class Zt extends qe{get(t){return new Yr(this,t)}}Ze("TextAnchorOffsetArray",Zt);class tr extends h{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}tr.prototype.size=8;class $i extends Re{get(t){return new tr(this,t)}}Ze("FeatureIndexArray",$i);class Di extends k{}class Zi extends k{}class kn extends k{}class Pa extends P{}class jl extends F{}class Ma extends U{}class Lr extends ${}class Vl extends W{}class Mu extends J{}class Dr extends Y{}class Rr extends Z{}class co extends le{}class Qr extends pe{}class Ci extends De{}let Ri=x([{name:"a_pos",components:2,type:"Int16"}],4),{members:xr}=Ri;class wt{constructor(t=[]){this.segments=t}prepareSegment(t,o,l,d){let y=this.segments[this.segments.length-1];return t>wt.MAX_VERTEX_ARRAY_LENGTH&&Wt(`Max vertices per segment is ${wt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!y||y.vertexLength+t>wt.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==d)&&(y={vertexOffset:o.length,primitiveOffset:l.length,vertexLength:0,primitiveLength:0},d!==void 0&&(y.sortKey=d),this.segments.push(y)),y}get(){return this.segments}destroy(){for(let t of this.segments)for(let o in t.vaos)t.vaos[o].destroy()}static simpleSegment(t,o,l,d){return new wt([{vertexOffset:t,primitiveOffset:o,vertexLength:l,primitiveLength:d,vaos:{},sortKey:0}])}}function Vo(r,t){return 256*(r=ae(Math.floor(r),0,255))+ae(Math.floor(t),0,255)}wt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ze("SegmentVector",wt);let Aa=x([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var La={exports:{}},Dd={exports:{}};Dd.exports=function(r,t){var o,l,d,y,_,v,w,S;for(l=r.length-(o=3&r.length),d=t,_=3432918353,v=461845907,S=0;S<l;)w=255&r.charCodeAt(S)|(255&r.charCodeAt(++S))<<8|(255&r.charCodeAt(++S))<<16|(255&r.charCodeAt(++S))<<24,++S,d=27492+(65535&(y=5*(65535&(d=(d^=w=(65535&(w=(w=(65535&w)*_+(((w>>>16)*_&65535)<<16)&4294967295)<<15|w>>>17))*v+(((w>>>16)*v&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(w=0,o){case 3:w^=(255&r.charCodeAt(S+2))<<16;case 2:w^=(255&r.charCodeAt(S+1))<<8;case 1:d^=w=(65535&(w=(w=(65535&(w^=255&r.charCodeAt(S)))*_+(((w>>>16)*_&65535)<<16)&4294967295)<<15|w>>>17))*v+(((w>>>16)*v&65535)<<16)&4294967295}return d^=r.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0};var xm=Dd.exports,Rd={exports:{}};Rd.exports=function(r,t){for(var o,l=r.length,d=t^l,y=0;l>=4;)o=1540483477*(65535&(o=255&r.charCodeAt(y)|(255&r.charCodeAt(++y))<<8|(255&r.charCodeAt(++y))<<16|(255&r.charCodeAt(++y))<<24))+((1540483477*(o>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),l-=4,++y;switch(l){case 3:d^=(255&r.charCodeAt(y+2))<<16;case 2:d^=(255&r.charCodeAt(y+1))<<8;case 1:d=1540483477*(65535&(d^=255&r.charCodeAt(y)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};var uo=xm,Fd=Rd.exports;La.exports=uo,La.exports.murmur3=uo,La.exports.murmur2=Fd;var Ul=E(La.exports);class Fs{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,o,l,d){this.ids.push(ql(t)),this.positions.push(o,l,d)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let o=ql(t),l=0,d=this.ids.length-1;for(;l<d;){let _=l+d>>1;this.ids[_]>=o?d=_:l=_+1}let y=[];for(;this.ids[l]===o;)y.push({index:this.positions[3*l],start:this.positions[3*l+1],end:this.positions[3*l+2]}),l++;return y}static serialize(t,o){let l=new Float64Array(t.ids),d=new Uint32Array(t.positions);return $l(l,d,0,l.length-1),o&&o.push(l.buffer,d.buffer),{ids:l,positions:d}}static deserialize(t){let o=new Fs;return o.ids=t.ids,o.positions=t.positions,o.indexed=!0,o}}function ql(r){let t=+r;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Ul(String(r))}function $l(r,t,o,l){for(;o<l;){let d=r[o+l>>1],y=o-1,_=l+1;for(;;){do y++;while(r[y]<d);do _--;while(r[_]>d);if(y>=_)break;Da(r,y,_),Da(t,3*y,3*_),Da(t,3*y+1,3*_+1),Da(t,3*y+2,3*_+2)}_-o<l-_?($l(r,t,o,_),o=_+1):($l(r,t,_+1,l),l=_)}}function Da(r,t,o){let l=r[t];r[t]=r[o],r[o]=l}Ze("FeaturePositionMap",Fs);class Bs{constructor(t,o){this.gl=t.gl,this.location=o}}class Bd extends Bs{constructor(t,o){super(t,o),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class dy extends Bs{constructor(t,o){super(t,o),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class py extends Bs{constructor(t,o){super(t,o),this.current=Lt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}let jb=new Float32Array(16);function wm(r){return[Vo(255*r.r,255*r.g),Vo(255*r.b,255*r.a)]}class Au{constructor(t,o,l){this.value=t,this.uniformNames=o.map(d=>`u_${d}`),this.type=l}setUniform(t,o,l){t.set(l.constantOr(this.value))}getBinding(t,o,l){return this.type==="color"?new py(t,o):new Bd(t,o)}}class Zl{constructor(t,o){this.uniformNames=o.map(l=>`u_${l}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,o){this.pixelRatioFrom=o.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=o.tlbr,this.patternTo=t.tlbr}setUniform(t,o,l,d){let y=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;y&&t.set(y)}getBinding(t,o,l){return l.substr(0,9)==="u_pattern"?new dy(t,o):new Bd(t,o)}}class Uo{constructor(t,o,l,d){this.expression=t,this.type=l,this.maxValue=0,this.paintVertexAttributes=o.map(y=>({name:`a_${y}`,type:"Float32",components:l==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(t,o,l,d,y){let _=this.paintVertexArray.length,v=this.expression.evaluate(new Ut(0),o,{},d,[],y);this.paintVertexArray.resize(t),this._setPaintValue(_,t,v)}updatePaintArray(t,o,l,d){let y=this.expression.evaluate({zoom:0},l,d);this._setPaintValue(t,o,y)}_setPaintValue(t,o,l){if(this.type==="color"){let d=wm(l);for(let y=t;y<o;y++)this.paintVertexArray.emplace(y,d[0],d[1])}else{for(let d=t;d<o;d++)this.paintVertexArray.emplace(d,l);this.maxValue=Math.max(this.maxValue,Math.abs(l))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Vn{constructor(t,o,l,d,y,_){this.expression=t,this.uniformNames=o.map(v=>`u_${v}_t`),this.type=l,this.useIntegerZoom=d,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=o.map(v=>({name:`a_${v}`,type:"Float32",components:l==="color"?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(t,o,l,d,y){let _=this.expression.evaluate(new Ut(this.zoom),o,{},d,[],y),v=this.expression.evaluate(new Ut(this.zoom+1),o,{},d,[],y),w=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(w,t,_,v)}updatePaintArray(t,o,l,d){let y=this.expression.evaluate({zoom:this.zoom},l,d),_=this.expression.evaluate({zoom:this.zoom+1},l,d);this._setPaintValue(t,o,y,_)}_setPaintValue(t,o,l,d){if(this.type==="color"){let y=wm(l),_=wm(d);for(let v=t;v<o;v++)this.paintVertexArray.emplace(v,y[0],y[1],_[0],_[1])}else{for(let y=t;y<o;y++)this.paintVertexArray.emplace(y,l,d);this.maxValue=Math.max(this.maxValue,Math.abs(l),Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,o){let l=this.useIntegerZoom?Math.floor(o.zoom):o.zoom,d=ae(this.expression.interpolationFactor(l,this.zoom,this.zoom+1),0,1);t.set(d)}getBinding(t,o,l){return new Bd(t,o)}}class Ra{constructor(t,o,l,d,y,_){this.expression=t,this.type=o,this.useIntegerZoom=l,this.zoom=d,this.layerId=_,this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(t,o,l){let d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(d,t,o.patterns&&o.patterns[this.layerId],l)}updatePaintArray(t,o,l,d,y){this._setPaintValues(t,o,l.patterns&&l.patterns[this.layerId],y)}_setPaintValues(t,o,l,d){if(!d||!l)return;let{min:y,mid:_,max:v}=l,w=d[y],S=d[_],T=d[v];if(w&&S&&T)for(let z=t;z<o;z++)this.zoomInPaintVertexArray.emplace(z,S.tl[0],S.tl[1],S.br[0],S.br[1],w.tl[0],w.tl[1],w.br[0],w.br[1],S.pixelRatio,w.pixelRatio),this.zoomOutPaintVertexArray.emplace(z,S.tl[0],S.tl[1],S.br[0],S.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],S.pixelRatio,T.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Aa.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Aa.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class fy{constructor(t,o,l){this.binders={},this._buffers=[];let d=[];for(let y in t.paint._values){if(!l(y))continue;let _=t.paint.get(y);if(!(_ instanceof bn&&ya(_.property.specification)))continue;let v=Vb(y,t.type),w=_.value,S=_.property.specification.type,T=_.property.useIntegerZoom,z=_.property.specification["property-type"],M=z==="cross-faded"||z==="cross-faded-data-driven";if(w.kind==="constant")this.binders[y]=M?new Zl(w.value,v):new Au(w.value,v,S),d.push(`/u_${y}`);else if(w.kind==="source"||M){let R=my(y,S,"source");this.binders[y]=M?new Ra(w,S,T,o,R,t.id):new Uo(w,v,S,R),d.push(`/a_${y}`)}else{let R=my(y,S,"composite");this.binders[y]=new Vn(w,v,S,T,o,R),d.push(`/z_${y}`)}}this.cacheKey=d.sort().join("")}getMaxValue(t){let o=this.binders[t];return o instanceof Uo||o instanceof Vn?o.maxValue:0}populatePaintArrays(t,o,l,d,y){for(let _ in this.binders){let v=this.binders[_];(v instanceof Uo||v instanceof Vn||v instanceof Ra)&&v.populatePaintArray(t,o,l,d,y)}}setConstantPatternPositions(t,o){for(let l in this.binders){let d=this.binders[l];d instanceof Zl&&d.setConstantPatternPositions(t,o)}}updatePaintArrays(t,o,l,d,y){let _=!1;for(let v in t){let w=o.getPositions(v);for(let S of w){let T=l.feature(S.index);for(let z in this.binders){let M=this.binders[z];if((M instanceof Uo||M instanceof Vn||M instanceof Ra)&&M.expression.isStateDependent===!0){let R=d.paint.get(z);M.expression=R.value,M.updatePaintArray(S.start,S.end,T,t[v],y),_=!0}}}}return _}defines(){let t=[];for(let o in this.binders){let l=this.binders[o];(l instanceof Au||l instanceof Zl)&&t.push(...l.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return t}getBinderAttributes(){let t=[];for(let o in this.binders){let l=this.binders[o];if(l instanceof Uo||l instanceof Vn)for(let d=0;d<l.paintVertexAttributes.length;d++)t.push(l.paintVertexAttributes[d].name);else if(l instanceof Ra)for(let d=0;d<Aa.members.length;d++)t.push(Aa.members[d].name)}return t}getBinderUniforms(){let t=[];for(let o in this.binders){let l=this.binders[o];if(l instanceof Au||l instanceof Zl||l instanceof Vn)for(let d of l.uniformNames)t.push(d)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,o){let l=[];for(let d in this.binders){let y=this.binders[d];if(y instanceof Au||y instanceof Zl||y instanceof Vn){for(let _ of y.uniformNames)if(o[_]){let v=y.getBinding(t,o[_],_);l.push({name:_,property:d,binding:v})}}}return l}setUniforms(t,o,l,d){for(let{name:y,property:_,binding:v}of o)this.binders[_].setUniform(v,d,l.get(_),y)}updatePaintBuffers(t){this._buffers=[];for(let o in this.binders){let l=this.binders[o];if(t&&l instanceof Ra){let d=t.fromScale===2?l.zoomInPaintVertexBuffer:l.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(l instanceof Uo||l instanceof Vn)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(t){for(let o in this.binders){let l=this.binders[o];(l instanceof Uo||l instanceof Vn||l instanceof Ra)&&l.upload(t)}this.updatePaintBuffers()}destroy(){for(let t in this.binders){let o=this.binders[t];(o instanceof Uo||o instanceof Vn||o instanceof Ra)&&o.destroy()}}}class Os{constructor(t,o,l=()=>!0){this.programConfigurations={};for(let d of t)this.programConfigurations[d.id]=new fy(d,o,l);this.needsUpload=!1,this._featureMap=new Fs,this._bufferOffset=0}populatePaintArrays(t,o,l,d,y,_){for(let v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(t,o,d,y,_);o.id!==void 0&&this._featureMap.add(o.id,l,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,o,l,d){for(let y of l)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(t,this._featureMap,o,y,d)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(let o in this.programConfigurations)this.programConfigurations[o].upload(t);this.needsUpload=!1}}destroy(){for(let t in this.programConfigurations)this.programConfigurations[t].destroy()}}function Vb(r,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[r]||[r.replace(`${t}-`,"").replace(/-/g,"_")]}function my(r,t,o){let l={color:{source:U,composite:ut},number:{source:Ne,composite:U}},d=function(y){return{"line-pattern":{source:Lr,composite:Lr},"fill-pattern":{source:Lr,composite:Lr},"fill-extrusion-pattern":{source:Lr,composite:Lr}}[y]}(r);return d&&d[o]||l[t][o]}Ze("ConstantBinder",Au),Ze("CrossFadedConstantBinder",Zl),Ze("SourceExpressionBinder",Uo),Ze("CrossFadedCompositeBinder",Ra),Ze("CompositeExpressionBinder",Vn),Ze("ProgramConfiguration",fy,{omit:["_buffers"]}),Ze("ProgramConfigurationSet",Os);let fi=8192,bm=Math.pow(2,14)-1,gy=-bm-1;function Ns(r){let t=fi/r.extent,o=r.loadGeometry();for(let l=0;l<o.length;l++){let d=o[l];for(let y=0;y<d.length;y++){let _=d[y],v=Math.round(_.x*t),w=Math.round(_.y*t);_.x=ae(v,gy,bm),_.y=ae(w,gy,bm),(v<_.x||v>_.x+1||w<_.y||w>_.y+1)&&Wt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return o}function js(r,t){return{type:r.type,id:r.id,properties:r.properties,geometry:t?Ns(r):[]}}function Od(r,t,o,l,d){r.emplaceBack(2*t+(l+1)/2,2*o+(d+1)/2)}class km{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Zi,this.indexArray=new Qr,this.segments=new wt,this.programConfigurations=new Os(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,l){let d=this.layers[0],y=[],_=null,v=!1;d.type==="circle"&&(_=d.layout.get("circle-sort-key"),v=!_.isConstant());for(let{feature:w,id:S,index:T,sourceLayerIndex:z}of t){let M=this.layers[0]._featureFilter.needGeometry,R=js(w,M);if(!this.layers[0]._featureFilter.filter(new Ut(this.zoom),R,l))continue;let O=v?_.evaluate(R,{},l):void 0,V={id:S,properties:w.properties,type:w.type,sourceLayerIndex:z,index:T,geometry:M?R.geometry:Ns(w),patterns:{},sortKey:O};y.push(V)}v&&y.sort((w,S)=>w.sortKey-S.sortKey);for(let w of y){let{geometry:S,index:T,sourceLayerIndex:z}=w,M=t[T].feature;this.addFeature(w,S,T,l),o.featureIndex.insert(M,S,T,z,this.index)}}update(t,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,xr),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,o,l,d){for(let y of o)for(let _ of y){let v=_.x,w=_.y;if(v<0||v>=fi||w<0||w>=fi)continue;let S=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),T=S.vertexLength;Od(this.layoutVertexArray,v,w,-1,-1),Od(this.layoutVertexArray,v,w,1,-1),Od(this.layoutVertexArray,v,w,1,1),Od(this.layoutVertexArray,v,w,-1,1),this.indexArray.emplaceBack(T,T+1,T+2),this.indexArray.emplaceBack(T,T+3,T+2),S.vertexLength+=4,S.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,{},d)}}function yy(r,t){for(let o=0;o<r.length;o++)if(Hl(t,r[o]))return!0;for(let o=0;o<t.length;o++)if(Hl(r,t[o]))return!0;return!!Sm(r,t)}function Ub(r,t,o){return!!Hl(r,t)||!!Em(t,r,o)}function _y(r,t){if(r.length===1)return xy(t,r[0]);for(let o=0;o<t.length;o++){let l=t[o];for(let d=0;d<l.length;d++)if(Hl(r,l[d]))return!0}for(let o=0;o<r.length;o++)if(xy(t,r[o]))return!0;for(let o=0;o<t.length;o++)if(Sm(r,t[o]))return!0;return!1}function qb(r,t,o){if(r.length>1){if(Sm(r,t))return!0;for(let l=0;l<t.length;l++)if(Em(t[l],r,o))return!0}for(let l=0;l<r.length;l++)if(Em(r[l],t,o))return!0;return!1}function Sm(r,t){if(r.length===0||t.length===0)return!1;for(let o=0;o<r.length-1;o++){let l=r[o],d=r[o+1];for(let y=0;y<t.length-1;y++)if($b(l,d,t[y],t[y+1]))return!0}return!1}function $b(r,t,o,l){return Ei(r,o,l)!==Ei(t,o,l)&&Ei(r,t,o)!==Ei(r,t,l)}function Em(r,t,o){let l=o*o;if(t.length===1)return r.distSqr(t[0])<l;for(let d=1;d<t.length;d++)if(vy(r,t[d-1],t[d])<l)return!0;return!1}function vy(r,t,o){let l=t.distSqr(o);if(l===0)return r.distSqr(t);let d=((r.x-t.x)*(o.x-t.x)+(r.y-t.y)*(o.y-t.y))/l;return r.distSqr(d<0?t:d>1?o:o.sub(t)._mult(d)._add(t))}function xy(r,t){let o,l,d,y=!1;for(let _=0;_<r.length;_++){o=r[_];for(let v=0,w=o.length-1;v<o.length;w=v++)l=o[v],d=o[w],l.y>t.y!=d.y>t.y&&t.x<(d.x-l.x)*(t.y-l.y)/(d.y-l.y)+l.x&&(y=!y)}return y}function Hl(r,t){let o=!1;for(let l=0,d=r.length-1;l<r.length;d=l++){let y=r[l],_=r[d];y.y>t.y!=_.y>t.y&&t.x<(_.x-y.x)*(t.y-y.y)/(_.y-y.y)+y.x&&(o=!o)}return o}function Zb(r,t,o){let l=o[0],d=o[2];if(r.x<l.x&&t.x<l.x||r.x>d.x&&t.x>d.x||r.y<l.y&&t.y<l.y||r.y>d.y&&t.y>d.y)return!1;let y=Ei(r,t,o[0]);return y!==Ei(r,t,o[1])||y!==Ei(r,t,o[2])||y!==Ei(r,t,o[3])}function Lu(r,t,o){let l=t.paint.get(r).value;return l.kind==="constant"?l.value:o.programConfigurations.get(t.id).getMaxValue(r)}function Nd(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function jd(r,t,o,l,d){if(!t[0]&&!t[1])return r;let y=B.convert(t)._mult(d);o==="viewport"&&y._rotate(-l);let _=[];for(let v=0;v<r.length;v++)_.push(r[v].sub(y));return _}let wy,by;Ze("CircleBucket",km,{omit:["layers"]});var Hb={get paint(){return by=by||new g({"circle-radius":new ot(ye.paint_circle["circle-radius"]),"circle-color":new ot(ye.paint_circle["circle-color"]),"circle-blur":new ot(ye.paint_circle["circle-blur"]),"circle-opacity":new ot(ye.paint_circle["circle-opacity"]),"circle-translate":new We(ye.paint_circle["circle-translate"]),"circle-translate-anchor":new We(ye.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new We(ye.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new We(ye.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ot(ye.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ot(ye.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ot(ye.paint_circle["circle-stroke-opacity"])})},get layout(){return wy=wy||new g({"circle-sort-key":new ot(ye.layout_circle["circle-sort-key"])})}},ir=1e-6,Gl=typeof Float32Array<"u"?Float32Array:Array;function Tm(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function ky(r,t,o){var l=t[0],d=t[1],y=t[2],_=t[3],v=t[4],w=t[5],S=t[6],T=t[7],z=t[8],M=t[9],R=t[10],O=t[11],V=t[12],H=t[13],K=t[14],he=t[15],ie=o[0],ce=o[1],_e=o[2],Ce=o[3];return r[0]=ie*l+ce*v+_e*z+Ce*V,r[1]=ie*d+ce*w+_e*M+Ce*H,r[2]=ie*y+ce*S+_e*R+Ce*K,r[3]=ie*_+ce*T+_e*O+Ce*he,r[4]=(ie=o[4])*l+(ce=o[5])*v+(_e=o[6])*z+(Ce=o[7])*V,r[5]=ie*d+ce*w+_e*M+Ce*H,r[6]=ie*y+ce*S+_e*R+Ce*K,r[7]=ie*_+ce*T+_e*O+Ce*he,r[8]=(ie=o[8])*l+(ce=o[9])*v+(_e=o[10])*z+(Ce=o[11])*V,r[9]=ie*d+ce*w+_e*M+Ce*H,r[10]=ie*y+ce*S+_e*R+Ce*K,r[11]=ie*_+ce*T+_e*O+Ce*he,r[12]=(ie=o[12])*l+(ce=o[13])*v+(_e=o[14])*z+(Ce=o[15])*V,r[13]=ie*d+ce*w+_e*M+Ce*H,r[14]=ie*y+ce*S+_e*R+Ce*K,r[15]=ie*_+ce*T+_e*O+Ce*he,r}Math.hypot||(Math.hypot=function(){for(var r=0,t=arguments.length;t--;)r+=arguments[t]*arguments[t];return Math.sqrt(r)});var Du,Gb=ky;function Vd(r,t,o){var l=t[0],d=t[1],y=t[2],_=t[3];return r[0]=o[0]*l+o[4]*d+o[8]*y+o[12]*_,r[1]=o[1]*l+o[5]*d+o[9]*y+o[13]*_,r[2]=o[2]*l+o[6]*d+o[10]*y+o[14]*_,r[3]=o[3]*l+o[7]*d+o[11]*y+o[15]*_,r}Du=new Gl(4),Gl!=Float32Array&&(Du[0]=0,Du[1]=0,Du[2]=0,Du[3]=0);class Wb extends a{constructor(t){super(t,Hb)}createBucket(t){return new km(t)}queryRadius(t){let o=t;return Lu("circle-radius",this,o)+Lu("circle-stroke-width",this,o)+Nd(this.paint.get("circle-translate"))}queryIntersectsFeature(t,o,l,d,y,_,v,w){let S=jd(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,v),T=this.paint.get("circle-radius").evaluate(o,l)+this.paint.get("circle-stroke-width").evaluate(o,l),z=this.paint.get("circle-pitch-alignment")==="map",M=z?S:function(O,V){return O.map(H=>Sy(H,V))}(S,w),R=z?T*v:T;for(let O of d)for(let V of O){let H=z?V:Sy(V,w),K=R,he=Vd([],[V.x,V.y,0,1],w);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?K*=he[3]/_.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(K*=_.cameraToCenterDistance/he[3]),Ub(M,H,K))return!0}return!1}}function Sy(r,t){let o=Vd([],[r.x,r.y,0,1],t);return new B(o[0]/o[3],o[1]/o[3])}class Ey extends km{}let Ty;Ze("HeatmapBucket",Ey,{omit:["layers"]});var Xb={get paint(){return Ty=Ty||new g({"heatmap-radius":new ot(ye.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ot(ye.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new We(ye.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Pu(ye.paint_heatmap["heatmap-color"]),"heatmap-opacity":new We(ye.paint_heatmap["heatmap-opacity"])})}};function Cm(r,{width:t,height:o},l,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==t*o*l)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${t*o*l}`)}else d=new Uint8Array(t*o*l);return r.width=t,r.height=o,r.data=d,r}function Cy(r,{width:t,height:o},l){if(t===r.width&&o===r.height)return;let d=Cm({},{width:t,height:o},l);zm(r,d,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,t),height:Math.min(r.height,o)},l),r.width=t,r.height=o,r.data=d.data}function zm(r,t,o,l,d,y){if(d.width===0||d.height===0)return t;if(d.width>r.width||d.height>r.height||o.x>r.width-d.width||o.y>r.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>t.width||d.height>t.height||l.x>t.width-d.width||l.y>t.height-d.height)throw new RangeError("out of range destination coordinates for image copy");let _=r.data,v=t.data;if(_===v)throw new Error("srcData equals dstData, so image is already copied");for(let w=0;w<d.height;w++){let S=((o.y+w)*r.width+o.x)*y,T=((l.y+w)*t.width+l.x)*y;for(let z=0;z<d.width*y;z++)v[T+z]=_[S+z]}return t}class Ru{constructor(t,o){Cm(this,t,1,o)}resize(t){Cy(this,t,1)}clone(){return new Ru({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,l,d,y){zm(t,o,l,d,y,1)}}class en{constructor(t,o){Cm(this,t,4,o)}resize(t){Cy(this,t,4)}replace(t,o){o?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new en({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,l,d,y){zm(t,o,l,d,y,4)}}function zy(r){let t={},o=r.resolution||256,l=r.clips?r.clips.length:1,d=r.image||new en({width:o,height:l});if(Math.log(o)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${o}`);let y=(_,v,w)=>{t[r.evaluationKey]=w;let S=r.expression.evaluate(t);d.data[_+v+0]=Math.floor(255*S.r/S.a),d.data[_+v+1]=Math.floor(255*S.g/S.a),d.data[_+v+2]=Math.floor(255*S.b/S.a),d.data[_+v+3]=Math.floor(255*S.a)};if(r.clips)for(let _=0,v=0;_<l;++_,v+=4*o)for(let w=0,S=0;w<o;w++,S+=4){let T=w/(o-1),{start:z,end:M}=r.clips[_];y(v,S,z*(1-T)+M*T)}else for(let _=0,v=0;_<o;_++,v+=4)y(0,v,_/(o-1));return d}Ze("AlphaImage",Ru),Ze("RGBAImage",en);let Im="big-fb";class Kb extends a{createBucket(t){return new Ey(t)}constructor(t){super(t,Xb),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=zy({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Im)&&this.heatmapFbos.delete(Im)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Iy;var Jb={get paint(){return Iy=Iy||new g({"hillshade-illumination-direction":new We(ye.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new We(ye.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new We(ye.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new We(ye.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new We(ye.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new We(ye.paint_hillshade["hillshade-accent-color"])})}};class Yb extends a{constructor(t){super(t,Jb)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let Qb=x([{name:"a_pos",components:2,type:"Int16"}],4),{members:e5}=Qb;function Py(r,t,o=2){let l=t&&t.length,d=l?t[0]*o:r.length,y=My(r,0,d,o,!0),_=[];if(!y||y.next===y.prev)return _;let v,w,S;if(l&&(y=function(T,z,M,R){let O=[];for(let V=0,H=z.length;V<H;V++){let K=My(T,z[V]*R,V<H-1?z[V+1]*R:T.length,R,!1);K===K.next&&(K.steiner=!0),O.push(l5(K))}O.sort(o5);for(let V=0;V<O.length;V++)M=a5(O[V],M);return M}(r,t,y,o)),r.length>80*o){v=1/0,w=1/0;let T=-1/0,z=-1/0;for(let M=o;M<d;M+=o){let R=r[M],O=r[M+1];R<v&&(v=R),O<w&&(w=O),R>T&&(T=R),O>z&&(z=O)}S=Math.max(T-v,z-w),S=S!==0?32767/S:0}return Fu(y,_,o,v,w,S,0),_}function My(r,t,o,l,d){let y;if(d===function(_,v,w,S){let T=0;for(let z=v,M=w-S;z<w;z+=S)T+=(_[M]-_[z])*(_[z+1]+_[M+1]),M=z;return T}(r,t,o,l)>0)for(let _=t;_<o;_+=l)y=Dy(_/l|0,r[_],r[_+1],y);else for(let _=o-l;_>=t;_-=l)y=Dy(_/l|0,r[_],r[_+1],y);return y&&Ud(y,y.next)&&(Ou(y),y=y.next),y}function Vs(r,t){if(!r)return r;t||(t=r);let o,l=r;do if(o=!1,l.steiner||!Ud(l,l.next)&&li(l.prev,l,l.next)!==0)l=l.next;else{if(Ou(l),l=t=l.prev,l===l.next)break;o=!0}while(o||l!==t);return t}function Fu(r,t,o,l,d,y,_){if(!r)return;!_&&y&&function(w,S,T,z){let M=w;do M.z===0&&(M.z=Pm(M.x,M.y,S,T,z)),M.prevZ=M.prev,M.nextZ=M.next,M=M.next;while(M!==w);M.prevZ.nextZ=null,M.prevZ=null,function(R){let O,V=1;do{let H,K=R;R=null;let he=null;for(O=0;K;){O++;let ie=K,ce=0;for(let Ce=0;Ce<V&&(ce++,ie=ie.nextZ,ie);Ce++);let _e=V;for(;ce>0||_e>0&&ie;)ce!==0&&(_e===0||!ie||K.z<=ie.z)?(H=K,K=K.nextZ,ce--):(H=ie,ie=ie.nextZ,_e--),he?he.nextZ=H:R=H,H.prevZ=he,he=H;K=ie}he.nextZ=null,V*=2}while(O>1)}(M)}(r,l,d,y);let v=r;for(;r.prev!==r.next;){let w=r.prev,S=r.next;if(y?i5(r,l,d,y):t5(r))t.push(w.i,r.i,S.i),Ou(r),r=S.next,v=S.next;else if((r=S)===v){_?_===1?Fu(r=r5(Vs(r),t),t,o,l,d,y,2):_===2&&n5(r,t,o,l,d,y):Fu(Vs(r),t,o,l,d,y,1);break}}}function t5(r){let t=r.prev,o=r,l=r.next;if(li(t,o,l)>=0)return!1;let d=t.x,y=o.x,_=l.x,v=t.y,w=o.y,S=l.y,T=d<y?d<_?d:_:y<_?y:_,z=v<w?v<S?v:S:w<S?w:S,M=d>y?d>_?d:_:y>_?y:_,R=v>w?v>S?v:S:w>S?w:S,O=l.next;for(;O!==t;){if(O.x>=T&&O.x<=M&&O.y>=z&&O.y<=R&&Wl(d,v,y,w,_,S,O.x,O.y)&&li(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function i5(r,t,o,l){let d=r.prev,y=r,_=r.next;if(li(d,y,_)>=0)return!1;let v=d.x,w=y.x,S=_.x,T=d.y,z=y.y,M=_.y,R=v<w?v<S?v:S:w<S?w:S,O=T<z?T<M?T:M:z<M?z:M,V=v>w?v>S?v:S:w>S?w:S,H=T>z?T>M?T:M:z>M?z:M,K=Pm(R,O,t,o,l),he=Pm(V,H,t,o,l),ie=r.prevZ,ce=r.nextZ;for(;ie&&ie.z>=K&&ce&&ce.z<=he;){if(ie.x>=R&&ie.x<=V&&ie.y>=O&&ie.y<=H&&ie!==d&&ie!==_&&Wl(v,T,w,z,S,M,ie.x,ie.y)&&li(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,ce.x>=R&&ce.x<=V&&ce.y>=O&&ce.y<=H&&ce!==d&&ce!==_&&Wl(v,T,w,z,S,M,ce.x,ce.y)&&li(ce.prev,ce,ce.next)>=0))return!1;ce=ce.nextZ}for(;ie&&ie.z>=K;){if(ie.x>=R&&ie.x<=V&&ie.y>=O&&ie.y<=H&&ie!==d&&ie!==_&&Wl(v,T,w,z,S,M,ie.x,ie.y)&&li(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;ce&&ce.z<=he;){if(ce.x>=R&&ce.x<=V&&ce.y>=O&&ce.y<=H&&ce!==d&&ce!==_&&Wl(v,T,w,z,S,M,ce.x,ce.y)&&li(ce.prev,ce,ce.next)>=0)return!1;ce=ce.nextZ}return!0}function r5(r,t){let o=r;do{let l=o.prev,d=o.next.next;!Ud(l,d)&&Ay(l,o,o.next,d)&&Bu(l,d)&&Bu(d,l)&&(t.push(l.i,o.i,d.i),Ou(o),Ou(o.next),o=r=d),o=o.next}while(o!==r);return Vs(o)}function n5(r,t,o,l,d,y){let _=r;do{let v=_.next.next;for(;v!==_.prev;){if(_.i!==v.i&&c5(_,v)){let w=Ly(_,v);return _=Vs(_,_.next),w=Vs(w,w.next),Fu(_,t,o,l,d,y,0),void Fu(w,t,o,l,d,y,0)}v=v.next}_=_.next}while(_!==r)}function o5(r,t){return r.x-t.x}function a5(r,t){let o=function(d,y){let _=y,v=d.x,w=d.y,S,T=-1/0;do{if(w<=_.y&&w>=_.next.y&&_.next.y!==_.y){let V=_.x+(w-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(V<=v&&V>T&&(T=V,S=_.x<_.next.x?_:_.next,V===v))return S}_=_.next}while(_!==y);if(!S)return null;let z=S,M=S.x,R=S.y,O=1/0;_=S;do{if(v>=_.x&&_.x>=M&&v!==_.x&&Wl(w<R?v:T,w,M,R,w<R?T:v,w,_.x,_.y)){let V=Math.abs(w-_.y)/(v-_.x);Bu(_,d)&&(V<O||V===O&&(_.x>S.x||_.x===S.x&&s5(S,_)))&&(S=_,O=V)}_=_.next}while(_!==z);return S}(r,t);if(!o)return t;let l=Ly(o,r);return Vs(l,l.next),Vs(o,o.next)}function s5(r,t){return li(r.prev,r,t.prev)<0&&li(t.next,r,r.next)<0}function Pm(r,t,o,l,d){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-o)*d|0)|r<<8))|r<<4))|r<<2))|r<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-l)*d|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function l5(r){let t=r,o=r;do(t.x<o.x||t.x===o.x&&t.y<o.y)&&(o=t),t=t.next;while(t!==r);return o}function Wl(r,t,o,l,d,y,_,v){return(d-_)*(t-v)>=(r-_)*(y-v)&&(r-_)*(l-v)>=(o-_)*(t-v)&&(o-_)*(y-v)>=(d-_)*(l-v)}function c5(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!function(o,l){let d=o;do{if(d.i!==o.i&&d.next.i!==o.i&&d.i!==l.i&&d.next.i!==l.i&&Ay(d,d.next,o,l))return!0;d=d.next}while(d!==o);return!1}(r,t)&&(Bu(r,t)&&Bu(t,r)&&function(o,l){let d=o,y=!1,_=(o.x+l.x)/2,v=(o.y+l.y)/2;do d.y>v!=d.next.y>v&&d.next.y!==d.y&&_<(d.next.x-d.x)*(v-d.y)/(d.next.y-d.y)+d.x&&(y=!y),d=d.next;while(d!==o);return y}(r,t)&&(li(r.prev,r,t.prev)||li(r,t.prev,t))||Ud(r,t)&&li(r.prev,r,r.next)>0&&li(t.prev,t,t.next)>0)}function li(r,t,o){return(t.y-r.y)*(o.x-t.x)-(t.x-r.x)*(o.y-t.y)}function Ud(r,t){return r.x===t.x&&r.y===t.y}function Ay(r,t,o,l){let d=$d(li(r,t,o)),y=$d(li(r,t,l)),_=$d(li(o,l,r)),v=$d(li(o,l,t));return d!==y&&_!==v||!(d!==0||!qd(r,o,t))||!(y!==0||!qd(r,l,t))||!(_!==0||!qd(o,r,l))||!(v!==0||!qd(o,t,l))}function qd(r,t,o){return t.x<=Math.max(r.x,o.x)&&t.x>=Math.min(r.x,o.x)&&t.y<=Math.max(r.y,o.y)&&t.y>=Math.min(r.y,o.y)}function $d(r){return r>0?1:r<0?-1:0}function Bu(r,t){return li(r.prev,r,r.next)<0?li(r,t,r.next)>=0&&li(r,r.prev,t)>=0:li(r,t,r.prev)<0||li(r,r.next,t)<0}function Ly(r,t){let o=Mm(r.i,r.x,r.y),l=Mm(t.i,t.x,t.y),d=r.next,y=t.prev;return r.next=t,t.prev=r,o.next=d,d.prev=o,l.next=o,o.prev=l,y.next=l,l.prev=y,l}function Dy(r,t,o,l){let d=Mm(r,t,o);return l?(d.next=l.next,d.prev=l,l.next.prev=d,l.next=d):(d.prev=d,d.next=d),d}function Ou(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Mm(r,t,o){return{i:r,x:t,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Am(r,t,o){let l=o.patternDependencies,d=!1;for(let y of t){let _=y.paint.get(`${r}-pattern`);_.isConstant()||(d=!0);let v=_.constantOr(null);v&&(d=!0,l[v.to]=!0,l[v.from]=!0)}return d}function Lm(r,t,o,l,d){let y=d.patternDependencies;for(let _ of t){let v=_.paint.get(`${r}-pattern`).value;if(v.kind!=="constant"){let w=v.evaluate({zoom:l-1},o,{},d.availableImages),S=v.evaluate({zoom:l},o,{},d.availableImages),T=v.evaluate({zoom:l+1},o,{},d.availableImages);w=w&&w.name?w.name:w,S=S&&S.name?S.name:S,T=T&&T.name?T.name:T,y[w]=!0,y[S]=!0,y[T]=!0,o.patterns[_.id]={min:w,mid:S,max:T}}}return o}class Dm{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new kn,this.indexArray=new Qr,this.indexArray2=new Ci,this.programConfigurations=new Os(t.layers,t.zoom),this.segments=new wt,this.segments2=new wt,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,l){this.hasPattern=Am("fill",this.layers,o);let d=this.layers[0].layout.get("fill-sort-key"),y=!d.isConstant(),_=[];for(let{feature:v,id:w,index:S,sourceLayerIndex:T}of t){let z=this.layers[0]._featureFilter.needGeometry,M=js(v,z);if(!this.layers[0]._featureFilter.filter(new Ut(this.zoom),M,l))continue;let R=y?d.evaluate(M,{},l,o.availableImages):void 0,O={id:w,properties:v.properties,type:v.type,sourceLayerIndex:T,index:S,geometry:z?M.geometry:Ns(v),patterns:{},sortKey:R};_.push(O)}y&&_.sort((v,w)=>v.sortKey-w.sortKey);for(let v of _){let{geometry:w,index:S,sourceLayerIndex:T}=v;if(this.hasPattern){let z=Lm("fill",this.layers,v,this.zoom,o);this.patternFeatures.push(z)}else this.addFeature(v,w,S,l,{});o.featureIndex.insert(t[S].feature,w,S,T,this.index)}}update(t,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,l)}addFeatures(t,o,l){for(let d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,o,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,e5),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,o,l,d,y){for(let _ of _l(o,500)){let v=0;for(let R of _)v+=R.length;let w=this.segments.prepareSegment(v,this.layoutVertexArray,this.indexArray),S=w.vertexLength,T=[],z=[];for(let R of _){if(R.length===0)continue;R!==_[0]&&z.push(T.length/2);let O=this.segments2.prepareSegment(R.length,this.layoutVertexArray,this.indexArray2),V=O.vertexLength;this.layoutVertexArray.emplaceBack(R[0].x,R[0].y),this.indexArray2.emplaceBack(V+R.length-1,V),T.push(R[0].x),T.push(R[0].y);for(let H=1;H<R.length;H++)this.layoutVertexArray.emplaceBack(R[H].x,R[H].y),this.indexArray2.emplaceBack(V+H-1,V+H),T.push(R[H].x),T.push(R[H].y);O.vertexLength+=R.length,O.primitiveLength+=R.length}let M=Py(T,z);for(let R=0;R<M.length;R+=3)this.indexArray.emplaceBack(S+M[R],S+M[R+1],S+M[R+2]);w.vertexLength+=v,w.primitiveLength+=M.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,y,d)}}let Ry,Fy;Ze("FillBucket",Dm,{omit:["layers","patternFeatures"]});var u5={get paint(){return Fy=Fy||new g({"fill-antialias":new We(ye.paint_fill["fill-antialias"]),"fill-opacity":new ot(ye.paint_fill["fill-opacity"]),"fill-color":new ot(ye.paint_fill["fill-color"]),"fill-outline-color":new ot(ye.paint_fill["fill-outline-color"]),"fill-translate":new We(ye.paint_fill["fill-translate"]),"fill-translate-anchor":new We(ye.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ol(ye.paint_fill["fill-pattern"])})},get layout(){return Ry=Ry||new g({"fill-sort-key":new ot(ye.layout_fill["fill-sort-key"])})}};class h5 extends a{constructor(t){super(t,u5)}recalculate(t,o){super.recalculate(t,o);let l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Dm(t)}queryRadius(){return Nd(this.paint.get("fill-translate"))}queryIntersectsFeature(t,o,l,d,y,_,v){return _y(jd(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,v),d)}isTileClipped(){return!0}}let d5=x([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),p5=x([{name:"a_centroid",components:2,type:"Int16"}],4),{members:f5}=d5;var Fa={},m5=A,By=Xl;function Xl(r,t,o,l,d){this.properties={},this.extent=o,this.type=0,this._pbf=r,this._geometry=-1,this._keys=l,this._values=d,r.readFields(g5,this,t)}function g5(r,t,o){r==1?t.id=o.readVarint():r==2?function(l,d){for(var y=l.readVarint()+l.pos;l.pos<y;){var _=d._keys[l.readVarint()],v=d._values[l.readVarint()];d.properties[_]=v}}(o,t):r==3?t.type=o.readVarint():r==4&&(t._geometry=o.pos)}function y5(r){for(var t,o,l=0,d=0,y=r.length,_=y-1;d<y;_=d++)l+=((o=r[_]).x-(t=r[d]).x)*(t.y+o.y);return l}Xl.types=["Unknown","Point","LineString","Polygon"],Xl.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var t,o=r.readVarint()+r.pos,l=1,d=0,y=0,_=0,v=[];r.pos<o;){if(d<=0){var w=r.readVarint();l=7&w,d=w>>3}if(d--,l===1||l===2)y+=r.readSVarint(),_+=r.readSVarint(),l===1&&(t&&v.push(t),t=[]),t.push(new m5(y,_));else{if(l!==7)throw new Error("unknown command "+l);t&&t.push(t[0].clone())}}return t&&v.push(t),v},Xl.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var t=r.readVarint()+r.pos,o=1,l=0,d=0,y=0,_=1/0,v=-1/0,w=1/0,S=-1/0;r.pos<t;){if(l<=0){var T=r.readVarint();o=7&T,l=T>>3}if(l--,o===1||o===2)(d+=r.readSVarint())<_&&(_=d),d>v&&(v=d),(y+=r.readSVarint())<w&&(w=y),y>S&&(S=y);else if(o!==7)throw new Error("unknown command "+o)}return[_,w,v,S]},Xl.prototype.toGeoJSON=function(r,t,o){var l,d,y=this.extent*Math.pow(2,o),_=this.extent*r,v=this.extent*t,w=this.loadGeometry(),S=Xl.types[this.type];function T(R){for(var O=0;O<R.length;O++){var V=R[O];R[O]=[360*(V.x+_)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(V.y+v)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var z=[];for(l=0;l<w.length;l++)z[l]=w[l][0];T(w=z);break;case 2:for(l=0;l<w.length;l++)T(w[l]);break;case 3:for(w=function(R){var O=R.length;if(O<=1)return[R];for(var V,H,K=[],he=0;he<O;he++){var ie=y5(R[he]);ie!==0&&(H===void 0&&(H=ie<0),H===ie<0?(V&&K.push(V),V=[R[he]]):V.push(R[he]))}return V&&K.push(V),K}(w),l=0;l<w.length;l++)for(d=0;d<w[l].length;d++)T(w[l][d])}w.length===1?w=w[0]:S="Multi"+S;var M={type:"Feature",geometry:{type:S,coordinates:w},properties:this.properties};return"id"in this&&(M.id=this.id),M};var _5=By,Oy=Ny;function Ny(r,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(v5,this,t),this.length=this._features.length}function v5(r,t,o){r===15?t.version=o.readVarint():r===1?t.name=o.readString():r===5?t.extent=o.readVarint():r===2?t._features.push(o.pos):r===3?t._keys.push(o.readString()):r===4&&t._values.push(function(l){for(var d=null,y=l.readVarint()+l.pos;l.pos<y;){var _=l.readVarint()>>3;d=_===1?l.readString():_===2?l.readFloat():_===3?l.readDouble():_===4?l.readVarint64():_===5?l.readVarint():_===6?l.readSVarint():_===7?l.readBoolean():null}return d}(o))}Ny.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var t=this._pbf.readVarint()+this._pbf.pos;return new _5(this._pbf,t,this.extent,this._keys,this._values)};var x5=Oy;function w5(r,t,o){if(r===3){var l=new x5(o,o.readVarint()+o.pos);l.length&&(t[l.name]=l)}}Fa.VectorTile=function(r,t){this.layers=r.readFields(w5,{},t)},Fa.VectorTileFeature=By,Fa.VectorTileLayer=Oy;let b5=Fa.VectorTileFeature.types,Rm=Math.pow(2,13);function Nu(r,t,o,l,d,y,_,v){r.emplaceBack(t,o,2*Math.floor(l*Rm)+_,d*Rm*2,y*Rm*2,Math.round(v))}class Fm{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Pa,this.centroidVertexArray=new Di,this.indexArray=new Qr,this.programConfigurations=new Os(t.layers,t.zoom),this.segments=new wt,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,l){this.features=[],this.hasPattern=Am("fill-extrusion",this.layers,o);for(let{feature:d,id:y,index:_,sourceLayerIndex:v}of t){let w=this.layers[0]._featureFilter.needGeometry,S=js(d,w);if(!this.layers[0]._featureFilter.filter(new Ut(this.zoom),S,l))continue;let T={id:y,sourceLayerIndex:v,index:_,geometry:w?S.geometry:Ns(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(Lm("fill-extrusion",this.layers,T,this.zoom,o)):this.addFeature(T,T.geometry,_,l,{}),o.featureIndex.insert(d,T.geometry,_,v,this.index,!0)}}addFeatures(t,o,l){for(let d of this.features){let{geometry:y}=d;this.addFeature(d,y,d.index,o,l)}}update(t,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,l)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,f5),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,p5.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,o,l,d,y){for(let _ of _l(o,500)){let v={x:0,y:0,vertexCount:0},w=0;for(let O of _)w+=O.length;let S=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let O of _){if(O.length===0||S5(O))continue;let V=0;for(let H=0;H<O.length;H++){let K=O[H];if(H>=1){let he=O[H-1];if(!k5(K,he)){S.vertexLength+4>wt.MAX_VERTEX_ARRAY_LENGTH&&(S=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let ie=K.sub(he)._perp()._unit(),ce=he.dist(K);V+ce>32768&&(V=0),Nu(this.layoutVertexArray,K.x,K.y,ie.x,ie.y,0,0,V),Nu(this.layoutVertexArray,K.x,K.y,ie.x,ie.y,0,1,V),v.x+=2*K.x,v.y+=2*K.y,v.vertexCount+=2,V+=ce,Nu(this.layoutVertexArray,he.x,he.y,ie.x,ie.y,0,0,V),Nu(this.layoutVertexArray,he.x,he.y,ie.x,ie.y,0,1,V),v.x+=2*he.x,v.y+=2*he.y,v.vertexCount+=2;let _e=S.vertexLength;this.indexArray.emplaceBack(_e,_e+2,_e+1),this.indexArray.emplaceBack(_e+1,_e+2,_e+3),S.vertexLength+=4,S.primitiveLength+=2}}}}if(S.vertexLength+w>wt.MAX_VERTEX_ARRAY_LENGTH&&(S=this.segments.prepareSegment(w,this.layoutVertexArray,this.indexArray)),b5[t.type]!=="Polygon")continue;let T=[],z=[],M=S.vertexLength;for(let O of _)if(O.length!==0){O!==_[0]&&z.push(T.length/2);for(let V=0;V<O.length;V++){let H=O[V];Nu(this.layoutVertexArray,H.x,H.y,0,0,1,1,0),v.x+=H.x,v.y+=H.y,v.vertexCount+=1,T.push(H.x),T.push(H.y)}}let R=Py(T,z);for(let O=0;O<R.length;O+=3)this.indexArray.emplaceBack(M+R[O],M+R[O+2],M+R[O+1]);S.primitiveLength+=R.length/3,S.vertexLength+=w;for(let O=0;O<v.vertexCount;O++){let V=Math.floor(v.x/v.vertexCount),H=Math.floor(v.y/v.vertexCount);this.centroidVertexArray.emplaceBack(V,H)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,y,d)}}function k5(r,t){return r.x===t.x&&(r.x<0||r.x>fi)||r.y===t.y&&(r.y<0||r.y>fi)}function S5(r){return r.every(t=>t.x<0)||r.every(t=>t.x>fi)||r.every(t=>t.y<0)||r.every(t=>t.y>fi)}let jy;Ze("FillExtrusionBucket",Fm,{omit:["layers","features"]});var E5={get paint(){return jy=jy||new g({"fill-extrusion-opacity":new We(ye["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ot(ye["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new We(ye["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new We(ye["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ol(ye["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ot(ye["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ot(ye["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new We(ye["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class T5 extends a{constructor(t){super(t,E5)}createBucket(t){return new Fm(t)}queryRadius(){return Nd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(t,o,l,d,y,_,v,w){let S=jd(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,v),T=this.paint.get("fill-extrusion-height").evaluate(o,l),z=this.paint.get("fill-extrusion-base").evaluate(o,l),M=function(O,V,H,K){let he=[];for(let ie of O){let ce=[ie.x,ie.y,0,1];Vd(ce,ce,V),he.push(new B(ce[0]/ce[3],ce[1]/ce[3]))}return he}(S,w),R=function(O,V,H,K){let he=[],ie=[],ce=K[8]*V,_e=K[9]*V,Ce=K[10]*V,Ue=K[11]*V,nt=K[8]*H,je=K[9]*H,Oe=K[10]*H,Je=K[11]*H;for(let He of O){let $e=[],we=[];for(let Qe of He){let Ke=Qe.x,lt=Qe.y,Ot=K[0]*Ke+K[4]*lt+K[12],Ft=K[1]*Ke+K[5]*lt+K[13],xi=K[2]*Ke+K[6]*lt+K[14],Sn=K[3]*Ke+K[7]*lt+K[15],Bi=xi+Ce,wi=Sn+Ue,rr=Ot+nt,nr=Ft+je,or=xi+Oe,oi=Sn+Je,bi=new B((Ot+ce)/wi,(Ft+_e)/wi);bi.z=Bi/wi,$e.push(bi);let Hi=new B(rr/oi,nr/oi);Hi.z=or/oi,we.push(Hi)}he.push($e),ie.push(we)}return[he,ie]}(d,z,T,w);return function(O,V,H){let K=1/0;_y(H,V)&&(K=Vy(H,V[0]));for(let he=0;he<V.length;he++){let ie=V[he],ce=O[he];for(let _e=0;_e<ie.length-1;_e++){let Ce=ie[_e],Ue=[Ce,ie[_e+1],ce[_e+1],ce[_e],Ce];yy(H,Ue)&&(K=Math.min(K,Vy(H,Ue)))}}return K!==1/0&&K}(R[0],R[1],M)}}function ju(r,t){return r.x*t.x+r.y*t.y}function Vy(r,t){if(r.length===1){let o=0,l=t[o++],d;for(;!d||l.equals(d);)if(d=t[o++],!d)return 1/0;for(;o<t.length;o++){let y=t[o],_=r[0],v=d.sub(l),w=y.sub(l),S=_.sub(l),T=ju(v,v),z=ju(v,w),M=ju(w,w),R=ju(S,v),O=ju(S,w),V=T*M-z*z,H=(M*R-z*O)/V,K=(T*O-z*R)/V,he=l.z*(1-H-K)+d.z*H+y.z*K;if(isFinite(he))return he}return 1/0}{let o=1/0;for(let l of t)o=Math.min(o,l.z);return o}}let C5=x([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:z5}=C5,I5=x([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:P5}=I5,M5=Fa.VectorTileFeature.types,A5=Math.cos(Math.PI/180*37.5),Uy=Math.pow(2,14)/.5;class Bm{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new jl,this.layoutVertexArray2=new Ma,this.indexArray=new Qr,this.programConfigurations=new Os(t.layers,t.zoom),this.segments=new wt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(t,o,l){this.hasPattern=Am("line",this.layers,o);let d=this.layers[0].layout.get("line-sort-key"),y=!d.isConstant(),_=[];for(let{feature:v,id:w,index:S,sourceLayerIndex:T}of t){let z=this.layers[0]._featureFilter.needGeometry,M=js(v,z);if(!this.layers[0]._featureFilter.filter(new Ut(this.zoom),M,l))continue;let R=y?d.evaluate(M,{},l):void 0,O={id:w,properties:v.properties,type:v.type,sourceLayerIndex:T,index:S,geometry:z?M.geometry:Ns(v),patterns:{},sortKey:R};_.push(O)}y&&_.sort((v,w)=>v.sortKey-w.sortKey);for(let v of _){let{geometry:w,index:S,sourceLayerIndex:T}=v;if(this.hasPattern){let z=Lm("line",this.layers,v,this.zoom,o);this.patternFeatures.push(z)}else this.addFeature(v,w,S,l,{});o.featureIndex.insert(t[S].feature,w,S,T,this.index)}}update(t,o,l){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,o,this.stateDependentLayers,l)}addFeatures(t,o,l){for(let d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,o,l)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,P5)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,z5),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,o,l,d,y){let _=this.layers[0].layout,v=_.get("line-join").evaluate(t,{}),w=_.get("line-cap"),S=_.get("line-miter-limit"),T=_.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(let z of o)this.addLine(z,t,v,w,S,T);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,l,y,d)}addLine(t,o,l,d,y,_){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let K=0;K<t.length-1;K++)this.totalDistance+=t[K].dist(t[K+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let v=M5[o.type]==="Polygon",w=t.length;for(;w>=2&&t[w-1].equals(t[w-2]);)w--;let S=0;for(;S<w-1&&t[S].equals(t[S+1]);)S++;if(w<(v?3:2))return;l==="bevel"&&(y=1.05);let T=this.overscaling<=16?15*fi/(512*this.overscaling):0,z=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray),M,R,O,V,H;this.e1=this.e2=-1,v&&(M=t[w-2],H=t[S].sub(M)._unit()._perp());for(let K=S;K<w;K++){if(O=K===w-1?v?t[S+1]:void 0:t[K+1],O&&t[K].equals(O))continue;H&&(V=H),M&&(R=M),M=t[K],H=O?O.sub(M)._unit()._perp():V,V=V||H;let he=V.add(H);he.x===0&&he.y===0||he._unit();let ie=V.x*H.x+V.y*H.y,ce=he.x*H.x+he.y*H.y,_e=ce!==0?1/ce:1/0,Ce=2*Math.sqrt(2-2*ce),Ue=ce<A5&&R&&O,nt=V.x*H.y-V.y*H.x>0;if(Ue&&K>S){let Je=M.dist(R);if(Je>2*T){let He=M.sub(M.sub(R)._mult(T/Je)._round());this.updateDistance(R,He),this.addCurrentVertex(He,V,0,0,z),R=He}}let je=R&&O,Oe=je?l:v?"butt":d;if(je&&Oe==="round"&&(_e<_?Oe="miter":_e<=2&&(Oe="fakeround")),Oe==="miter"&&_e>y&&(Oe="bevel"),Oe==="bevel"&&(_e>2&&(Oe="flipbevel"),_e<y&&(Oe="miter")),R&&this.updateDistance(R,M),Oe==="miter")he._mult(_e),this.addCurrentVertex(M,he,0,0,z);else if(Oe==="flipbevel"){if(_e>100)he=H.mult(-1);else{let Je=_e*V.add(H).mag()/V.sub(H).mag();he._perp()._mult(Je*(nt?-1:1))}this.addCurrentVertex(M,he,0,0,z),this.addCurrentVertex(M,he.mult(-1),0,0,z)}else if(Oe==="bevel"||Oe==="fakeround"){let Je=-Math.sqrt(_e*_e-1),He=nt?Je:0,$e=nt?0:Je;if(R&&this.addCurrentVertex(M,V,He,$e,z),Oe==="fakeround"){let we=Math.round(180*Ce/Math.PI/20);for(let Qe=1;Qe<we;Qe++){let Ke=Qe/we;if(Ke!==.5){let Ot=Ke-.5;Ke+=Ke*Ot*(Ke-1)*((1.0904+ie*(ie*(3.55645-1.43519*ie)-3.2452))*Ot*Ot+(.848013+ie*(.215638*ie-1.06021)))}let lt=H.sub(V)._mult(Ke)._add(V)._unit()._mult(nt?-1:1);this.addHalfVertex(M,lt.x,lt.y,!1,nt,0,z)}}O&&this.addCurrentVertex(M,H,-He,-$e,z)}else if(Oe==="butt")this.addCurrentVertex(M,he,0,0,z);else if(Oe==="square"){let Je=R?1:-1;this.addCurrentVertex(M,he,Je,Je,z)}else Oe==="round"&&(R&&(this.addCurrentVertex(M,V,0,0,z),this.addCurrentVertex(M,V,1,1,z,!0)),O&&(this.addCurrentVertex(M,H,-1,-1,z,!0),this.addCurrentVertex(M,H,0,0,z)));if(Ue&&K<w-1){let Je=M.dist(O);if(Je>2*T){let He=M.add(O.sub(M)._mult(T/Je)._round());this.updateDistance(M,He),this.addCurrentVertex(He,H,0,0,z),M=He}}}}addCurrentVertex(t,o,l,d,y,_=!1){let v=o.y*d-o.x,w=-o.y-o.x*d;this.addHalfVertex(t,o.x+o.y*l,o.y-o.x*l,_,!1,l,y),this.addHalfVertex(t,v,w,_,!0,-d,y),this.distance>Uy/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,o,l,d,y,_))}addHalfVertex({x:t,y:o},l,d,y,_,v,w){let S=.5*(this.lineClips?this.scaledDistance*(Uy-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(y?1:0),(o<<1)+(_?1:0),Math.round(63*l)+128,Math.round(63*d)+128,1+(v===0?0:v<0?-1:1)|(63&S)<<2,S>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);let T=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),w.primitiveLength++),_?this.e2=T:this.e1=T}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,o){this.distance+=t.dist(o),this.updateScaledDistance()}}let qy,$y;Ze("LineBucket",Bm,{omit:["layers","patternFeatures"]});var Zy={get paint(){return $y=$y||new g({"line-opacity":new ot(ye.paint_line["line-opacity"]),"line-color":new ot(ye.paint_line["line-color"]),"line-translate":new We(ye.paint_line["line-translate"]),"line-translate-anchor":new We(ye.paint_line["line-translate-anchor"]),"line-width":new ot(ye.paint_line["line-width"]),"line-gap-width":new ot(ye.paint_line["line-gap-width"]),"line-offset":new ot(ye.paint_line["line-offset"]),"line-blur":new ot(ye.paint_line["line-blur"]),"line-dasharray":new Nl(ye.paint_line["line-dasharray"]),"line-pattern":new Ol(ye.paint_line["line-pattern"]),"line-gradient":new Pu(ye.paint_line["line-gradient"])})},get layout(){return qy=qy||new g({"line-cap":new We(ye.layout_line["line-cap"]),"line-join":new ot(ye.layout_line["line-join"]),"line-miter-limit":new We(ye.layout_line["line-miter-limit"]),"line-round-limit":new We(ye.layout_line["line-round-limit"]),"line-sort-key":new ot(ye.layout_line["line-sort-key"])})}};class L5 extends ot{possiblyEvaluate(t,o){return o=new Ut(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,zoomHistory:o.zoomHistory,transition:o.transition}),super.possiblyEvaluate(t,o)}evaluate(t,o,l,d){return o=Ie({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(t,o,l,d)}}let Zd;class D5 extends a{constructor(t){super(t,Zy),this.gradientVersion=0,Zd||(Zd=new L5(Zy.paint.properties["line-width"].specification),Zd.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){let o=this.gradientExpression();this.stepInterpolant=!!function(l){return l._styleExpression!==void 0}(o)&&o._styleExpression.expression instanceof ha,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,o){super.recalculate(t,o),this.paint._values["line-floorwidth"]=Zd.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Bm(t)}queryRadius(t){let o=t,l=Hy(Lu("line-width",this,o),Lu("line-gap-width",this,o)),d=Lu("line-offset",this,o);return l/2+Math.abs(d)+Nd(this.paint.get("line-translate"))}queryIntersectsFeature(t,o,l,d,y,_,v){let w=jd(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,v),S=v/2*Hy(this.paint.get("line-width").evaluate(o,l),this.paint.get("line-gap-width").evaluate(o,l)),T=this.paint.get("line-offset").evaluate(o,l);return T&&(d=function(z,M){let R=[];for(let O=0;O<z.length;O++){let V=z[O],H=[];for(let K=0;K<V.length;K++){let he=V[K-1],ie=V[K],ce=V[K+1],_e=K===0?new B(0,0):ie.sub(he)._unit()._perp(),Ce=K===V.length-1?new B(0,0):ce.sub(ie)._unit()._perp(),Ue=_e._add(Ce)._unit(),nt=Ue.x*Ce.x+Ue.y*Ce.y;nt!==0&&Ue._mult(1/nt),H.push(Ue._mult(M)._add(ie))}R.push(H)}return R}(d,T*v)),function(z,M,R){for(let O=0;O<M.length;O++){let V=M[O];if(z.length>=3){for(let H=0;H<V.length;H++)if(Hl(z,V[H]))return!0}if(qb(z,V,R))return!0}return!1}(w,d,S)}isTileClipped(){return!0}}function Hy(r,t){return t>0?t+2*r:r}let R5=x([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),F5=x([{name:"a_projected_pos",components:3,type:"Float32"}],4);x([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let B5=x([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);x([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let Gy=x([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),O5=x([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function N5(r,t,o){return r.sections.forEach(l=>{l.text=function(d,y,_){let v=y.layout.get("text-transform").evaluate(_,{});return v==="uppercase"?d=d.toLocaleUpperCase():v==="lowercase"&&(d=d.toLocaleLowerCase()),vr.applyArabicShaping&&(d=vr.applyArabicShaping(d)),d}(l.text,t,o)}),r}x([{name:"triangle",components:3,type:"Uint16"}]),x([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),x([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),x([{type:"Float32",name:"offsetX"}]),x([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),x([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);let Vu={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var gi=24,Wy=Rt,Xy=function(r,t,o,l,d){var y,_,v=8*d-l-1,w=(1<<v)-1,S=w>>1,T=-7,z=o?d-1:0,M=o?-1:1,R=r[t+z];for(z+=M,y=R&(1<<-T)-1,R>>=-T,T+=v;T>0;y=256*y+r[t+z],z+=M,T-=8);for(_=y&(1<<-T)-1,y>>=-T,T+=l;T>0;_=256*_+r[t+z],z+=M,T-=8);if(y===0)y=1-S;else{if(y===w)return _?NaN:1/0*(R?-1:1);_+=Math.pow(2,l),y-=S}return(R?-1:1)*_*Math.pow(2,y-l)},Ky=function(r,t,o,l,d,y){var _,v,w,S=8*y-d-1,T=(1<<S)-1,z=T>>1,M=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,R=l?0:y-1,O=l?1:-1,V=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(v=isNaN(t)?1:0,_=T):(_=Math.floor(Math.log(t)/Math.LN2),t*(w=Math.pow(2,-_))<1&&(_--,w*=2),(t+=_+z>=1?M/w:M*Math.pow(2,1-z))*w>=2&&(_++,w/=2),_+z>=T?(v=0,_=T):_+z>=1?(v=(t*w-1)*Math.pow(2,d),_+=z):(v=t*Math.pow(2,z-1)*Math.pow(2,d),_=0));d>=8;r[o+R]=255&v,R+=O,v/=256,d-=8);for(_=_<<d|v,S+=d;S>0;r[o+R]=255&_,R+=O,_/=256,S-=8);r[o+R-O]|=128*V};function Rt(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Rt.Varint=0,Rt.Fixed64=1,Rt.Bytes=2,Rt.Fixed32=5;var Om=4294967296,Jy=1/Om,Yy=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function qo(r){return r.type===Rt.Bytes?r.readVarint()+r.pos:r.pos+1}function Kl(r,t,o){return o?4294967296*t+(r>>>0):4294967296*(t>>>0)+(r>>>0)}function Qy(r,t,o){var l=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));o.realloc(l);for(var d=o.pos-1;d>=r;d--)o.buf[d+l]=o.buf[d]}function j5(r,t){for(var o=0;o<r.length;o++)t.writeVarint(r[o])}function V5(r,t){for(var o=0;o<r.length;o++)t.writeSVarint(r[o])}function U5(r,t){for(var o=0;o<r.length;o++)t.writeFloat(r[o])}function q5(r,t){for(var o=0;o<r.length;o++)t.writeDouble(r[o])}function $5(r,t){for(var o=0;o<r.length;o++)t.writeBoolean(r[o])}function Z5(r,t){for(var o=0;o<r.length;o++)t.writeFixed32(r[o])}function H5(r,t){for(var o=0;o<r.length;o++)t.writeSFixed32(r[o])}function G5(r,t){for(var o=0;o<r.length;o++)t.writeFixed64(r[o])}function W5(r,t){for(var o=0;o<r.length;o++)t.writeSFixed64(r[o])}function Hd(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+16777216*r[t+3]}function Jl(r,t,o){r[o]=t,r[o+1]=t>>>8,r[o+2]=t>>>16,r[o+3]=t>>>24}function e_(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16)+(r[t+3]<<24)}Rt.prototype={destroy:function(){this.buf=null},readFields:function(r,t,o){for(o=o||this.length;this.pos<o;){var l=this.readVarint(),d=l>>3,y=this.pos;this.type=7&l,r(d,t,this),this.pos===y&&this.skip(l)}return t},readMessage:function(r,t){return this.readFields(r,t,this.readVarint()+this.pos)},readFixed32:function(){var r=Hd(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=e_(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=Hd(this.buf,this.pos)+Hd(this.buf,this.pos+4)*Om;return this.pos+=8,r},readSFixed64:function(){var r=Hd(this.buf,this.pos)+e_(this.buf,this.pos+4)*Om;return this.pos+=8,r},readFloat:function(){var r=Xy(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=Xy(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var t,o,l=this.buf;return t=127&(o=l[this.pos++]),o<128?t:(t|=(127&(o=l[this.pos++]))<<7,o<128?t:(t|=(127&(o=l[this.pos++]))<<14,o<128?t:(t|=(127&(o=l[this.pos++]))<<21,o<128?t:function(d,y,_){var v,w,S=_.buf;if(v=(112&(w=S[_.pos++]))>>4,w<128||(v|=(127&(w=S[_.pos++]))<<3,w<128)||(v|=(127&(w=S[_.pos++]))<<10,w<128)||(v|=(127&(w=S[_.pos++]))<<17,w<128)||(v|=(127&(w=S[_.pos++]))<<24,w<128)||(v|=(1&(w=S[_.pos++]))<<31,w<128))return Kl(d,v,y);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(o=l[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,t=this.pos;return this.pos=r,r-t>=12&&Yy?function(o,l,d){return Yy.decode(o.subarray(l,d))}(this.buf,t,r):function(o,l,d){for(var y="",_=l;_<d;){var v,w,S,T=o[_],z=null,M=T>239?4:T>223?3:T>191?2:1;if(_+M>d)break;M===1?T<128&&(z=T):M===2?(192&(v=o[_+1]))==128&&(z=(31&T)<<6|63&v)<=127&&(z=null):M===3?(w=o[_+2],(192&(v=o[_+1]))==128&&(192&w)==128&&((z=(15&T)<<12|(63&v)<<6|63&w)<=2047||z>=55296&&z<=57343)&&(z=null)):M===4&&(w=o[_+2],S=o[_+3],(192&(v=o[_+1]))==128&&(192&w)==128&&(192&S)==128&&((z=(15&T)<<18|(63&v)<<12|(63&w)<<6|63&S)<=65535||z>=1114112)&&(z=null)),z===null?(z=65533,M=1):z>65535&&(z-=65536,y+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),y+=String.fromCharCode(z),_+=M}return y}(this.buf,t,r)},readBytes:function(){var r=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,r);return this.pos=r,t},readPackedVarint:function(r,t){if(this.type!==Rt.Bytes)return r.push(this.readVarint(t));var o=qo(this);for(r=r||[];this.pos<o;)r.push(this.readVarint(t));return r},readPackedSVarint:function(r){if(this.type!==Rt.Bytes)return r.push(this.readSVarint());var t=qo(this);for(r=r||[];this.pos<t;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Rt.Bytes)return r.push(this.readBoolean());var t=qo(this);for(r=r||[];this.pos<t;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Rt.Bytes)return r.push(this.readFloat());var t=qo(this);for(r=r||[];this.pos<t;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Rt.Bytes)return r.push(this.readDouble());var t=qo(this);for(r=r||[];this.pos<t;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Rt.Bytes)return r.push(this.readFixed32());var t=qo(this);for(r=r||[];this.pos<t;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Rt.Bytes)return r.push(this.readSFixed32());var t=qo(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Rt.Bytes)return r.push(this.readFixed64());var t=qo(this);for(r=r||[];this.pos<t;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Rt.Bytes)return r.push(this.readSFixed64());var t=qo(this);for(r=r||[];this.pos<t;)r.push(this.readSFixed64());return r},skip:function(r){var t=7&r;if(t===Rt.Varint)for(;this.buf[this.pos++]>127;);else if(t===Rt.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Rt.Fixed32)this.pos+=4;else{if(t!==Rt.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(r,t){this.writeVarint(r<<3|t)},realloc:function(r){for(var t=this.length||16;t<this.pos+r;)t*=2;if(t!==this.length){var o=new Uint8Array(t);o.set(this.buf),this.buf=o,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),Jl(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),Jl(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),Jl(this.buf,-1&r,this.pos),Jl(this.buf,Math.floor(r*Jy),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),Jl(this.buf,-1&r,this.pos),Jl(this.buf,Math.floor(r*Jy),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(t,o){var l,d;if(t>=0?(l=t%4294967296|0,d=t/4294967296|0):(d=~(-t/4294967296),4294967295^(l=~(-t%4294967296))?l=l+1|0:(l=0,d=d+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),function(y,_,v){v.buf[v.pos++]=127&y|128,y>>>=7,v.buf[v.pos++]=127&y|128,y>>>=7,v.buf[v.pos++]=127&y|128,y>>>=7,v.buf[v.pos++]=127&y|128,v.buf[v.pos]=127&(y>>>=7)}(l,0,o),function(y,_){var v=(7&y)<<4;_.buf[_.pos++]|=v|((y>>>=3)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y|((y>>>=7)?128:0),y&&(_.buf[_.pos++]=127&y)))))}(d,o)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var t=this.pos;this.pos=function(l,d,y){for(var _,v,w=0;w<d.length;w++){if((_=d.charCodeAt(w))>55295&&_<57344){if(!v){_>56319||w+1===d.length?(l[y++]=239,l[y++]=191,l[y++]=189):v=_;continue}if(_<56320){l[y++]=239,l[y++]=191,l[y++]=189,v=_;continue}_=v-55296<<10|_-56320|65536,v=null}else v&&(l[y++]=239,l[y++]=191,l[y++]=189,v=null);_<128?l[y++]=_:(_<2048?l[y++]=_>>6|192:(_<65536?l[y++]=_>>12|224:(l[y++]=_>>18|240,l[y++]=_>>12&63|128),l[y++]=_>>6&63|128),l[y++]=63&_|128)}return y}(this.buf,r,this.pos);var o=this.pos-t;o>=128&&Qy(t,o,this),this.pos=t-1,this.writeVarint(o),this.pos+=o},writeFloat:function(r){this.realloc(4),Ky(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),Ky(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var t=r.length;this.writeVarint(t),this.realloc(t);for(var o=0;o<t;o++)this.buf[this.pos++]=r[o]},writeRawMessage:function(r,t){this.pos++;var o=this.pos;r(t,this);var l=this.pos-o;l>=128&&Qy(o,l,this),this.pos=o-1,this.writeVarint(l),this.pos+=l},writeMessage:function(r,t,o){this.writeTag(r,Rt.Bytes),this.writeRawMessage(t,o)},writePackedVarint:function(r,t){t.length&&this.writeMessage(r,j5,t)},writePackedSVarint:function(r,t){t.length&&this.writeMessage(r,V5,t)},writePackedBoolean:function(r,t){t.length&&this.writeMessage(r,$5,t)},writePackedFloat:function(r,t){t.length&&this.writeMessage(r,U5,t)},writePackedDouble:function(r,t){t.length&&this.writeMessage(r,q5,t)},writePackedFixed32:function(r,t){t.length&&this.writeMessage(r,Z5,t)},writePackedSFixed32:function(r,t){t.length&&this.writeMessage(r,H5,t)},writePackedFixed64:function(r,t){t.length&&this.writeMessage(r,G5,t)},writePackedSFixed64:function(r,t){t.length&&this.writeMessage(r,W5,t)},writeBytesField:function(r,t){this.writeTag(r,Rt.Bytes),this.writeBytes(t)},writeFixed32Field:function(r,t){this.writeTag(r,Rt.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(r,t){this.writeTag(r,Rt.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(r,t){this.writeTag(r,Rt.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(r,t){this.writeTag(r,Rt.Fixed64),this.writeSFixed64(t)},writeVarintField:function(r,t){this.writeTag(r,Rt.Varint),this.writeVarint(t)},writeSVarintField:function(r,t){this.writeTag(r,Rt.Varint),this.writeSVarint(t)},writeStringField:function(r,t){this.writeTag(r,Rt.Bytes),this.writeString(t)},writeFloatField:function(r,t){this.writeTag(r,Rt.Fixed32),this.writeFloat(t)},writeDoubleField:function(r,t){this.writeTag(r,Rt.Fixed64),this.writeDouble(t)},writeBooleanField:function(r,t){this.writeVarintField(r,!!t)}};var Nm=E(Wy);let jm=3;function X5(r,t,o){r===1&&o.readMessage(K5,t)}function K5(r,t,o){if(r===3){let{id:l,bitmap:d,width:y,height:_,left:v,top:w,advance:S}=o.readMessage(J5,{});t.push({id:l,bitmap:new Ru({width:y+2*jm,height:_+2*jm},d),metrics:{width:y,height:_,left:v,top:w,advance:S}})}}function J5(r,t,o){r===1?t.id=o.readVarint():r===2?t.bitmap=o.readBytes():r===3?t.width=o.readVarint():r===4?t.height=o.readVarint():r===5?t.left=o.readSVarint():r===6?t.top=o.readSVarint():r===7&&(t.advance=o.readVarint())}let t_=jm;function i_(r){let t=0,o=0;for(let _ of r)t+=_.w*_.h,o=Math.max(o,_.w);r.sort((_,v)=>v.h-_.h);let l=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),o),h:1/0}],d=0,y=0;for(let _ of r)for(let v=l.length-1;v>=0;v--){let w=l[v];if(!(_.w>w.w||_.h>w.h)){if(_.x=w.x,_.y=w.y,y=Math.max(y,_.y+_.h),d=Math.max(d,_.x+_.w),_.w===w.w&&_.h===w.h){let S=l.pop();v<l.length&&(l[v]=S)}else _.h===w.h?(w.x+=_.w,w.w-=_.w):_.w===w.w?(w.y+=_.h,w.h-=_.h):(l.push({x:w.x+_.w,y:w.y,w:w.w-_.w,h:_.h}),w.y+=_.h,w.h-=_.h);break}}return{w:d,h:y,fill:t/(d*y)||0}}let wr=1;class Vm{constructor(t,{pixelRatio:o,version:l,stretchX:d,stretchY:y,content:_,textFitWidth:v,textFitHeight:w}){this.paddedRect=t,this.pixelRatio=o,this.stretchX=d,this.stretchY=y,this.content=_,this.version=l,this.textFitWidth=v,this.textFitHeight=w}get tl(){return[this.paddedRect.x+wr,this.paddedRect.y+wr]}get br(){return[this.paddedRect.x+this.paddedRect.w-wr,this.paddedRect.y+this.paddedRect.h-wr]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*wr)/this.pixelRatio,(this.paddedRect.h-2*wr)/this.pixelRatio]}}class r_{constructor(t,o){let l={},d={};this.haveRenderCallbacks=[];let y=[];this.addImages(t,l,y),this.addImages(o,d,y);let{w:_,h:v}=i_(y),w=new en({width:_||1,height:v||1});for(let S in t){let T=t[S],z=l[S].paddedRect;en.copy(T.data,w,{x:0,y:0},{x:z.x+wr,y:z.y+wr},T.data)}for(let S in o){let T=o[S],z=d[S].paddedRect,M=z.x+wr,R=z.y+wr,O=T.data.width,V=T.data.height;en.copy(T.data,w,{x:0,y:0},{x:M,y:R},T.data),en.copy(T.data,w,{x:0,y:V-1},{x:M,y:R-1},{width:O,height:1}),en.copy(T.data,w,{x:0,y:0},{x:M,y:R+V},{width:O,height:1}),en.copy(T.data,w,{x:O-1,y:0},{x:M-1,y:R},{width:1,height:V}),en.copy(T.data,w,{x:0,y:0},{x:M+O,y:R},{width:1,height:V})}this.image=w,this.iconPositions=l,this.patternPositions=d}addImages(t,o,l){for(let d in t){let y=t[d],_={x:0,y:0,w:y.data.width+2*wr,h:y.data.height+2*wr};l.push(_),o[d]=new Vm(_,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(t,o){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let l in t.updatedImages)this.patchUpdatedImage(this.iconPositions[l],t.getImage(l),o),this.patchUpdatedImage(this.patternPositions[l],t.getImage(l),o)}patchUpdatedImage(t,o,l){if(!t||!o||t.version===o.version)return;t.version=o.version;let[d,y]=t.tl;l.update(o.data,void 0,{x:d,y})}}var Ba;Ze("ImagePosition",Vm),Ze("ImageAtlas",r_),f.ah=void 0,(Ba=f.ah||(f.ah={}))[Ba.none=0]="none",Ba[Ba.horizontal=1]="horizontal",Ba[Ba.vertical=2]="vertical",Ba[Ba.horizontalOnly=3]="horizontalOnly";let Uu=-17;class qu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,o){let l=new qu;return l.scale=t||1,l.fontStack=o,l}static forImage(t){let o=new qu;return o.imageName=t,o}}class Yl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,o){let l=new Yl;for(let d=0;d<t.sections.length;d++){let y=t.sections[d];y.image?l.addImageSection(y):l.addTextSection(y,o)}return l}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let o="";for(let l=0;l<t.length;l++){let d=t.charCodeAt(l+1)||null,y=t.charCodeAt(l-1)||null;o+=d&&Ad(d)&&!Vu[t[l+1]]||y&&Ad(y)&&!Vu[t[l-1]]||!Vu[t[l]]?t[l]:Vu[t[l]]}return o}(this.text)}trim(){let t=0;for(let l=0;l<this.text.length&&Wd[this.text.charCodeAt(l)];l++)t++;let o=this.text.length;for(let l=this.text.length-1;l>=0&&l>=t&&Wd[this.text.charCodeAt(l)];l--)o--;this.text=this.text.substring(t,o),this.sectionIndex=this.sectionIndex.slice(t,o)}substring(t,o){let l=new Yl;return l.text=this.text.substring(t,o),l.sectionIndex=this.sectionIndex.slice(t,o),l.sections=this.sections,l}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,o)=>Math.max(t,this.sections[o].scale),0)}addTextSection(t,o){this.text+=t.text,this.sections.push(qu.forText(t.scale,t.fontStack||o));let l=this.sections.length-1;for(let d=0;d<t.text.length;++d)this.sectionIndex.push(l)}addImageSection(t){let o=t.image?t.image.name:"";if(o.length===0)return void Wt("Can't add FormattedSection with an empty image.");let l=this.getNextImageSectionCharCode();l?(this.text+=String.fromCharCode(l),this.sections.push(qu.forImage(o)),this.sectionIndex.push(this.sections.length-1)):Wt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Gd(r,t,o,l,d,y,_,v,w,S,T,z,M,R,O){let V=Yl.fromFeature(r,d),H;z===f.ah.vertical&&V.verticalizePunctuation();let{processBidirectionalText:K,processStyledBidirectionalText:he}=vr;if(K&&V.sections.length===1){H=[];let _e=K(V.toString(),Um(V,S,y,t,l,R));for(let Ce of _e){let Ue=new Yl;Ue.text=Ce,Ue.sections=V.sections;for(let nt=0;nt<Ce.length;nt++)Ue.sectionIndex.push(0);H.push(Ue)}}else if(he){H=[];let _e=he(V.text,V.sectionIndex,Um(V,S,y,t,l,R));for(let Ce of _e){let Ue=new Yl;Ue.text=Ce[0],Ue.sectionIndex=Ce[1],Ue.sections=V.sections,H.push(Ue)}}else H=function(_e,Ce){let Ue=[],nt=_e.text,je=0;for(let Oe of Ce)Ue.push(_e.substring(je,Oe)),je=Oe;return je<nt.length&&Ue.push(_e.substring(je,nt.length)),Ue}(V,Um(V,S,y,t,l,R));let ie=[],ce={positionedLines:ie,text:V.toString(),top:T[1],bottom:T[1],left:T[0],right:T[0],writingMode:z,iconsInText:!1,verticalizable:!1};return function(_e,Ce,Ue,nt,je,Oe,Je,He,$e,we,Qe,Ke){let lt=0,Ot=Uu,Ft=0,xi=0,Sn=He==="right"?1:He==="left"?0:.5,Bi=0;for(let oi of je){oi.trim();let bi=oi.getMaxScale(),Hi=(bi-1)*gi,Oi={positionedGlyphs:[],lineOffset:0};_e.positionedLines[Bi]=Oi;let ar=Oi.positionedGlyphs,Ni=0;if(!oi.length()){Ot+=Oe,++Bi;continue}for(let br=0;br<oi.length();br++){let Ct=oi.getSection(br),jt=oi.getSectionIndex(br),Ht=oi.getCharCode(br),Fr=0,ei=null,ic=null,po=null,fo=gi,En=!($e===f.ah.horizontal||!Qe&&!zu(Ht)||Qe&&(Wd[Ht]||(wi=Ht,/\p{sc=Arab}/u.test(String.fromCodePoint(wi)))));if(Ct.imageName){let nn=nt[Ct.imageName];if(!nn)continue;po=Ct.imageName,_e.iconsInText=_e.iconsInText||!0,ic=nn.paddedRect;let zi=nn.displaySize;Ct.scale=Ct.scale*gi/Ke,ei={width:zi[0],height:zi[1],left:wr,top:-t_,advance:En?zi[1]:zi[0]},Fr=Hi+(gi-zi[1]*Ct.scale),fo=ei.advance;let $o=En?zi[0]*Ct.scale-gi*bi:zi[1]*Ct.scale-gi*bi;$o>0&&$o>Ni&&(Ni=$o)}else{let nn=Ue[Ct.fontStack],zi=nn&&nn[Ht];if(zi&&zi.rect)ic=zi.rect,ei=zi.metrics;else{let $o=Ce[Ct.fontStack],Xu=$o&&$o[Ht];if(!Xu)continue;ei=Xu.metrics}Fr=(bi-Ct.scale)*gi}En?(_e.verticalizable=!0,ar.push({glyph:Ht,imageName:po,x:lt,y:Ot+Fr,vertical:En,scale:Ct.scale,fontStack:Ct.fontStack,sectionIndex:jt,metrics:ei,rect:ic}),lt+=fo*Ct.scale+we):(ar.push({glyph:Ht,imageName:po,x:lt,y:Ot+Fr,vertical:En,scale:Ct.scale,fontStack:Ct.fontStack,sectionIndex:jt,metrics:ei,rect:ic}),lt+=ei.advance*Ct.scale+we)}ar.length!==0&&(Ft=Math.max(lt-we,Ft),t3(ar,0,ar.length-1,Sn,Ni)),lt=0;let rn=Oe*bi+Ni;Oi.lineOffset=Math.max(Ni,Hi),Ot+=rn,xi=Math.max(rn,xi),++Bi}var wi;let rr=Ot-Uu,{horizontalAlign:nr,verticalAlign:or}=qm(Je);(function(oi,bi,Hi,Oi,ar,Ni,rn,br,Ct){let jt=(bi-Hi)*ar,Ht=0;Ht=Ni!==rn?-br*Oi-Uu:(-Oi*Ct+.5)*rn;for(let Fr of oi)for(let ei of Fr.positionedGlyphs)ei.x+=jt,ei.y+=Ht})(_e.positionedLines,Sn,nr,or,Ft,xi,Oe,rr,je.length),_e.top+=-or*rr,_e.bottom=_e.top+rr,_e.left+=-nr*Ft,_e.right=_e.left+Ft}(ce,t,o,l,H,_,v,w,z,S,M,O),!function(_e){for(let Ce of _e)if(Ce.positionedGlyphs.length!==0)return!1;return!0}(ie)&&ce}let Wd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Y5={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Q5={40:!0};function n_(r,t,o,l,d,y){if(t.imageName){let _=l[t.imageName];return _?_.displaySize[0]*t.scale*gi/y+d:0}{let _=o[t.fontStack],v=_&&_[r];return v?v.metrics.advance*t.scale+d:0}}function o_(r,t,o,l){let d=Math.pow(r-t,2);return l?r<t?d/2:2*d:d+Math.abs(o)*o}function e3(r,t,o){let l=0;return r===10&&(l-=1e4),o&&(l+=150),r!==40&&r!==65288||(l+=50),t!==41&&t!==65289||(l+=50),l}function a_(r,t,o,l,d,y){let _=null,v=o_(t,o,d,y);for(let w of l){let S=o_(t-w.x,o,d,y)+w.badness;S<=v&&(_=w,v=S)}return{index:r,x:t,priorBreak:_,badness:v}}function s_(r){return r?s_(r.priorBreak).concat(r.index):[]}function Um(r,t,o,l,d,y){if(!r)return[];let _=[],v=function(z,M,R,O,V,H){let K=0;for(let he=0;he<z.length();he++){let ie=z.getSection(he);K+=n_(z.getCharCode(he),ie,O,V,M,H)}return K/Math.max(1,Math.ceil(K/R))}(r,t,o,l,d,y),w=r.text.indexOf("\u200B")>=0,S=0;for(let z=0;z<r.length();z++){let M=r.getSection(z),R=r.getCharCode(z);if(Wd[R]||(S+=n_(R,M,l,d,t,y)),z<r.length()-1){let O=!((T=R)<11904)&&(!!xt["CJK Compatibility Forms"](T)||!!xt["CJK Compatibility"](T)||!!xt["CJK Strokes"](T)||!!xt["CJK Symbols and Punctuation"](T)||!!xt["Enclosed CJK Letters and Months"](T)||!!xt["Halfwidth and Fullwidth Forms"](T)||!!xt["Ideographic Description Characters"](T)||!!xt["Vertical Forms"](T)||Md.test(String.fromCodePoint(T)));(Y5[R]||O||M.imageName||z!==r.length()-2&&Q5[r.getCharCode(z+1)])&&_.push(a_(z+1,S,v,_,e3(R,r.getCharCode(z+1),O&&w),!1))}}var T;return s_(a_(r.length(),S,v,_,0,!0))}function qm(r){let t=.5,o=.5;switch(r){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:t,verticalAlign:o}}function t3(r,t,o,l,d){if(!l&&!d)return;let y=r[o],_=(r[o].x+y.metrics.advance*y.scale)*l;for(let v=t;v<=o;v++)r[v].x-=_,r[v].y+=d}function i3(r,t,o){let{horizontalAlign:l,verticalAlign:d}=qm(o),y=t[0]-r.displaySize[0]*l,_=t[1]-r.displaySize[1]*d;return{image:r,top:_,bottom:_+r.displaySize[1],left:y,right:y+r.displaySize[0]}}function l_(r){var t,o;let l=r.left,d=r.top,y=r.right-l,_=r.bottom-d,v=(t=r.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",w=(o=r.image.textFitHeight)!==null&&o!==void 0?o:"stretchOrShrink",S=(r.image.content[2]-r.image.content[0])/(r.image.content[3]-r.image.content[1]);if(w==="proportional"){if(v==="stretchOnly"&&y/_<S||v==="proportional"){let T=Math.ceil(_*S);l*=T/y,y=T}}else if(v==="proportional"&&w==="stretchOnly"&&S!==0&&y/_>S){let T=Math.ceil(y/S);d*=T/_,_=T}return{x1:l,y1:d,x2:l+y,y2:d+_}}function c_(r,t,o,l,d,y){let _=r.image,v;if(_.content){let H=_.content,K=_.pixelRatio||1;v=[H[0]/K,H[1]/K,_.displaySize[0]-H[2]/K,_.displaySize[1]-H[3]/K]}let w=t.left*y,S=t.right*y,T,z,M,R;o==="width"||o==="both"?(R=d[0]+w-l[3],z=d[0]+S+l[1]):(R=d[0]+(w+S-_.displaySize[0])/2,z=R+_.displaySize[0]);let O=t.top*y,V=t.bottom*y;return o==="height"||o==="both"?(T=d[1]+O-l[0],M=d[1]+V+l[2]):(T=d[1]+(O+V-_.displaySize[1])/2,M=T+_.displaySize[1]),{image:_,top:T,right:z,bottom:M,left:R,collisionPadding:v}}let $u=255,ho=128,Oa=$u*ho;function u_(r,t){let{expression:o}=t;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new Ut(r+1))};if(o.kind==="source")return{kind:"source"};{let{zoomStops:l,interpolationType:d}=o,y=0;for(;y<l.length&&l[y]<=r;)y++;y=Math.max(0,y-1);let _=y;for(;_<l.length&&l[_]<r+1;)_++;_=Math.min(l.length-1,_);let v=l[y],w=l[_];return o.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:w,interpolationType:d}:{kind:"camera",minZoom:v,maxZoom:w,minSize:o.evaluate(new Ut(v)),maxSize:o.evaluate(new Ut(w)),interpolationType:d}}}function $m(r,t,o){let l="never",d=r.get(t);return d?l=d:r.get(o)&&(l="always"),l}let r3=Fa.VectorTileFeature.types,n3=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Xd(r,t,o,l,d,y,_,v,w,S,T,z,M){let R=v?Math.min(Oa,Math.round(v[0])):0,O=v?Math.min(Oa,Math.round(v[1])):0;r.emplaceBack(t,o,Math.round(32*l),Math.round(32*d),y,_,(R<<1)+(w?1:0),O,16*S,16*T,256*z,256*M)}function Zm(r,t,o){r.emplaceBack(t.x,t.y,o),r.emplaceBack(t.x,t.y,o),r.emplaceBack(t.x,t.y,o),r.emplaceBack(t.x,t.y,o)}function o3(r){for(let t of r.sections)if(vm(t.text))return!0;return!1}class Hm{constructor(t){this.layoutVertexArray=new Vl,this.indexArray=new Qr,this.programConfigurations=t,this.segments=new wt,this.dynamicLayoutVertexArray=new Mu,this.opacityVertexArray=new Dr,this.hasVisibleVertices=!1,this.placedSymbolArray=new qt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,o,l,d){this.isEmpty()||(l&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,R5.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,F5.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,n3,!0),this.opacityVertexBuffer.itemSize=1),(l||d)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ze("SymbolBuffers",Hm);class Gm{constructor(t,o,l){this.layoutVertexArray=new t,this.layoutAttributes=o,this.indexArray=new l,this.segments=new wt,this.collisionVertexArray=new co}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,B5.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ze("CollisionBuffers",Gm);class Ql{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(_=>_.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Tm([]),this.placementViewportMatrix=Tm([]);let o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=u_(this.zoom,o["text-size"]),this.iconSizeData=u_(this.zoom,o["icon-size"]);let l=this.layers[0].layout,d=l.get("symbol-sort-key"),y=l.get("symbol-z-order");this.canOverlap=$m(l,"text-overlap","text-allow-overlap")!=="never"||$m(l,"icon-overlap","icon-allow-overlap")!=="never"||l.get("text-ignore-placement")||l.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,l.get("symbol-placement")==="point"&&(this.writingModes=l.get("text-writing-mode").map(_=>f.ah[_])),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=t.sourceID}createArrays(){this.text=new Hm(new Os(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Hm(new Os(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new $t,this.lineVertexArray=new Li,this.symbolInstances=new vt,this.textAnchorOffsets=new Zt}calculateGlyphDependencies(t,o,l,d,y){for(let _=0;_<t.length;_++)if(o[t.charCodeAt(_)]=!0,(l||d)&&y){let v=Vu[t.charAt(_)];v&&(o[v.charCodeAt(0)]=!0)}}populate(t,o,l){let d=this.layers[0],y=d.layout,_=y.get("text-font"),v=y.get("text-field"),w=y.get("icon-image"),S=(v.value.kind!=="constant"||v.value.value instanceof mr&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(_.value.kind!=="constant"||_.value.value.length>0),T=w.value.kind!=="constant"||!!w.value.value||Object.keys(w.parameters).length>0,z=y.get("symbol-sort-key");if(this.features=[],!S&&!T)return;let M=o.iconDependencies,R=o.glyphDependencies,O=o.availableImages,V=new Ut(this.zoom);for(let{feature:H,id:K,index:he,sourceLayerIndex:ie}of t){let ce=d._featureFilter.needGeometry,_e=js(H,ce);if(!d._featureFilter.filter(V,_e,l))continue;let Ce,Ue;if(ce||(_e.geometry=Ns(H)),S){let je=d.getValueAndResolveTokens("text-field",_e,l,O),Oe=mr.factory(je),Je=this.hasRTLText=this.hasRTLText||o3(Oe);(!Je||vr.getRTLTextPluginStatus()==="unavailable"||Je&&vr.isParsed())&&(Ce=N5(Oe,d,_e))}if(T){let je=d.getValueAndResolveTokens("icon-image",_e,l,O);Ue=je instanceof yr?je:yr.fromString(je)}if(!Ce&&!Ue)continue;let nt=this.sortFeaturesByKey?z.evaluate(_e,{},l):void 0;if(this.features.push({id:K,text:Ce,icon:Ue,index:he,sourceLayerIndex:ie,geometry:_e.geometry,properties:H.properties,type:r3[H.type],sortKey:nt}),Ue&&(M[Ue.name]=!0),Ce){let je=_.evaluate(_e,{},l).join(","),Oe=y.get("text-rotation-alignment")!=="viewport"&&y.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(f.ah.vertical)>=0;for(let Je of Ce.sections)if(Je.image)M[Je.image.name]=!0;else{let He=Tu(Ce.toString()),$e=Je.fontStack||je,we=R[$e]=R[$e]||{};this.calculateGlyphDependencies(Je.text,we,Oe,this.allowVerticalPlacement,He)}}}y.get("symbol-placement")==="line"&&(this.features=function(H){let K={},he={},ie=[],ce=0;function _e(je){ie.push(H[je]),ce++}function Ce(je,Oe,Je){let He=he[je];return delete he[je],he[Oe]=He,ie[He].geometry[0].pop(),ie[He].geometry[0]=ie[He].geometry[0].concat(Je[0]),He}function Ue(je,Oe,Je){let He=K[Oe];return delete K[Oe],K[je]=He,ie[He].geometry[0].shift(),ie[He].geometry[0]=Je[0].concat(ie[He].geometry[0]),He}function nt(je,Oe,Je){let He=Je?Oe[0][Oe[0].length-1]:Oe[0][0];return`${je}:${He.x}:${He.y}`}for(let je=0;je<H.length;je++){let Oe=H[je],Je=Oe.geometry,He=Oe.text?Oe.text.toString():null;if(!He){_e(je);continue}let $e=nt(He,Je),we=nt(He,Je,!0);if($e in he&&we in K&&he[$e]!==K[we]){let Qe=Ue($e,we,Je),Ke=Ce($e,we,ie[Qe].geometry);delete K[$e],delete he[we],he[nt(He,ie[Ke].geometry,!0)]=Ke,ie[Qe].geometry=null}else $e in he?Ce($e,we,Je):we in K?Ue($e,we,Je):(_e(je),K[$e]=ce-1,he[we]=ce-1)}return ie.filter(je=>je.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((H,K)=>H.sortKey-K.sortKey)}update(t,o,l){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,o,this.layers,l),this.icon.programConfigurations.updatePaintArrays(t,o,this.layers,l))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,o){let l=this.lineVertexArray.length;if(t.segment!==void 0){let d=t.dist(o[t.segment+1]),y=t.dist(o[t.segment]),_={};for(let v=t.segment+1;v<o.length;v++)_[v]={x:o[v].x,y:o[v].y,tileUnitDistanceFromAnchor:d},v<o.length-1&&(d+=o[v+1].dist(o[v]));for(let v=t.segment||0;v>=0;v--)_[v]={x:o[v].x,y:o[v].y,tileUnitDistanceFromAnchor:y},v>0&&(y+=o[v-1].dist(o[v]));for(let v=0;v<o.length;v++){let w=_[v];this.lineVertexArray.emplaceBack(w.x,w.y,w.tileUnitDistanceFromAnchor)}}return{lineStartIndex:l,lineLength:this.lineVertexArray.length-l}}addSymbols(t,o,l,d,y,_,v,w,S,T,z,M){let R=t.indexArray,O=t.layoutVertexArray,V=t.segments.prepareSegment(4*o.length,O,R,this.canOverlap?_.sortKey:void 0),H=this.glyphOffsetArray.length,K=V.vertexLength,he=this.allowVerticalPlacement&&v===f.ah.vertical?Math.PI/2:0,ie=_.text&&_.text.sections;for(let ce=0;ce<o.length;ce++){let{tl:_e,tr:Ce,bl:Ue,br:nt,tex:je,pixelOffsetTL:Oe,pixelOffsetBR:Je,minFontScaleX:He,minFontScaleY:$e,glyphOffset:we,isSDF:Qe,sectionIndex:Ke}=o[ce],lt=V.vertexLength,Ot=we[1];Xd(O,w.x,w.y,_e.x,Ot+_e.y,je.x,je.y,l,Qe,Oe.x,Oe.y,He,$e),Xd(O,w.x,w.y,Ce.x,Ot+Ce.y,je.x+je.w,je.y,l,Qe,Je.x,Oe.y,He,$e),Xd(O,w.x,w.y,Ue.x,Ot+Ue.y,je.x,je.y+je.h,l,Qe,Oe.x,Je.y,He,$e),Xd(O,w.x,w.y,nt.x,Ot+nt.y,je.x+je.w,je.y+je.h,l,Qe,Je.x,Je.y,He,$e),Zm(t.dynamicLayoutVertexArray,w,he),R.emplaceBack(lt,lt+1,lt+2),R.emplaceBack(lt+1,lt+2,lt+3),V.vertexLength+=4,V.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(we[0]),ce!==o.length-1&&Ke===o[ce+1].sectionIndex||t.programConfigurations.populatePaintArrays(O.length,_,_.index,{},M,ie&&ie[Ke])}t.placedSymbolArray.emplaceBack(w.x,w.y,H,this.glyphOffsetArray.length-H,K,S,T,w.segment,l?l[0]:0,l?l[1]:0,d[0],d[1],v,0,!1,0,z)}_addCollisionDebugVertex(t,o,l,d,y,_){return o.emplaceBack(0,0),t.emplaceBack(l.x,l.y,d,y,Math.round(_.x),Math.round(_.y))}addCollisionDebugVertices(t,o,l,d,y,_,v){let w=y.segments.prepareSegment(4,y.layoutVertexArray,y.indexArray),S=w.vertexLength,T=y.layoutVertexArray,z=y.collisionVertexArray,M=v.anchorX,R=v.anchorY;this._addCollisionDebugVertex(T,z,_,M,R,new B(t,o)),this._addCollisionDebugVertex(T,z,_,M,R,new B(l,o)),this._addCollisionDebugVertex(T,z,_,M,R,new B(l,d)),this._addCollisionDebugVertex(T,z,_,M,R,new B(t,d)),w.vertexLength+=4;let O=y.indexArray;O.emplaceBack(S,S+1),O.emplaceBack(S+1,S+2),O.emplaceBack(S+2,S+3),O.emplaceBack(S+3,S),w.primitiveLength+=4}addDebugCollisionBoxes(t,o,l,d){for(let y=t;y<o;y++){let _=this.collisionBoxArray.get(y);this.addCollisionDebugVertices(_.x1,_.y1,_.x2,_.y2,d?this.textCollisionBox:this.iconCollisionBox,_.anchorPoint,l)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Gm(Rr,Gy.members,Ci),this.iconCollisionBox=new Gm(Rr,Gy.members,Ci);for(let t=0;t<this.symbolInstances.length;t++){let o=this.symbolInstances.get(t);this.addDebugCollisionBoxes(o.textBoxStartIndex,o.textBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o,!0),this.addDebugCollisionBoxes(o.iconBoxStartIndex,o.iconBoxEndIndex,o,!1),this.addDebugCollisionBoxes(o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o,!1)}}_deserializeCollisionBoxesForSymbol(t,o,l,d,y,_,v,w,S){let T={};for(let z=o;z<l;z++){let M=t.get(z);T.textBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,anchorPointX:M.anchorPointX,anchorPointY:M.anchorPointY},T.textFeatureIndex=M.featureIndex;break}for(let z=d;z<y;z++){let M=t.get(z);T.verticalTextBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,anchorPointX:M.anchorPointX,anchorPointY:M.anchorPointY},T.verticalTextFeatureIndex=M.featureIndex;break}for(let z=_;z<v;z++){let M=t.get(z);T.iconBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,anchorPointX:M.anchorPointX,anchorPointY:M.anchorPointY},T.iconFeatureIndex=M.featureIndex;break}for(let z=w;z<S;z++){let M=t.get(z);T.verticalIconBox={x1:M.x1,y1:M.y1,x2:M.x2,y2:M.y2,anchorPointX:M.anchorPointX,anchorPointY:M.anchorPointY},T.verticalIconFeatureIndex=M.featureIndex;break}return T}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){let l=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,l.textBoxStartIndex,l.textBoxEndIndex,l.verticalTextBoxStartIndex,l.verticalTextBoxEndIndex,l.iconBoxStartIndex,l.iconBoxEndIndex,l.verticalIconBoxStartIndex,l.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,o){let l=t.placedSymbolArray.get(o),d=l.vertexStartIndex+4*l.numGlyphs;for(let y=l.vertexStartIndex;y<d;y+=4)t.indexArray.emplaceBack(y,y+1,y+2),t.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let o=Math.sin(t),l=Math.cos(t),d=[],y=[],_=[];for(let v=0;v<this.symbolInstances.length;++v){_.push(v);let w=this.symbolInstances.get(v);d.push(0|Math.round(o*w.anchorX+l*w.anchorY)),y.push(w.featureIndex)}return _.sort((v,w)=>d[v]-d[w]||y[w]-y[v]),_}addToSortKeyRanges(t,o){let l=this.sortKeyRanges[this.sortKeyRanges.length-1];l&&l.sortKey===o?l.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let o of this.symbolInstanceIndexes){let l=this.symbolInstances.get(o);this.featureSortOrder.push(l.featureIndex),[l.rightJustifiedTextSymbolIndex,l.centerJustifiedTextSymbolIndex,l.leftJustifiedTextSymbolIndex].forEach((d,y,_)=>{d>=0&&_.indexOf(d)===y&&this.addIndicesForPlacedSymbol(this.text,d)}),l.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,l.verticalPlacedTextSymbolIndex),l.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.placedIconSymbolIndex),l.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,l.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let h_,d_;Ze("SymbolBucket",Ql,{omit:["layers","collisionBoxArray","features","compareText"]}),Ql.MAX_GLYPHS=65535,Ql.addDynamicAttributes=Zm;var Wm={get paint(){return d_=d_||new g({"icon-opacity":new ot(ye.paint_symbol["icon-opacity"]),"icon-color":new ot(ye.paint_symbol["icon-color"]),"icon-halo-color":new ot(ye.paint_symbol["icon-halo-color"]),"icon-halo-width":new ot(ye.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ot(ye.paint_symbol["icon-halo-blur"]),"icon-translate":new We(ye.paint_symbol["icon-translate"]),"icon-translate-anchor":new We(ye.paint_symbol["icon-translate-anchor"]),"text-opacity":new ot(ye.paint_symbol["text-opacity"]),"text-color":new ot(ye.paint_symbol["text-color"],{runtimeType:Yi,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new ot(ye.paint_symbol["text-halo-color"]),"text-halo-width":new ot(ye.paint_symbol["text-halo-width"]),"text-halo-blur":new ot(ye.paint_symbol["text-halo-blur"]),"text-translate":new We(ye.paint_symbol["text-translate"]),"text-translate-anchor":new We(ye.paint_symbol["text-translate-anchor"])})},get layout(){return h_=h_||new g({"symbol-placement":new We(ye.layout_symbol["symbol-placement"]),"symbol-spacing":new We(ye.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new We(ye.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ot(ye.layout_symbol["symbol-sort-key"]),"symbol-z-order":new We(ye.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new We(ye.layout_symbol["icon-allow-overlap"]),"icon-overlap":new We(ye.layout_symbol["icon-overlap"]),"icon-ignore-placement":new We(ye.layout_symbol["icon-ignore-placement"]),"icon-optional":new We(ye.layout_symbol["icon-optional"]),"icon-rotation-alignment":new We(ye.layout_symbol["icon-rotation-alignment"]),"icon-size":new ot(ye.layout_symbol["icon-size"]),"icon-text-fit":new We(ye.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new We(ye.layout_symbol["icon-text-fit-padding"]),"icon-image":new ot(ye.layout_symbol["icon-image"]),"icon-rotate":new ot(ye.layout_symbol["icon-rotate"]),"icon-padding":new ot(ye.layout_symbol["icon-padding"]),"icon-keep-upright":new We(ye.layout_symbol["icon-keep-upright"]),"icon-offset":new ot(ye.layout_symbol["icon-offset"]),"icon-anchor":new ot(ye.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new We(ye.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new We(ye.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new We(ye.layout_symbol["text-rotation-alignment"]),"text-field":new ot(ye.layout_symbol["text-field"]),"text-font":new ot(ye.layout_symbol["text-font"]),"text-size":new ot(ye.layout_symbol["text-size"]),"text-max-width":new ot(ye.layout_symbol["text-max-width"]),"text-line-height":new We(ye.layout_symbol["text-line-height"]),"text-letter-spacing":new ot(ye.layout_symbol["text-letter-spacing"]),"text-justify":new ot(ye.layout_symbol["text-justify"]),"text-radial-offset":new ot(ye.layout_symbol["text-radial-offset"]),"text-variable-anchor":new We(ye.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ot(ye.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ot(ye.layout_symbol["text-anchor"]),"text-max-angle":new We(ye.layout_symbol["text-max-angle"]),"text-writing-mode":new We(ye.layout_symbol["text-writing-mode"]),"text-rotate":new ot(ye.layout_symbol["text-rotate"]),"text-padding":new We(ye.layout_symbol["text-padding"]),"text-keep-upright":new We(ye.layout_symbol["text-keep-upright"]),"text-transform":new ot(ye.layout_symbol["text-transform"]),"text-offset":new ot(ye.layout_symbol["text-offset"]),"text-allow-overlap":new We(ye.layout_symbol["text-allow-overlap"]),"text-overlap":new We(ye.layout_symbol["text-overlap"]),"text-ignore-placement":new We(ye.layout_symbol["text-ignore-placement"]),"text-optional":new We(ye.layout_symbol["text-optional"])})}};class p_{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:oo,this.defaultValue=t}evaluate(t){if(t.formattedSection){let o=this.defaultValue.property.overrides;if(o&&o.hasOverride(t.formattedSection))return o.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ze("FormatSectionOverride",p_,{omit:["defaultValue"]});class Kd extends a{constructor(t){super(t,Wm)}recalculate(t,o){if(super.recalculate(t,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let l=this.layout.get("text-writing-mode");if(l){let d=[];for(let y of l)d.indexOf(y)<0&&d.push(y);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,o,l,d){let y=this.layout.get(t).evaluate(o,{},l,d),_=this._unevaluatedLayout._values[t];return _.isDataDriven()||Tl(_.value)||!y?y:function(v,w){return w.replace(/{([^{}]+)}/g,(S,T)=>v&&T in v?String(v[T]):"")}(o.properties,y)}createBucket(t){return new Ql(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let t of Wm.paint.overridableProperties){if(!Kd.hasPaintOverride(this.layout,t))continue;let o=this.paint.get(t),l=new p_(o),d=new El(l,o.property.specification),y=null;y=o.value.kind==="constant"||o.value.kind==="source"?new xa("source",d):new wa("composite",d,o.value.zoomStops),this.paint._values[t]=new bn(o.property,y,o.parameters)}}_handleOverridablePaintPropertyUpdate(t,o,l){return!(!this.layout||o.isDataDriven()||l.isDataDriven())&&Kd.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,o){let l=t.get("text-field"),d=Wm.paint.properties[o],y=!1,_=v=>{for(let w of v)if(d.overrides&&d.overrides.hasOverride(w))return void(y=!0)};if(l.value.kind==="constant"&&l.value.value instanceof mr)_(l.value.value.sections);else if(l.value.kind==="source"){let v=S=>{y||(S instanceof Gr&&pi(S.value)===On?_(S.value.sections):S instanceof gl?_(S.sections):S.eachChild(v))},w=l.value;w._styleExpression&&v(w._styleExpression.expression)}return y}}let f_;var a3={get paint(){return f_=f_||new g({"background-color":new We(ye.paint_background["background-color"]),"background-pattern":new Nl(ye.paint_background["background-pattern"]),"background-opacity":new We(ye.paint_background["background-opacity"])})}};class s3 extends a{constructor(t){super(t,a3)}}let m_;var l3={get paint(){return m_=m_||new g({"raster-opacity":new We(ye.paint_raster["raster-opacity"]),"raster-hue-rotate":new We(ye.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new We(ye.paint_raster["raster-brightness-min"]),"raster-brightness-max":new We(ye.paint_raster["raster-brightness-max"]),"raster-saturation":new We(ye.paint_raster["raster-saturation"]),"raster-contrast":new We(ye.paint_raster["raster-contrast"]),"raster-resampling":new We(ye.paint_raster["raster-resampling"]),"raster-fade-duration":new We(ye.paint_raster["raster-fade-duration"])})}};class c3 extends a{constructor(t){super(t,l3)}}class u3 extends a{constructor(t){super(t,{}),this.onAdd=o=>{this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)},this.onRemove=o=>{this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class h3{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}let Xm=63710088e-1;class Na{constructor(t,o){if(isNaN(t)||isNaN(o))throw new Error(`Invalid LngLat object: (${t}, ${o})`);if(this.lng=+t,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Na(be(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){let o=Math.PI/180,l=this.lat*o,d=t.lat*o,y=Math.sin(l)*Math.sin(d)+Math.cos(l)*Math.cos(d)*Math.cos((t.lng-this.lng)*o);return Xm*Math.acos(Math.min(y,1))}static convert(t){if(t instanceof Na)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Na(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Na(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}let g_=2*Math.PI*Xm;function y_(r){return g_*Math.cos(r*Math.PI/180)}function __(r){return(180+r)/360}function v_(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function x_(r,t){return r/y_(t)}function Km(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}class Zu{constructor(t,o,l=0){this.x=+t,this.y=+o,this.z=+l}static fromLngLat(t,o=0){let l=Na.convert(t);return new Zu(__(l.lng),v_(l.lat),x_(o,l.lat))}toLngLat(){return new Na(360*this.x-180,Km(this.y))}toAltitude(){return this.z*y_(Km(this.y))}meterInMercatorCoordinateUnits(){return 1/g_*(t=Km(this.y),1/Math.cos(t*Math.PI/180));var t}}function w_(r,t,o){var l=2*Math.PI*6378137/256/Math.pow(2,o);return[r*l-2*Math.PI*6378137/2,t*l-2*Math.PI*6378137/2]}class Jm{constructor(t,o,l){if(!function(d,y,_){return!(d<0||d>25||_<0||_>=Math.pow(2,d)||y<0||y>=Math.pow(2,d))}(t,o,l))throw new Error(`x=${o}, y=${l}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=o,this.y=l,this.key=Hu(0,t,t,o,l)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,o,l){let d=(_=this.y,v=this.z,w=w_(256*(y=this.x),256*(_=Math.pow(2,v)-_-1),v),S=w_(256*(y+1),256*(_+1),v),w[0]+","+w[1]+","+S[0]+","+S[1]);var y,_,v,w,S;let T=function(z,M,R){let O,V="";for(let H=z;H>0;H--)O=1<<H-1,V+=(M&O?1:0)+(R&O?2:0);return V}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,o>1?"@2x":"").replace(/{quadkey}/g,T).replace(/{bbox-epsg-3857}/g,d)}isChildOf(t){let o=this.z-t.z;return o>0&&t.x===this.x>>o&&t.y===this.y>>o}getTilePoint(t){let o=Math.pow(2,this.z);return new B((t.x*o-this.x)*fi,(t.y*o-this.y)*fi)}toString(){return`${this.z}/${this.x}/${this.y}`}}class b_{constructor(t,o){this.wrap=t,this.canonical=o,this.key=Hu(t,o.z,o.z,o.x,o.y)}}class tn{constructor(t,o,l,d,y){if(t<l)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${l}`);this.overscaledZ=t,this.wrap=o,this.canonical=new Jm(l,+d,+y),this.key=Hu(o,t,l,d,y)}clone(){return new tn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);let o=this.canonical.z-t;return t>this.canonical.z?new tn(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new tn(t,this.wrap,t,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(t,o){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);let l=this.canonical.z-t;return t>this.canonical.z?Hu(this.wrap*+o,t,this.canonical.z,this.canonical.x,this.canonical.y):Hu(this.wrap*+o,t,t,this.canonical.x>>l,this.canonical.y>>l)}isChildOf(t){if(t.wrap!==this.wrap)return!1;let o=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>o&&t.canonical.y===this.canonical.y>>o}children(t){if(this.overscaledZ>=t)return[new tn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let o=this.canonical.z+1,l=2*this.canonical.x,d=2*this.canonical.y;return[new tn(o,this.wrap,o,l,d),new tn(o,this.wrap,o,l+1,d),new tn(o,this.wrap,o,l,d+1),new tn(o,this.wrap,o,l+1,d+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new tn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new tn(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new b_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new Zu(t.x-this.wrap,t.y))}}function Hu(r,t,o,l,d){(r*=2)<0&&(r=-1*r-1);let y=1<<o;return(y*y*r+y*d+l).toString(36)+o.toString(36)+t.toString(36)}Ze("CanonicalTileID",Jm),Ze("OverscaledTileID",tn,{omit:["posMatrix"]});class k_{constructor(t,o,l,d=1,y=1,_=1,v=0){if(this.uid=t,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(l&&!["mapbox","terrarium","custom"].includes(l))return void Wt(`"${l}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=o.height;let w=this.dim=o.height-2;switch(this.data=new Uint32Array(o.data.buffer),l){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=d,this.greenFactor=y,this.blueFactor=_,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let S=0;S<w;S++)this.data[this._idx(-1,S)]=this.data[this._idx(0,S)],this.data[this._idx(w,S)]=this.data[this._idx(w-1,S)],this.data[this._idx(S,-1)]=this.data[this._idx(S,0)],this.data[this._idx(S,w)]=this.data[this._idx(S,w-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(w,-1)]=this.data[this._idx(w-1,0)],this.data[this._idx(-1,w)]=this.data[this._idx(0,w-1)],this.data[this._idx(w,w)]=this.data[this._idx(w-1,w-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let S=0;S<w;S++)for(let T=0;T<w;T++){let z=this.get(S,T);z>this.max&&(this.max=z),z<this.min&&(this.min=z)}}get(t,o){let l=new Uint8Array(this.data.buffer),d=4*this._idx(t,o);return this.unpack(l[d],l[d+1],l[d+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,o){if(t<-1||t>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(t+1)}unpack(t,o,l){return t*this.redFactor+o*this.greenFactor+l*this.blueFactor-this.baseShift}getPixels(){return new en({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,o,l){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let d=o*this.dim,y=o*this.dim+this.dim,_=l*this.dim,v=l*this.dim+this.dim;switch(o){case-1:d=y-1;break;case 1:y=d+1}switch(l){case-1:_=v-1;break;case 1:v=_+1}let w=-o*this.dim,S=-l*this.dim;for(let T=_;T<v;T++)for(let z=d;z<y;z++)this.data[this._idx(z,T)]=t.data[this._idx(z+w,T+S)]}}Ze("DEMData",k_);class S_{constructor(t){this._stringToNumber={},this._numberToString=[];for(let o=0;o<t.length;o++){let l=t[o];this._stringToNumber[l]=o,this._numberToString[o]=l}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class E_{constructor(t,o,l,d,y){this.type="Feature",this._vectorTileFeature=t,t._z=o,t._x=l,t._y=d,this.properties=t.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){let t={geometry:this.geometry};for(let o in this)o!=="_geometry"&&o!=="_vectorTileFeature"&&(t[o]=this[o]);return t}}class T_{constructor(t,o){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Ea(fi,16,0),this.grid3D=new Ea(fi,16,0),this.featureIndexArray=new $i,this.promoteId=o}insert(t,o,l,d,y,_){let v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(l,d,y);let w=_?this.grid3D:this.grid;for(let S=0;S<o.length;S++){let T=o[S],z=[1/0,1/0,-1/0,-1/0];for(let M=0;M<T.length;M++){let R=T[M];z[0]=Math.min(z[0],R.x),z[1]=Math.min(z[1],R.y),z[2]=Math.max(z[2],R.x),z[3]=Math.max(z[3],R.y)}z[0]<fi&&z[1]<fi&&z[2]>=0&&z[3]>=0&&w.insert(v,z[0],z[1],z[2],z[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Fa.VectorTile(new Nm(this.rawTileData)).layers,this.sourceLayerCoder=new S_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,o,l,d){this.loadVTLayers();let y=t.params||{},_=fi/t.tileSize/t.scale,v=hu(y.filter),w=t.queryGeometry,S=t.queryPadding*_,T=z_(w),z=this.grid.query(T.minX-S,T.minY-S,T.maxX+S,T.maxY+S),M=z_(t.cameraQueryGeometry),R=this.grid3D.query(M.minX-S,M.minY-S,M.maxX+S,M.maxY+S,(H,K,he,ie)=>function(ce,_e,Ce,Ue,nt){for(let Oe of ce)if(_e<=Oe.x&&Ce<=Oe.y&&Ue>=Oe.x&&nt>=Oe.y)return!0;let je=[new B(_e,Ce),new B(_e,nt),new B(Ue,nt),new B(Ue,Ce)];if(ce.length>2){for(let Oe of je)if(Hl(ce,Oe))return!0}for(let Oe=0;Oe<ce.length-1;Oe++)if(Zb(ce[Oe],ce[Oe+1],je))return!0;return!1}(t.cameraQueryGeometry,H-S,K-S,he+S,ie+S));for(let H of R)z.push(H);z.sort(d3);let O={},V;for(let H=0;H<z.length;H++){let K=z[H];if(K===V)continue;V=K;let he=this.featureIndexArray.get(K),ie=null;this.loadMatchingFeature(O,he.bucketIndex,he.sourceLayerIndex,he.featureIndex,v,y.layers,y.availableImages,o,l,d,(ce,_e,Ce)=>(ie||(ie=Ns(ce)),_e.queryIntersectsFeature(w,ce,Ce,ie,this.z,t.transform,_,t.pixelPosMatrix)))}return O}loadMatchingFeature(t,o,l,d,y,_,v,w,S,T,z){let M=this.bucketLayerIDs[o];if(_&&!function(H,K){for(let he=0;he<H.length;he++)if(K.indexOf(H[he])>=0)return!0;return!1}(_,M))return;let R=this.sourceLayerCoder.decode(l),O=this.vtLayers[R].feature(d);if(y.needGeometry){let H=js(O,!0);if(!y.filter(new Ut(this.tileID.overscaledZ),H,this.tileID.canonical))return}else if(!y.filter(new Ut(this.tileID.overscaledZ),O))return;let V=this.getId(O,R);for(let H=0;H<M.length;H++){let K=M[H];if(_&&_.indexOf(K)<0)continue;let he=w[K];if(!he)continue;let ie={};V&&T&&(ie=T.getState(he.sourceLayer||"_geojsonTileLayer",V));let ce=Ie({},S[K]);ce.paint=C_(ce.paint,he.paint,O,ie,v),ce.layout=C_(ce.layout,he.layout,O,ie,v);let _e=!z||z(O,he,ie);if(!_e)continue;let Ce=new E_(O,this.z,this.x,this.y,V);Ce.layer=ce;let Ue=t[K];Ue===void 0&&(Ue=t[K]=[]),Ue.push({featureIndex:d,feature:Ce,intersectionZ:_e})}}lookupSymbolFeatures(t,o,l,d,y,_,v,w){let S={};this.loadVTLayers();let T=hu(y);for(let z of t)this.loadMatchingFeature(S,l,d,z,T,_,v,w,o);return S}hasLayer(t){for(let o of this.bucketLayerIDs)for(let l of o)if(t===l)return!0;return!1}getId(t,o){let l=t.id;return this.promoteId&&(l=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[o]],typeof l=="boolean"&&(l=Number(l))),l}}function C_(r,t,o,l,d){return Ge(r,(y,_)=>{let v=t instanceof Rs?t.get(_):null;return v&&v.evaluate?v.evaluate(o,l,d):v})}function z_(r){let t=1/0,o=1/0,l=-1/0,d=-1/0;for(let y of r)t=Math.min(t,y.x),o=Math.min(o,y.y),l=Math.max(l,y.x),d=Math.max(d,y.y);return{minX:t,minY:o,maxX:l,maxY:d}}function d3(r,t){return t-r}function I_(r,t,o,l,d){let y=[];for(let _=0;_<r.length;_++){let v=r[_],w;for(let S=0;S<v.length-1;S++){let T=v[S],z=v[S+1];T.x<t&&z.x<t||(T.x<t?T=new B(t,T.y+(t-T.x)/(z.x-T.x)*(z.y-T.y))._round():z.x<t&&(z=new B(t,T.y+(t-T.x)/(z.x-T.x)*(z.y-T.y))._round()),T.y<o&&z.y<o||(T.y<o?T=new B(T.x+(o-T.y)/(z.y-T.y)*(z.x-T.x),o)._round():z.y<o&&(z=new B(T.x+(o-T.y)/(z.y-T.y)*(z.x-T.x),o)._round()),T.x>=l&&z.x>=l||(T.x>=l?T=new B(l,T.y+(l-T.x)/(z.x-T.x)*(z.y-T.y))._round():z.x>=l&&(z=new B(l,T.y+(l-T.x)/(z.x-T.x)*(z.y-T.y))._round()),T.y>=d&&z.y>=d||(T.y>=d?T=new B(T.x+(d-T.y)/(z.y-T.y)*(z.x-T.x),d)._round():z.y>=d&&(z=new B(T.x+(d-T.y)/(z.y-T.y)*(z.x-T.x),d)._round()),w&&T.equals(w[w.length-1])||(w=[T],y.push(w)),w.push(z)))))}}return y}Ze("FeatureIndex",T_,{omit:["rawTileData","sourceLayerCoder"]});class ja extends B{constructor(t,o,l,d){super(t,o),this.angle=l,d!==void 0&&(this.segment=d)}clone(){return new ja(this.x,this.y,this.angle,this.segment)}}function P_(r,t,o,l,d){if(t.segment===void 0||o===0)return!0;let y=t,_=t.segment+1,v=0;for(;v>-o/2;){if(_--,_<0)return!1;v-=r[_].dist(y),y=r[_]}v+=r[_].dist(r[_+1]),_++;let w=[],S=0;for(;v<o/2;){let T=r[_],z=r[_+1];if(!z)return!1;let M=r[_-1].angleTo(T)-T.angleTo(z);for(M=Math.abs((M+3*Math.PI)%(2*Math.PI)-Math.PI),w.push({distance:v,angleDelta:M}),S+=M;v-w[0].distance>l;)S-=w.shift().angleDelta;if(S>d)return!1;_++,v+=T.dist(z)}return!0}function M_(r){let t=0;for(let o=0;o<r.length-1;o++)t+=r[o].dist(r[o+1]);return t}function A_(r,t,o){return r?.6*t*o:0}function L_(r,t){return Math.max(r?r.right-r.left:0,t?t.right-t.left:0)}function p3(r,t,o,l,d,y){let _=A_(o,d,y),v=L_(o,l)*y,w=0,S=M_(r)/2;for(let T=0;T<r.length-1;T++){let z=r[T],M=r[T+1],R=z.dist(M);if(w+R>S){let O=(S-w)/R,V=Qi.number(z.x,M.x,O),H=Qi.number(z.y,M.y,O),K=new ja(V,H,M.angleTo(z),T);return K._round(),!_||P_(r,K,v,_,t)?K:void 0}w+=R}}function f3(r,t,o,l,d,y,_,v,w){let S=A_(l,y,_),T=L_(l,d),z=T*_,M=r[0].x===0||r[0].x===w||r[0].y===0||r[0].y===w;return t-z<t/4&&(t=z+t/4),D_(r,M?t/2*v%t:(T/2+2*y)*_*v%t,t,S,o,z,M,!1,w)}function D_(r,t,o,l,d,y,_,v,w){let S=y/2,T=M_(r),z=0,M=t-o,R=[];for(let O=0;O<r.length-1;O++){let V=r[O],H=r[O+1],K=V.dist(H),he=H.angleTo(V);for(;M+o<z+K;){M+=o;let ie=(M-z)/K,ce=Qi.number(V.x,H.x,ie),_e=Qi.number(V.y,H.y,ie);if(ce>=0&&ce<w&&_e>=0&&_e<w&&M-S>=0&&M+S<=T){let Ce=new ja(ce,_e,he,O);Ce._round(),l&&!P_(r,Ce,y,l,d)||R.push(Ce)}}z+=K}return v||R.length||_||(R=D_(r,z/2,o,l,d,y,_,!0,w)),R}Ze("Anchor",ja);let ec=wr;function R_(r,t,o,l){let d=[],y=r.image,_=y.pixelRatio,v=y.paddedRect.w-2*ec,w=y.paddedRect.h-2*ec,S={x1:r.left,y1:r.top,x2:r.right,y2:r.bottom},T=y.stretchX||[[0,v]],z=y.stretchY||[[0,w]],M=(we,Qe)=>we+Qe[1]-Qe[0],R=T.reduce(M,0),O=z.reduce(M,0),V=v-R,H=w-O,K=0,he=R,ie=0,ce=O,_e=0,Ce=V,Ue=0,nt=H;if(y.content&&l){let we=y.content,Qe=we[2]-we[0],Ke=we[3]-we[1];(y.textFitWidth||y.textFitHeight)&&(S=l_(r)),K=Jd(T,0,we[0]),ie=Jd(z,0,we[1]),he=Jd(T,we[0],we[2]),ce=Jd(z,we[1],we[3]),_e=we[0]-K,Ue=we[1]-ie,Ce=Qe-he,nt=Ke-ce}let je=S.x1,Oe=S.y1,Je=S.x2-je,He=S.y2-Oe,$e=(we,Qe,Ke,lt)=>{let Ot=Yd(we.stretch-K,he,Je,je),Ft=Qd(we.fixed-_e,Ce,we.stretch,R),xi=Yd(Qe.stretch-ie,ce,He,Oe),Sn=Qd(Qe.fixed-Ue,nt,Qe.stretch,O),Bi=Yd(Ke.stretch-K,he,Je,je),wi=Qd(Ke.fixed-_e,Ce,Ke.stretch,R),rr=Yd(lt.stretch-ie,ce,He,Oe),nr=Qd(lt.fixed-Ue,nt,lt.stretch,O),or=new B(Ot,xi),oi=new B(Bi,xi),bi=new B(Bi,rr),Hi=new B(Ot,rr),Oi=new B(Ft/_,Sn/_),ar=new B(wi/_,nr/_),Ni=t*Math.PI/180;if(Ni){let Ct=Math.sin(Ni),jt=Math.cos(Ni),Ht=[jt,-Ct,Ct,jt];or._matMult(Ht),oi._matMult(Ht),Hi._matMult(Ht),bi._matMult(Ht)}let rn=we.stretch+we.fixed,br=Qe.stretch+Qe.fixed;return{tl:or,tr:oi,bl:Hi,br:bi,tex:{x:y.paddedRect.x+ec+rn,y:y.paddedRect.y+ec+br,w:Ke.stretch+Ke.fixed-rn,h:lt.stretch+lt.fixed-br},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Oi,pixelOffsetBR:ar,minFontScaleX:Ce/_/Je,minFontScaleY:nt/_/He,isSDF:o}};if(l&&(y.stretchX||y.stretchY)){let we=F_(T,V,R),Qe=F_(z,H,O);for(let Ke=0;Ke<we.length-1;Ke++){let lt=we[Ke],Ot=we[Ke+1];for(let Ft=0;Ft<Qe.length-1;Ft++)d.push($e(lt,Qe[Ft],Ot,Qe[Ft+1]))}}else d.push($e({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:w+1}));return d}function Jd(r,t,o){let l=0;for(let d of r)l+=Math.max(t,Math.min(o,d[1]))-Math.max(t,Math.min(o,d[0]));return l}function F_(r,t,o){let l=[{fixed:-ec,stretch:0}];for(let[d,y]of r){let _=l[l.length-1];l.push({fixed:d-_.stretch,stretch:_.stretch}),l.push({fixed:d-_.stretch,stretch:_.stretch+(y-d)})}return l.push({fixed:t+ec,stretch:o}),l}function Yd(r,t,o,l){return r/t*o+l}function Qd(r,t,o,l){return r-t*o/l}class ep{constructor(t,o,l,d,y,_,v,w,S,T){var z;if(this.boxStartIndex=t.length,S){let M=_.top,R=_.bottom,O=_.collisionPadding;O&&(M-=O[1],R+=O[3]);let V=R-M;V>0&&(V=Math.max(10,V),this.circleDiameter=V)}else{let M=!((z=_.image)===null||z===void 0)&&z.content&&(_.image.textFitWidth||_.image.textFitHeight)?l_(_):{x1:_.left,y1:_.top,x2:_.right,y2:_.bottom};M.y1=M.y1*v-w[0],M.y2=M.y2*v+w[2],M.x1=M.x1*v-w[3],M.x2=M.x2*v+w[1];let R=_.collisionPadding;if(R&&(M.x1-=R[0]*v,M.y1-=R[1]*v,M.x2+=R[2]*v,M.y2+=R[3]*v),T){let O=new B(M.x1,M.y1),V=new B(M.x2,M.y1),H=new B(M.x1,M.y2),K=new B(M.x2,M.y2),he=T*Math.PI/180;O._rotate(he),V._rotate(he),H._rotate(he),K._rotate(he),M.x1=Math.min(O.x,V.x,H.x,K.x),M.x2=Math.max(O.x,V.x,H.x,K.x),M.y1=Math.min(O.y,V.y,H.y,K.y),M.y2=Math.max(O.y,V.y,H.y,K.y)}t.emplaceBack(o.x,o.y,M.x1,M.y1,M.x2,M.y2,l,d,y)}this.boxEndIndex=t.length}}class m3{constructor(t=[],o=(l,d)=>l<d?-1:l>d?1:0){if(this.data=t,this.length=this.data.length,this.compare=o,this.length>0)for(let l=(this.length>>1)-1;l>=0;l--)this._down(l)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;let t=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),t}peek(){return this.data[0]}_up(t){let{data:o,compare:l}=this,d=o[t];for(;t>0;){let y=t-1>>1,_=o[y];if(l(d,_)>=0)break;o[t]=_,t=y}o[t]=d}_down(t){let{data:o,compare:l}=this,d=this.length>>1,y=o[t];for(;t<d;){let _=1+(t<<1),v=_+1;if(v<this.length&&l(o[v],o[_])<0&&(_=v),l(o[_],y)>=0)break;o[t]=o[_],t=_}o[t]=y}}function g3(r,t=1,o=!1){let l=1/0,d=1/0,y=-1/0,_=-1/0,v=r[0];for(let R=0;R<v.length;R++){let O=v[R];(!R||O.x<l)&&(l=O.x),(!R||O.y<d)&&(d=O.y),(!R||O.x>y)&&(y=O.x),(!R||O.y>_)&&(_=O.y)}let w=Math.min(y-l,_-d),S=w/2,T=new m3([],y3);if(w===0)return new B(l,d);for(let R=l;R<y;R+=w)for(let O=d;O<_;O+=w)T.push(new tc(R+S,O+S,S,r));let z=function(R){let O=0,V=0,H=0,K=R[0];for(let he=0,ie=K.length,ce=ie-1;he<ie;ce=he++){let _e=K[he],Ce=K[ce],Ue=_e.x*Ce.y-Ce.x*_e.y;V+=(_e.x+Ce.x)*Ue,H+=(_e.y+Ce.y)*Ue,O+=3*Ue}return new tc(V/O,H/O,0,R)}(r),M=T.length;for(;T.length;){let R=T.pop();(R.d>z.d||!z.d)&&(z=R,o&&console.log("found best %d after %d probes",Math.round(1e4*R.d)/1e4,M)),R.max-z.d<=t||(S=R.h/2,T.push(new tc(R.p.x-S,R.p.y-S,S,r)),T.push(new tc(R.p.x+S,R.p.y-S,S,r)),T.push(new tc(R.p.x-S,R.p.y+S,S,r)),T.push(new tc(R.p.x+S,R.p.y+S,S,r)),M+=4)}return o&&(console.log(`num probes: ${M}`),console.log(`best distance: ${z.d}`)),z.p}function y3(r,t){return t.max-r.max}function tc(r,t,o,l){this.p=new B(r,t),this.h=o,this.d=function(d,y){let _=!1,v=1/0;for(let w=0;w<y.length;w++){let S=y[w];for(let T=0,z=S.length,M=z-1;T<z;M=T++){let R=S[T],O=S[M];R.y>d.y!=O.y>d.y&&d.x<(O.x-R.x)*(d.y-R.y)/(O.y-R.y)+R.x&&(_=!_),v=Math.min(v,vy(d,R,O))}}return(_?1:-1)*Math.sqrt(v)}(this.p,l),this.max=this.d+this.h*Math.SQRT2}var Fi;f.aq=void 0,(Fi=f.aq||(f.aq={}))[Fi.center=1]="center",Fi[Fi.left=2]="left",Fi[Fi.right=3]="right",Fi[Fi.top=4]="top",Fi[Fi.bottom=5]="bottom",Fi[Fi["top-left"]=6]="top-left",Fi[Fi["top-right"]=7]="top-right",Fi[Fi["bottom-left"]=8]="bottom-left",Fi[Fi["bottom-right"]=9]="bottom-right";let Va=7,Ym=Number.POSITIVE_INFINITY;function B_(r,t){return t[1]!==Ym?function(o,l,d){let y=0,_=0;switch(l=Math.abs(l),d=Math.abs(d),o){case"top-right":case"top-left":case"top":_=d-Va;break;case"bottom-right":case"bottom-left":case"bottom":_=-d+Va}switch(o){case"top-right":case"bottom-right":case"right":y=-l;break;case"top-left":case"bottom-left":case"left":y=l}return[y,_]}(r,t[0],t[1]):function(o,l){let d=0,y=0;l<0&&(l=0);let _=l/Math.SQRT2;switch(o){case"top-right":case"top-left":y=_-Va;break;case"bottom-right":case"bottom-left":y=-_+Va;break;case"bottom":y=-l+Va;break;case"top":y=l-Va}switch(o){case"top-right":case"bottom-right":d=-_;break;case"top-left":case"bottom-left":d=_;break;case"left":d=l;break;case"right":d=-l}return[d,y]}(r,t[0])}function O_(r,t,o){var l;let d=r.layout,y=(l=d.get("text-variable-anchor-offset"))===null||l===void 0?void 0:l.evaluate(t,{},o);if(y){let v=y.values,w=[];for(let S=0;S<v.length;S+=2){let T=w[S]=v[S],z=v[S+1].map(M=>M*gi);T.startsWith("top")?z[1]-=Va:T.startsWith("bottom")&&(z[1]+=Va),w[S+1]=z}return new Ir(w)}let _=d.get("text-variable-anchor");if(_){let v;v=r._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[d.get("text-radial-offset").evaluate(t,{},o)*gi,Ym]:d.get("text-offset").evaluate(t,{},o).map(S=>S*gi);let w=[];for(let S of _)w.push(S,B_(S,v));return new Ir(w)}return null}function Qm(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function _3(r,t,o,l,d,y,_,v,w,S,T){let z=y.textMaxSize.evaluate(t,{});z===void 0&&(z=_);let M=r.layers[0].layout,R=M.get("icon-offset").evaluate(t,{},T),O=j_(o.horizontal),V=_/24,H=r.tilePixelRatio*V,K=r.tilePixelRatio*z/24,he=r.tilePixelRatio*v,ie=r.tilePixelRatio*M.get("symbol-spacing"),ce=M.get("text-padding")*r.tilePixelRatio,_e=function(we,Qe,Ke,lt=1){let Ot=we.get("icon-padding").evaluate(Qe,{},Ke),Ft=Ot&&Ot.values;return[Ft[0]*lt,Ft[1]*lt,Ft[2]*lt,Ft[3]*lt]}(M,t,T,r.tilePixelRatio),Ce=M.get("text-max-angle")/180*Math.PI,Ue=M.get("text-rotation-alignment")!=="viewport"&&M.get("symbol-placement")!=="point",nt=M.get("icon-rotation-alignment")==="map"&&M.get("symbol-placement")!=="point",je=M.get("symbol-placement"),Oe=ie/2,Je=M.get("icon-text-fit"),He;l&&Je!=="none"&&(r.allowVerticalPlacement&&o.vertical&&(He=c_(l,o.vertical,Je,M.get("icon-text-fit-padding"),R,V)),O&&(l=c_(l,O,Je,M.get("icon-text-fit-padding"),R,V)));let $e=(we,Qe)=>{Qe.x<0||Qe.x>=fi||Qe.y<0||Qe.y>=fi||function(Ke,lt,Ot,Ft,xi,Sn,Bi,wi,rr,nr,or,oi,bi,Hi,Oi,ar,Ni,rn,br,Ct,jt,Ht,Fr,ei,ic){let po=Ke.addToLineVertexArray(lt,Ot),fo,En,nn,zi,$o=0,Xu=0,$_=0,Z_=0,s1=-1,l1=-1,Zo={},H_=Ul("");if(Ke.allowVerticalPlacement&&Ft.vertical){let Gi=wi.layout.get("text-rotate").evaluate(jt,{},ei)+90;nn=new ep(rr,lt,nr,or,oi,Ft.vertical,bi,Hi,Oi,Gi),Bi&&(zi=new ep(rr,lt,nr,or,oi,Bi,Ni,rn,Oi,Gi))}if(xi){let Gi=wi.layout.get("icon-rotate").evaluate(jt,{}),on=wi.layout.get("icon-text-fit")!=="none",Us=R_(xi,Gi,Fr,on),qn=Bi?R_(Bi,Gi,Fr,on):void 0;En=new ep(rr,lt,nr,or,oi,xi,Ni,rn,!1,Gi),$o=4*Us.length;let qs=Ke.iconSizeData,mo=null;qs.kind==="source"?(mo=[ho*wi.layout.get("icon-size").evaluate(jt,{})],mo[0]>Oa&&Wt(`${Ke.layerIds[0]}: Value for "icon-size" is >= ${$u}. Reduce your "icon-size".`)):qs.kind==="composite"&&(mo=[ho*Ht.compositeIconSizes[0].evaluate(jt,{},ei),ho*Ht.compositeIconSizes[1].evaluate(jt,{},ei)],(mo[0]>Oa||mo[1]>Oa)&&Wt(`${Ke.layerIds[0]}: Value for "icon-size" is >= ${$u}. Reduce your "icon-size".`)),Ke.addSymbols(Ke.icon,Us,mo,Ct,br,jt,f.ah.none,lt,po.lineStartIndex,po.lineLength,-1,ei),s1=Ke.icon.placedSymbolArray.length-1,qn&&(Xu=4*qn.length,Ke.addSymbols(Ke.icon,qn,mo,Ct,br,jt,f.ah.vertical,lt,po.lineStartIndex,po.lineLength,-1,ei),l1=Ke.icon.placedSymbolArray.length-1)}let G_=Object.keys(Ft.horizontal);for(let Gi of G_){let on=Ft.horizontal[Gi];if(!fo){H_=Ul(on.text);let qn=wi.layout.get("text-rotate").evaluate(jt,{},ei);fo=new ep(rr,lt,nr,or,oi,on,bi,Hi,Oi,qn)}let Us=on.positionedLines.length===1;if($_+=N_(Ke,lt,on,Sn,wi,Oi,jt,ar,po,Ft.vertical?f.ah.horizontal:f.ah.horizontalOnly,Us?G_:[Gi],Zo,s1,Ht,ei),Us)break}Ft.vertical&&(Z_+=N_(Ke,lt,Ft.vertical,Sn,wi,Oi,jt,ar,po,f.ah.vertical,["vertical"],Zo,l1,Ht,ei));let w3=fo?fo.boxStartIndex:Ke.collisionBoxArray.length,b3=fo?fo.boxEndIndex:Ke.collisionBoxArray.length,k3=nn?nn.boxStartIndex:Ke.collisionBoxArray.length,S3=nn?nn.boxEndIndex:Ke.collisionBoxArray.length,E3=En?En.boxStartIndex:Ke.collisionBoxArray.length,T3=En?En.boxEndIndex:Ke.collisionBoxArray.length,C3=zi?zi.boxStartIndex:Ke.collisionBoxArray.length,z3=zi?zi.boxEndIndex:Ke.collisionBoxArray.length,Un=-1,ip=(Gi,on)=>Gi&&Gi.circleDiameter?Math.max(Gi.circleDiameter,on):on;Un=ip(fo,Un),Un=ip(nn,Un),Un=ip(En,Un),Un=ip(zi,Un);let W_=Un>-1?1:0;W_&&(Un*=ic/gi),Ke.glyphOffsetArray.length>=Ql.MAX_GLYPHS&&Wt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),jt.sortKey!==void 0&&Ke.addToSortKeyRanges(Ke.symbolInstances.length,jt.sortKey);let I3=O_(wi,jt,ei),[P3,M3]=function(Gi,on){let Us=Gi.length,qn=on?.values;if(qn?.length>0)for(let qs=0;qs<qn.length;qs+=2){let mo=qn[qs+1];Gi.emplaceBack(f.aq[qn[qs]],mo[0],mo[1])}return[Us,Gi.length]}(Ke.textAnchorOffsets,I3);Ke.symbolInstances.emplaceBack(lt.x,lt.y,Zo.right>=0?Zo.right:-1,Zo.center>=0?Zo.center:-1,Zo.left>=0?Zo.left:-1,Zo.vertical||-1,s1,l1,H_,w3,b3,k3,S3,E3,T3,C3,z3,nr,$_,Z_,$o,Xu,W_,0,bi,Un,P3,M3)}(r,Qe,we,o,l,d,He,r.layers[0],r.collisionBoxArray,t.index,t.sourceLayerIndex,r.index,H,[ce,ce,ce,ce],Ue,w,he,_e,nt,R,t,y,S,T,_)};if(je==="line")for(let we of I_(t.geometry,0,0,fi,fi)){let Qe=f3(we,ie,Ce,o.vertical||O,l,24,K,r.overscaling,fi);for(let Ke of Qe)O&&v3(r,O.text,Oe,Ke)||$e(we,Ke)}else if(je==="line-center"){for(let we of t.geometry)if(we.length>1){let Qe=p3(we,Ce,o.vertical||O,l,24,K);Qe&&$e(we,Qe)}}else if(t.type==="Polygon")for(let we of _l(t.geometry,0)){let Qe=g3(we,16);$e(we[0],new ja(Qe.x,Qe.y,0))}else if(t.type==="LineString")for(let we of t.geometry)$e(we,new ja(we[0].x,we[0].y,0));else if(t.type==="Point")for(let we of t.geometry)for(let Qe of we)$e([Qe],new ja(Qe.x,Qe.y,0))}function N_(r,t,o,l,d,y,_,v,w,S,T,z,M,R,O){let V=function(he,ie,ce,_e,Ce,Ue,nt,je){let Oe=_e.layout.get("text-rotate").evaluate(Ue,{})*Math.PI/180,Je=[];for(let He of ie.positionedLines)for(let $e of He.positionedGlyphs){if(!$e.rect)continue;let we=$e.rect||{},Qe=t_+1,Ke=!0,lt=1,Ot=0,Ft=(Ce||je)&&$e.vertical,xi=$e.metrics.advance*$e.scale/2;if(je&&ie.verticalizable&&(Ot=He.lineOffset/2-($e.imageName?-(gi-$e.metrics.width*$e.scale)/2:($e.scale-1)*gi)),$e.imageName){let Ct=nt[$e.imageName];Ke=Ct.sdf,lt=Ct.pixelRatio,Qe=wr/lt}let Sn=Ce?[$e.x+xi,$e.y]:[0,0],Bi=Ce?[0,0]:[$e.x+xi+ce[0],$e.y+ce[1]-Ot],wi=[0,0];Ft&&(wi=Bi,Bi=[0,0]);let rr=$e.metrics.isDoubleResolution?2:1,nr=($e.metrics.left-Qe)*$e.scale-xi+Bi[0],or=(-$e.metrics.top-Qe)*$e.scale+Bi[1],oi=nr+we.w/rr*$e.scale/lt,bi=or+we.h/rr*$e.scale/lt,Hi=new B(nr,or),Oi=new B(oi,or),ar=new B(nr,bi),Ni=new B(oi,bi);if(Ft){let Ct=new B(-xi,xi-Uu),jt=-Math.PI/2,Ht=gi/2-xi,Fr=new B(5-Uu-Ht,-($e.imageName?Ht:0)),ei=new B(...wi);Hi._rotateAround(jt,Ct)._add(Fr)._add(ei),Oi._rotateAround(jt,Ct)._add(Fr)._add(ei),ar._rotateAround(jt,Ct)._add(Fr)._add(ei),Ni._rotateAround(jt,Ct)._add(Fr)._add(ei)}if(Oe){let Ct=Math.sin(Oe),jt=Math.cos(Oe),Ht=[jt,-Ct,Ct,jt];Hi._matMult(Ht),Oi._matMult(Ht),ar._matMult(Ht),Ni._matMult(Ht)}let rn=new B(0,0),br=new B(0,0);Je.push({tl:Hi,tr:Oi,bl:ar,br:Ni,tex:we,writingMode:ie.writingMode,glyphOffset:Sn,sectionIndex:$e.sectionIndex,isSDF:Ke,pixelOffsetTL:rn,pixelOffsetBR:br,minFontScaleX:0,minFontScaleY:0})}return Je}(0,o,v,d,y,_,l,r.allowVerticalPlacement),H=r.textSizeData,K=null;H.kind==="source"?(K=[ho*d.layout.get("text-size").evaluate(_,{})],K[0]>Oa&&Wt(`${r.layerIds[0]}: Value for "text-size" is >= ${$u}. Reduce your "text-size".`)):H.kind==="composite"&&(K=[ho*R.compositeTextSizes[0].evaluate(_,{},O),ho*R.compositeTextSizes[1].evaluate(_,{},O)],(K[0]>Oa||K[1]>Oa)&&Wt(`${r.layerIds[0]}: Value for "text-size" is >= ${$u}. Reduce your "text-size".`)),r.addSymbols(r.text,V,K,v,y,_,S,t,w.lineStartIndex,w.lineLength,M,O);for(let he of T)z[he]=r.text.placedSymbolArray.length-1;return 4*V.length}function j_(r){for(let t in r)return r[t];return null}function v3(r,t,o,l){let d=r.compareText;if(t in d){let y=d[t];for(let _=y.length-1;_>=0;_--)if(l.dist(y[_])<o)return!0}else d[t]=[];return d[t].push(l),!1}let V_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class e1{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[o,l]=new Uint8Array(t,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");let d=l>>4;if(d!==1)throw new Error(`Got v${d} data when expected v1.`);let y=V_[15&l];if(!y)throw new Error("Unrecognized array type.");let[_]=new Uint16Array(t,2,1),[v]=new Uint32Array(t,4,1);return new e1(v,_,y,t)}constructor(t,o=64,l=Float64Array,d){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=l,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;let y=V_.indexOf(this.ArrayType),_=2*t*this.ArrayType.BYTES_PER_ELEMENT,v=t*this.IndexArrayType.BYTES_PER_ELEMENT,w=(8-v%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${l}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+w,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+_+v+w),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+v+w,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=t)}add(t,o){let l=this._pos>>1;return this.ids[l]=l,this.coords[this._pos++]=t,this.coords[this._pos++]=o,l}finish(){let t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return t1(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,o,l,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:y,coords:_,nodeSize:v}=this,w=[0,y.length-1,0],S=[];for(;w.length;){let T=w.pop()||0,z=w.pop()||0,M=w.pop()||0;if(z-M<=v){for(let H=M;H<=z;H++){let K=_[2*H],he=_[2*H+1];K>=t&&K<=l&&he>=o&&he<=d&&S.push(y[H])}continue}let R=M+z>>1,O=_[2*R],V=_[2*R+1];O>=t&&O<=l&&V>=o&&V<=d&&S.push(y[R]),(T===0?t<=O:o<=V)&&(w.push(M),w.push(R-1),w.push(1-T)),(T===0?l>=O:d>=V)&&(w.push(R+1),w.push(z),w.push(1-T))}return S}within(t,o,l){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:d,coords:y,nodeSize:_}=this,v=[0,d.length-1,0],w=[],S=l*l;for(;v.length;){let T=v.pop()||0,z=v.pop()||0,M=v.pop()||0;if(z-M<=_){for(let H=M;H<=z;H++)q_(y[2*H],y[2*H+1],t,o)<=S&&w.push(d[H]);continue}let R=M+z>>1,O=y[2*R],V=y[2*R+1];q_(O,V,t,o)<=S&&w.push(d[R]),(T===0?t-l<=O:o-l<=V)&&(v.push(M),v.push(R-1),v.push(1-T)),(T===0?t+l>=O:o+l>=V)&&(v.push(R+1),v.push(z),v.push(1-T))}return w}}function t1(r,t,o,l,d,y){if(d-l<=o)return;let _=l+d>>1;U_(r,t,_,l,d,y),t1(r,t,o,l,_-1,1-y),t1(r,t,o,_+1,d,1-y)}function U_(r,t,o,l,d,y){for(;d>l;){if(d-l>600){let S=d-l+1,T=o-l+1,z=Math.log(S),M=.5*Math.exp(2*z/3),R=.5*Math.sqrt(z*M*(S-M)/S)*(T-S/2<0?-1:1);U_(r,t,o,Math.max(l,Math.floor(o-T*M/S+R)),Math.min(d,Math.floor(o+(S-T)*M/S+R)),y)}let _=t[2*o+y],v=l,w=d;for(Gu(r,t,l,o),t[2*d+y]>_&&Gu(r,t,l,d);v<w;){for(Gu(r,t,v,w),v++,w--;t[2*v+y]<_;)v++;for(;t[2*w+y]>_;)w--}t[2*l+y]===_?Gu(r,t,l,w):(w++,Gu(r,t,w,d)),w<=o&&(l=w+1),o<=w&&(d=w-1)}}function Gu(r,t,o,l){i1(r,o,l),i1(t,2*o,2*l),i1(t,2*o+1,2*l+1)}function i1(r,t,o){let l=r[t];r[t]=r[o],r[o]=l}function q_(r,t,o,l){let d=r-o,y=t-l;return d*d+y*y}var r1;f.bg=void 0,(r1=f.bg||(f.bg={})).create="create",r1.load="load",r1.fullLoad="fullLoad";let tp=null,Wu=[],n1=1e3/60,o1="loadTime",a1="fullLoadTime",x3={mark(r){performance.mark(r)},frame(r){let t=r;tp!=null&&Wu.push(t-tp),tp=t},clearMetrics(){tp=null,Wu=[],performance.clearMeasures(o1),performance.clearMeasures(a1);for(let r in f.bg)performance.clearMarks(f.bg[r])},getPerformanceMetrics(){performance.measure(o1,f.bg.create,f.bg.load),performance.measure(a1,f.bg.create,f.bg.fullLoad);let r=performance.getEntriesByName(o1)[0].duration,t=performance.getEntriesByName(a1)[0].duration,o=Wu.length,l=1/(Wu.reduce((y,_)=>y+_,0)/o/1e3),d=Wu.filter(y=>y>n1).reduce((y,_)=>y+(_-n1)/n1,0);return{loadTime:r,fullLoadTime:t,fps:l,percentDroppedFrames:d/(o+d)*100,totalFrames:o}}};f.$=class extends I{},f.A=Gl,f.B=fm,f.C=function(r){if(ra==null){let t=r.navigator?r.navigator.userAgent:null;ra=!!r.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return ra},f.D=We,f.E=aa,f.F=class{constructor(r,t){this.target=r,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new h3(()=>this.process()),this.subscription=function(o,l,d,y){return o.addEventListener(l,d,!1),{unsubscribe:()=>{o.removeEventListener(l,d,!1)}}}(this.target,"message",o=>this.receive(o)),this.globalScope=Dn(self)?r:window}registerMessageHandler(r,t){this.messageHandlers[r]=t}sendAsync(r,t){return new Promise((o,l)=>{let d=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[d]={resolve:o,reject:l},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[d];let v={id:d,type:"<cancel>",origin:location.origin,targetMapId:r.targetMapId,sourceMapId:this.mapId};this.target.postMessage(v)},{once:!0});let y=[],_=Object.assign(Object.assign({},r),{id:d,sourceMapId:this.mapId,origin:location.origin,data:Ta(r.data,y)});this.target.postMessage(_,{transfer:y})})}receive(r){let t=r.data,o=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[o];let l=this.abortControllers[o];return delete this.abortControllers[o],void(l&&l.abort())}if(Dn(self)||t.mustQueue)return this.tasks[o]=t,this.taskQueue.push(o),void this.invoker.trigger();this.processTask(o,t)}}process(){if(this.taskQueue.length===0)return;let r=this.taskQueue.shift(),t=this.tasks[r];delete this.tasks[r],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(r,t)}processTask(r,t){return s(this,void 0,void 0,function*(){if(t.type==="<response>"){let d=this.resolveRejects[r];return delete this.resolveRejects[r],d?void(t.error?d.reject(Ca(t.error)):d.resolve(Ca(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(r,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));let o=Ca(t.data),l=new AbortController;this.abortControllers[r]=l;try{let d=yield this.messageHandlers[t.type](t.sourceMapId,o,l);this.completeTask(r,null,d)}catch(d){this.completeTask(r,d)}})}completeTask(r,t,o){let l=[];delete this.abortControllers[r];let d={id:r,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?Ta(t):null,data:Ta(o,l)};this.target.postMessage(d,{transfer:l})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},f.G=oa,f.H=function(){var r=new Gl(16);return Gl!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},f.I=Vm,f.J=function(r,t,o){var l,d,y,_,v,w,S,T,z,M,R,O,V=o[0],H=o[1],K=o[2];return t===r?(r[12]=t[0]*V+t[4]*H+t[8]*K+t[12],r[13]=t[1]*V+t[5]*H+t[9]*K+t[13],r[14]=t[2]*V+t[6]*H+t[10]*K+t[14],r[15]=t[3]*V+t[7]*H+t[11]*K+t[15]):(d=t[1],y=t[2],_=t[3],v=t[4],w=t[5],S=t[6],T=t[7],z=t[8],M=t[9],R=t[10],O=t[11],r[0]=l=t[0],r[1]=d,r[2]=y,r[3]=_,r[4]=v,r[5]=w,r[6]=S,r[7]=T,r[8]=z,r[9]=M,r[10]=R,r[11]=O,r[12]=l*V+v*H+z*K+t[12],r[13]=d*V+w*H+M*K+t[13],r[14]=y*V+S*H+R*K+t[14],r[15]=_*V+T*H+O*K+t[15]),r},f.K=function(r,t,o){var l=o[0],d=o[1],y=o[2];return r[0]=t[0]*l,r[1]=t[1]*l,r[2]=t[2]*l,r[3]=t[3]*l,r[4]=t[4]*d,r[5]=t[5]*d,r[6]=t[6]*d,r[7]=t[7]*d,r[8]=t[8]*y,r[9]=t[9]*y,r[10]=t[10]*y,r[11]=t[11]*y,r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},f.L=ky,f.M=function(r,t){let o={};for(let l=0;l<t.length;l++){let d=t[l];d in r&&(o[d]=r[d])}return o},f.N=Na,f.O=__,f.P=B,f.Q=v_,f.R=en,f.S=tn,f.T=Bl,f.U=Se,f.V=Ae,f.W=Eo,f.X=fi,f.Y=x,f.Z=Zu,f._=s,f.a=to,f.a$=function(r,t){var o=r[0],l=r[1],d=r[2],y=r[3],_=r[4],v=r[5],w=r[6],S=r[7],T=r[8],z=r[9],M=r[10],R=r[11],O=r[12],V=r[13],H=r[14],K=r[15],he=t[0],ie=t[1],ce=t[2],_e=t[3],Ce=t[4],Ue=t[5],nt=t[6],je=t[7],Oe=t[8],Je=t[9],He=t[10],$e=t[11],we=t[12],Qe=t[13],Ke=t[14],lt=t[15];return Math.abs(o-he)<=ir*Math.max(1,Math.abs(o),Math.abs(he))&&Math.abs(l-ie)<=ir*Math.max(1,Math.abs(l),Math.abs(ie))&&Math.abs(d-ce)<=ir*Math.max(1,Math.abs(d),Math.abs(ce))&&Math.abs(y-_e)<=ir*Math.max(1,Math.abs(y),Math.abs(_e))&&Math.abs(_-Ce)<=ir*Math.max(1,Math.abs(_),Math.abs(Ce))&&Math.abs(v-Ue)<=ir*Math.max(1,Math.abs(v),Math.abs(Ue))&&Math.abs(w-nt)<=ir*Math.max(1,Math.abs(w),Math.abs(nt))&&Math.abs(S-je)<=ir*Math.max(1,Math.abs(S),Math.abs(je))&&Math.abs(T-Oe)<=ir*Math.max(1,Math.abs(T),Math.abs(Oe))&&Math.abs(z-Je)<=ir*Math.max(1,Math.abs(z),Math.abs(Je))&&Math.abs(M-He)<=ir*Math.max(1,Math.abs(M),Math.abs(He))&&Math.abs(R-$e)<=ir*Math.max(1,Math.abs(R),Math.abs($e))&&Math.abs(O-we)<=ir*Math.max(1,Math.abs(O),Math.abs(we))&&Math.abs(V-Qe)<=ir*Math.max(1,Math.abs(V),Math.abs(Qe))&&Math.abs(H-Ke)<=ir*Math.max(1,Math.abs(H),Math.abs(Ke))&&Math.abs(K-lt)<=ir*Math.max(1,Math.abs(K),Math.abs(lt))},f.a0=wt,f.a1=Jm,f.a2=Pe,f.a3=r=>{let t=window.document.createElement("video");return t.muted=!0,new Promise(o=>{t.onloadstart=()=>{o(t)};for(let l of r){let d=window.document.createElement("source");Co(l)||(t.crossOrigin="Anonymous"),d.src=l,t.appendChild(d)}})},f.a4=function(){return Ye++},f.a5=Ve,f.a6=Ql,f.a7=hu,f.a8=js,f.a9=E_,f.aA=function(r){if(r.type==="custom")return new u3(r);switch(r.type){case"background":return new s3(r);case"circle":return new Wb(r);case"fill":return new h5(r);case"fill-extrusion":return new T5(r);case"heatmap":return new Kb(r);case"hillshade":return new Yb(r);case"line":return new D5(r);case"raster":return new c3(r);case"symbol":return new Kd(r)}},f.aB=ct,f.aC=function(r,t){if(!r)return[{command:"setStyle",args:[t]}];let o=[];try{if(!zt(r.version,t.version))return[{command:"setStyle",args:[t]}];zt(r.center,t.center)||o.push({command:"setCenter",args:[t.center]}),zt(r.zoom,t.zoom)||o.push({command:"setZoom",args:[t.zoom]}),zt(r.bearing,t.bearing)||o.push({command:"setBearing",args:[t.bearing]}),zt(r.pitch,t.pitch)||o.push({command:"setPitch",args:[t.pitch]}),zt(r.sprite,t.sprite)||o.push({command:"setSprite",args:[t.sprite]}),zt(r.glyphs,t.glyphs)||o.push({command:"setGlyphs",args:[t.glyphs]}),zt(r.transition,t.transition)||o.push({command:"setTransition",args:[t.transition]}),zt(r.light,t.light)||o.push({command:"setLight",args:[t.light]}),zt(r.terrain,t.terrain)||o.push({command:"setTerrain",args:[t.terrain]}),zt(r.sky,t.sky)||o.push({command:"setSky",args:[t.sky]}),zt(r.projection,t.projection)||o.push({command:"setProjection",args:[t.projection]});let l={},d=[];(function(_,v,w,S){let T;for(T in v=v||{},_=_||{})Object.prototype.hasOwnProperty.call(_,T)&&(Object.prototype.hasOwnProperty.call(v,T)||no(T,w,S));for(T in v)Object.prototype.hasOwnProperty.call(v,T)&&(Object.prototype.hasOwnProperty.call(_,T)?zt(_[T],v[T])||(_[T].type==="geojson"&&v[T].type==="geojson"&&sa(_,v,T)?Yt(w,{command:"setGeoJSONSourceData",args:[T,v[T].data]}):Bn(T,v,w,S)):ms(T,v,w))})(r.sources,t.sources,d,l);let y=[];r.layers&&r.layers.forEach(_=>{"source"in _&&l[_.source]?o.push({command:"removeLayer",args:[_.id]}):y.push(_)}),o=o.concat(d),function(_,v,w){v=v||[];let S=(_=_||[]).map(gs),T=v.map(gs),z=_.reduce(ys,{}),M=v.reduce(ys,{}),R=S.slice(),O=Object.create(null),V,H,K,he,ie;for(let ce=0,_e=0;ce<S.length;ce++)V=S[ce],Object.prototype.hasOwnProperty.call(M,V)?_e++:(Yt(w,{command:"removeLayer",args:[V]}),R.splice(R.indexOf(V,_e),1));for(let ce=0,_e=0;ce<T.length;ce++)V=T[T.length-1-ce],R[R.length-1-ce]!==V&&(Object.prototype.hasOwnProperty.call(z,V)?(Yt(w,{command:"removeLayer",args:[V]}),R.splice(R.lastIndexOf(V,R.length-_e),1)):_e++,he=R[R.length-ce],Yt(w,{command:"addLayer",args:[M[V],he]}),R.splice(R.length-ce,0,V),O[V]=!0);for(let ce=0;ce<T.length;ce++)if(V=T[ce],H=z[V],K=M[V],!O[V]&&!zt(H,K))if(zt(H.source,K.source)&&zt(H["source-layer"],K["source-layer"])&&zt(H.type,K.type)){for(ie in zr(H.layout,K.layout,w,V,null,"setLayoutProperty"),zr(H.paint,K.paint,w,V,null,"setPaintProperty"),zt(H.filter,K.filter)||Yt(w,{command:"setFilter",args:[V,K.filter]}),zt(H.minzoom,K.minzoom)&&zt(H.maxzoom,K.maxzoom)||Yt(w,{command:"setLayerZoomRange",args:[V,K.minzoom,K.maxzoom]}),H)Object.prototype.hasOwnProperty.call(H,ie)&&ie!=="layout"&&ie!=="paint"&&ie!=="filter"&&ie!=="metadata"&&ie!=="minzoom"&&ie!=="maxzoom"&&(ie.indexOf("paint.")===0?zr(H[ie],K[ie],w,V,ie.slice(6),"setPaintProperty"):zt(H[ie],K[ie])||Yt(w,{command:"setLayerProperty",args:[V,ie,K[ie]]}));for(ie in K)Object.prototype.hasOwnProperty.call(K,ie)&&!Object.prototype.hasOwnProperty.call(H,ie)&&ie!=="layout"&&ie!=="paint"&&ie!=="filter"&&ie!=="metadata"&&ie!=="minzoom"&&ie!=="maxzoom"&&(ie.indexOf("paint.")===0?zr(H[ie],K[ie],w,V,ie.slice(6),"setPaintProperty"):zt(H[ie],K[ie])||Yt(w,{command:"setLayerProperty",args:[V,ie,K[ie]]}))}else Yt(w,{command:"removeLayer",args:[V]}),he=R[R.lastIndexOf(V)+1],Yt(w,{command:"addLayer",args:[K,he]})}(y,t.layers,o)}catch(l){console.warn("Unable to compute style diff:",l),o=[{command:"setStyle",args:[t]}]}return o},f.aD=function(r){let t=[],o=r.id;return o===void 0&&t.push({message:`layers.${o}: missing required property "id"`}),r.render===void 0&&t.push({message:`layers.${o}: missing required method "render"`}),r.renderingMode&&r.renderingMode!=="2d"&&r.renderingMode!=="3d"&&t.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),t},f.aE=function r(t,o){if(Array.isArray(t)){if(!Array.isArray(o)||t.length!==o.length)return!1;for(let l=0;l<t.length;l++)if(!r(t[l],o[l]))return!1;return!0}if(typeof t=="object"&&t!==null&&o!==null){if(typeof o!="object"||Object.keys(t).length!==Object.keys(o).length)return!1;for(let l in t)if(!r(t[l],o[l]))return!1;return!0}return t===o},f.aF=Ge,f.aG=rt,f.aH=class extends Bs{constructor(r,t){super(r,t),this.current=0}set(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},f.aI=Bd,f.aJ=class extends Bs{constructor(r,t){super(r,t),this.current=jb}set(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let t=1;t<16;t++)if(r[t]!==this.current[t]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}},f.aK=dy,f.aL=py,f.aM=Lt,f.aN=class extends Bs{constructor(r,t){super(r,t),this.current=[0,0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))}},f.aO=class extends Bs{constructor(r,t){super(r,t),this.current=[0,0]}set(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))}},f.aP=function(r,t,o,l,d,y,_){var v=1/(t-o),w=1/(l-d),S=1/(y-_);return r[0]=-2*v,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*w,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*S,r[11]=0,r[12]=(t+o)*v,r[13]=(d+l)*w,r[14]=(_+y)*S,r[15]=1,r},f.aQ=Gb,f.aR=class extends oe{},f.aS=O5,f.aT=class extends pe{},f.aU=Im,f.aV=function(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},f.aW=zy,f.aX=Di,f.aY=Qr,f.aZ=class extends Xe{},f.a_=function(r,t){return r[0]===t[0]&&r[1]===t[1]&&r[2]===t[2]&&r[3]===t[3]&&r[4]===t[4]&&r[5]===t[5]&&r[6]===t[6]&&r[7]===t[7]&&r[8]===t[8]&&r[9]===t[9]&&r[10]===t[10]&&r[11]===t[11]&&r[12]===t[12]&&r[13]===t[13]&&r[14]===t[14]&&r[15]===t[15]},f.aa=function(r){let t={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,l,d,y)=>{let _=d||y;return t[l]=!_||_.toLowerCase(),""}),t["max-age"]){let o=parseInt(t["max-age"],10);isNaN(o)?delete t["max-age"]:t["max-age"]=o}return t},f.ab=function(r,t){let o=[];for(let l in r)l in t||o.push(l);return o},f.ac=ae,f.ad=function(r,t,o){var l=Math.sin(o),d=Math.cos(o),y=t[0],_=t[1],v=t[2],w=t[3],S=t[4],T=t[5],z=t[6],M=t[7];return t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[0]=y*d+S*l,r[1]=_*d+T*l,r[2]=v*d+z*l,r[3]=w*d+M*l,r[4]=S*d-y*l,r[5]=T*d-_*l,r[6]=z*d-v*l,r[7]=M*d-w*l,r},f.ae=function(r){var t=new Gl(16);return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},f.af=Vd,f.ag=function(r,t){let o=0,l=0;if(r.kind==="constant")l=r.layoutSize;else if(r.kind!=="source"){let{interpolationType:d,minZoom:y,maxZoom:_}=r,v=d?ae(er.interpolationFactor(d,t,y,_),0,1):0;r.kind==="camera"?l=Qi.number(r.minSize,r.maxSize,v):o=v}return{uSizeT:o,uSize:l}},f.ai=function(r,{uSize:t,uSizeT:o},{lowerSize:l,upperSize:d}){return r.kind==="source"?l/ho:r.kind==="composite"?Qi.number(l/ho,d/ho,o):t},f.aj=Zm,f.ak=function(r,t,o,l){let d=t.y-r.y,y=t.x-r.x,_=l.y-o.y,v=l.x-o.x,w=_*y-v*d;if(w===0)return null;let S=(v*(r.y-o.y)-_*(r.x-o.x))/w;return new B(r.x+S*y,r.y+S*d)},f.al=I_,f.am=yy,f.an=Tm,f.ao=function(r){let t=1/0,o=1/0,l=-1/0,d=-1/0;for(let y of r)t=Math.min(t,y.x),o=Math.min(o,y.y),l=Math.max(l,y.x),d=Math.max(d,y.y);return[t,o,l,d]},f.ap=gi,f.ar=$m,f.as=function(r,t){var o=t[0],l=t[1],d=t[2],y=t[3],_=t[4],v=t[5],w=t[6],S=t[7],T=t[8],z=t[9],M=t[10],R=t[11],O=t[12],V=t[13],H=t[14],K=t[15],he=o*v-l*_,ie=o*w-d*_,ce=o*S-y*_,_e=l*w-d*v,Ce=l*S-y*v,Ue=d*S-y*w,nt=T*V-z*O,je=T*H-M*O,Oe=T*K-R*O,Je=z*H-M*V,He=z*K-R*V,$e=M*K-R*H,we=he*$e-ie*He+ce*Je+_e*Oe-Ce*je+Ue*nt;return we?(r[0]=(v*$e-w*He+S*Je)*(we=1/we),r[1]=(d*He-l*$e-y*Je)*we,r[2]=(V*Ue-H*Ce+K*_e)*we,r[3]=(M*Ce-z*Ue-R*_e)*we,r[4]=(w*Oe-_*$e-S*je)*we,r[5]=(o*$e-d*Oe+y*je)*we,r[6]=(H*ce-O*Ue-K*ie)*we,r[7]=(T*Ue-M*ce+R*ie)*we,r[8]=(_*He-v*Oe+S*nt)*we,r[9]=(l*Oe-o*He-y*nt)*we,r[10]=(O*Ce-V*ce+K*he)*we,r[11]=(z*ce-T*Ce-R*he)*we,r[12]=(v*je-_*Je-w*nt)*we,r[13]=(o*Je-l*je+d*nt)*we,r[14]=(V*ie-O*_e-H*he)*we,r[15]=(T*_e-z*ie+M*he)*we,r):null},f.at=Qm,f.au=qm,f.av=e1,f.aw=function(){let r={},t=ye.$version;for(let o in ye.$root){let l=ye.$root[o];if(l.required){let d=null;d=o==="version"?t:l.type==="array"?[]:{},d!=null&&(r[o]=d)}}return r},f.ax=Eu,f.ay=Zr,f.az=function(r){r=r.slice();let t=Object.create(null);for(let o=0;o<r.length;o++)t[r[o].id]=r[o];for(let o=0;o<r.length;o++)"ref"in r[o]&&(r[o]=fs(r[o],t[r[o].ref]));return r},f.b=fn,f.b0=function(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},f.b1=function(r,t,o){return r[0]=t[0]*o[0],r[1]=t[1]*o[1],r[2]=t[2]*o[2],r[3]=t[3]*o[3],r},f.b2=function(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]+r[3]*t[3]},f.b3=be,f.b4=b_,f.b5=x_,f.b6=function(r,t,o,l,d){var y,_=1/Math.tan(t/2);return r[0]=_/o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=_,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,d!=null&&d!==1/0?(r[10]=(d+l)*(y=1/(l-d)),r[14]=2*d*l*y):(r[10]=-1,r[14]=-2*l),r},f.b7=function(r,t,o){var l=Math.sin(o),d=Math.cos(o),y=t[4],_=t[5],v=t[6],w=t[7],S=t[8],T=t[9],z=t[10],M=t[11];return t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r[4]=y*d+S*l,r[5]=_*d+T*l,r[6]=v*d+z*l,r[7]=w*d+M*l,r[8]=S*d-y*l,r[9]=T*d-_*l,r[10]=z*d-v*l,r[11]=M*d-w*l,r},f.b8=ne,f.b9=ee,f.bA=Wy,f.bB=function(r){return r.message===$r},f.bC=va,f.bD=vr,f.ba=function(r){return r*Math.PI/180},f.bb=function(r,t){let{x:o,y:l}=Zu.fromLngLat(t);return!(r<0||r>25||l<0||l>=1||o<0||o>=1)},f.bc=function(r,t){return r[0]=t[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=t[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},f.bd=class extends C{},f.be=Xm,f.bf=x3,f.bh=fr,f.bi=function(r,t){to.REGISTERED_PROTOCOLS[r]=t},f.bj=function(r){delete to.REGISTERED_PROTOCOLS[r]},f.bk=function(r,t){let o={};for(let d=0;d<r.length;d++){let y=t&&t[r[d].id]||Ed(r[d]);t&&(t[r[d].id]=y);let _=o[y];_||(_=o[y]=[]),_.push(r[d])}let l=[];for(let d in o)l.push(o[d]);return l},f.bl=Ze,f.bm=S_,f.bn=T_,f.bo=r_,f.bp=function(r){r.bucket.createArrays(),r.bucket.tilePixelRatio=fi/(512*r.bucket.overscaling),r.bucket.compareText={},r.bucket.iconsNeedLinear=!1;let t=r.bucket.layers[0],o=t.layout,l=t._unevaluatedLayout._values,d={layoutIconSize:l["icon-size"].possiblyEvaluate(new Ut(r.bucket.zoom+1),r.canonical),layoutTextSize:l["text-size"].possiblyEvaluate(new Ut(r.bucket.zoom+1),r.canonical),textMaxSize:l["text-size"].possiblyEvaluate(new Ut(18))};if(r.bucket.textSizeData.kind==="composite"){let{minZoom:S,maxZoom:T}=r.bucket.textSizeData;d.compositeTextSizes=[l["text-size"].possiblyEvaluate(new Ut(S),r.canonical),l["text-size"].possiblyEvaluate(new Ut(T),r.canonical)]}if(r.bucket.iconSizeData.kind==="composite"){let{minZoom:S,maxZoom:T}=r.bucket.iconSizeData;d.compositeIconSizes=[l["icon-size"].possiblyEvaluate(new Ut(S),r.canonical),l["icon-size"].possiblyEvaluate(new Ut(T),r.canonical)]}let y=o.get("text-line-height")*gi,_=o.get("text-rotation-alignment")!=="viewport"&&o.get("symbol-placement")!=="point",v=o.get("text-keep-upright"),w=o.get("text-size");for(let S of r.bucket.features){let T=o.get("text-font").evaluate(S,{},r.canonical).join(","),z=w.evaluate(S,{},r.canonical),M=d.layoutTextSize.evaluate(S,{},r.canonical),R=d.layoutIconSize.evaluate(S,{},r.canonical),O={horizontal:{},vertical:void 0},V=S.text,H,K=[0,0];if(V){let ce=V.toString(),_e=o.get("text-letter-spacing").evaluate(S,{},r.canonical)*gi,Ce=mm(ce)?_e:0,Ue=o.get("text-anchor").evaluate(S,{},r.canonical),nt=O_(t,S,r.canonical);if(!nt){let He=o.get("text-radial-offset").evaluate(S,{},r.canonical);K=He?B_(Ue,[He*gi,Ym]):o.get("text-offset").evaluate(S,{},r.canonical).map($e=>$e*gi)}let je=_?"center":o.get("text-justify").evaluate(S,{},r.canonical),Oe=o.get("symbol-placement")==="point"?o.get("text-max-width").evaluate(S,{},r.canonical)*gi:1/0,Je=()=>{r.bucket.allowVerticalPlacement&&Tu(ce)&&(O.vertical=Gd(V,r.glyphMap,r.glyphPositions,r.imagePositions,T,Oe,y,Ue,"left",Ce,K,f.ah.vertical,!0,M,z))};if(!_&&nt){let He=new Set;if(je==="auto")for(let we=0;we<nt.values.length;we+=2)He.add(Qm(nt.values[we]));else He.add(je);let $e=!1;for(let we of He)if(!O.horizontal[we])if($e)O.horizontal[we]=O.horizontal[0];else{let Qe=Gd(V,r.glyphMap,r.glyphPositions,r.imagePositions,T,Oe,y,"center",we,Ce,K,f.ah.horizontal,!1,M,z);Qe&&(O.horizontal[we]=Qe,$e=Qe.positionedLines.length===1)}Je()}else{je==="auto"&&(je=Qm(Ue));let He=Gd(V,r.glyphMap,r.glyphPositions,r.imagePositions,T,Oe,y,Ue,je,Ce,K,f.ah.horizontal,!1,M,z);He&&(O.horizontal[je]=He),Je(),Tu(ce)&&_&&v&&(O.vertical=Gd(V,r.glyphMap,r.glyphPositions,r.imagePositions,T,Oe,y,Ue,je,Ce,K,f.ah.vertical,!1,M,z))}}let he=!1;if(S.icon&&S.icon.name){let ce=r.imageMap[S.icon.name];ce&&(H=i3(r.imagePositions[S.icon.name],o.get("icon-offset").evaluate(S,{},r.canonical),o.get("icon-anchor").evaluate(S,{},r.canonical)),he=!!ce.sdf,r.bucket.sdfIcons===void 0?r.bucket.sdfIcons=he:r.bucket.sdfIcons!==he&&Wt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ce.pixelRatio!==r.bucket.pixelRatio||o.get("icon-rotate").constantOr(1)!==0)&&(r.bucket.iconsNeedLinear=!0))}let ie=j_(O.horizontal)||O.vertical;r.bucket.iconsInText=!!ie&&ie.iconsInText,(ie||H)&&_3(r.bucket,S,O,H,r.imageMap,d,M,R,K,he,r.canonical)}r.showCollisionBoxes&&r.bucket.generateCollisionDebugBuffers()},f.bq=Bm,f.br=Dm,f.bs=Fm,f.bt=Fa,f.bu=Nm,f.bv=class{constructor(r){this._marks={start:[r.url,"start"].join("#"),end:[r.url,"end"].join("#"),measure:r.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let r=performance.getEntriesByName(this._marks.measure);return r.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),r=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),r}},f.bw=function(r,t,o,l,d){return s(this,void 0,void 0,function*(){if(Ae())try{return yield Eo(r,t,o,l,d)}catch{}return function(y,_,v,w,S){let T=y.width,z=y.height;Rn&&Ji||(Rn=new OffscreenCanvas(T,z),Ji=Rn.getContext("2d",{willReadFrequently:!0})),Rn.width=T,Rn.height=z,Ji.drawImage(y,0,0,T,z);let M=Ji.getImageData(_,v,w,S);return Ji.clearRect(0,0,T,z),M.data}(r,t,o,l,d)})},f.bx=k_,f.by=E,f.bz=A,f.c=na,f.d=r=>s(void 0,void 0,void 0,function*(){if(r.byteLength===0)return createImageBitmap(new ImageData(1,1));let t=new Blob([new Uint8Array(r)],{type:"image/png"});try{return createImageBitmap(t)}catch(o){throw new Error(`Could not load image because of ${o.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),f.e=Ie,f.f=r=>new Promise((t,o)=>{let l=new Image;l.onload=()=>{t(l),URL.revokeObjectURL(l.src),l.onload=null,window.requestAnimationFrame(()=>{l.src=ll})},l.onerror=()=>o(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let d=new Blob([new Uint8Array(r)],{type:"image/png"});l.src=r.byteLength?URL.createObjectURL(d):ll}),f.g=mn,f.h=(r,t)=>To(Ie(r,{type:"json"}),t),f.i=Dn,f.j=ro,f.k=io,f.l=(r,t)=>To(Ie(r,{type:"arrayBuffer"}),t),f.m=To,f.n=function(r){return new Nm(r).readFields(X5,[])},f.o=Ru,f.p=i_,f.q=g,f.r=pm,f.s=Co,f.t=ku,f.u=jo,f.v=ye,f.w=Wt,f.x=function([r,t,o]){return t+=90,t*=Math.PI/180,o*=Math.PI/180,{x:r*Math.cos(t)*Math.sin(o),y:r*Math.sin(t)*Math.sin(o),z:r*Math.cos(o)}},f.y=Qi,f.z=Ut}),c("worker",["./shared"],function(f){"use strict";class s{constructor(D){this.keyCache={},D&&this.replace(D)}replace(D){this._layerConfigs={},this._layers={},this.update(D,[])}update(D,L){for(let G of D){this._layerConfigs[G.id]=G;let re=this._layers[G.id]=f.aA(G);re._featureFilter=f.a7(re.filter),this.keyCache[G.id]&&delete this.keyCache[G.id]}for(let G of L)delete this.keyCache[G],delete this._layerConfigs[G],delete this._layers[G];this.familiesBySource={};let q=f.bk(Object.values(this._layerConfigs),this.keyCache);for(let G of q){let re=G.map(me=>this._layers[me.id]),se=re[0];if(se.visibility==="none")continue;let ue=se.source||"",Q=this.familiesBySource[ue];Q||(Q=this.familiesBySource[ue]={});let ve=se.sourceLayer||"_geojsonTileLayer",Ee=Q[ve];Ee||(Ee=Q[ve]=[]),Ee.push(re)}}}class E{constructor(D){let L={},q=[];for(let ue in D){let Q=D[ue],ve=L[ue]={};for(let Ee in Q){let me=Q[+Ee];if(!me||me.bitmap.width===0||me.bitmap.height===0)continue;let Le={x:0,y:0,w:me.bitmap.width+2,h:me.bitmap.height+2};q.push(Le),ve[Ee]={rect:Le,metrics:me.metrics}}}let{w:G,h:re}=f.p(q),se=new f.o({width:G||1,height:re||1});for(let ue in D){let Q=D[ue];for(let ve in Q){let Ee=Q[+ve];if(!Ee||Ee.bitmap.width===0||Ee.bitmap.height===0)continue;let me=L[ue][ve].rect;f.o.copy(Ee.bitmap,se,{x:0,y:0},{x:me.x+1,y:me.y+1},Ee.bitmap)}}this.image=se,this.positions=L}}f.bl("GlyphAtlas",E);class A{constructor(D){this.tileID=new f.S(D.tileID.overscaledZ,D.tileID.wrap,D.tileID.canonical.z,D.tileID.canonical.x,D.tileID.canonical.y),this.uid=D.uid,this.zoom=D.zoom,this.pixelRatio=D.pixelRatio,this.tileSize=D.tileSize,this.source=D.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=D.showCollisionBoxes,this.collectResourceTiming=!!D.collectResourceTiming,this.returnDependencies=!!D.returnDependencies,this.promoteId=D.promoteId,this.inFlightDependencies=[]}parse(D,L,q,G){return f._(this,void 0,void 0,function*(){this.status="parsing",this.data=D,this.collisionBoxArray=new f.a5;let re=new f.bm(Object.keys(D.layers).sort()),se=new f.bn(this.tileID,this.promoteId);se.bucketLayerIDs=[];let ue={},Q={featureIndex:se,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:q},ve=L.familiesBySource[this.source];for(let gt in ve){let At=D.layers[gt];if(!At)continue;At.version===1&&f.w(`Vector tile source "${this.source}" layer "${gt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let Xt=re.encode(gt),vi=[];for(let Ti=0;Ti<At.length;Ti++){let qi=At.feature(Ti),la=se.getId(qi,gt);vi.push({feature:qi,id:la,index:Ti,sourceLayerIndex:Xt})}for(let Ti of ve[gt]){let qi=Ti[0];qi.source!==this.source&&f.w(`layer.source = ${qi.source} does not equal this.source = ${this.source}`),qi.minzoom&&this.zoom<Math.floor(qi.minzoom)||qi.maxzoom&&this.zoom>=qi.maxzoom||qi.visibility!=="none"&&(N(Ti,this.zoom,q),(ue[qi.id]=qi.createBucket({index:se.bucketLayerIDs.length,layers:Ti,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Xt,sourceID:this.source})).populate(vi,Q,this.tileID.canonical),se.bucketLayerIDs.push(Ti.map(la=>la.id)))}}let Ee=f.aF(Q.glyphDependencies,gt=>Object.keys(gt).map(Number));this.inFlightDependencies.forEach(gt=>gt?.abort()),this.inFlightDependencies=[];let me=Promise.resolve({});if(Object.keys(Ee).length){let gt=new AbortController;this.inFlightDependencies.push(gt),me=G.sendAsync({type:"GG",data:{stacks:Ee,source:this.source,tileID:this.tileID,type:"glyphs"}},gt)}let Le=Object.keys(Q.iconDependencies),et=Promise.resolve({});if(Le.length){let gt=new AbortController;this.inFlightDependencies.push(gt),et=G.sendAsync({type:"GI",data:{icons:Le,source:this.source,tileID:this.tileID,type:"icons"}},gt)}let it=Object.keys(Q.patternDependencies),kt=Promise.resolve({});if(it.length){let gt=new AbortController;this.inFlightDependencies.push(gt),kt=G.sendAsync({type:"GI",data:{icons:it,source:this.source,tileID:this.tileID,type:"patterns"}},gt)}let[dt,St,_t]=yield Promise.all([me,et,kt]),di=new E(dt),Qt=new f.bo(St,_t);for(let gt in ue){let At=ue[gt];At instanceof f.a6?(N(At.layers,this.zoom,q),f.bp({bucket:At,glyphMap:dt,glyphPositions:di.positions,imageMap:St,imagePositions:Qt.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):At.hasPattern&&(At instanceof f.bq||At instanceof f.br||At instanceof f.bs)&&(N(At.layers,this.zoom,q),At.addFeatures(Q,this.tileID.canonical,Qt.patternPositions))}return this.status="done",{buckets:Object.values(ue).filter(gt=>!gt.isEmpty()),featureIndex:se,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:di.image,imageAtlas:Qt,glyphMap:this.returnDependencies?dt:null,iconMap:this.returnDependencies?St:null,glyphPositions:this.returnDependencies?di.positions:null}})}}function N(X,D,L){let q=new f.z(D);for(let G of X)G.recalculate(q,L)}class B{constructor(D,L,q){this.actor=D,this.layerIndex=L,this.availableImages=q,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(D,L){return f._(this,void 0,void 0,function*(){let q=yield f.l(D.request,L);try{return{vectorTile:new f.bt.VectorTile(new f.bu(q.data)),rawData:q.data,cacheControl:q.cacheControl,expires:q.expires}}catch(G){let re=new Uint8Array(q.data),se=`Unable to parse the tile at ${D.request.url}, `;throw se+=re[0]===31&&re[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${G.message}`,new Error(se)}})}loadTile(D){return f._(this,void 0,void 0,function*(){let L=D.uid,q=!!(D&&D.request&&D.request.collectResourceTiming)&&new f.bv(D.request),G=new A(D);this.loading[L]=G;let re=new AbortController;G.abort=re;try{let se=yield this.loadVectorTile(D,re);if(delete this.loading[L],!se)return null;let ue=se.rawData,Q={};se.expires&&(Q.expires=se.expires),se.cacheControl&&(Q.cacheControl=se.cacheControl);let ve={};if(q){let me=q.finish();me&&(ve.resourceTiming=JSON.parse(JSON.stringify(me)))}G.vectorTile=se.vectorTile;let Ee=G.parse(se.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[L]=G,this.fetching[L]={rawTileData:ue,cacheControl:Q,resourceTiming:ve};try{let me=yield Ee;return f.e({rawTileData:ue.slice(0)},me,Q,ve)}finally{delete this.fetching[L]}}catch(se){throw delete this.loading[L],G.status="done",this.loaded[L]=G,se}})}reloadTile(D){return f._(this,void 0,void 0,function*(){let L=D.uid;if(!this.loaded||!this.loaded[L])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");let q=this.loaded[L];if(q.showCollisionBoxes=D.showCollisionBoxes,q.status==="parsing"){let G=yield q.parse(q.vectorTile,this.layerIndex,this.availableImages,this.actor),re;if(this.fetching[L]){let{rawTileData:se,cacheControl:ue,resourceTiming:Q}=this.fetching[L];delete this.fetching[L],re=f.e({rawTileData:se.slice(0)},G,ue,Q)}else re=G;return re}if(q.status==="done"&&q.vectorTile)return q.parse(q.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(D){return f._(this,void 0,void 0,function*(){let L=this.loading,q=D.uid;L&&L[q]&&L[q].abort&&(L[q].abort.abort(),delete L[q])})}removeTile(D){return f._(this,void 0,void 0,function*(){this.loaded&&this.loaded[D.uid]&&delete this.loaded[D.uid]})}}class j{constructor(){this.loaded={}}loadTile(D){return f._(this,void 0,void 0,function*(){let{uid:L,encoding:q,rawImageData:G,redFactor:re,greenFactor:se,blueFactor:ue,baseShift:Q}=D,ve=G.width+2,Ee=G.height+2,me=f.b(G)?new f.R({width:ve,height:Ee},yield f.bw(G,-1,-1,ve,Ee)):G,Le=new f.bx(L,me,q,re,se,ue,Q);return this.loaded=this.loaded||{},this.loaded[L]=Le,Le})}removeTile(D){let L=this.loaded,q=D.uid;L&&L[q]&&delete L[q]}}function de(X,D){if(X.length!==0){ge(X[0],D);for(var L=1;L<X.length;L++)ge(X[L],!D)}}function ge(X,D){for(var L=0,q=0,G=0,re=X.length,se=re-1;G<re;se=G++){var ue=(X[G][0]-X[se][0])*(X[se][1]+X[G][1]),Q=L+ue;q+=Math.abs(L)>=Math.abs(ue)?L-Q+ue:ue-Q+L,L=Q}L+q>=0!=!!D&&X.reverse()}var Te=f.by(function X(D,L){var q,G=D&&D.type;if(G==="FeatureCollection")for(q=0;q<D.features.length;q++)X(D.features[q],L);else if(G==="GeometryCollection")for(q=0;q<D.geometries.length;q++)X(D.geometries[q],L);else if(G==="Feature")X(D.geometry,L);else if(G==="Polygon")de(D.coordinates,L);else if(G==="MultiPolygon")for(q=0;q<D.coordinates.length;q++)de(D.coordinates[q],L);return D});let xe=f.bt.VectorTileFeature.prototype.toGeoJSON;var Se={exports:{}},Ae=f.bz,ne=f.bt.VectorTileFeature,ee=ae;function ae(X,D){this.options=D||{},this.features=X,this.length=X.length}function be(X,D){this.id=typeof X.id=="number"?X.id:void 0,this.type=X.type,this.rawGeometry=X.type===1?[X.geometry]:X.geometry,this.properties=X.tags,this.extent=D||4096}ae.prototype.feature=function(X){return new be(this.features[X],this.options.extent)},be.prototype.loadGeometry=function(){var X=this.rawGeometry;this.geometry=[];for(var D=0;D<X.length;D++){for(var L=X[D],q=[],G=0;G<L.length;G++)q.push(new Ae(L[G][0],L[G][1]));this.geometry.push(q)}return this.geometry},be.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var X=this.geometry,D=1/0,L=-1/0,q=1/0,G=-1/0,re=0;re<X.length;re++)for(var se=X[re],ue=0;ue<se.length;ue++){var Q=se[ue];D=Math.min(D,Q.x),L=Math.max(L,Q.x),q=Math.min(q,Q.y),G=Math.max(G,Q.y)}return[D,q,L,G]},be.prototype.toGeoJSON=ne.prototype.toGeoJSON;var Ie=f.bA,Ye=ee;function Ge(X){var D=new Ie;return function(L,q){for(var G in L.layers)q.writeMessage(3,rt,L.layers[G])}(X,D),D.finish()}function rt(X,D){var L;D.writeVarintField(15,X.version||1),D.writeStringField(1,X.name||""),D.writeVarintField(5,X.extent||4096);var q={keys:[],values:[],keycache:{},valuecache:{}};for(L=0;L<X.length;L++)q.feature=X.feature(L),D.writeMessage(2,ct,q);var G=q.keys;for(L=0;L<G.length;L++)D.writeStringField(3,G[L]);var re=q.values;for(L=0;L<re.length;L++)D.writeMessage(4,ra,re[L])}function ct(X,D){var L=X.feature;L.id!==void 0&&D.writeVarintField(1,L.id),D.writeMessage(2,bt,X),D.writeVarintField(3,L.type),D.writeMessage(4,Dn,L)}function bt(X,D){var L=X.feature,q=X.keys,G=X.values,re=X.keycache,se=X.valuecache;for(var ue in L.properties){var Q=L.properties[ue],ve=re[ue];if(Q!==null){ve===void 0&&(q.push(ue),re[ue]=ve=q.length-1),D.writeVarint(ve);var Ee=typeof Q;Ee!=="string"&&Ee!=="boolean"&&Ee!=="number"&&(Q=JSON.stringify(Q));var me=Ee+":"+Q,Le=se[me];Le===void 0&&(G.push(Q),se[me]=Le=G.length-1),D.writeVarint(Le)}}}function Wt(X,D){return(D<<3)+(7&X)}function Ei(X){return X<<1^X>>31}function Dn(X,D){for(var L=X.loadGeometry(),q=X.type,G=0,re=0,se=L.length,ue=0;ue<se;ue++){var Q=L[ue],ve=1;q===1&&(ve=Q.length),D.writeVarint(Wt(1,ve));for(var Ee=q===3?Q.length-1:Q.length,me=0;me<Ee;me++){me===1&&q!==1&&D.writeVarint(Wt(2,Ee-1));var Le=Q[me].x-G,et=Q[me].y-re;D.writeVarint(Ei(Le)),D.writeVarint(Ei(et)),G+=Le,re+=et}q===3&&D.writeVarint(Wt(7,1))}}function ra(X,D){var L=typeof X;L==="string"?D.writeStringField(1,X):L==="boolean"?D.writeBooleanField(7,X):L==="number"&&(X%1!=0?D.writeDoubleField(3,X):X<0?D.writeSVarintField(6,X):D.writeVarintField(5,X))}Se.exports=Ge,Se.exports.fromVectorTileJs=Ge,Se.exports.fromGeojsonVt=function(X,D){D=D||{};var L={};for(var q in X)L[q]=new Ye(X[q].features,D),L[q].name=q,L[q].version=D.version,L[q].extent=D.extent;return Ge({layers:L})},Se.exports.GeoJSONWrapper=Ye;var fn=f.by(Se.exports);let ll={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:X=>X},Eo=Math.fround||(Rn=new Float32Array(1),X=>(Rn[0]=+X,Rn[0]));var Rn;let Ji=3,$r=5,na=6;class to{constructor(D){this.options=Object.assign(Object.create(ll),D),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(D){let{log:L,minZoom:q,maxZoom:G}=this.options;L&&console.time("total time");let re=`prepare ${D.length} points`;L&&console.time(re),this.points=D;let se=[];for(let Q=0;Q<D.length;Q++){let ve=D[Q];if(!ve.geometry)continue;let[Ee,me]=ve.geometry.coordinates,Le=Eo(fr(Ee)),et=Eo(Zr(me));se.push(Le,et,1/0,Q,-1,1),this.options.reduce&&se.push(0)}let ue=this.trees[G+1]=this._createTree(se);L&&console.timeEnd(re);for(let Q=G;Q>=q;Q--){let ve=+Date.now();ue=this.trees[Q]=this._createTree(this._cluster(ue,Q)),L&&console.log("z%d: %d clusters in %dms",Q,ue.numItems,+Date.now()-ve)}return L&&console.timeEnd("total time"),this}getClusters(D,L){let q=((D[0]+180)%360+360)%360-180,G=Math.max(-90,Math.min(90,D[1])),re=D[2]===180?180:((D[2]+180)%360+360)%360-180,se=Math.max(-90,Math.min(90,D[3]));if(D[2]-D[0]>=360)q=-180,re=180;else if(q>re){let me=this.getClusters([q,G,180,se],L),Le=this.getClusters([-180,G,re,se],L);return me.concat(Le)}let ue=this.trees[this._limitZoom(L)],Q=ue.range(fr(q),Zr(se),fr(re),Zr(G)),ve=ue.data,Ee=[];for(let me of Q){let Le=this.stride*me;Ee.push(ve[Le+$r]>1?mn(ve,Le,this.clusterProps):this.points[ve[Le+Ji]])}return Ee}getChildren(D){let L=this._getOriginId(D),q=this._getOriginZoom(D),G="No cluster with the specified id.",re=this.trees[q];if(!re)throw new Error(G);let se=re.data;if(L*this.stride>=se.length)throw new Error(G);let ue=this.options.radius/(this.options.extent*Math.pow(2,q-1)),Q=re.within(se[L*this.stride],se[L*this.stride+1],ue),ve=[];for(let Ee of Q){let me=Ee*this.stride;se[me+4]===D&&ve.push(se[me+$r]>1?mn(se,me,this.clusterProps):this.points[se[me+Ji]])}if(ve.length===0)throw new Error(G);return ve}getLeaves(D,L,q){let G=[];return this._appendLeaves(G,D,L=L||10,q=q||0,0),G}getTile(D,L,q){let G=this.trees[this._limitZoom(D)],re=Math.pow(2,D),{extent:se,radius:ue}=this.options,Q=ue/se,ve=(q-Q)/re,Ee=(q+1+Q)/re,me={features:[]};return this._addTileFeatures(G.range((L-Q)/re,ve,(L+1+Q)/re,Ee),G.data,L,q,re,me),L===0&&this._addTileFeatures(G.range(1-Q/re,ve,1,Ee),G.data,re,q,re,me),L===re-1&&this._addTileFeatures(G.range(0,ve,Q/re,Ee),G.data,-1,q,re,me),me.features.length?me:null}getClusterExpansionZoom(D){let L=this._getOriginZoom(D)-1;for(;L<=this.options.maxZoom;){let q=this.getChildren(D);if(L++,q.length!==1)break;D=q[0].properties.cluster_id}return L}_appendLeaves(D,L,q,G,re){let se=this.getChildren(L);for(let ue of se){let Q=ue.properties;if(Q&&Q.cluster?re+Q.point_count<=G?re+=Q.point_count:re=this._appendLeaves(D,Q.cluster_id,q,G,re):re<G?re++:D.push(ue),D.length===q)break}return re}_createTree(D){let L=new f.av(D.length/this.stride|0,this.options.nodeSize,Float32Array);for(let q=0;q<D.length;q+=this.stride)L.add(D[q],D[q+1]);return L.finish(),L.data=D,L}_addTileFeatures(D,L,q,G,re,se){for(let ue of D){let Q=ue*this.stride,ve=L[Q+$r]>1,Ee,me,Le;if(ve)Ee=oa(L,Q,this.clusterProps),me=L[Q],Le=L[Q+1];else{let kt=this.points[L[Q+Ji]];Ee=kt.properties;let[dt,St]=kt.geometry.coordinates;me=fr(dt),Le=Zr(St)}let et={type:1,geometry:[[Math.round(this.options.extent*(me*re-q)),Math.round(this.options.extent*(Le*re-G))]],tags:Ee},it;it=ve||this.options.generateId?L[Q+Ji]:this.points[L[Q+Ji]].id,it!==void 0&&(et.id=it),se.features.push(et)}}_limitZoom(D){return Math.max(this.options.minZoom,Math.min(Math.floor(+D),this.options.maxZoom+1))}_cluster(D,L){let{radius:q,extent:G,reduce:re,minPoints:se}=this.options,ue=q/(G*Math.pow(2,L)),Q=D.data,ve=[],Ee=this.stride;for(let me=0;me<Q.length;me+=Ee){if(Q[me+2]<=L)continue;Q[me+2]=L;let Le=Q[me],et=Q[me+1],it=D.within(Q[me],Q[me+1],ue),kt=Q[me+$r],dt=kt;for(let St of it){let _t=St*Ee;Q[_t+2]>L&&(dt+=Q[_t+$r])}if(dt>kt&&dt>=se){let St,_t=Le*kt,di=et*kt,Qt=-1,gt=((me/Ee|0)<<5)+(L+1)+this.points.length;for(let At of it){let Xt=At*Ee;if(Q[Xt+2]<=L)continue;Q[Xt+2]=L;let vi=Q[Xt+$r];_t+=Q[Xt]*vi,di+=Q[Xt+1]*vi,Q[Xt+4]=gt,re&&(St||(St=this._map(Q,me,!0),Qt=this.clusterProps.length,this.clusterProps.push(St)),re(St,this._map(Q,Xt)))}Q[me+4]=gt,ve.push(_t/dt,di/dt,1/0,gt,-1,dt),re&&ve.push(Qt)}else{for(let St=0;St<Ee;St++)ve.push(Q[me+St]);if(dt>1)for(let St of it){let _t=St*Ee;if(!(Q[_t+2]<=L)){Q[_t+2]=L;for(let di=0;di<Ee;di++)ve.push(Q[_t+di])}}}}return ve}_getOriginId(D){return D-this.points.length>>5}_getOriginZoom(D){return(D-this.points.length)%32}_map(D,L,q){if(D[L+$r]>1){let se=this.clusterProps[D[L+na]];return q?Object.assign({},se):se}let G=this.points[D[L+Ji]].properties,re=this.options.map(G);return q&&re===G?Object.assign({},re):re}}function mn(X,D,L){return{type:"Feature",id:X[D+Ji],properties:oa(X,D,L),geometry:{type:"Point",coordinates:[(q=X[D],360*(q-.5)),To(X[D+1])]}};var q}function oa(X,D,L){let q=X[D+$r],G=q>=1e4?`${Math.round(q/1e3)}k`:q>=1e3?Math.round(q/100)/10+"k":q,re=X[D+na],se=re===-1?{}:Object.assign({},L[re]);return Object.assign(se,{cluster:!0,cluster_id:X[D+Ji],point_count:q,point_count_abbreviated:G})}function fr(X){return X/360+.5}function Zr(X){let D=Math.sin(X*Math.PI/180),L=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return L<0?0:L>1?1:L}function To(X){let D=(180-360*X)*Math.PI/180;return 360*Math.atan(Math.exp(D))/Math.PI-90}function Co(X,D,L,q){let G=q,re=D+(L-D>>1),se,ue=L-D,Q=X[D],ve=X[D+1],Ee=X[L],me=X[L+1];for(let Le=D+3;Le<L;Le+=3){let et=ps(X[Le],X[Le+1],Q,ve,Ee,me);if(et>G)se=Le,G=et;else if(et===G){let it=Math.abs(Le-re);it<ue&&(se=Le,ue=it)}}G>q&&(se-D>3&&Co(X,D,se,q),X[se+2]=G,L-se>3&&Co(X,se,L,q))}function ps(X,D,L,q,G,re){let se=G-L,ue=re-q;if(se!==0||ue!==0){let Q=((X-L)*se+(D-q)*ue)/(se*se+ue*ue);Q>1?(L=G,q=re):Q>0&&(L+=se*Q,q+=ue*Q)}return se=X-L,ue=D-q,se*se+ue*ue}function Fn(X,D,L,q){let G={id:X??null,type:D,geometry:L,tags:q,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(D==="Point"||D==="MultiPoint"||D==="LineString")io(G,L);else if(D==="Polygon")io(G,L[0]);else if(D==="MultiLineString")for(let re of L)io(G,re);else if(D==="MultiPolygon")for(let re of L)io(G,re[0]);return G}function io(X,D){for(let L=0;L<D.length;L+=3)X.minX=Math.min(X.minX,D[L]),X.minY=Math.min(X.minY,D[L+1]),X.maxX=Math.max(X.maxX,D[L]),X.maxY=Math.max(X.maxY,D[L+1])}function ro(X,D,L,q){if(!D.geometry)return;let G=D.geometry.coordinates;if(G&&G.length===0)return;let re=D.geometry.type,se=Math.pow(L.tolerance/((1<<L.maxZoom)*L.extent),2),ue=[],Q=D.id;if(L.promoteId?Q=D.properties[L.promoteId]:L.generateId&&(Q=q||0),re==="Point")aa(G,ue);else if(re==="MultiPoint")for(let ve of G)aa(ve,ue);else if(re==="LineString")ye(G,ue,se,!1);else if(re==="MultiLineString"){if(L.lineMetrics){for(let ve of G)ue=[],ye(ve,ue,se,!1),X.push(Fn(Q,"LineString",ue,D.properties));return}zo(G,ue,se,!1)}else if(re==="Polygon")zo(G,ue,se,!0);else{if(re!=="MultiPolygon"){if(re==="GeometryCollection"){for(let ve of D.geometry.geometries)ro(X,{id:Q,geometry:ve,properties:D.properties},L,q);return}throw new Error("Input data is not a valid GeoJSON object.")}for(let ve of G){let Ee=[];zo(ve,Ee,se,!0),ue.push(Ee)}}X.push(Fn(Q,re,ue,D.properties))}function aa(X,D){D.push(fs(X[0]),zt(X[1]),0)}function ye(X,D,L,q){let G,re,se=0;for(let Q=0;Q<X.length;Q++){let ve=fs(X[Q][0]),Ee=zt(X[Q][1]);D.push(ve,Ee,0),Q>0&&(se+=q?(G*Ee-ve*re)/2:Math.sqrt(Math.pow(ve-G,2)+Math.pow(Ee-re,2))),G=ve,re=Ee}let ue=D.length-3;D[2]=1,Co(D,0,ue,L),D[ue+2]=1,D.size=Math.abs(se),D.start=0,D.end=D.size}function zo(X,D,L,q){for(let G=0;G<X.length;G++){let re=[];ye(X[G],re,L,q),D.push(re)}}function fs(X){return X/360+.5}function zt(X){let D=Math.sin(X*Math.PI/180),L=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return L<0?0:L>1?1:L}function Yt(X,D,L,q,G,re,se,ue){if(q/=D,re>=(L/=D)&&se<q)return X;if(se<L||re>=q)return null;let Q=[];for(let ve of X){let Ee=ve.geometry,me=ve.type,Le=G===0?ve.minX:ve.minY,et=G===0?ve.maxX:ve.maxY;if(Le>=L&&et<q){Q.push(ve);continue}if(et<L||Le>=q)continue;let it=[];if(me==="Point"||me==="MultiPoint")ms(Ee,it,L,q,G);else if(me==="LineString")no(Ee,it,L,q,G,!1,ue.lineMetrics);else if(me==="MultiLineString")sa(Ee,it,L,q,G,!1);else if(me==="Polygon")sa(Ee,it,L,q,G,!0);else if(me==="MultiPolygon")for(let kt of Ee){let dt=[];sa(kt,dt,L,q,G,!0),dt.length&&it.push(dt)}if(it.length){if(ue.lineMetrics&&me==="LineString"){for(let kt of it)Q.push(Fn(ve.id,me,kt,ve.tags));continue}me!=="LineString"&&me!=="MultiLineString"||(it.length===1?(me="LineString",it=it[0]):me="MultiLineString"),me!=="Point"&&me!=="MultiPoint"||(me=it.length===3?"Point":"MultiPoint"),Q.push(Fn(ve.id,me,it,ve.tags))}}return Q.length?Q:null}function ms(X,D,L,q,G){for(let re=0;re<X.length;re+=3){let se=X[re+G];se>=L&&se<=q&&zr(D,X[re],X[re+1],X[re+2])}}function no(X,D,L,q,G,re,se){let ue=Bn(X),Q=G===0?gs:ys,ve,Ee,me=X.start;for(let dt=0;dt<X.length-3;dt+=3){let St=X[dt],_t=X[dt+1],di=X[dt+2],Qt=X[dt+3],gt=X[dt+4],At=G===0?St:_t,Xt=G===0?Qt:gt,vi=!1;se&&(ve=Math.sqrt(Math.pow(St-Qt,2)+Math.pow(_t-gt,2))),At<L?Xt>L&&(Ee=Q(ue,St,_t,Qt,gt,L),se&&(ue.start=me+ve*Ee)):At>q?Xt<q&&(Ee=Q(ue,St,_t,Qt,gt,q),se&&(ue.start=me+ve*Ee)):zr(ue,St,_t,di),Xt<L&&At>=L&&(Ee=Q(ue,St,_t,Qt,gt,L),vi=!0),Xt>q&&At<=q&&(Ee=Q(ue,St,_t,Qt,gt,q),vi=!0),!re&&vi&&(se&&(ue.end=me+ve*Ee),D.push(ue),ue=Bn(X)),se&&(me+=ve)}let Le=X.length-3,et=X[Le],it=X[Le+1],kt=G===0?et:it;kt>=L&&kt<=q&&zr(ue,et,it,X[Le+2]),Le=ue.length-3,re&&Le>=3&&(ue[Le]!==ue[0]||ue[Le+1]!==ue[1])&&zr(ue,ue[0],ue[1],ue[2]),ue.length&&D.push(ue)}function Bn(X){let D=[];return D.size=X.size,D.start=X.start,D.end=X.end,D}function sa(X,D,L,q,G,re){for(let se of X)no(se,D,L,q,G,re,!1)}function zr(X,D,L,q){X.push(D,L,q)}function gs(X,D,L,q,G,re){let se=(re-D)/(q-D);return zr(X,re,L+(G-L)*se,1),se}function ys(X,D,L,q,G,re){let se=(re-L)/(G-L);return zr(X,D+(q-D)*se,re,1),se}function Pe(X,D){let L=[];for(let q=0;q<X.length;q++){let G=X[q],re=G.type,se;if(re==="Point"||re==="MultiPoint"||re==="LineString")se=gn(G.geometry,D);else if(re==="MultiLineString"||re==="Polygon"){se=[];for(let ue of G.geometry)se.push(gn(ue,D))}else if(re==="MultiPolygon"){se=[];for(let ue of G.geometry){let Q=[];for(let ve of ue)Q.push(gn(ve,D));se.push(Q)}}L.push(Fn(G.id,re,se,G.tags))}return L}function gn(X,D){let L=[];L.size=X.size,X.start!==void 0&&(L.start=X.start,L.end=X.end);for(let q=0;q<X.length;q+=3)L.push(X[q]+D,X[q+1],X[q+2]);return L}function Ui(X,D){if(X.transformed)return X;let L=1<<X.z,q=X.x,G=X.y;for(let re of X.features){let se=re.geometry,ue=re.type;if(re.geometry=[],ue===1)for(let Q=0;Q<se.length;Q+=2)re.geometry.push(yn(se[Q],se[Q+1],D,L,q,G));else for(let Q=0;Q<se.length;Q++){let ve=[];for(let Ee=0;Ee<se[Q].length;Ee+=2)ve.push(yn(se[Q][Ee],se[Q][Ee+1],D,L,q,G));re.geometry.push(ve)}}return X.transformed=!0,X}function yn(X,D,L,q,G,re){return[Math.round(L*(X*q-G)),Math.round(L*(D*q-re))]}function oo(X,D,L,q,G){let re=D===G.maxZoom?0:G.tolerance/((1<<D)*G.extent),se={features:[],numPoints:0,numSimplified:0,numFeatures:X.length,source:null,x:L,y:q,z:D,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(let ue of X)Fe(se,ue,re,G);return se}function Fe(X,D,L,q){let G=D.geometry,re=D.type,se=[];if(X.minX=Math.min(X.minX,D.minX),X.minY=Math.min(X.minY,D.minY),X.maxX=Math.max(X.maxX,D.maxX),X.maxY=Math.max(X.maxY,D.maxY),re==="Point"||re==="MultiPoint")for(let ue=0;ue<G.length;ue+=3)se.push(G[ue],G[ue+1]),X.numPoints++,X.numSimplified++;else if(re==="LineString")mt(se,G,X,L,!1,!1);else if(re==="MultiLineString"||re==="Polygon")for(let ue=0;ue<G.length;ue++)mt(se,G[ue],X,L,re==="Polygon",ue===0);else if(re==="MultiPolygon")for(let ue=0;ue<G.length;ue++){let Q=G[ue];for(let ve=0;ve<Q.length;ve++)mt(se,Q[ve],X,L,!0,ve===0)}if(se.length){let ue=D.tags||null;if(re==="LineString"&&q.lineMetrics){ue={};for(let ve in D.tags)ue[ve]=D.tags[ve];ue.mapbox_clip_start=G.start/G.size,ue.mapbox_clip_end=G.end/G.size}let Q={geometry:se,type:re==="Polygon"||re==="MultiPolygon"?3:re==="LineString"||re==="MultiLineString"?2:1,tags:ue};D.id!==null&&(Q.id=D.id),X.features.push(Q)}}function mt(X,D,L,q,G,re){let se=q*q;if(q>0&&D.size<(G?se:q))return void(L.numPoints+=D.length/3);let ue=[];for(let Q=0;Q<D.length;Q+=3)(q===0||D[Q+2]>se)&&(L.numSimplified++,ue.push(D[Q],D[Q+1])),L.numPoints++;G&&function(Q,ve){let Ee=0;for(let me=0,Le=Q.length,et=Le-2;me<Le;et=me,me+=2)Ee+=(Q[me]-Q[et])*(Q[me+1]+Q[et+1]);if(Ee>0===ve)for(let me=0,Le=Q.length;me<Le/2;me+=2){let et=Q[me],it=Q[me+1];Q[me]=Q[Le-2-me],Q[me+1]=Q[Le-1-me],Q[Le-2-me]=et,Q[Le-1-me]=it}}(ue,re),X.push(ue)}let at={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Yi{constructor(D,L){let q=(L=this.options=function(re,se){for(let ue in se)re[ue]=se[ue];return re}(Object.create(at),L)).debug;if(q&&console.time("preprocess data"),L.maxZoom<0||L.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(L.promoteId&&L.generateId)throw new Error("promoteId and generateId cannot be used together.");let G=function(re,se){let ue=[];if(re.type==="FeatureCollection")for(let Q=0;Q<re.features.length;Q++)ro(ue,re.features[Q],se,Q);else ro(ue,re.type==="Feature"?re:{geometry:re},se);return ue}(D,L);this.tiles={},this.tileCoords=[],q&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",L.indexMaxZoom,L.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),G=function(re,se){let ue=se.buffer/se.extent,Q=re,ve=Yt(re,1,-1-ue,ue,0,-1,2,se),Ee=Yt(re,1,1-ue,2+ue,0,-1,2,se);return(ve||Ee)&&(Q=Yt(re,1,-ue,1+ue,0,-1,2,se)||[],ve&&(Q=Pe(ve,1).concat(Q)),Ee&&(Q=Q.concat(Pe(Ee,-1)))),Q}(G,L),G.length&&this.splitTile(G,0,0,0),q&&(G.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(D,L,q,G,re,se,ue){let Q=[D,L,q,G],ve=this.options,Ee=ve.debug;for(;Q.length;){G=Q.pop(),q=Q.pop(),L=Q.pop(),D=Q.pop();let me=1<<L,Le=Hr(L,q,G),et=this.tiles[Le];if(!et&&(Ee>1&&console.time("creation"),et=this.tiles[Le]=oo(D,L,q,G,ve),this.tileCoords.push({z:L,x:q,y:G}),Ee)){Ee>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",L,q,G,et.numFeatures,et.numPoints,et.numSimplified),console.timeEnd("creation"));let vi=`z${L}`;this.stats[vi]=(this.stats[vi]||0)+1,this.total++}if(et.source=D,re==null){if(L===ve.indexMaxZoom||et.numPoints<=ve.indexMaxPoints)continue}else{if(L===ve.maxZoom||L===re)continue;if(re!=null){let vi=re-L;if(q!==se>>vi||G!==ue>>vi)continue}}if(et.source=null,D.length===0)continue;Ee>1&&console.time("clipping");let it=.5*ve.buffer/ve.extent,kt=.5-it,dt=.5+it,St=1+it,_t=null,di=null,Qt=null,gt=null,At=Yt(D,me,q-it,q+dt,0,et.minX,et.maxX,ve),Xt=Yt(D,me,q+kt,q+St,0,et.minX,et.maxX,ve);D=null,At&&(_t=Yt(At,me,G-it,G+dt,1,et.minY,et.maxY,ve),di=Yt(At,me,G+kt,G+St,1,et.minY,et.maxY,ve),At=null),Xt&&(Qt=Yt(Xt,me,G-it,G+dt,1,et.minY,et.maxY,ve),gt=Yt(Xt,me,G+kt,G+St,1,et.minY,et.maxY,ve),Xt=null),Ee>1&&console.timeEnd("clipping"),Q.push(_t||[],L+1,2*q,2*G),Q.push(di||[],L+1,2*q,2*G+1),Q.push(Qt||[],L+1,2*q+1,2*G),Q.push(gt||[],L+1,2*q+1,2*G+1)}}getTile(D,L,q){D=+D,L=+L,q=+q;let G=this.options,{extent:re,debug:se}=G;if(D<0||D>24)return null;let ue=1<<D,Q=Hr(D,L=L+ue&ue-1,q);if(this.tiles[Q])return Ui(this.tiles[Q],re);se>1&&console.log("drilling down to z%d-%d-%d",D,L,q);let ve,Ee=D,me=L,Le=q;for(;!ve&&Ee>0;)Ee--,me>>=1,Le>>=1,ve=this.tiles[Hr(Ee,me,Le)];return ve&&ve.source?(se>1&&(console.log("found parent tile z%d-%d-%d",Ee,me,Le),console.time("drilling down")),this.splitTile(ve.source,Ee,me,Le,D,L,q),se>1&&console.timeEnd("drilling down"),this.tiles[Q]?Ui(this.tiles[Q],re):null):null}}function Hr(X,D,L){return 32*((1<<X)*L+D)+X}function ht(X,D){return D?X.properties[D]:X.id}function _n(X,D){if(X==null)return!0;if(X.type==="Feature")return ht(X,D)!=null;if(X.type==="FeatureCollection"){let L=new Set;for(let q of X.features){let G=ht(q,D);if(G==null||L.has(G))return!1;L.add(G)}return!0}return!1}function On(X,D){let L=new Map;if(X!=null)if(X.type==="Feature")L.set(ht(X,D),X);else for(let q of X.features)L.set(ht(q,D),q);return L}class ao extends B{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(D,L){return f._(this,void 0,void 0,function*(){let q=D.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");let G=this._geoJSONIndex.getTile(q.z,q.x,q.y);if(!G)return null;let re=new class{constructor(ue){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=f.X,this.length=ue.length,this._features=ue}feature(ue){return new class{constructor(Q){this._feature=Q,this.extent=f.X,this.type=Q.type,this.properties=Q.tags,"id"in Q&&!isNaN(Q.id)&&(this.id=parseInt(Q.id,10))}loadGeometry(){if(this._feature.type===1){let Q=[];for(let ve of this._feature.geometry)Q.push([new f.P(ve[0],ve[1])]);return Q}{let Q=[];for(let ve of this._feature.geometry){let Ee=[];for(let me of ve)Ee.push(new f.P(me[0],me[1]));Q.push(Ee)}return Q}}toGeoJSON(Q,ve,Ee){return xe.call(this,Q,ve,Ee)}}(this._features[ue])}}(G.features),se=fn(re);return se.byteOffset===0&&se.byteLength===se.buffer.byteLength||(se=new Uint8Array(se)),{vectorTile:re,rawData:se.buffer}})}loadData(D){return f._(this,void 0,void 0,function*(){var L;(L=this._pendingRequest)===null||L===void 0||L.abort();let q=!!(D&&D.request&&D.request.collectResourceTiming)&&new f.bv(D.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(D,this._pendingRequest),this._geoJSONIndex=D.cluster?new to(function({superclusterOptions:se,clusterProperties:ue}){if(!ue||!se)return se;let Q={},ve={},Ee={accumulated:null,zoom:0},me={properties:null},Le=Object.keys(ue);for(let et of Le){let[it,kt]=ue[et],dt=f.bC(kt),St=f.bC(typeof it=="string"?[it,["accumulated"],["get",et]]:it);Q[et]=dt.value,ve[et]=St.value}return se.map=et=>{me.properties=et;let it={};for(let kt of Le)it[kt]=Q[kt].evaluate(Ee,me);return it},se.reduce=(et,it)=>{me.properties=it;for(let kt of Le)Ee.accumulated=et[kt],et[kt]=ve[kt].evaluate(Ee,me)},se}(D)).load((yield this._pendingData).features):(G=yield this._pendingData,new Yi(G,D.geojsonVtOptions)),this.loaded={};let re={};if(q){let se=q.finish();se&&(re.resourceTiming={},re.resourceTiming[D.source]=JSON.parse(JSON.stringify(se)))}return re}catch(re){if(delete this._pendingRequest,f.bB(re))return{abandoned:!0};throw re}var G})}getData(){return f._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(D){let L=this.loaded;return L&&L[D.uid]?super.reloadTile(D):this.loadTile(D)}loadAndProcessGeoJSON(D,L){return f._(this,void 0,void 0,function*(){let q=yield this.loadGeoJSON(D,L);if(delete this._pendingRequest,typeof q!="object")throw new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`);if(Te(q,!0),D.filter){let G=f.bC(D.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(G.result==="error")throw new Error(G.value.map(se=>`${se.key}: ${se.message}`).join(", "));q={type:"FeatureCollection",features:q.features.filter(se=>G.value.evaluate({zoom:0},se))}}return q})}loadGeoJSON(D,L){return f._(this,void 0,void 0,function*(){let{promoteId:q}=D;if(D.request){let G=yield f.h(D.request,L);return this._dataUpdateable=_n(G.data,q)?On(G.data,q):void 0,G.data}if(typeof D.data=="string")try{let G=JSON.parse(D.data);return this._dataUpdateable=_n(G,q)?On(G,q):void 0,G}catch{throw new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`)}if(!D.dataDiff)throw new Error(`Input data given to '${D.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${D.source}`);return function(G,re,se){var ue,Q,ve,Ee;if(re.removeAll&&G.clear(),re.remove)for(let me of re.remove)G.delete(me);if(re.add)for(let me of re.add){let Le=ht(me,se);Le!=null&&G.set(Le,me)}if(re.update)for(let me of re.update){let Le=G.get(me.id);if(Le==null)continue;let et=!me.removeAllProperties&&(((ue=me.removeProperties)===null||ue===void 0?void 0:ue.length)>0||((Q=me.addOrUpdateProperties)===null||Q===void 0?void 0:Q.length)>0);if((me.newGeometry||me.removeAllProperties||et)&&(Le=Object.assign({},Le),G.set(me.id,Le),et&&(Le.properties=Object.assign({},Le.properties))),me.newGeometry&&(Le.geometry=me.newGeometry),me.removeAllProperties)Le.properties={};else if(((ve=me.removeProperties)===null||ve===void 0?void 0:ve.length)>0)for(let it of me.removeProperties)Object.prototype.hasOwnProperty.call(Le.properties,it)&&delete Le.properties[it];if(((Ee=me.addOrUpdateProperties)===null||Ee===void 0?void 0:Ee.length)>0)for(let{key:it,value:kt}of me.addOrUpdateProperties)Le.properties[it]=kt}}(this._dataUpdateable,D.dataDiff,q),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(D){return f._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(D){return this._geoJSONIndex.getClusterExpansionZoom(D.clusterId)}getClusterChildren(D){return this._geoJSONIndex.getChildren(D.clusterId)}getClusterLeaves(D){return this._geoJSONIndex.getLeaves(D.clusterId,D.limit,D.offset)}}class vn{constructor(D){this.self=D,this.actor=new f.F(D),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(L,q)=>{if(this.externalWorkerSourceTypes[L])throw new Error(`Worker source with name "${L}" already registered.`);this.externalWorkerSourceTypes[L]=q},this.self.addProtocol=f.bi,this.self.removeProtocol=f.bj,this.self.registerRTLTextPlugin=L=>{if(f.bD.isParsed())throw new Error("RTL text plugin already registered.");f.bD.setMethods(L)},this.actor.registerMessageHandler("LDT",(L,q)=>this._getDEMWorkerSource(L,q.source).loadTile(q)),this.actor.registerMessageHandler("RDT",(L,q)=>f._(this,void 0,void 0,function*(){this._getDEMWorkerSource(L,q.source).removeTile(q)})),this.actor.registerMessageHandler("GCEZ",(L,q)=>f._(this,void 0,void 0,function*(){return this._getWorkerSource(L,q.type,q.source).getClusterExpansionZoom(q)})),this.actor.registerMessageHandler("GCC",(L,q)=>f._(this,void 0,void 0,function*(){return this._getWorkerSource(L,q.type,q.source).getClusterChildren(q)})),this.actor.registerMessageHandler("GCL",(L,q)=>f._(this,void 0,void 0,function*(){return this._getWorkerSource(L,q.type,q.source).getClusterLeaves(q)})),this.actor.registerMessageHandler("LD",(L,q)=>this._getWorkerSource(L,q.type,q.source).loadData(q)),this.actor.registerMessageHandler("GD",(L,q)=>this._getWorkerSource(L,q.type,q.source).getData()),this.actor.registerMessageHandler("LT",(L,q)=>this._getWorkerSource(L,q.type,q.source).loadTile(q)),this.actor.registerMessageHandler("RT",(L,q)=>this._getWorkerSource(L,q.type,q.source).reloadTile(q)),this.actor.registerMessageHandler("AT",(L,q)=>this._getWorkerSource(L,q.type,q.source).abortTile(q)),this.actor.registerMessageHandler("RMT",(L,q)=>this._getWorkerSource(L,q.type,q.source).removeTile(q)),this.actor.registerMessageHandler("RS",(L,q)=>f._(this,void 0,void 0,function*(){if(!this.workerSources[L]||!this.workerSources[L][q.type]||!this.workerSources[L][q.type][q.source])return;let G=this.workerSources[L][q.type][q.source];delete this.workerSources[L][q.type][q.source],G.removeSource!==void 0&&G.removeSource(q)})),this.actor.registerMessageHandler("RM",L=>f._(this,void 0,void 0,function*(){delete this.layerIndexes[L],delete this.availableImages[L],delete this.workerSources[L],delete this.demWorkerSources[L]})),this.actor.registerMessageHandler("SR",(L,q)=>f._(this,void 0,void 0,function*(){this.referrer=q})),this.actor.registerMessageHandler("SRPS",(L,q)=>this._syncRTLPluginState(L,q)),this.actor.registerMessageHandler("IS",(L,q)=>f._(this,void 0,void 0,function*(){this.self.importScripts(q)})),this.actor.registerMessageHandler("SI",(L,q)=>this._setImages(L,q)),this.actor.registerMessageHandler("UL",(L,q)=>f._(this,void 0,void 0,function*(){this._getLayerIndex(L).update(q.layers,q.removedIds)})),this.actor.registerMessageHandler("SL",(L,q)=>f._(this,void 0,void 0,function*(){this._getLayerIndex(L).replace(q)}))}_setImages(D,L){return f._(this,void 0,void 0,function*(){this.availableImages[D]=L;for(let q in this.workerSources[D]){let G=this.workerSources[D][q];for(let re in G)G[re].availableImages=L}})}_syncRTLPluginState(D,L){return f._(this,void 0,void 0,function*(){if(f.bD.isParsed())return f.bD.getState();if(L.pluginStatus!=="loading")return f.bD.setState(L),L;let q=L.pluginURL;if(this.self.importScripts(q),f.bD.isParsed()){let G={pluginStatus:"loaded",pluginURL:q};return f.bD.setState(G),G}throw f.bD.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${q}`)})}_getAvailableImages(D){let L=this.availableImages[D];return L||(L=[]),L}_getLayerIndex(D){let L=this.layerIndexes[D];return L||(L=this.layerIndexes[D]=new s),L}_getWorkerSource(D,L,q){if(this.workerSources[D]||(this.workerSources[D]={}),this.workerSources[D][L]||(this.workerSources[D][L]={}),!this.workerSources[D][L][q]){let G={sendAsync:(re,se)=>(re.targetMapId=D,this.actor.sendAsync(re,se))};switch(L){case"vector":this.workerSources[D][L][q]=new B(G,this._getLayerIndex(D),this._getAvailableImages(D));break;case"geojson":this.workerSources[D][L][q]=new ao(G,this._getLayerIndex(D),this._getAvailableImages(D));break;default:this.workerSources[D][L][q]=new this.externalWorkerSourceTypes[L](G,this._getLayerIndex(D),this._getAvailableImages(D))}}return this.workerSources[D][L][q]}_getDEMWorkerSource(D,L){return this.demWorkerSources[D]||(this.demWorkerSources[D]={}),this.demWorkerSources[D][L]||(this.demWorkerSources[D][L]=new j),this.demWorkerSources[D][L]}}return f.i(self)&&(self.worker=new vn(self)),vn}),c("index",["exports","./shared"],function(f,s){"use strict";var E="4.7.1";let A,N,B={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:g=>new Promise((e,a)=>{let u=requestAnimationFrame(e);g.signal.addEventListener("abort",()=>{cancelAnimationFrame(u),a(s.c())})}),getImageData(g,e=0){return this.getImageCanvasContext(g).getImageData(-e,-e,g.width+2*e,g.height+2*e)},getImageCanvasContext(g){let e=window.document.createElement("canvas"),a=e.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return e.width=g.width,e.height=g.height,a.drawImage(g,0,0,g.width,g.height),a},resolveURL:g=>(A||(A=document.createElement("a")),A.href=g,A.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(N==null&&(N=matchMedia("(prefers-reduced-motion: reduce)")),N.matches)}};class j{static testProp(e){if(!j.docStyle)return e[0];for(let a=0;a<e.length;a++)if(e[a]in j.docStyle)return e[a];return e[0]}static create(e,a,u){let h=window.document.createElement(e);return a!==void 0&&(h.className=a),u&&u.appendChild(h),h}static createNS(e,a){return window.document.createElementNS(e,a)}static disableDrag(){j.docStyle&&j.selectProp&&(j.userSelect=j.docStyle[j.selectProp],j.docStyle[j.selectProp]="none")}static enableDrag(){j.docStyle&&j.selectProp&&(j.docStyle[j.selectProp]=j.userSelect)}static setTransform(e,a){e.style[j.transformProp]=a}static addEventListener(e,a,u,h={}){e.addEventListener(a,u,"passive"in h?h:h.capture)}static removeEventListener(e,a,u,h={}){e.removeEventListener(a,u,"passive"in h?h:h.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",j.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",j.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",j.suppressClickInternal,!0)},0)}static getScale(e){let a=e.getBoundingClientRect();return{x:a.width/e.offsetWidth||1,y:a.height/e.offsetHeight||1,boundingClientRect:a}}static getPoint(e,a,u){let h=a.boundingClientRect;return new s.P((u.clientX-h.left)/a.x-e.clientLeft,(u.clientY-h.top)/a.y-e.clientTop)}static mousePos(e,a){let u=j.getScale(e);return j.getPoint(e,u,a)}static touchPos(e,a){let u=[],h=j.getScale(e);for(let m=0;m<a.length;m++)u.push(j.getPoint(e,h,a[m]));return u}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}}j.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,j.selectProp=j.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),j.transformProp=j.testProp(["transform","WebkitTransform"]);let de={supported:!1,testSupport:function(g){!xe&&Te&&(Se?Ae(g):ge=g)}},ge,Te,xe=!1,Se=!1;function Ae(g){let e=g.createTexture();g.bindTexture(g.TEXTURE_2D,e);try{if(g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,Te),g.isContextLost())return;de.supported=!0}catch{}g.deleteTexture(e),xe=!0}var ne;typeof document<"u"&&(Te=document.createElement("img"),Te.onload=()=>{ge&&Ae(ge),ge=null,Se=!0},Te.onerror=()=>{xe=!0,ge=null},Te.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(g){let e,a,u,h;g.resetRequestQueue=()=>{e=[],a=0,u=0,h={}},g.addThrottleControl=k=>{let C=u++;return h[C]=k,C},g.removeThrottleControl=k=>{delete h[k],x()},g.getImage=(k,C,I=!0)=>new Promise((P,F)=>{de.supported&&(k.headers||(k.headers={}),k.headers.accept="image/webp,*/*"),s.e(k,{type:"image"}),e.push({abortController:C,requestParameters:k,supportImageRefresh:I,state:"queued",onError:U=>{F(U)},onSuccess:U=>{P(U)}}),x()});let m=k=>s._(this,void 0,void 0,function*(){k.state="running";let{requestParameters:C,supportImageRefresh:I,onError:P,onSuccess:F,abortController:U}=k,$=I===!1&&!s.i(self)&&!s.g(C.url)&&(!C.headers||Object.keys(C.headers).reduce((Y,te)=>Y&&te==="accept",!0));a++;let W=$?b(C,U):s.m(C,U);try{let Y=yield W;delete k.abortController,k.state="completed",Y.data instanceof HTMLImageElement||s.b(Y.data)?F(Y):Y.data&&F({data:yield(J=Y.data,typeof createImageBitmap=="function"?s.d(J):s.f(J)),cacheControl:Y.cacheControl,expires:Y.expires})}catch(Y){delete k.abortController,P(Y)}finally{a--,x()}var J}),x=()=>{let k=(()=>{for(let C of Object.keys(h))if(h[C]())return!0;return!1})()?s.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:s.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let C=a;C<k&&e.length>0;C++){let I=e.shift();I.abortController.signal.aborted?C--:m(I)}},b=(k,C)=>new Promise((I,P)=>{let F=new Image,U=k.url,$=k.credentials;$&&$==="include"?F.crossOrigin="use-credentials":($&&$==="same-origin"||!s.s(U))&&(F.crossOrigin="anonymous"),C.signal.addEventListener("abort",()=>{F.src="",P(s.c())}),F.fetchPriority="high",F.onload=()=>{F.onerror=F.onload=null,I({data:F})},F.onerror=()=>{F.onerror=F.onload=null,C.signal.aborted||P(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},F.src=U})}(ne||(ne={})),ne.resetRequestQueue();class ee{constructor(e){this._transformRequestFn=e}transformRequest(e,a){return this._transformRequestFn&&this._transformRequestFn(e,a)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function ae(g){var e=new s.A(3);return e[0]=g[0],e[1]=g[1],e[2]=g[2],e}var be,Ie=function(g,e,a){return g[0]=e[0]-a[0],g[1]=e[1]-a[1],g[2]=e[2]-a[2],g};be=new s.A(3),s.A!=Float32Array&&(be[0]=0,be[1]=0,be[2]=0);var Ye=function(g){var e=g[0],a=g[1];return e*e+a*a};function Ge(g){let e=[];if(typeof g=="string")e.push({id:"default",url:g});else if(g&&g.length>0){let a=[];for(let{id:u,url:h}of g){let m=`${u}${h}`;a.indexOf(m)===-1&&(a.push(m),e.push({id:u,url:h}))}}return e}function rt(g,e,a){let u=g.split("?");return u[0]+=`${e}${a}`,u.join("?")}(function(){var g=new s.A(2);s.A!=Float32Array&&(g[0]=0,g[1]=0)})();class ct{constructor(e,a,u,h){this.context=e,this.format=u,this.texture=e.gl.createTexture(),this.update(a,h)}update(e,a,u){let{width:h,height:m}=e,x=!(this.size&&this.size[0]===h&&this.size[1]===m||u),{context:b}=this,{gl:k}=b;if(this.useMipmap=!!(a&&a.useMipmap),k.bindTexture(k.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===k.RGBA&&(!a||a.premultiply!==!1)),x)this.size=[h,m],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||s.b(e)?k.texImage2D(k.TEXTURE_2D,0,this.format,this.format,k.UNSIGNED_BYTE,e):k.texImage2D(k.TEXTURE_2D,0,this.format,h,m,0,this.format,k.UNSIGNED_BYTE,e.data);else{let{x:C,y:I}=u||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||s.b(e)?k.texSubImage2D(k.TEXTURE_2D,0,C,I,k.RGBA,k.UNSIGNED_BYTE,e):k.texSubImage2D(k.TEXTURE_2D,0,C,I,h,m,k.RGBA,k.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&k.generateMipmap(k.TEXTURE_2D)}bind(e,a,u){let{context:h}=this,{gl:m}=h;m.bindTexture(m.TEXTURE_2D,this.texture),u!==m.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(u=m.LINEAR),e!==this.filter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,e),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,u||e),this.filter=e),a!==this.wrap&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,a),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){let{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function bt(g){let{userImage:e}=g;return!!(e&&e.render&&e.render())&&(g.data.replace(new Uint8Array(e.data.buffer)),!0)}class Wt extends s.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(let{ids:a,promiseResolve:u}of this.requestors)u(this._getImagesForIds(a));this.requestors=[]}}getImage(e){let a=this.images[e];if(a&&!a.data&&a.spriteData){let u=a.spriteData;a.data=new s.R({width:u.width,height:u.height},u.context.getImageData(u.x,u.y,u.width,u.height).data),a.spriteData=null}return a}addImage(e,a){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,a)&&(this.images[e]=a)}_validate(e,a){let u=!0,h=a.data||a.spriteData;return this._validateStretch(a.stretchX,h&&h.width)||(this.fire(new s.j(new Error(`Image "${e}" has invalid "stretchX" value`))),u=!1),this._validateStretch(a.stretchY,h&&h.height)||(this.fire(new s.j(new Error(`Image "${e}" has invalid "stretchY" value`))),u=!1),this._validateContent(a.content,a)||(this.fire(new s.j(new Error(`Image "${e}" has invalid "content" value`))),u=!1),u}_validateStretch(e,a){if(!e)return!0;let u=0;for(let h of e){if(h[0]<u||h[1]<h[0]||a<h[1])return!1;u=h[1]}return!0}_validateContent(e,a){if(!e)return!0;if(e.length!==4)return!1;let u=a.spriteData,h=u&&u.width||a.data.width,m=u&&u.height||a.data.height;return!(e[0]<0||h<e[0]||e[1]<0||m<e[1]||e[2]<0||h<e[2]||e[3]<0||m<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,a,u=!0){let h=this.getImage(e);if(u&&(h.data.width!==a.data.width||h.data.height!==a.data.height))throw new Error(`size mismatch between old image (${h.data.width}x${h.data.height}) and new image (${a.data.width}x${a.data.height}).`);a.version=h.version+1,this.images[e]=a,this.updatedImages[e]=!0}removeImage(e){let a=this.images[e];delete this.images[e],delete this.patterns[e],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((a,u)=>{let h=!0;if(!this.isLoaded())for(let m of e)this.images[m]||(h=!1);this.isLoaded()||h?a(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:a})})}_getImagesForIds(e){let a={};for(let u of e){let h=this.getImage(u);h||(this.fire(new s.k("styleimagemissing",{id:u})),h=this.getImage(u)),h?a[u]={data:h.data.clone(),pixelRatio:h.pixelRatio,sdf:h.sdf,version:h.version,stretchX:h.stretchX,stretchY:h.stretchY,content:h.content,textFitWidth:h.textFitWidth,textFitHeight:h.textFitHeight,hasRenderCallback:!!(h.userImage&&h.userImage.render)}:s.w(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return a}getPixelSize(){let{width:e,height:a}=this.atlasImage;return{width:e,height:a}}getPattern(e){let a=this.patterns[e],u=this.getImage(e);if(!u)return null;if(a&&a.position.version===u.version)return a.position;if(a)a.position.version=u.version;else{let h={w:u.data.width+2,h:u.data.height+2,x:0,y:0},m=new s.I(h,u);this.patterns[e]={bin:h,position:m}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){let a=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new ct(e,this.atlasImage,a.RGBA),this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){let e=[];for(let m in this.patterns)e.push(this.patterns[m].bin);let{w:a,h:u}=s.p(e),h=this.atlasImage;h.resize({width:a||1,height:u||1});for(let m in this.patterns){let{bin:x}=this.patterns[m],b=x.x+1,k=x.y+1,C=this.getImage(m).data,I=C.width,P=C.height;s.R.copy(C,h,{x:0,y:0},{x:b,y:k},{width:I,height:P}),s.R.copy(C,h,{x:0,y:P-1},{x:b,y:k-1},{width:I,height:1}),s.R.copy(C,h,{x:0,y:0},{x:b,y:k+P},{width:I,height:1}),s.R.copy(C,h,{x:I-1,y:0},{x:b-1,y:k},{width:1,height:P}),s.R.copy(C,h,{x:0,y:0},{x:b+I,y:k},{width:1,height:P})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(let a of e){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;let u=this.getImage(a);u||s.w(`Image with ID: "${a}" was not found`),bt(u)&&this.updateImage(a,u)}}}let Ei=1e20;function Dn(g,e,a,u,h,m,x,b,k){for(let C=e;C<e+u;C++)ra(g,a*m+C,m,h,x,b,k);for(let C=a;C<a+h;C++)ra(g,C*m+e,1,u,x,b,k)}function ra(g,e,a,u,h,m,x){m[0]=0,x[0]=-Ei,x[1]=Ei,h[0]=g[e];for(let b=1,k=0,C=0;b<u;b++){h[b]=g[e+b*a];let I=b*b;do{let P=m[k];C=(h[b]-h[P]+I-P*P)/(b-P)/2}while(C<=x[k]&&--k>-1);k++,m[k]=b,x[k]=C,x[k+1]=Ei}for(let b=0,k=0;b<u;b++){for(;x[k+1]<b;)k++;let C=m[k],I=b-C;g[e+b*a]=h[C]+I*I}}class fn{constructor(e,a){this.requestManager=e,this.localIdeographFontFamily=a,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return s._(this,void 0,void 0,function*(){let a=[];for(let m in e)for(let x of e[m])a.push(this._getAndCacheGlyphsPromise(m,x));let u=yield Promise.all(a),h={};for(let{stack:m,id:x,glyph:b}of u)h[m]||(h[m]={}),h[m][x]=b&&{id:b.id,bitmap:b.bitmap.clone(),metrics:b.metrics};return h})}_getAndCacheGlyphsPromise(e,a){return s._(this,void 0,void 0,function*(){let u=this.entries[e];u||(u=this.entries[e]={glyphs:{},requests:{},ranges:{}});let h=u.glyphs[a];if(h!==void 0)return{stack:e,id:a,glyph:h};if(h=this._tinySDF(u,e,a),h)return u.glyphs[a]=h,{stack:e,id:a,glyph:h};let m=Math.floor(a/256);if(256*m>65535)throw new Error("glyphs > 65535 not supported");if(u.ranges[m])return{stack:e,id:a,glyph:h};if(!this.url)throw new Error("glyphsUrl is not set");if(!u.requests[m]){let b=fn.loadGlyphRange(e,m,this.url,this.requestManager);u.requests[m]=b}let x=yield u.requests[m];for(let b in x)this._doesCharSupportLocalGlyph(+b)||(u.glyphs[+b]=x[+b]);return u.ranges[m]=!0,{stack:e,id:a,glyph:x[a]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&/\p{Ideo}|\p{sc=Hang}|\p{sc=Hira}|\p{sc=Kana}/u.test(String.fromCodePoint(e))}_tinySDF(e,a,u){let h=this.localIdeographFontFamily;if(!h||!this._doesCharSupportLocalGlyph(u))return;let m=e.tinySDF;if(!m){let b="400";/bold/i.test(a)?b="900":/medium/i.test(a)?b="500":/light/i.test(a)&&(b="200"),m=e.tinySDF=new fn.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:h,fontWeight:b})}let x=m.draw(String.fromCharCode(u));return{id:u,bitmap:new s.o({width:x.width||60,height:x.height||60},x.data),metrics:{width:x.glyphWidth/2||24,height:x.glyphHeight/2||24,left:x.glyphLeft/2+.5||0,top:x.glyphTop/2-27.5||-8,advance:x.glyphAdvance/2||24,isDoubleResolution:!0}}}}fn.loadGlyphRange=function(g,e,a,u){return s._(this,void 0,void 0,function*(){let h=256*e,m=h+255,x=u.transformRequest(a.replace("{fontstack}",g).replace("{range}",`${h}-${m}`),"Glyphs"),b=yield s.l(x,new AbortController);if(!b||!b.data)throw new Error(`Could not load glyph range. range: ${e}, ${h}-${m}`);let k={};for(let C of s.n(b.data))k[C.id]=C;return k})},fn.TinySDF=class{constructor({fontSize:g=24,buffer:e=3,radius:a=8,cutoff:u=.25,fontFamily:h="sans-serif",fontWeight:m="normal",fontStyle:x="normal"}={}){this.buffer=e,this.cutoff=u,this.radius=a;let b=this.size=g+4*e,k=this._createCanvas(b),C=this.ctx=k.getContext("2d",{willReadFrequently:!0});C.font=`${x} ${m} ${g}px ${h}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(g){let e=document.createElement("canvas");return e.width=e.height=g,e}draw(g){let{width:e,actualBoundingBoxAscent:a,actualBoundingBoxDescent:u,actualBoundingBoxLeft:h,actualBoundingBoxRight:m}=this.ctx.measureText(g),x=Math.ceil(a),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-h))),k=Math.min(this.size-this.buffer,x+Math.ceil(u)),C=b+2*this.buffer,I=k+2*this.buffer,P=Math.max(C*I,0),F=new Uint8ClampedArray(P),U={data:F,width:C,height:I,glyphWidth:b,glyphHeight:k,glyphTop:x,glyphLeft:0,glyphAdvance:e};if(b===0||k===0)return U;let{ctx:$,buffer:W,gridInner:J,gridOuter:Y}=this;$.clearRect(W,W,b,k),$.fillText(g,W,W+x);let te=$.getImageData(W,W,b,k);Y.fill(Ei,0,P),J.fill(0,0,P);for(let Z=0;Z<k;Z++)for(let oe=0;oe<b;oe++){let le=te.data[4*(Z*b+oe)+3]/255;if(le===0)continue;let pe=(Z+W)*C+oe+W;if(le===1)Y[pe]=0,J[pe]=Ei;else{let ke=.5-le;Y[pe]=ke>0?ke*ke:0,J[pe]=ke<0?ke*ke:0}}Dn(Y,0,0,C,I,C,this.f,this.v,this.z),Dn(J,W,W,b,k,C,this.f,this.v,this.z);for(let Z=0;Z<P;Z++){let oe=Math.sqrt(Y[Z])-Math.sqrt(J[Z]);F[Z]=Math.round(255-255*(oe/this.radius+this.cutoff))}return U}};class ll{constructor(){this.specification=s.v.light.position}possiblyEvaluate(e,a){return s.x(e.expression.evaluate(a))}interpolate(e,a,u){return{x:s.y.number(e.x,a.x,u),y:s.y.number(e.y,a.y,u),z:s.y.number(e.z,a.z,u)}}}let Eo;class Rn extends s.E{constructor(e){super(),Eo=Eo||new s.q({anchor:new s.D(s.v.light.anchor),position:new ll,color:new s.D(s.v.light.color),intensity:new s.D(s.v.light.intensity)}),this._transitionable=new s.T(Eo),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,a={}){if(!this._validate(s.r,e,a))for(let u in e){let h=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),h):this._transitionable.setValue(u,h)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,u){return(!u||u.validate!==!1)&&s.t(this,e.call(s.u,{value:a,style:{glyphs:!0,sprite:!0},styleSpec:s.v}))}}let Ji=new s.q({"sky-color":new s.D(s.v.sky["sky-color"]),"horizon-color":new s.D(s.v.sky["horizon-color"]),"fog-color":new s.D(s.v.sky["fog-color"]),"fog-ground-blend":new s.D(s.v.sky["fog-ground-blend"]),"horizon-fog-blend":new s.D(s.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new s.D(s.v.sky["sky-horizon-blend"]),"atmosphere-blend":new s.D(s.v.sky["atmosphere-blend"])});class $r extends s.E{constructor(e){super(),this._transitionable=new s.T(Ji),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new s.z(0))}setSky(e,a={}){if(!this._validate(s.B,e,a)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(let u in e){let h=e[u];u.endsWith("-transition")?this._transitionable.setTransition(u.slice(0,-11),h):this._transitionable.setValue(u,h)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,a,u={}){return u?.validate!==!1&&s.t(this,e.call(s.u,s.e({value:a,style:{glyphs:!0,sprite:!0},styleSpec:s.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class na{constructor(e,a){this.width=e,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,a){let u=e.join(",")+String(a);return this.dashEntry[u]||(this.dashEntry[u]=this.addDash(e,a)),this.dashEntry[u]}getDashRanges(e,a,u){let h=[],m=e.length%2==1?-e[e.length-1]*u:0,x=e[0]*u,b=!0;h.push({left:m,right:x,isDash:b,zeroLength:e[0]===0});let k=e[0];for(let C=1;C<e.length;C++){b=!b;let I=e[C];m=k*u,k+=I,x=k*u,h.push({left:m,right:x,isDash:b,zeroLength:I===0})}return h}addRoundDash(e,a,u){let h=a/2;for(let m=-u;m<=u;m++){let x=this.width*(this.nextRow+u+m),b=0,k=e[b];for(let C=0;C<this.width;C++){C/k.right>1&&(k=e[++b]);let I=Math.abs(C-k.left),P=Math.abs(C-k.right),F=Math.min(I,P),U,$=m/u*(h+1);if(k.isDash){let W=h-Math.abs($);U=Math.sqrt(F*F+W*W)}else U=h-Math.sqrt(F*F+$*$);this.data[x+C]=Math.max(0,Math.min(255,U+128))}}}addRegularDash(e){for(let b=e.length-1;b>=0;--b){let k=e[b],C=e[b+1];k.zeroLength?e.splice(b,1):C&&C.isDash===k.isDash&&(C.left=k.left,e.splice(b,1))}let a=e[0],u=e[e.length-1];a.isDash===u.isDash&&(a.left=u.left-this.width,u.right=a.right+this.width);let h=this.width*this.nextRow,m=0,x=e[m];for(let b=0;b<this.width;b++){b/x.right>1&&(x=e[++m]);let k=Math.abs(b-x.left),C=Math.abs(b-x.right),I=Math.min(k,C);this.data[h+b]=Math.max(0,Math.min(255,(x.isDash?I:-I)+128))}}addDash(e,a){let u=a?7:0,h=2*u+1;if(this.nextRow+h>this.height)return s.w("LineAtlas out of space"),null;let m=0;for(let b=0;b<e.length;b++)m+=e[b];if(m!==0){let b=this.width/m,k=this.getDashRanges(e,this.width,b);a?this.addRoundDash(k,b,u):this.addRegularDash(k)}let x={y:(this.nextRow+u+.5)/this.height,height:2*u/this.height,width:m};return this.nextRow+=h,this.dirty=!0,x}bind(e){let a=e.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))}}let to="maplibre_preloaded_worker_pool";class mn{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<mn.workerCount;)this.workers.push(new Worker(s.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[to]}numActive(){return Object.keys(this.active).length}}let oa=Math.floor(B.hardwareConcurrency/2),fr,Zr;function To(){return fr||(fr=new mn),fr}mn.workerCount=s.C(globalThis)?Math.max(Math.min(oa,3),1):1;class Co{constructor(e,a){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=a;let u=this.workerPool.acquire(a);for(let h=0;h<u.length;h++){let m=new s.F(u[h],a);m.name=`Worker ${h}`,this.actors.push(m)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,a){let u=[];for(let h of this.actors)u.push(h.sendAsync({type:e,data:a}));return Promise.all(u)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(a=>{a.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,a){for(let u of this.actors)u.registerMessageHandler(e,a)}}function ps(){return Zr||(Zr=new Co(To(),s.G),Zr.registerMessageHandler("GR",(g,e,a)=>s.m(e,a))),Zr}function Fn(g,e){let a=s.H();return s.J(a,a,[1,1,0]),s.K(a,a,[.5*g.width,.5*g.height,1]),s.L(a,a,g.calculatePosMatrix(e.toUnwrapped()))}function io(g,e,a,u,h,m){let x=function(P,F,U){if(P)for(let $ of P){let W=F[$];if(W&&W.source===U&&W.type==="fill-extrusion")return!0}else for(let $ in F){let W=F[$];if(W.source===U&&W.type==="fill-extrusion")return!0}return!1}(h&&h.layers,e,g.id),b=m.maxPitchScaleFactor(),k=g.tilesIn(u,b,x);k.sort(ro);let C=[];for(let P of k)C.push({wrappedTileID:P.tileID.wrapped().key,queryResults:P.tile.queryRenderedFeatures(e,a,g._state,P.queryGeometry,P.cameraQueryGeometry,P.scale,h,m,b,Fn(g.transform,P.tileID))});let I=function(P){let F={},U={};for(let $ of P){let W=$.queryResults,J=$.wrappedTileID,Y=U[J]=U[J]||{};for(let te in W){let Z=W[te],oe=Y[te]=Y[te]||{},le=F[te]=F[te]||[];for(let pe of Z)oe[pe.featureIndex]||(oe[pe.featureIndex]=!0,le.push(pe))}}return F}(C);for(let P in I)I[P].forEach(F=>{let U=F.feature,$=g.getFeatureState(U.layer["source-layer"],U.id);U.source=U.layer.source,U.layer["source-layer"]&&(U.sourceLayer=U.layer["source-layer"]),U.state=$});return I}function ro(g,e){let a=g.tileID,u=e.tileID;return a.overscaledZ-u.overscaledZ||a.canonical.y-u.canonical.y||a.wrap-u.wrap||a.canonical.x-u.canonical.x}function aa(g,e,a){return s._(this,void 0,void 0,function*(){let u=g;if(g.url?u=(yield s.h(e.transformRequest(g.url,"Source"),a)).data:yield B.frameAsync(a),!u)return null;let h=s.M(s.e(u,g),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in u&&u.vector_layers&&(h.vectorLayerIds=u.vector_layers.map(m=>m.id)),h})}class ye{constructor(e,a){e&&(a?this.setSouthWest(e).setNorthEast(a):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof s.N?new s.N(e.lng,e.lat):s.N.convert(e),this}setSouthWest(e){return this._sw=e instanceof s.N?new s.N(e.lng,e.lat):s.N.convert(e),this}extend(e){let a=this._sw,u=this._ne,h,m;if(e instanceof s.N)h=e,m=e;else{if(!(e instanceof ye))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ye.convert(e)):this.extend(s.N.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(s.N.convert(e)):this;if(h=e._sw,m=e._ne,!h||!m)return this}return a||u?(a.lng=Math.min(h.lng,a.lng),a.lat=Math.min(h.lat,a.lat),u.lng=Math.max(m.lng,u.lng),u.lat=Math.max(m.lat,u.lat)):(this._sw=new s.N(h.lng,h.lat),this._ne=new s.N(m.lng,m.lat)),this}getCenter(){return new s.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new s.N(this.getWest(),this.getNorth())}getSouthEast(){return new s.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){let{lng:a,lat:u}=s.N.convert(e),h=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&h}static convert(e){return e instanceof ye?e:e&&new ye(e)}static fromLngLat(e,a=0){let u=360*a/40075017,h=u/Math.cos(Math.PI/180*e.lat);return new ye(new s.N(e.lng-h,e.lat-u),new s.N(e.lng+h,e.lat+u))}adjustAntiMeridian(){let e=new s.N(this._sw.lng,this._sw.lat),a=new s.N(this._ne.lng,this._ne.lat);return new ye(e,e.lng>a.lng?new s.N(a.lng+360,a.lat):a)}}class zo{constructor(e,a,u){this.bounds=ye.convert(this.validateBounds(e)),this.minzoom=a||0,this.maxzoom=u||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){let a=Math.pow(2,e.z),u=Math.floor(s.O(this.bounds.getWest())*a),h=Math.floor(s.Q(this.bounds.getNorth())*a),m=Math.ceil(s.O(this.bounds.getEast())*a),x=Math.ceil(s.Q(this.bounds.getSouth())*a);return e.x>=u&&e.x<m&&e.y>=h&&e.y<x}}class fs extends s.E{constructor(e,a,u,h){if(super(),this.id=e,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.e(this,s.M(a,["url","scheme","tileSize","promoteId"])),this._options=s.e({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(h)}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=yield aa(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(s.e(this,e),e.bounds&&(this.tileBounds=new zo(e.bounds,this.minzoom,this.maxzoom)),this.fire(new s.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new s.j(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return s.e({},this._options)}loadTile(e){return s._(this,void 0,void 0,function*(){let a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u={request:this.map._requestManager.transformRequest(a,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};u.request.collectResourceTiming=this._collectResourceTiming;let h="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((m,x)=>{e.reloadPromise={resolve:m,reject:x}})}else e.actor=this.dispatcher.getActor(),h="LT";e.abortController=new AbortController;try{let m=yield e.actor.sendAsync({type:h,data:u},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,m)}catch(m){if(delete e.abortController,e.aborted)return;if(m&&m.status!==404)throw m;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,a){if(a&&a.resourceTiming&&(e.resourceTiming=a.resourceTiming),a&&this.map._refreshExpiredTiles&&e.setExpiryData(a),e.loadVectorData(a,this.map.painter),e.reloadPromise){let u=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(u.resolve).catch(u.reject)}}abortTile(e){return s._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return s._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class zt extends s.E{constructor(e,a,u,h){super(),this.id=e,this.dispatcher=u,this.setEventedParent(h),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.e({type:"raster"},a),s.e(this,s.M(a,["url","scheme","tileSize"]))}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{let e=yield aa(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(s.e(this,e),e.bounds&&(this.tileBounds=new zo(e.bounds,this.minzoom,this.maxzoom)),this.fire(new s.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new s.j(e))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return s.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return s._(this,void 0,void 0,function*(){let a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{let u=yield ne.getImage(this.map._requestManager.transformRequest(a,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(u&&u.data){this.map._refreshExpiredTiles&&u.cacheControl&&u.expires&&e.setExpiryData({cacheControl:u.cacheControl,expires:u.expires});let h=this.map.painter.context,m=h.gl,x=u.data;e.texture=this.map.painter.getTileTexture(x.width),e.texture?e.texture.update(x,{useMipmap:!0}):(e.texture=new ct(h,x,m.RGBA,{useMipmap:!0}),e.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(u){if(delete e.abortController,e.aborted)e.state="unloaded";else if(u)throw e.state="errored",u}})}abortTile(e){return s._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return s._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class Yt extends zt{constructor(e,a,u,h){super(e,a,u,h),this.type="raster-dem",this.maxzoom=22,this._options=s.e({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox",this.redFactor=a.redFactor,this.greenFactor=a.greenFactor,this.blueFactor=a.blueFactor,this.baseShift=a.baseShift}loadTile(e){return s._(this,void 0,void 0,function*(){let a=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),u=this.map._requestManager.transformRequest(a,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{let h=yield ne.getImage(u,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(h&&h.data){let m=h.data;this.map._refreshExpiredTiles&&h.cacheControl&&h.expires&&e.setExpiryData({cacheControl:h.cacheControl,expires:h.expires});let x=s.b(m)&&s.U()?m:yield this.readImageNow(m),b={type:this.type,uid:e.uid,source:this.id,rawImageData:x,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();let k=yield e.actor.sendAsync({type:"LDT",data:b});e.dem=k,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(h){if(delete e.abortController,e.aborted)e.state="unloaded";else if(h)throw e.state="errored",h}})}readImageNow(e){return s._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&s.V()){let a=e.width+2,u=e.height+2;try{return new s.R({width:a,height:u},yield s.W(e,-1,-1,a,u))}catch{}}return B.getImageData(e,1)})}_getNeighboringTiles(e){let a=e.canonical,u=Math.pow(2,a.z),h=(a.x-1+u)%u,m=a.x===0?e.wrap-1:e.wrap,x=(a.x+1+u)%u,b=a.x+1===u?e.wrap+1:e.wrap,k={};return k[new s.S(e.overscaledZ,m,a.z,h,a.y).key]={backfilled:!1},k[new s.S(e.overscaledZ,b,a.z,x,a.y).key]={backfilled:!1},a.y>0&&(k[new s.S(e.overscaledZ,m,a.z,h,a.y-1).key]={backfilled:!1},k[new s.S(e.overscaledZ,e.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},k[new s.S(e.overscaledZ,b,a.z,x,a.y-1).key]={backfilled:!1}),a.y+1<u&&(k[new s.S(e.overscaledZ,m,a.z,h,a.y+1).key]={backfilled:!1},k[new s.S(e.overscaledZ,e.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},k[new s.S(e.overscaledZ,b,a.z,x,a.y+1).key]={backfilled:!1}),k}unloadTile(e){return s._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class ms extends s.E{constructor(e,a,u,h){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=u.getActor(),this.setEventedParent(h),this._data=a.data,this._options=s.e({},a),this._collectResourceTiming=a.collectResourceTiming,a.maxzoom!==void 0&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;let m=s.X/this.tileSize;a.clusterMaxZoom!==void 0&&this.maxzoom<=a.clusterMaxZoom&&s.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${a.clusterMaxZoom}".`),this.workerOptions=s.e({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(a.buffer!==void 0?a.buffer:128)*m,tolerance:(a.tolerance!==void 0?a.tolerance:.375)*m,extent:s.X,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:a.clusterMaxZoom!==void 0?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:s.X,radius:(a.clusterRadius||50)*m,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){return s._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return s._(this,void 0,void 0,function*(){let e=s.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,a,u){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:a,offset:u}})}_updateWorkerData(e){return s._(this,void 0,void 0,function*(){let a=s.e({type:this.type},this.workerOptions);e?a.dataDiff=e:typeof this._data=="string"?(a.request=this.map._requestManager.transformRequest(B.resolveURL(this._data),"Source"),a.request.collectResourceTiming=this._collectResourceTiming):a.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new s.k("dataloading",{dataType:"source"}));try{let u=yield this.actor.sendAsync({type:"LD",data:a});if(this._pendingLoads--,this._removed||u.abandoned)return void this.fire(new s.k("dataabort",{dataType:"source"}));let h=null;u.resourceTiming&&u.resourceTiming[this.id]&&(h=u.resourceTiming[this.id].slice(0));let m={dataType:"source"};this._collectResourceTiming&&h&&h.length>0&&s.e(m,{resourceTiming:h}),this.fire(new s.k("data",Object.assign(Object.assign({},m),{sourceDataType:"metadata"}))),this.fire(new s.k("data",Object.assign(Object.assign({},m),{sourceDataType:"content"})))}catch(u){if(this._pendingLoads--,this._removed)return void this.fire(new s.k("dataabort",{dataType:"source"}));this.fire(new s.j(u))}})}loaded(){return this._pendingLoads===0}loadTile(e){return s._(this,void 0,void 0,function*(){let a=e.actor?"RT":"LT";e.actor=this.actor;let u={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;let h=yield this.actor.sendAsync({type:a,data:u},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(h,this.map.painter,a==="RT")})}abortTile(e){return s._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return s._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return s.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var no=s.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Bn extends s.E{constructor(e,a,u,h){super(),this.id=e,this.dispatcher=u,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(h),this.options=a}load(e){return s._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new s.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{let a=yield ne.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,a&&a.data&&(this.image=a.data,e&&(this.coordinates=e),this._finishLoading())}catch(a){this._request=null,this._loaded=!0,this.fire(new s.j(a))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;let a=e.map(s.Z.fromLngLat);this.tileID=function(h){let m=1/0,x=1/0,b=-1/0,k=-1/0;for(let F of h)m=Math.min(m,F.x),x=Math.min(x,F.y),b=Math.max(b,F.x),k=Math.max(k,F.y);let C=Math.max(b-m,k-x),I=Math.max(0,Math.floor(-Math.log(C)/Math.LN2)),P=Math.pow(2,I);return new s.a1(I,Math.floor((m+b)/2*P),Math.floor((x+k)/2*P))}(a),this.minzoom=this.maxzoom=this.tileID.z;let u=a.map(h=>this.tileID.getTilePoint(h)._round());return this._boundsArray=new s.$,this._boundsArray.emplaceBack(u[0].x,u[0].y,0,0),this._boundsArray.emplaceBack(u[1].x,u[1].y,s.X,0),this._boundsArray.emplaceBack(u[3].x,u[3].y,0,s.X),this._boundsArray.emplaceBack(u[2].x,u[2].y,s.X,s.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new s.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;let e=this.map.painter.context,a=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,no.members)),this.boundsSegments||(this.boundsSegments=s.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new ct(e,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let u=!1;for(let h in this.tiles){let m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,u=!0)}u&&this.fire(new s.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return s._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class sa extends Bn{constructor(e,a,u,h){super(e,a,u,h),this.roundZoom=!0,this.type="video",this.options=a}load(){return s._(this,void 0,void 0,function*(){this._loaded=!1;let e=this.options;this.urls=[];for(let a of e.urls)this.urls.push(this.map._requestManager.transformRequest(a,"Source").url);try{let a=yield s.a3(this.urls);if(this._loaded=!0,!a)return;this.video=a,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(a){this.fire(new s.j(a))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){let a=this.video.seekable;e<a.start(0)||e>a.end(0)?this.fire(new s.j(new s.a2(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let e=this.map.painter.context,a=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,no.members)),this.boundsSegments||(this.boundsSegments=s.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new ct(e,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE));let u=!1;for(let h in this.tiles){let m=this.tiles[h];m.state!=="loaded"&&(m.state="loaded",m.texture=this.texture,u=!0)}u&&this.fire(new s.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class zr extends Bn{constructor(e,a,u,h){super(e,a,u,h),a.coordinates?Array.isArray(a.coordinates)&&a.coordinates.length===4&&!a.coordinates.some(m=>!Array.isArray(m)||m.length!==2||m.some(x=>typeof x!="number"))||this.fire(new s.j(new s.a2(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.j(new s.a2(`sources.${e}`,null,'missing required property "coordinates"'))),a.animate&&typeof a.animate!="boolean"&&this.fire(new s.j(new s.a2(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),a.canvas?typeof a.canvas=="string"||a.canvas instanceof HTMLCanvasElement||this.fire(new s.j(new s.a2(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.j(new s.a2(`sources.${e}`,null,'missing required property "canvas"'))),this.options=a,this.animate=a.animate===void 0||a.animate}load(){return s._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let a=this.map.painter.context,u=a.gl;this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,no.members)),this.boundsSegments||(this.boundsSegments=s.a0.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new ct(a,this.canvas,u.RGBA,{premultiply:!0});let h=!1;for(let m in this.tiles){let x=this.tiles[m];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,h=!0)}h&&this.fire(new s.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}let gs={},ys=g=>{switch(g){case"geojson":return ms;case"image":return Bn;case"raster":return zt;case"raster-dem":return Yt;case"vector":return fs;case"video":return sa;case"canvas":return zr}return gs[g]},Pe="RTLPluginLoaded";class gn extends s.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ps()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(a=>{throw this.status="error",a})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return s._(this,arguments,void 0,function*(a,u=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=B.resolveURL(a),!this.url)throw new Error(`requested url ${a} is invalid`);if(this.status==="unavailable"){if(!u)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return s._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new s.k(Pe))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Ui=null;function yn(){return Ui||(Ui=new gn),Ui}class oo{constructor(e,a){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=s.a4(),this.uses=0,this.tileSize=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){let a=e+this.timeAdded;a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,a,u){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,m){let x={};if(!m)return x;for(let b of h){let k=b.layerIds.map(C=>m.getLayer(C)).filter(Boolean);if(k.length!==0){b.layers=k,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(C=>k.filter(I=>I.id===C)[0]));for(let C of k)x[C.id]=b}}return x}(e.buckets,a.style),this.hasSymbolBuckets=!1;for(let h in this.buckets){let m=this.buckets[h];if(m instanceof s.a6){if(this.hasSymbolBuckets=!0,!u)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let h in this.buckets){let m=this.buckets[h];if(m instanceof s.a6&&m.hasRTLText){this.hasRTLText=!0,yn().lazyLoad();break}}this.queryPadding=0;for(let h in this.buckets){let m=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(h).queryRadius(m))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new s.a5}unloadVectorData(){for(let e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(let u in this.buckets){let h=this.buckets[u];h.uploadPending()&&h.upload(e)}let a=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ct(e,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ct(e,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,a,u,h,m,x,b,k,C,I){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:h,cameraQueryGeometry:m,scale:x,tileSize:this.tileSize,pixelPosMatrix:I,transform:k,params:b,queryPadding:this.queryPadding*C},e,a,u):{}}querySourceFeatures(e,a){let u=this.latestFeatureIndex;if(!u||!u.rawTileData)return;let h=u.loadVTLayers(),m=a&&a.sourceLayer?a.sourceLayer:"",x=h._geojsonTileLayer||h[m];if(!x)return;let b=s.a7(a&&a.filter),{z:k,x:C,y:I}=this.tileID.canonical,P={z:k,x:C,y:I};for(let F=0;F<x.length;F++){let U=x.feature(F);if(b.needGeometry){let J=s.a8(U,!0);if(!b.filter(new s.z(this.tileID.overscaledZ),J,this.tileID.canonical))continue}else if(!b.filter(new s.z(this.tileID.overscaledZ),U))continue;let $=u.getId(U,m),W=new s.a9(U,k,C,I,$);W.tile=P,e.push(W)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){let a=this.expirationTime;if(e.cacheControl){let u=s.aa(e.cacheControl);u["max-age"]&&(this.expirationTime=Date.now()+1e3*u["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){let u=Date.now(),h=!1;if(this.expirationTime>u)h=!1;else if(a)if(this.expirationTime<a)h=!0;else{let m=this.expirationTime-a;m?this.expirationTime=u+Math.max(m,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;let u=this.latestFeatureIndex.loadVTLayers();for(let h in this.buckets){if(!a.style.hasLayer(h))continue;let m=this.buckets[h],x=m.layers[0].sourceLayer||"_geojsonTileLayer",b=u[x],k=e[x];if(!b||!k||Object.keys(k).length===0)continue;m.update(k,b,this.imageAtlas&&this.imageAtlas.patternPositions||{});let C=a&&a.style&&a.style.getLayer(h);C&&(this.queryPadding=Math.max(this.queryPadding,C.queryRadius(m)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<B.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=B.now()+e}setDependencies(e,a){let u={};for(let h of a)u[h]=!0;this.dependencies[e]=u}hasDependency(e,a){for(let u of e){let h=this.dependencies[u];if(h){for(let m of a)if(h[m])return!0}}return!1}}class Fe{constructor(e,a){this.max=e,this.onRemove=a,this.reset()}reset(){for(let e in this.data)for(let a of this.data[e])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(e,a,u){let h=e.wrapped().key;this.data[h]===void 0&&(this.data[h]=[]);let m={value:a,timeout:void 0};if(u!==void 0&&(m.timeout=setTimeout(()=>{this.remove(e,m)},u)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){let x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){let a=this.data[e].shift();return a.timeout&&clearTimeout(a.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),a.value}getByKey(e){let a=this.data[e];return a?a[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,a){if(!this.has(e))return this;let u=e.wrapped().key,h=a===void 0?0:this.data[u].indexOf(a),m=this.data[u][h];return this.data[u].splice(h,1),m.timeout&&clearTimeout(m.timeout),this.data[u].length===0&&delete this.data[u],this.onRemove(m.value),this.order.splice(this.order.indexOf(u),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){let a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(e){let a=[];for(let u in this.data)for(let h of this.data[u])e(h.value)||a.push(h);for(let u of a)this.remove(u.value.tileID,u)}}class mt{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,a,u){let h=String(a);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},s.e(this.stateChanges[e][h],u),this.deletedStates[e]===null){this.deletedStates[e]={};for(let m in this.state[e])m!==h&&(this.deletedStates[e][m]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][h]===null){this.deletedStates[e][h]={};for(let m in this.state[e][h])u[m]||(this.deletedStates[e][h][m]=null)}else for(let m in u)this.deletedStates[e]&&this.deletedStates[e][h]&&this.deletedStates[e][h][m]===null&&delete this.deletedStates[e][h][m]}removeFeatureState(e,a,u){if(this.deletedStates[e]===null)return;let h=String(a);if(this.deletedStates[e]=this.deletedStates[e]||{},u&&a!==void 0)this.deletedStates[e][h]!==null&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][u]=null);else if(a!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][h])for(u in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][u]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,a){let u=String(a),h=s.e({},(this.state[e]||{})[u],(this.stateChanges[e]||{})[u]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){let m=this.deletedStates[e][a];if(m===null)return{};for(let x in m)delete h[x]}return h}initializeTileState(e,a){e.setFeatureState(this.state,a)}coalesceChanges(e,a){let u={};for(let h in this.stateChanges){this.state[h]=this.state[h]||{};let m={};for(let x in this.stateChanges[h])this.state[h][x]||(this.state[h][x]={}),s.e(this.state[h][x],this.stateChanges[h][x]),m[x]=this.state[h][x];u[h]=m}for(let h in this.deletedStates){this.state[h]=this.state[h]||{};let m={};if(this.deletedStates[h]===null)for(let x in this.state[h])m[x]={},this.state[h][x]={};else for(let x in this.deletedStates[h]){if(this.deletedStates[h][x]===null)this.state[h][x]={};else for(let b of Object.keys(this.deletedStates[h][x]))delete this.state[h][x][b];m[x]=this.state[h][x]}u[h]=u[h]||{},s.e(u[h],m)}if(this.stateChanges={},this.deletedStates={},Object.keys(u).length!==0)for(let h in e)e[h].setFeatureState(u,a)}}class at extends s.E{constructor(e,a,u){super(),this.id=e,this.dispatcher=u,this.on("data",h=>this._dataHandler(h)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((h,m,x,b)=>{let k=new(ys(m.type))(h,m,x,b);if(k.id!==h)throw new Error(`Expected Source id to be ${h} instead of ${k.id}`);return k})(e,a,u,this),this._tiles={},this._cache=new Fe(0,h=>this._unloadTile(h)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new mt,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(let e in this._tiles){let a=this._tiles[e];if(a.state!=="loaded"&&a.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,a,u){return s._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,a,u)}catch(h){e.state="errored",h.status!==404?this._source.fire(new s.j(h,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new s.k("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let a in this._tiles){let u=this._tiles[a];u.upload(e),u.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(Yi).map(e=>e.key)}getRenderableIds(e){let a=[];for(let u in this._tiles)this._isIdRenderable(u,e)&&a.push(this._tiles[u]);return e?a.sort((u,h)=>{let m=u.tileID,x=h.tileID,b=new s.P(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),k=new s.P(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-x.overscaledZ||k.y-b.y||k.x-b.x}).map(u=>u.tileID.key):a.map(u=>u.tileID).sort(Yi).map(u=>u.key)}hasRenderableParent(e){let a=this.findLoadedParent(e,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(e,a){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(a||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(e,"reloading")}}_reloadTile(e,a){return s._(this,void 0,void 0,function*(){let u=this._tiles[e];u&&(u.state!=="loading"&&(u.state=a),yield this._loadTile(u,e,a))})}_tileLoaded(e,a,u){e.timeAdded=B.now(),u==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(a,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new s.k("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){let a=this.getRenderableIds();for(let h=0;h<a.length;h++){let m=a[h];if(e.neighboringTiles&&e.neighboringTiles[m]){let x=this.getTileByID(m);u(e,x),u(x,e)}}function u(h,m){h.needsHillshadePrepare=!0,h.needsTerrainPrepare=!0;let x=m.tileID.canonical.x-h.tileID.canonical.x,b=m.tileID.canonical.y-h.tileID.canonical.y,k=Math.pow(2,h.tileID.canonical.z),C=m.tileID.key;x===0&&b===0||Math.abs(b)>1||(Math.abs(x)>1&&(Math.abs(x+k)===1?x+=k:Math.abs(x-k)===1&&(x-=k)),m.dem&&h.dem&&(h.dem.backfillBorder(m.dem,x,b),h.neighboringTiles&&h.neighboringTiles[C]&&(h.neighboringTiles[C].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,a,u,h){for(let m in this._tiles){let x=this._tiles[m];if(h[m]||!x.hasData()||x.tileID.overscaledZ<=a||x.tileID.overscaledZ>u)continue;let b=x.tileID;for(;x&&x.tileID.overscaledZ>a+1;){let C=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[C.key],x&&x.hasData()&&(b=C)}let k=b;for(;k.overscaledZ>a;)if(k=k.scaledTo(k.overscaledZ-1),e[k.key]){h[b.key]=b;break}}}findLoadedParent(e,a){if(e.key in this._loadedParentTiles){let u=this._loadedParentTiles[e.key];return u&&u.tileID.overscaledZ>=a?u:null}for(let u=e.overscaledZ-1;u>=a;u--){let h=e.scaledTo(u),m=this._getLoadedTile(h);if(m)return m}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){let a=this._tiles[e.key];return a&&a.hasData()?a:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){let a=Math.ceil(e.width/this._source.tileSize)+1,u=Math.ceil(e.height/this._source.tileSize)+1,h=Math.floor(a*u*(this._maxTileCacheZoomLevels===null?s.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),m=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,h):h;this._cache.setMaxSize(m)}handleWrapJump(e){let a=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,a){let u={};for(let h in this._tiles){let m=this._tiles[h];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+a),u[m.tileID.key]=m}this._tiles=u;for(let h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(let h in this._tiles)this._setTileReloadTimer(h,this._tiles[h])}}_updateCoveredAndRetainedTiles(e,a,u,h,m,x){let b={},k={},C=Object.keys(e),I=B.now();for(let P of C){let F=e[P],U=this._tiles[P];if(!U||U.fadeEndTime!==0&&U.fadeEndTime<=I)continue;let $=this.findLoadedParent(F,a),W=this.findLoadedSibling(F),J=$||W||null;J&&(this._addTile(J.tileID),b[J.tileID.key]=J.tileID),k[P]=F}this._retainLoadedChildren(k,h,u,e);for(let P in b)e[P]||(this._coveredTiles[P]=!0,e[P]=b[P]);if(x){let P={},F={};for(let U of m)this._tiles[U.key].hasData()?P[U.key]=U:F[U.key]=U;for(let U in F){let $=F[U].children(this._source.maxzoom);this._tiles[$[0].key]&&this._tiles[$[1].key]&&this._tiles[$[2].key]&&this._tiles[$[3].key]&&(P[$[0].key]=e[$[0].key]=$[0],P[$[1].key]=e[$[1].key]=$[1],P[$[2].key]=e[$[2].key]=$[2],P[$[3].key]=e[$[3].key]=$[3],delete F[U])}for(let U in F){let $=F[U],W=this.findLoadedParent($,this._source.minzoom),J=this.findLoadedSibling($),Y=W||J||null;if(Y){P[Y.tileID.key]=e[Y.tileID.key]=Y.tileID;for(let te in P)P[te].isChildOf(Y.tileID)&&delete P[te]}}for(let U in this._tiles)P[U]||(this._coveredTiles[U]=!0)}}update(e,a){if(!this._sourceLoaded||this._paused)return;let u;this.transform=e,this.terrain=a,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(I=>new s.S(I.canonical.z,I.wrap,I.canonical.z,I.canonical.x,I.canonical.y)):(u=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:a}),this._source.hasTile&&(u=u.filter(I=>this._source.hasTile(I)))):u=[];let h=e.coveringZoomLevel(this._source),m=Math.max(h-at.maxOverzooming,this._source.minzoom),x=Math.max(h+at.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let I={};for(let P of u)if(P.canonical.z>this._source.minzoom){let F=P.scaledTo(P.canonical.z-1);I[F.key]=F;let U=P.scaledTo(Math.max(this._source.minzoom,Math.min(P.canonical.z,5)));I[U.key]=U}u=u.concat(Object.values(I))}let b=u.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,b&&this.fire(new s.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let k=this._updateRetainedTiles(u,h);Hr(this._source.type)&&this._updateCoveredAndRetainedTiles(k,m,x,h,u,a);for(let I in k)this._tiles[I].clearFadeHold();let C=s.ab(this._tiles,k);for(let I of C){let P=this._tiles[I];P.hasSymbolBuckets&&!P.holdingForFade()?P.setHoldDuration(this.map._fadeDuration):P.hasSymbolBuckets&&!P.symbolFadeFinished()||this._removeTile(I)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(let e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,a){var u;let h={},m={},x=Math.max(a-at.maxOverzooming,this._source.minzoom),b=Math.max(a+at.maxUnderzooming,this._source.minzoom),k={};for(let C of e){let I=this._addTile(C);h[C.key]=C,I.hasData()||a<this._source.maxzoom&&(k[C.key]=C)}this._retainLoadedChildren(k,a,b,h);for(let C of e){let I=this._tiles[C.key];if(I.hasData())continue;if(a+1>this._source.maxzoom){let F=C.children(this._source.maxzoom)[0],U=this.getTile(F);if(U&&U.hasData()){h[F.key]=F;continue}}else{let F=C.children(this._source.maxzoom);if(h[F[0].key]&&h[F[1].key]&&h[F[2].key]&&h[F[3].key])continue}let P=I.wasRequested();for(let F=C.overscaledZ-1;F>=x;--F){let U=C.scaledTo(F);if(m[U.key])break;if(m[U.key]=!0,I=this.getTile(U),!I&&P&&(I=this._addTile(U)),I){let $=I.hasData();if(($||!(!((u=this.map)===null||u===void 0)&&u.cancelPendingTileRequestsWhileZooming)||P)&&(h[U.key]=U),P=I.wasRequested(),$)break}}}return h}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let e in this._tiles){let a=[],u,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){u=this._loadedParentTiles[h.key];break}a.push(h.key);let m=h.scaledTo(h.overscaledZ-1);if(u=this._getLoadedTile(m),u)break;h=m}for(let m of a)this._loadedParentTiles[m]=u}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(let e in this._tiles){let a=this._tiles[e].tileID,u=this._getLoadedTile(a);this._loadedSiblingTiles[a.key]=u}}_addTile(e){let a=this._tiles[e.key];if(a)return a;a=this._cache.getAndRemove(e),a&&(this._setTileReloadTimer(e.key,a),a.tileID=e,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,a)));let u=a;return a||(a=new oo(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(a,e.key,a.state)),a.uses++,this._tiles[e.key]=a,u||this._source.fire(new s.k("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a}_setTileReloadTimer(e,a){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);let u=a.getExpiryTimeout();u&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},u))}_removeTile(e){let a=this._tiles[e];a&&(a.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),a.uses>0||(a.hasData()&&a.state!=="reloading"?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}_dataHandler(e){let a=e.sourceDataType;e.dataType==="source"&&a==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&a==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,a,u){let h=[],m=this.transform;if(!m)return h;let x=u?m.getCameraQueryGeometry(e):e,b=e.map($=>m.pointCoordinate($,this.terrain)),k=x.map($=>m.pointCoordinate($,this.terrain)),C=this.getIds(),I=1/0,P=1/0,F=-1/0,U=-1/0;for(let $ of k)I=Math.min(I,$.x),P=Math.min(P,$.y),F=Math.max(F,$.x),U=Math.max(U,$.y);for(let $=0;$<C.length;$++){let W=this._tiles[C[$]];if(W.holdingForFade())continue;let J=W.tileID,Y=Math.pow(2,m.zoom-W.tileID.overscaledZ),te=a*W.queryPadding*s.X/W.tileSize/Y,Z=[J.getTilePoint(new s.Z(I,P)),J.getTilePoint(new s.Z(F,U))];if(Z[0].x-te<s.X&&Z[0].y-te<s.X&&Z[1].x+te>=0&&Z[1].y+te>=0){let oe=b.map(pe=>J.getTilePoint(pe)),le=k.map(pe=>J.getTilePoint(pe));h.push({tile:W,tileID:J,queryGeometry:oe,cameraQueryGeometry:le,scale:Y})}}return h}getVisibleCoordinates(e){let a=this.getRenderableIds(e).map(u=>this._tiles[u].tileID);for(let u of a)u.posMatrix=this.transform.calculatePosMatrix(u.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(Hr(this._source.type)){let e=B.now();for(let a in this._tiles)if(this._tiles[a].fadeEndTime>=e)return!0}return!1}setFeatureState(e,a,u){this._state.updateState(e=e||"_geojsonTileLayer",a,u)}removeFeatureState(e,a,u){this._state.removeFeatureState(e=e||"_geojsonTileLayer",a,u)}getFeatureState(e,a){return this._state.getState(e=e||"_geojsonTileLayer",a)}setDependencies(e,a,u){let h=this._tiles[e];h&&h.setDependencies(a,u)}reloadTilesForDependencies(e,a){for(let u in this._tiles)this._tiles[u].hasDependency(e,a)&&this._reloadTile(u,"reloading");this._cache.filter(u=>!u.hasDependency(e,a))}}function Yi(g,e){let a=Math.abs(2*g.wrap)-+(g.wrap<0),u=Math.abs(2*e.wrap)-+(e.wrap<0);return g.overscaledZ-e.overscaledZ||u-a||e.canonical.y-g.canonical.y||e.canonical.x-g.canonical.x}function Hr(g){return g==="raster"||g==="image"||g==="video"}at.maxOverzooming=10,at.maxUnderzooming=3;class ht{constructor(e,a){this.reset(e,a)}reset(e,a){this.points=e||[],this._distances=[0];for(let u=1;u<this.points.length;u++)this._distances[u]=this._distances[u-1]+this.points[u].dist(this.points[u-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=s.ac(e,0,1);let a=1,u=this._distances[a],h=e*this.paddedLength+this.padding;for(;u<h&&a<this._distances.length;)u=this._distances[++a];let m=a-1,x=this._distances[m],b=u-x,k=b>0?(h-x)/b:0;return this.points[m].mult(1-k).add(this.points[a].mult(k))}}function _n(g,e){let a=!0;return g==="always"||g!=="never"&&e!=="never"||(a=!1),a}class On{constructor(e,a,u){let h=this.boxCells=[],m=this.circleCells=[];this.xCellCount=Math.ceil(e/u),this.yCellCount=Math.ceil(a/u);for(let x=0;x<this.xCellCount*this.yCellCount;x++)h.push([]),m.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=a,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,a,u,h,m){this._forEachCell(a,u,h,m,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(a),this.bboxes.push(u),this.bboxes.push(h),this.bboxes.push(m)}insertCircle(e,a,u,h){this._forEachCell(a-h,u-h,a+h,u+h,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(a),this.circles.push(u),this.circles.push(h)}_insertBoxCell(e,a,u,h,m,x){this.boxCells[m].push(x)}_insertCircleCell(e,a,u,h,m,x){this.circleCells[m].push(x)}_query(e,a,u,h,m,x,b){if(u<0||e>this.width||h<0||a>this.height)return[];let k=[];if(e<=0&&a<=0&&this.width<=u&&this.height<=h){if(m)return[{key:null,x1:e,y1:a,x2:u,y2:h}];for(let C=0;C<this.boxKeys.length;C++)k.push({key:this.boxKeys[C],x1:this.bboxes[4*C],y1:this.bboxes[4*C+1],x2:this.bboxes[4*C+2],y2:this.bboxes[4*C+3]});for(let C=0;C<this.circleKeys.length;C++){let I=this.circles[3*C],P=this.circles[3*C+1],F=this.circles[3*C+2];k.push({key:this.circleKeys[C],x1:I-F,y1:P-F,x2:I+F,y2:P+F})}}else this._forEachCell(e,a,u,h,this._queryCell,k,{hitTest:m,overlapMode:x,seenUids:{box:{},circle:{}}},b);return k}query(e,a,u,h){return this._query(e,a,u,h,!1,null)}hitTest(e,a,u,h,m,x){return this._query(e,a,u,h,!0,m,x).length>0}hitTestCircle(e,a,u,h,m){let x=e-u,b=e+u,k=a-u,C=a+u;if(b<0||x>this.width||C<0||k>this.height)return!1;let I=[];return this._forEachCell(x,k,b,C,this._queryCellCircle,I,{hitTest:!0,overlapMode:h,circle:{x:e,y:a,radius:u},seenUids:{box:{},circle:{}}},m),I.length>0}_queryCell(e,a,u,h,m,x,b,k){let{seenUids:C,hitTest:I,overlapMode:P}=b,F=this.boxCells[m];if(F!==null){let $=this.bboxes;for(let W of F)if(!C.box[W]){C.box[W]=!0;let J=4*W,Y=this.boxKeys[W];if(e<=$[J+2]&&a<=$[J+3]&&u>=$[J+0]&&h>=$[J+1]&&(!k||k(Y))&&(!I||!_n(P,Y.overlapMode))&&(x.push({key:Y,x1:$[J],y1:$[J+1],x2:$[J+2],y2:$[J+3]}),I))return!0}}let U=this.circleCells[m];if(U!==null){let $=this.circles;for(let W of U)if(!C.circle[W]){C.circle[W]=!0;let J=3*W,Y=this.circleKeys[W];if(this._circleAndRectCollide($[J],$[J+1],$[J+2],e,a,u,h)&&(!k||k(Y))&&(!I||!_n(P,Y.overlapMode))){let te=$[J],Z=$[J+1],oe=$[J+2];if(x.push({key:Y,x1:te-oe,y1:Z-oe,x2:te+oe,y2:Z+oe}),I)return!0}}}return!1}_queryCellCircle(e,a,u,h,m,x,b,k){let{circle:C,seenUids:I,overlapMode:P}=b,F=this.boxCells[m];if(F!==null){let $=this.bboxes;for(let W of F)if(!I.box[W]){I.box[W]=!0;let J=4*W,Y=this.boxKeys[W];if(this._circleAndRectCollide(C.x,C.y,C.radius,$[J+0],$[J+1],$[J+2],$[J+3])&&(!k||k(Y))&&!_n(P,Y.overlapMode))return x.push(!0),!0}}let U=this.circleCells[m];if(U!==null){let $=this.circles;for(let W of U)if(!I.circle[W]){I.circle[W]=!0;let J=3*W,Y=this.circleKeys[W];if(this._circlesCollide($[J],$[J+1],$[J+2],C.x,C.y,C.radius)&&(!k||k(Y))&&!_n(P,Y.overlapMode))return x.push(!0),!0}}}_forEachCell(e,a,u,h,m,x,b,k){let C=this._convertToXCellCoord(e),I=this._convertToYCellCoord(a),P=this._convertToXCellCoord(u),F=this._convertToYCellCoord(h);for(let U=C;U<=P;U++)for(let $=I;$<=F;$++)if(m.call(this,e,a,u,h,this.xCellCount*$+U,x,b,k))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,a,u,h,m,x){let b=h-e,k=m-a,C=u+x;return C*C>b*b+k*k}_circleAndRectCollide(e,a,u,h,m,x,b){let k=(x-h)/2,C=Math.abs(e-(h+k));if(C>k+u)return!1;let I=(b-m)/2,P=Math.abs(a-(m+I));if(P>I+u)return!1;if(C<=k||P<=I)return!0;let F=C-k,U=P-I;return F*F+U*U<=u*u}}function ao(g,e,a,u,h){let m=s.H();return e?(s.K(m,m,[1/h,1/h,1]),a||s.ad(m,m,u.angle)):s.L(m,u.labelPlaneMatrix,g),m}function vn(g,e,a,u,h){if(e){let m=s.ae(g);return s.K(m,m,[h,h,1]),a||s.ad(m,m,-u.angle),m}return u.glCoordMatrix}function X(g,e,a,u){let h;u?(h=[g,e,u(g,e),1],s.af(h,h,a)):(h=[g,e,0,1],kt(h,h,a));let m=h[3];return{point:new s.P(h[0]/m,h[1]/m),signedDistanceFromCamera:m,isOccluded:!1}}function D(g,e){return .5+g/e*.5}function L(g,e){return g.x>=-e[0]&&g.x<=e[0]&&g.y>=-e[1]&&g.y<=e[1]}function q(g,e,a,u,h,m,x,b,k,C,I,P,F,U,$){let W=u?g.textSizeData:g.iconSizeData,J=s.ag(W,a.transform.zoom),Y=[256/a.width*2+1,256/a.height*2+1],te=u?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;te.clear();let Z=g.lineVertexArray,oe=u?g.text.placedSymbolArray:g.icon.placedSymbolArray,le=a.transform.width/a.transform.height,pe=!1;for(let ke=0;ke<oe.length;ke++){let ze=oe.get(ke);if(ze.hidden||ze.writingMode===s.ah.vertical&&!pe){it(ze.numGlyphs,te);continue}pe=!1;let Ne=X(ze.anchorX,ze.anchorY,e,$);if(!L(Ne.point,Y)){it(ze.numGlyphs,te);continue}let qe=D(a.transform.cameraToCenterDistance,Ne.signedDistanceFromCamera),Re=s.ai(W,J,ze),De=x?Re/qe:Re*qe,Xe={getElevation:$,labelPlaneMatrix:h,lineVertexArray:Z,pitchWithMap:x,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:C,tileAnchorPoint:new s.P(ze.anchorX,ze.anchorY),unwrappedTileID:I,width:P,height:F,translation:U},ut=se(Xe,ze,De,!1,b,e,m,g.glyphOffsetArray,te,le,k);pe=ut.useVertical,(ut.notEnoughRoom||pe||ut.needsFlipping&&se(Xe,ze,De,!0,b,e,m,g.glyphOffsetArray,te,le,k).notEnoughRoom)&&it(ze.numGlyphs,te)}u?g.text.dynamicLayoutVertexBuffer.updateData(te):g.icon.dynamicLayoutVertexBuffer.updateData(te)}function G(g,e,a,u,h,m,x,b){let k=m.glyphStartIndex+m.numGlyphs,C=m.lineStartIndex,I=m.lineStartIndex+m.lineLength,P=e.getoffsetX(m.glyphStartIndex),F=e.getoffsetX(k-1),U=Le(g*P,a,u,h,m.segment,C,I,b,x);if(!U)return null;let $=Le(g*F,a,u,h,m.segment,C,I,b,x);return $?b.projectionCache.anyProjectionOccluded?null:{first:U,last:$}:null}function re(g,e,a,u){return g===s.ah.horizontal&&Math.abs(a.y-e.y)>Math.abs(a.x-e.x)*u?{useVertical:!0}:(g===s.ah.vertical?e.y<a.y:e.x>a.x)?{needsFlipping:!0}:null}function se(g,e,a,u,h,m,x,b,k,C,I){let P=a/24,F=e.lineOffsetX*P,U=e.lineOffsetY*P,$;if(e.numGlyphs>1){let W=e.glyphStartIndex+e.numGlyphs,J=e.lineStartIndex,Y=e.lineStartIndex+e.lineLength,te=G(P,b,F,U,u,e,I,g);if(!te)return{notEnoughRoom:!0};let Z=X(te.first.point.x,te.first.point.y,x,g.getElevation).point,oe=X(te.last.point.x,te.last.point.y,x,g.getElevation).point;if(h&&!u){let le=re(e.writingMode,Z,oe,C);if(le)return le}$=[te.first];for(let le=e.glyphStartIndex+1;le<W-1;le++)$.push(Le(P*b.getoffsetX(le),F,U,u,e.segment,J,Y,g,I));$.push(te.last)}else{if(h&&!u){let J=X(g.tileAnchorPoint.x,g.tileAnchorPoint.y,m,g.getElevation).point,Y=e.lineStartIndex+e.segment+1,te=new s.P(g.lineVertexArray.getx(Y),g.lineVertexArray.gety(Y)),Z=X(te.x,te.y,m,g.getElevation),oe=Z.signedDistanceFromCamera>0?Z.point:function(pe,ke,ze,Ne,qe,Re){return ue(pe,ke,ze,1,qe,Re)}(g.tileAnchorPoint,te,J,0,m,g),le=re(e.writingMode,J,oe,C);if(le)return le}let W=Le(P*b.getoffsetX(e.glyphStartIndex),F,U,u,e.segment,e.lineStartIndex,e.lineStartIndex+e.lineLength,g,I);if(!W||g.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};$=[W]}for(let W of $)s.aj(k,W.point,W.angle);return{}}function ue(g,e,a,u,h,m){let x=g.add(g.sub(e)._unit()),b=h!==void 0?X(x.x,x.y,h,m.getElevation).point:ve(x.x,x.y,m).point,k=a.sub(b);return a.add(k._mult(u/k.mag()))}function Q(g,e,a){let u=e.projectionCache;if(u.projections[g])return u.projections[g];let h=new s.P(e.lineVertexArray.getx(g),e.lineVertexArray.gety(g)),m=ve(h.x,h.y,e);if(m.signedDistanceFromCamera>0)return u.projections[g]=m.point,u.anyProjectionOccluded=u.anyProjectionOccluded||m.isOccluded,m.point;let x=g-a.direction;return function(b,k,C,I,P){return ue(b,k,C,I,void 0,P)}(a.distanceFromAnchor===0?e.tileAnchorPoint:new s.P(e.lineVertexArray.getx(x),e.lineVertexArray.gety(x)),h,a.previousVertex,a.absOffsetX-a.distanceFromAnchor+1,e)}function ve(g,e,a){let u=g+a.translation[0],h=e+a.translation[1],m;return!a.pitchWithMap&&a.projection.useSpecialProjectionForSymbols?(m=a.projection.projectTileCoordinates(u,h,a.unwrappedTileID,a.getElevation),m.point.x=(.5*m.point.x+.5)*a.width,m.point.y=(.5*-m.point.y+.5)*a.height):(m=X(u,h,a.labelPlaneMatrix,a.getElevation),m.isOccluded=!1),m}function Ee(g,e,a){return g._unit()._perp()._mult(e*a)}function me(g,e,a,u,h,m,x,b,k){if(b.projectionCache.offsets[g])return b.projectionCache.offsets[g];let C=a.add(e);if(g+k.direction<u||g+k.direction>=h)return b.projectionCache.offsets[g]=C,C;let I=Q(g+k.direction,b,k),P=Ee(I.sub(a),x,k.direction),F=a.add(P),U=I.add(P);return b.projectionCache.offsets[g]=s.ak(m,C,F,U)||C,b.projectionCache.offsets[g]}function Le(g,e,a,u,h,m,x,b,k){let C=u?g-e:g+e,I=C>0?1:-1,P=0;u&&(I*=-1,P=Math.PI),I<0&&(P+=Math.PI);let F,U=I>0?m+h:m+h+1;b.projectionCache.cachedAnchorPoint?F=b.projectionCache.cachedAnchorPoint:(F=ve(b.tileAnchorPoint.x,b.tileAnchorPoint.y,b).point,b.projectionCache.cachedAnchorPoint=F);let $,W,J=F,Y=F,te=0,Z=0,oe=Math.abs(C),le=[],pe;for(;te+Z<=oe;){if(U+=I,U<m||U>=x)return null;te+=Z,Y=J,W=$;let Ne={absOffsetX:oe,direction:I,distanceFromAnchor:te,previousVertex:Y};if(J=Q(U,b,Ne),a===0)le.push(Y),pe=J.sub(Y);else{let qe,Re=J.sub(Y);qe=Re.mag()===0?Ee(Q(U+I,b,Ne).sub(J),a,I):Ee(Re,a,I),W||(W=Y.add(qe)),$=me(U,qe,J,m,x,W,a,b,Ne),le.push(W),pe=$.sub(W)}Z=pe.mag()}let ke=pe._mult((oe-te)/Z)._add(W||Y),ze=P+Math.atan2(J.y-Y.y,J.x-Y.x);return le.push(ke),{point:ke,angle:k?ze:0,path:le}}let et=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function it(g,e){for(let a=0;a<g;a++){let u=e.length;e.resize(u+4),e.float32.set(et,3*u)}}function kt(g,e,a){let u=e[0],h=e[1];return g[0]=a[0]*u+a[4]*h+a[12],g[1]=a[1]*u+a[5]*h+a[13],g[3]=a[3]*u+a[7]*h+a[15],g}let dt=100;class St{constructor(e,a,u=new On(e.width+200,e.height+200,25),h=new On(e.width+200,e.height+200,25)){this.transform=e,this.mapProjection=a,this.grid=u,this.ignoredGrid=h,this.pitchFactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+dt,this.screenBottomBoundary=e.height+dt,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,a,u,h,m,x,b,k,C,I,P){let F=e.anchorPointX+k[0],U=e.anchorPointY+k[1],$=this.projectAndGetPerspectiveRatio(h,F,U,m,I),W=u*$.perspectiveRatio,J;if(x||b)J=this._projectCollisionBox(e,W,h,m,x,b,k,$,I,P);else{let le=$.point.x+(P?P.x*W:0),pe=$.point.y+(P?P.y*W:0);J={allPointsOccluded:!1,box:[le+e.x1*W,pe+e.y1*W,le+e.x2*W,pe+e.y2*W]}}let[Y,te,Z,oe]=J.box;return this.mapProjection.useSpecialProjectionForSymbols&&(x?J.allPointsOccluded:this.mapProjection.isOccluded(F,U,m))||$.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(Y,te,Z,oe)||a!=="always"&&this.grid.hitTest(Y,te,Z,oe,a,C)?{box:[Y,te,Z,oe],placeable:!1,offscreen:!1}:{box:[Y,te,Z,oe],placeable:!0,offscreen:this.isOffscreen(Y,te,Z,oe)}}placeCollisionCircles(e,a,u,h,m,x,b,k,C,I,P,F,U,$,W,J){let Y=[],te=new s.P(a.anchorX,a.anchorY),Z=this.getPerspectiveRatio(x,te.x,te.y,b,J),oe=(P?m/Z:m*Z)/s.ap,le={getElevation:J,labelPlaneMatrix:k,lineVertexArray:u,pitchWithMap:P,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:te,unwrappedTileID:b,width:this.transform.width,height:this.transform.height,translation:W},pe=G(oe,h,a.lineOffsetX*oe,a.lineOffsetY*oe,!1,a,!1,le),ke=!1,ze=!1,Ne=!0;if(pe){let qe=.5*U*Z+$,Re=new s.P(-100,-100),De=new s.P(this.screenRightBoundary,this.screenBottomBoundary),Xe=new ht,ut=pe.first,Be=pe.last,Ve=[];for(let ft=ut.path.length-1;ft>=1;ft--)Ve.push(ut.path[ft]);for(let ft=1;ft<Be.path.length;ft++)Ve.push(Be.path[ft]);let st=2.5*qe;if(C){let ft=this.projectPathToScreenSpace(Ve,le,C);Ve=ft.some(vt=>vt.signedDistanceFromCamera<=0)?[]:ft.map(vt=>vt.point)}let qt=[];if(Ve.length>0){let ft=Ve[0].clone(),vt=Ve[0].clone();for(let $t=1;$t<Ve.length;$t++)ft.x=Math.min(ft.x,Ve[$t].x),ft.y=Math.min(ft.y,Ve[$t].y),vt.x=Math.max(vt.x,Ve[$t].x),vt.y=Math.max(vt.y,Ve[$t].y);qt=ft.x>=Re.x&&vt.x<=De.x&&ft.y>=Re.y&&vt.y<=De.y?[Ve]:vt.x<Re.x||ft.x>De.x||vt.y<Re.y||ft.y>De.y?[]:s.al([Ve],Re.x,Re.y,De.x,De.y)}for(let ft of qt){Xe.reset(ft,.25*qe);let vt=0;vt=Xe.length<=.5*qe?1:Math.ceil(Xe.paddedLength/st)+1;for(let $t=0;$t<vt;$t++){let Li=$t/Math.max(vt-1,1),Yr=Xe.lerp(Li),Zt=Yr.x+dt,tr=Yr.y+dt;Y.push(Zt,tr,qe,0);let $i=Zt-qe,Di=tr-qe,Zi=Zt+qe,kn=tr+qe;if(Ne=Ne&&this.isOffscreen($i,Di,Zi,kn),ze=ze||this.isInsideGrid($i,Di,Zi,kn),e!=="always"&&this.grid.hitTestCircle(Zt,tr,qe,e,F)&&(ke=!0,!I))return{circles:[],offscreen:!1,collisionDetected:ke}}}}return{circles:!I&&ke||!ze||Z<this.perspectiveRatioCutoff?[]:Y,offscreen:Ne,collisionDetected:ke}}projectPathToScreenSpace(e,a,u){return e.map(h=>X(h.x,h.y,u,a.getElevation))}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let a=[],u=1/0,h=1/0,m=-1/0,x=-1/0;for(let I of e){let P=new s.P(I.x+dt,I.y+dt);u=Math.min(u,P.x),h=Math.min(h,P.y),m=Math.max(m,P.x),x=Math.max(x,P.y),a.push(P)}let b=this.grid.query(u,h,m,x).concat(this.ignoredGrid.query(u,h,m,x)),k={},C={};for(let I of b){let P=I.key;if(k[P.bucketInstanceId]===void 0&&(k[P.bucketInstanceId]={}),k[P.bucketInstanceId][P.featureIndex])continue;let F=[new s.P(I.x1,I.y1),new s.P(I.x2,I.y1),new s.P(I.x2,I.y2),new s.P(I.x1,I.y2)];s.am(a,F)&&(k[P.bucketInstanceId][P.featureIndex]=!0,C[P.bucketInstanceId]===void 0&&(C[P.bucketInstanceId]=[]),C[P.bucketInstanceId].push(P.featureIndex))}return C}insertCollisionBox(e,a,u,h,m,x){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:h,featureIndex:m,collisionGroupID:x,overlapMode:a},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,a,u,h,m,x){let b=u?this.ignoredGrid:this.grid,k={bucketInstanceId:h,featureIndex:m,collisionGroupID:x,overlapMode:a};for(let C=0;C<e.length;C+=4)b.insertCircle(k,e[C],e[C+1],e[C+2])}projectAndGetPerspectiveRatio(e,a,u,h,m){let x;m?(x=[a,u,m(a,u),1],s.af(x,x,e)):(x=[a,u,0,1],kt(x,x,e));let b=x[3];return{point:new s.P((x[0]/b+1)/2*this.transform.width+dt,(-x[1]/b+1)/2*this.transform.height+dt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/b*.5,isOccluded:!1,signedDistanceFromCamera:b}}getPerspectiveRatio(e,a,u,h,m){let x=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(a,u,h,m):X(a,u,e,m);return .5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5}isOffscreen(e,a,u,h){return u<dt||e>=this.screenRightBoundary||h<dt||a>this.screenBottomBoundary}isInsideGrid(e,a,u,h){return u>=0&&e<this.gridRightBoundary&&h>=0&&a<this.gridBottomBoundary}getViewportMatrix(){let e=s.an([]);return s.J(e,e,[-100,-100,0]),e}_projectCollisionBox(e,a,u,h,m,x,b,k,C,I){let P=new s.P(1,0),F=new s.P(0,1),U=new s.P(e.anchorPointX+b[0],e.anchorPointY+b[1]);if(x&&!m){let Ne=this.projectAndGetPerspectiveRatio(u,U.x+1,U.y,h,C).point.sub(k.point).unit(),qe=Math.atan(Ne.y/Ne.x)+(Ne.x<0?Math.PI:0),Re=Math.sin(qe),De=Math.cos(qe);P=new s.P(De,Re),F=new s.P(-Re,De)}else if(!x&&m){let Ne=-this.transform.angle,qe=Math.sin(Ne),Re=Math.cos(Ne);P=new s.P(Re,qe),F=new s.P(-qe,Re)}let $=k.point,W=a;if(m){$=U;let Ne=this.transform.zoom-Math.floor(this.transform.zoom);W=Math.pow(2,-Ne),W*=this.mapProjection.getPitchedTextCorrection(this.transform,U,h),I||(W*=s.ac(.5+k.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}I&&($=$.add(P.mult(I.x*W)).add(F.mult(I.y*W)));let J=e.x1*W,Y=e.x2*W,te=(J+Y)/2,Z=e.y1*W,oe=e.y2*W,le=(Z+oe)/2,pe=[{offsetX:J,offsetY:Z},{offsetX:te,offsetY:Z},{offsetX:Y,offsetY:Z},{offsetX:Y,offsetY:le},{offsetX:Y,offsetY:oe},{offsetX:te,offsetY:oe},{offsetX:J,offsetY:oe},{offsetX:J,offsetY:le}],ke=[];for(let{offsetX:Ne,offsetY:qe}of pe)ke.push(new s.P($.x+P.x*Ne+F.x*qe,$.y+P.y*Ne+F.y*qe));let ze=!1;if(m){let Ne=ke.map(qe=>this.projectAndGetPerspectiveRatio(u,qe.x,qe.y,h,C));ze=Ne.some(qe=>!qe.isOccluded),ke=Ne.map(qe=>qe.point)}else ze=!0;return{box:s.ao(ke),allPointsOccluded:!ze}}}function _t(g,e,a){return e*(s.X/(g.tileSize*Math.pow(2,a-g.tileID.overscaledZ)))}class di{constructor(e,a,u,h){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?a:-a))):h&&u?1:0,this.placed=u}isHidden(){return this.opacity===0&&!this.placed}}class Qt{constructor(e,a,u,h,m){this.text=new di(e?e.text:null,a,u,m),this.icon=new di(e?e.icon:null,a,h,m)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class gt{constructor(e,a,u){this.text=e,this.icon=a,this.skipFade=u}}class At{constructor(){this.invProjMatrix=s.H(),this.viewportMatrix=s.H(),this.circles=[]}}class Xt{constructor(e,a,u,h,m){this.bucketInstanceId=e,this.featureIndex=a,this.sourceLayerIndex=u,this.bucketIndex=h,this.tileID=m}}class vi{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){let a=++this.maxGroupID;this.collisionGroups[e]={ID:a,predicate:u=>u.collisionGroupID===a}}return this.collisionGroups[e]}}function Ti(g,e,a,u,h){let{horizontalAlign:m,verticalAlign:x}=s.au(g);return new s.P(-(m-.5)*e+u[0]*h,-(x-.5)*a+u[1]*h)}class qi{constructor(e,a,u,h,m,x){this.transform=e.clone(),this.terrain=u,this.collisionIndex=new St(this.transform,a),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new vi(m),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){let a=this.terrain;return a?(u,h)=>a.getElevation(e,u,h):null}getBucketParts(e,a,u,h){let m=u.getBucket(a),x=u.latestFeatureIndex;if(!m||!x||a.id!==m.layerIds[0])return;let b=u.collisionBoxArray,k=m.layers[0].layout,C=m.layers[0].paint,I=Math.pow(2,this.transform.zoom-u.tileID.overscaledZ),P=u.tileSize/s.X,F=u.tileID.toUnwrapped(),U=this.transform.calculatePosMatrix(F),$=k.get("text-pitch-alignment")==="map",W=k.get("text-rotation-alignment")==="map",J=_t(u,1,this.transform.zoom),Y=this.collisionIndex.mapProjection.translatePosition(this.transform,u,C.get("text-translate"),C.get("text-translate-anchor")),te=this.collisionIndex.mapProjection.translatePosition(this.transform,u,C.get("icon-translate"),C.get("icon-translate-anchor")),Z=ao(U,$,W,this.transform,J),oe=null;if($){let pe=vn(U,$,W,this.transform,J);oe=s.L([],this.transform.labelPlaneMatrix,pe)}this.retainedQueryData[m.bucketInstanceId]=new Xt(m.bucketInstanceId,x,m.sourceLayerIndex,m.index,u.tileID);let le={bucket:m,layout:k,translationText:Y,translationIcon:te,posMatrix:U,unwrappedTileID:F,textLabelPlaneMatrix:Z,labelToScreenMatrix:oe,scale:I,textPixelRatio:P,holdingForFade:u.holdingForFade(),collisionBoxArray:b,partiallyEvaluatedTextSize:s.ag(m.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(m.sourceID)};if(h)for(let pe of m.sortKeyRanges){let{sortKey:ke,symbolInstanceStart:ze,symbolInstanceEnd:Ne}=pe;e.push({sortKey:ke,symbolInstanceStart:ze,symbolInstanceEnd:Ne,parameters:le})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:m.symbolInstances.length,parameters:le})}attemptAnchorPlacement(e,a,u,h,m,x,b,k,C,I,P,F,U,$,W,J,Y,te,Z){let oe=s.aq[e.textAnchor],le=[e.textOffset0,e.textOffset1],pe=Ti(oe,u,h,le,m),ke=this.collisionIndex.placeCollisionBox(a,F,k,C,I,b,x,J,P.predicate,Z,pe);if((!te||this.collisionIndex.placeCollisionBox(te,F,k,C,I,b,x,Y,P.predicate,Z,pe).placeable)&&ke.placeable){let ze;if(this.prevPlacement&&this.prevPlacement.variableOffsets[U.crossTileID]&&this.prevPlacement.placements[U.crossTileID]&&this.prevPlacement.placements[U.crossTileID].text&&(ze=this.prevPlacement.variableOffsets[U.crossTileID].anchor),U.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[U.crossTileID]={textOffset:le,width:u,height:h,anchor:oe,textBoxScale:m,prevAnchor:ze},this.markUsedJustification($,oe,U,W),$.allowVerticalPlacement&&(this.markUsedOrientation($,W,U),this.placedOrientations[U.crossTileID]=W),{shift:pe,placedGlyphBoxes:ke}}}placeLayerBucketPart(e,a,u){let{bucket:h,layout:m,translationText:x,translationIcon:b,posMatrix:k,unwrappedTileID:C,textLabelPlaneMatrix:I,labelToScreenMatrix:P,textPixelRatio:F,holdingForFade:U,collisionBoxArray:$,partiallyEvaluatedTextSize:W,collisionGroup:J}=e.parameters,Y=m.get("text-optional"),te=m.get("icon-optional"),Z=s.ar(m,"text-overlap","text-allow-overlap"),oe=Z==="always",le=s.ar(m,"icon-overlap","icon-allow-overlap"),pe=le==="always",ke=m.get("text-rotation-alignment")==="map",ze=m.get("text-pitch-alignment")==="map",Ne=m.get("icon-text-fit")!=="none",qe=m.get("symbol-z-order")==="viewport-y",Re=oe&&(pe||!h.hasIconData()||te),De=pe&&(oe||!h.hasTextData()||Y);!h.collisionArrays&&$&&h.deserializeCollisionBoxes($);let Xe=this._getTerrainElevationFunc(this.retainedQueryData[h.bucketInstanceId].tileID),ut=(Be,Ve,st)=>{var qt,ft;if(a[Be.crossTileID])return;if(U)return void(this.placements[Be.crossTileID]=new gt(!1,!1,!1));let vt=!1,$t=!1,Li=!0,Yr=null,Zt={box:null,placeable:!1,offscreen:null},tr={box:null,placeable:!1,offscreen:null},$i=null,Di=null,Zi=null,kn=0,Pa=0,jl=0;Ve.textFeatureIndex?kn=Ve.textFeatureIndex:Be.useRuntimeCollisionCircles&&(kn=Be.featureIndex),Ve.verticalTextFeatureIndex&&(Pa=Ve.verticalTextFeatureIndex);let Ma=Ve.textBox;if(Ma){let Dr=Ci=>{let Ri=s.ah.horizontal;if(h.allowVerticalPlacement&&!Ci&&this.prevPlacement){let xr=this.prevPlacement.placedOrientations[Be.crossTileID];xr&&(this.placedOrientations[Be.crossTileID]=xr,Ri=xr,this.markUsedOrientation(h,Ri,Be))}return Ri},Rr=(Ci,Ri)=>{if(h.allowVerticalPlacement&&Be.numVerticalGlyphVertices>0&&Ve.verticalTextBox){for(let xr of h.writingModes)if(xr===s.ah.vertical?(Zt=Ri(),tr=Zt):Zt=Ci(),Zt&&Zt.placeable)break}else Zt=Ci()},co=Be.textAnchorOffsetStartIndex,Qr=Be.textAnchorOffsetEndIndex;if(Qr===co){let Ci=(Ri,xr)=>{let wt=this.collisionIndex.placeCollisionBox(Ri,Z,F,k,C,ze,ke,x,J.predicate,Xe);return wt&&wt.placeable&&(this.markUsedOrientation(h,xr,Be),this.placedOrientations[Be.crossTileID]=xr),wt};Rr(()=>Ci(Ma,s.ah.horizontal),()=>{let Ri=Ve.verticalTextBox;return h.allowVerticalPlacement&&Be.numVerticalGlyphVertices>0&&Ri?Ci(Ri,s.ah.vertical):{box:null,offscreen:null}}),Dr(Zt&&Zt.placeable)}else{let Ci=s.aq[(ft=(qt=this.prevPlacement)===null||qt===void 0?void 0:qt.variableOffsets[Be.crossTileID])===null||ft===void 0?void 0:ft.anchor],Ri=(wt,Vo,Aa)=>{let La=wt.x2-wt.x1,Dd=wt.y2-wt.y1,xm=Be.textBoxScale,Rd=Ne&&le==="never"?Vo:null,uo=null,Fd=Z==="never"?1:2,Ul="never";Ci&&Fd++;for(let Fs=0;Fs<Fd;Fs++){for(let ql=co;ql<Qr;ql++){let $l=h.textAnchorOffsets.get(ql);if(Ci&&$l.textAnchor!==Ci)continue;let Da=this.attemptAnchorPlacement($l,wt,La,Dd,xm,ke,ze,F,k,C,J,Ul,Be,h,Aa,x,b,Rd,Xe);if(Da&&(uo=Da.placedGlyphBoxes,uo&&uo.placeable))return vt=!0,Yr=Da.shift,uo}Ci?Ci=null:Ul=Z}return u&&!uo&&(uo={box:this.collisionIndex.placeCollisionBox(Ma,"always",F,k,C,ze,ke,x,J.predicate,Xe,new s.P(0,0)).box,offscreen:!1,placeable:!1}),uo};Rr(()=>Ri(Ma,Ve.iconBox,s.ah.horizontal),()=>{let wt=Ve.verticalTextBox;return h.allowVerticalPlacement&&(!Zt||!Zt.placeable)&&Be.numVerticalGlyphVertices>0&&wt?Ri(wt,Ve.verticalIconBox,s.ah.vertical):{box:null,occluded:!0,offscreen:null}}),Zt&&(vt=Zt.placeable,Li=Zt.offscreen);let xr=Dr(Zt&&Zt.placeable);if(!vt&&this.prevPlacement){let wt=this.prevPlacement.variableOffsets[Be.crossTileID];wt&&(this.variableOffsets[Be.crossTileID]=wt,this.markUsedJustification(h,wt.anchor,Be,xr))}}}if($i=Zt,vt=$i&&$i.placeable,Li=$i&&$i.offscreen,Be.useRuntimeCollisionCircles){let Dr=h.text.placedSymbolArray.get(Be.centerJustifiedTextSymbolIndex),Rr=s.ai(h.textSizeData,W,Dr),co=m.get("text-padding");Di=this.collisionIndex.placeCollisionCircles(Z,Dr,h.lineVertexArray,h.glyphOffsetArray,Rr,k,C,I,P,u,ze,J.predicate,Be.collisionCircleDiameter,co,x,Xe),Di.circles.length&&Di.collisionDetected&&!u&&s.w("Collisions detected, but collision boxes are not shown"),vt=oe||Di.circles.length>0&&!Di.collisionDetected,Li=Li&&Di.offscreen}if(Ve.iconFeatureIndex&&(jl=Ve.iconFeatureIndex),Ve.iconBox){let Dr=Rr=>this.collisionIndex.placeCollisionBox(Rr,le,F,k,C,ze,ke,b,J.predicate,Xe,Ne&&Yr?Yr:void 0);tr&&tr.placeable&&Ve.verticalIconBox?(Zi=Dr(Ve.verticalIconBox),$t=Zi.placeable):(Zi=Dr(Ve.iconBox),$t=Zi.placeable),Li=Li&&Zi.offscreen}let Lr=Y||Be.numHorizontalGlyphVertices===0&&Be.numVerticalGlyphVertices===0,Vl=te||Be.numIconVertices===0;Lr||Vl?Vl?Lr||($t=$t&&vt):vt=$t&&vt:$t=vt=$t&&vt;let Mu=$t&&Zi.placeable;if(vt&&$i.placeable&&this.collisionIndex.insertCollisionBox($i.box,Z,m.get("text-ignore-placement"),h.bucketInstanceId,tr&&tr.placeable&&Pa?Pa:kn,J.ID),Mu&&this.collisionIndex.insertCollisionBox(Zi.box,le,m.get("icon-ignore-placement"),h.bucketInstanceId,jl,J.ID),Di&&vt&&this.collisionIndex.insertCollisionCircles(Di.circles,Z,m.get("text-ignore-placement"),h.bucketInstanceId,kn,J.ID),u&&this.storeCollisionData(h.bucketInstanceId,st,Ve,$i,Zi,Di),Be.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(h.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Be.crossTileID]=new gt(vt||Re,$t||De,Li||h.justReloaded),a[Be.crossTileID]=!0};if(qe){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let Be=h.getSortedSymbolIndexes(this.transform.angle);for(let Ve=Be.length-1;Ve>=0;--Ve){let st=Be[Ve];ut(h.symbolInstances.get(st),h.collisionArrays[st],st)}}else for(let Be=e.symbolInstanceStart;Be<e.symbolInstanceEnd;Be++)ut(h.symbolInstances.get(Be),h.collisionArrays[Be],Be);if(u&&h.bucketInstanceId in this.collisionCircleArrays){let Be=this.collisionCircleArrays[h.bucketInstanceId];s.as(Be.invProjMatrix,k),Be.viewportMatrix=this.collisionIndex.getViewportMatrix()}h.justReloaded=!1}storeCollisionData(e,a,u,h,m,x){if(u.textBox||u.iconBox){let b,k;this.collisionBoxArrays.has(e)?b=this.collisionBoxArrays.get(e):(b=new Map,this.collisionBoxArrays.set(e,b)),b.has(a)?k=b.get(a):(k={text:null,icon:null},b.set(a,k)),u.textBox&&(k.text=h.box),u.iconBox&&(k.icon=m.box)}if(x){let b=this.collisionCircleArrays[e];b===void 0&&(b=this.collisionCircleArrays[e]=new At);for(let k=0;k<x.circles.length;k+=4)b.circles.push(x.circles[k+0]),b.circles.push(x.circles[k+1]),b.circles.push(x.circles[k+2]),b.circles.push(x.collisionDetected?1:0)}}markUsedJustification(e,a,u,h){let m;m=h===s.ah.vertical?u.verticalPlacedTextSymbolIndex:{left:u.leftJustifiedTextSymbolIndex,center:u.centerJustifiedTextSymbolIndex,right:u.rightJustifiedTextSymbolIndex}[s.at(a)];let x=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex,u.verticalPlacedTextSymbolIndex];for(let b of x)b>=0&&(e.text.placedSymbolArray.get(b).crossTileID=m>=0&&b!==m?0:u.crossTileID)}markUsedOrientation(e,a,u){let h=a===s.ah.horizontal||a===s.ah.horizontalOnly?a:0,m=a===s.ah.vertical?a:0,x=[u.leftJustifiedTextSymbolIndex,u.centerJustifiedTextSymbolIndex,u.rightJustifiedTextSymbolIndex];for(let b of x)e.text.placedSymbolArray.get(b).placedOrientation=h;u.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(u.verticalPlacedTextSymbolIndex).placedOrientation=m)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;let a=this.prevPlacement,u=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;let h=a?a.symbolFadeChange(e):1,m=a?a.opacities:{},x=a?a.variableOffsets:{},b=a?a.placedOrientations:{};for(let k in this.placements){let C=this.placements[k],I=m[k];I?(this.opacities[k]=new Qt(I,h,C.text,C.icon),u=u||C.text!==I.text.placed||C.icon!==I.icon.placed):(this.opacities[k]=new Qt(null,h,C.text,C.icon,C.skipFade),u=u||C.text||C.icon)}for(let k in m){let C=m[k];if(!this.opacities[k]){let I=new Qt(C,h,!1,!1);I.isHidden()||(this.opacities[k]=I,u=u||C.text.placed||C.icon.placed)}}for(let k in x)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=x[k]);for(let k in b)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=b[k]);if(a&&a.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");u?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:e)}updateLayerOpacities(e,a){let u={};for(let h of a){let m=h.getBucket(e);m&&h.latestFeatureIndex&&e.id===m.layerIds[0]&&this.updateBucketOpacities(m,h.tileID,u,h.collisionBoxArray)}}updateBucketOpacities(e,a,u,h){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();let m=e.layers[0],x=m.layout,b=new Qt(null,0,!1,!1,!0),k=x.get("text-allow-overlap"),C=x.get("icon-allow-overlap"),I=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),P=x.get("text-rotation-alignment")==="map",F=x.get("text-pitch-alignment")==="map",U=x.get("icon-text-fit")!=="none",$=new Qt(null,0,k&&(C||!e.hasIconData()||x.get("icon-optional")),C&&(k||!e.hasTextData()||x.get("text-optional")),!0);!e.collisionArrays&&h&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(h);let W=(Y,te,Z)=>{for(let oe=0;oe<te/4;oe++)Y.opacityVertexArray.emplaceBack(Z);Y.hasVisibleVertices=Y.hasVisibleVertices||Z!==ca},J=this.collisionBoxArrays.get(e.bucketInstanceId);for(let Y=0;Y<e.symbolInstances.length;Y++){let te=e.symbolInstances.get(Y),{numHorizontalGlyphVertices:Z,numVerticalGlyphVertices:oe,crossTileID:le}=te,pe=this.opacities[le];u[le]?pe=b:pe||(pe=$,this.opacities[le]=pe),u[le]=!0;let ke=te.numIconVertices>0,ze=this.placedOrientations[te.crossTileID],Ne=ze===s.ah.vertical,qe=ze===s.ah.horizontal||ze===s.ah.horizontalOnly;if(Z>0||oe>0){let De=yr(pe.text);W(e.text,Z,Ne?ca:De),W(e.text,oe,qe?ca:De);let Xe=pe.text.isHidden();[te.rightJustifiedTextSymbolIndex,te.centerJustifiedTextSymbolIndex,te.leftJustifiedTextSymbolIndex].forEach(Ve=>{Ve>=0&&(e.text.placedSymbolArray.get(Ve).hidden=Xe||Ne?1:0)}),te.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(te.verticalPlacedTextSymbolIndex).hidden=Xe||qe?1:0);let ut=this.variableOffsets[te.crossTileID];ut&&this.markUsedJustification(e,ut.anchor,te,ze);let Be=this.placedOrientations[te.crossTileID];Be&&(this.markUsedJustification(e,"left",te,Be),this.markUsedOrientation(e,Be,te))}if(ke){let De=yr(pe.icon),Xe=!(U&&te.verticalPlacedIconSymbolIndex&&Ne);te.placedIconSymbolIndex>=0&&(W(e.icon,te.numIconVertices,Xe?De:ca),e.icon.placedSymbolArray.get(te.placedIconSymbolIndex).hidden=pe.icon.isHidden()),te.verticalPlacedIconSymbolIndex>=0&&(W(e.icon,te.numVerticalIconVertices,Xe?ca:De),e.icon.placedSymbolArray.get(te.verticalPlacedIconSymbolIndex).hidden=pe.icon.isHidden())}let Re=J&&J.has(Y)?J.get(Y):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){let De=e.collisionArrays[Y];if(De){let Xe=new s.P(0,0);if(De.textBox||De.verticalTextBox){let ut=!0;if(I){let Be=this.variableOffsets[le];Be?(Xe=Ti(Be.anchor,Be.width,Be.height,Be.textOffset,Be.textBoxScale),P&&Xe._rotate(F?this.transform.angle:-this.transform.angle)):ut=!1}if(De.textBox||De.verticalTextBox){let Be;De.textBox&&(Be=Ne),De.verticalTextBox&&(Be=qe),la(e.textCollisionBox.collisionVertexArray,pe.text.placed,!ut||Be,Re.text,Xe.x,Xe.y)}}if(De.iconBox||De.verticalIconBox){let ut=!!(!qe&&De.verticalIconBox),Be;De.iconBox&&(Be=ut),De.verticalIconBox&&(Be=!ut),la(e.iconCollisionBox.collisionVertexArray,pe.icon.placed,Be,Re.icon,U?Xe.x:0,U?Xe.y:0)}}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);if(e.bucketInstanceId in this.collisionCircleArrays){let Y=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=Y.invProjMatrix,e.placementViewportMatrix=Y.viewportMatrix,e.collisionCircleArray=Y.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,a){let u=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*u>e}setStale(){this.stale=!0}}function la(g,e,a,u,h,m){u&&u.length!==0||(u=[0,0,0,0]);let x=u[0]-dt,b=u[1]-dt,k=u[2]-dt,C=u[3]-dt;g.emplaceBack(e?1:0,a?1:0,h||0,m||0,x,b),g.emplaceBack(e?1:0,a?1:0,h||0,m||0,k,b),g.emplaceBack(e?1:0,a?1:0,h||0,m||0,k,C),g.emplaceBack(e?1:0,a?1:0,h||0,m||0,x,C)}let Lt=Math.pow(2,25),Uc=Math.pow(2,24),qc=Math.pow(2,17),mr=Math.pow(2,16),gr=Math.pow(2,9),Wf=Math.pow(2,8),Ir=Math.pow(2,1);function yr(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;let e=g.placed?1:0,a=Math.floor(127*g.opacity);return a*Lt+e*Uc+a*qc+e*mr+a*gr+e*Wf+a*Ir+e}let ca=0;function Io(){return{isOccluded:(g,e,a)=>!1,getPitchedTextCorrection:(g,e,a)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(g,e,a,u){throw new Error("Not implemented.")},translatePosition:(g,e,a,u)=>function(h,m,x,b,k=!1){if(!x[0]&&!x[1])return[0,0];let C=k?b==="map"?h.angle:0:b==="viewport"?-h.angle:0;if(C){let I=Math.sin(C),P=Math.cos(C);x=[x[0]*P-x[1]*I,x[0]*I+x[1]*P]}return[k?x[0]:_t(m,x[0],h.zoom),k?x[1]:_t(m,x[1],h.zoom)]}(g,e,a,u),getCircleRadiusCorrection:g=>1}}class pi{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,a,u,h,m){let x=this._bucketParts;for(;this._currentTileIndex<e.length;)if(a.getBucketParts(x,h,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,m())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((b,k)=>b.sortKey-k.sortKey));this._currentPartIndex<x.length;)if(a.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,u),this._currentPartIndex++,m())return!0;return!1}}class _s{constructor(e,a,u,h,m,x,b,k){this.placement=new qi(e,Io(),a,x,b,k),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=h,this._showCollisionBoxes=m,this._done=!1}isDone(){return this._done}continuePlacement(e,a,u){let h=B.now(),m=()=>!this._forceFullPlacement&&B.now()-h>2;for(;this._currentPlacementIndex>=0;){let x=a[e[this._currentPlacementIndex]],b=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=b)&&(!x.maxzoom||x.maxzoom>b)){if(this._inProgressLayer||(this._inProgressLayer=new pi(x)),this._inProgressLayer.continuePlacement(u[x.source],this.placement,this._showCollisionBoxes,x,m))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}let Gr=512/s.X/2;class si{constructor(e,a,u){this.tileID=e,this.bucketInstanceId=u,this._symbolsByKey={};let h=new Map;for(let m=0;m<a.length;m++){let x=a.get(m),b=x.key,k=h.get(b);k?k.push(x):h.set(b,[x])}for(let[m,x]of h){let b={positions:x.map(k=>({x:Math.floor(k.anchorX*Gr),y:Math.floor(k.anchorY*Gr)})),crossTileIDs:x.map(k=>k.crossTileID)};if(b.positions.length>128){let k=new s.av(b.positions.length,16,Uint16Array);for(let{x:C,y:I}of b.positions)k.add(C,I);k.finish(),delete b.positions,b.index=k}this._symbolsByKey[m]=b}}getScaledCoordinates(e,a){let{x:u,y:h,z:m}=this.tileID.canonical,{x,y:b,z:k}=a.canonical,C=Gr/Math.pow(2,k-m),I=(b*s.X+e.anchorY)*C,P=h*s.X*Gr;return{x:Math.floor((x*s.X+e.anchorX)*C-u*s.X*Gr),y:Math.floor(I-P)}}findMatches(e,a,u){let h=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z);for(let m=0;m<e.length;m++){let x=e.get(m);if(x.crossTileID)continue;let b=this._symbolsByKey[x.key];if(!b)continue;let k=this.getScaledCoordinates(x,a);if(b.index){let C=b.index.range(k.x-h,k.y-h,k.x+h,k.y+h).sort();for(let I of C){let P=b.crossTileIDs[I];if(!u[P]){u[P]=!0,x.crossTileID=P;break}}}else if(b.positions)for(let C=0;C<b.positions.length;C++){let I=b.positions[C],P=b.crossTileIDs[C];if(Math.abs(I.x-k.x)<=h&&Math.abs(I.y-k.y)<=h&&!u[P]){u[P]=!0,x.crossTileID=P;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class cl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Wr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){let a=Math.round((e-this.lng)/360);if(a!==0)for(let u in this.indexes){let h=this.indexes[u],m={};for(let x in h){let b=h[x];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+a),m[b.tileID.key]=b}this.indexes[u]=m}this.lng=e}addBucket(e,a,u){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let m=0;m<a.symbolInstances.length;m++)a.symbolInstances.get(m).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});let h=this.usedCrossTileIDs[e.overscaledZ];for(let m in this.indexes){let x=this.indexes[m];if(Number(m)>e.overscaledZ)for(let b in x){let k=x[b];k.tileID.isChildOf(e)&&k.findMatches(a.symbolInstances,e,h)}else{let b=x[e.scaledTo(Number(m)).key];b&&b.findMatches(a.symbolInstances,e,h)}}for(let m=0;m<a.symbolInstances.length;m++){let x=a.symbolInstances.get(m);x.crossTileID||(x.crossTileID=u.generate(),h[x.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new si(e,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(e,a){for(let u of a.getCrossTileIDsLists())for(let h of u)delete this.usedCrossTileIDs[e][h]}removeStaleBuckets(e){let a=!1;for(let u in this.indexes){let h=this.indexes[u];for(let m in h)e[h[m].bucketInstanceId]||(this.removeBucketCrossTileIDs(u,h[m]),delete h[m],a=!0)}return a}}class $c{constructor(){this.layerIndexes={},this.crossTileIDs=new cl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,a,u){let h=this.layerIndexes[e.id];h===void 0&&(h=this.layerIndexes[e.id]=new Wr);let m=!1,x={};h.handleWrapJump(u);for(let b of a){let k=b.getBucket(e);k&&e.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),h.addBucket(b.tileID,k,this.crossTileIDs)&&(m=!0),x[k.bucketInstanceId]=!0)}return h.removeStaleBuckets(x)&&(m=!0),m}pruneUnusedLayers(e){let a={};e.forEach(u=>{a[u]=!0});for(let u in this.layerIndexes)a[u]||delete this.layerIndexes[u]}}let Xr=(g,e)=>s.t(g,e&&e.filter(a=>a.identifier!=="source.canvas")),Xf=s.aw();class ul extends s.E{constructor(e,a={}){super(),this._rtlPluginLoaded=()=>{for(let u in this.sourceCaches){let h=this.sourceCaches[u].getSource().type;h!=="vector"&&h!=="geojson"||this.sourceCaches[u].reload()}},this.map=e,this.dispatcher=new Co(To(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(u,h)=>this.getGlyphs(u,h)),this.dispatcher.registerMessageHandler("GI",(u,h)=>this.getImages(u,h)),this.imageManager=new Wt,this.imageManager.setEventedParent(this),this.glyphManager=new fn(e._requestManager,a.localIdeographFontFamily),this.lineAtlas=new na(256,512),this.crossTileSymbolIndex=new $c,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new s.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",s.ay()),yn().on(Pe,this._rtlPluginLoaded),this.on("data",u=>{if(u.dataType!=="source"||u.sourceDataType!=="metadata")return;let h=this.sourceCaches[u.sourceId];if(!h)return;let m=h.getSource();if(m&&m.vectorLayerIds)for(let x in this._layers){let b=this._layers[x];b.source===m.id&&this._validateLayer(b)}})}loadURL(e,a={},u){this.fire(new s.k("dataloading",{dataType:"style"})),a.validate=typeof a.validate!="boolean"||a.validate;let h=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;let m=this._loadStyleRequest;s.h(h,this._loadStyleRequest).then(x=>{this._loadStyleRequest=null,this._load(x.data,a,u)}).catch(x=>{this._loadStyleRequest=null,x&&!m.signal.aborted&&this.fire(new s.j(x))})}loadJSON(e,a={},u){this.fire(new s.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,B.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,a.validate=a.validate!==!1,this._load(e,a,u)}).catch(()=>{})}loadEmpty(){this.fire(new s.k("dataloading",{dataType:"style"})),this._load(Xf,{validate:!1})}_load(e,a,u){var h;let m=a.transformStyle?a.transformStyle(u,e):e;if(!a.validate||!Xr(this,s.u(m))){this._loaded=!0,this.stylesheet=m;for(let x in m.sources)this.addSource(x,m.sources[x],{validate:!1});m.sprite?this._loadSprite(m.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(m.glyphs),this._createLayers(),this.light=new Rn(this.stylesheet.light),this.sky=new $r(this.stylesheet.sky),this.map.setTerrain((h=this.stylesheet.terrain)!==null&&h!==void 0?h:null),this.fire(new s.k("data",{dataType:"style"})),this.fire(new s.k("style.load"))}}_createLayers(){let e=s.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(a=>a.id),this._layers={},this._serializedLayers=null;for(let a of e){let u=s.aA(a);u.setEventedParent(this,{layer:{id:a.id}}),this._layers[a.id]=u}}_loadSprite(e,a=!1,u=void 0){let h;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(m,x,b,k){return s._(this,void 0,void 0,function*(){let C=Ge(m),I=b>1?"@2x":"",P={},F={};for(let{id:U,url:$}of C){let W=x.transformRequest(rt($,I,".json"),"SpriteJSON");P[U]=s.h(W,k);let J=x.transformRequest(rt($,I,".png"),"SpriteImage");F[U]=ne.getImage(J,k)}return yield Promise.all([...Object.values(P),...Object.values(F)]),function(U,$){return s._(this,void 0,void 0,function*(){let W={};for(let J in U){W[J]={};let Y=B.getImageCanvasContext((yield $[J]).data),te=(yield U[J]).data;for(let Z in te){let{width:oe,height:le,x:pe,y:ke,sdf:ze,pixelRatio:Ne,stretchX:qe,stretchY:Re,content:De,textFitWidth:Xe,textFitHeight:ut}=te[Z];W[J][Z]={data:null,pixelRatio:Ne,sdf:ze,stretchX:qe,stretchY:Re,content:De,textFitWidth:Xe,textFitHeight:ut,spriteData:{width:oe,height:le,x:pe,y:ke,context:Y}}}}return W})}(P,F)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(m=>{if(this._spriteRequest=null,m)for(let x in m){this._spritesImagesIds[x]=[];let b=this._spritesImagesIds[x]?this._spritesImagesIds[x].filter(k=>!(k in m)):[];for(let k of b)this.imageManager.removeImage(k),this._changedImages[k]=!0;for(let k in m[x]){let C=x==="default"?k:`${x}:${k}`;this._spritesImagesIds[x].push(C),C in this.imageManager.images?this.imageManager.updateImage(C,m[x][k],!1):this.imageManager.addImage(C,m[x][k]),a&&(this._changedImages[C]=!0)}}}).catch(m=>{this._spriteRequest=null,h=m,this.fire(new s.j(h))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),a&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.k("data",{dataType:"style"})),u&&u(h)})}_unloadSprite(){for(let e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.k("data",{dataType:"style"}))}_validateLayer(e){let a=this.sourceCaches[e.source];if(!a)return;let u=e.sourceLayer;if(!u)return;let h=a.getSource();(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(u)===-1)&&this.fire(new s.j(new Error(`Source layer "${u}" does not exist on source "${h.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,a=!1){let u=this._serializedAllLayers();if(!e||e.length===0)return Object.values(a?s.aB(u):u);let h=[];for(let m of e)if(u[m]){let x=a?s.aB(u[m]):u[m];h.push(x)}return h}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};let a=Object.keys(this._layers);for(let u of a){let h=this._layers[u];h.type!=="custom"&&(e[u]=h.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition()||this.sky&&this.sky.hasTransition())return!0;for(let e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(let e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;let a=this._changed;if(a){let h=Object.keys(this._updatedLayers),m=Object.keys(this._removedLayers);(h.length||m.length)&&this._updateWorkerLayers(h,m);for(let x in this._updatedSources){let b=this._updatedSources[x];if(b==="reload")this._reloadSource(x);else{if(b!=="clear")throw new Error(`Invalid action ${b}`);this._clearSource(x)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let x in this._updatedPaintProps)this._layers[x].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}let u={};for(let h in this.sourceCaches){let m=this.sourceCaches[h];u[h]=m.used,m.used=!1}for(let h of this._order){let m=this._layers[h];m.recalculate(e,this._availableImages),!m.isHidden(e.zoom)&&m.source&&(this.sourceCaches[m.source].used=!0)}for(let h in u){let m=this.sourceCaches[h];!!u[h]!=!!m.used&&m.fire(new s.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:h}))}this.light.recalculate(e),this.sky.recalculate(e),this.z=e.zoom,a&&this.fire(new s.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){let e=Object.keys(this._changedImages);if(e.length){for(let a in this.sourceCaches)this.sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,a){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,a={}){var u;this._checkLoaded();let h=this.serialize();if(e=a.transformStyle?a.transformStyle(h,e):e,((u=a.validate)===null||u===void 0||u)&&Xr(this,s.u(e)))return!1;(e=s.aB(e)).layers=s.az(e.layers);let m=s.aC(h,e),x=this._getOperationsToPerform(m);if(x.unimplemented.length>0)throw new Error(`Unimplemented: ${x.unimplemented.join(", ")}.`);if(x.operations.length===0)return!1;for(let b of x.operations)b();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){let a=[],u=[];for(let h of e)switch(h.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":a.push(()=>this.addLayer.apply(this,h.args));break;case"removeLayer":a.push(()=>this.removeLayer.apply(this,h.args));break;case"setPaintProperty":a.push(()=>this.setPaintProperty.apply(this,h.args));break;case"setLayoutProperty":a.push(()=>this.setLayoutProperty.apply(this,h.args));break;case"setFilter":a.push(()=>this.setFilter.apply(this,h.args));break;case"addSource":a.push(()=>this.addSource.apply(this,h.args));break;case"removeSource":a.push(()=>this.removeSource.apply(this,h.args));break;case"setLayerZoomRange":a.push(()=>this.setLayerZoomRange.apply(this,h.args));break;case"setLight":a.push(()=>this.setLight.apply(this,h.args));break;case"setGeoJSONSourceData":a.push(()=>this.setGeoJSONSourceData.apply(this,h.args));break;case"setGlyphs":a.push(()=>this.setGlyphs.apply(this,h.args));break;case"setSprite":a.push(()=>this.setSprite.apply(this,h.args));break;case"setSky":a.push(()=>this.setSky.apply(this,h.args));break;case"setTerrain":a.push(()=>this.map.setTerrain.apply(this,h.args));break;case"setTransition":a.push(()=>{});break;default:u.push(h.command)}return{operations:a,unimplemented:u}}addImage(e,a){if(this.getImage(e))return this.fire(new s.j(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,a),this._afterImageUpdated(e)}updateImage(e,a){this.imageManager.updateImage(e,a)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new s.j(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,a,u={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(s.u.source,`sources.${e}`,a,null,u))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);let h=this.sourceCaches[e]=new at(e,a,this.dispatcher);h.style=this,h.setEventedParent(this,()=>({isSourceLoaded:h.loaded(),source:h.serialize(),sourceId:e})),h.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(let u in this._layers)if(this._layers[u].source===e)return this.fire(new s.j(new Error(`Source "${e}" cannot be removed while layer "${u}" is using it.`)));let a=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],a.fire(new s.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),a.setEventedParent(null),a.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,a){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);let u=this.sourceCaches[e].getSource();if(u.type!=="geojson")throw new Error(`geojsonSource.type is ${u.type}, which is !== 'geojson`);u.setData(a),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,a,u={}){this._checkLoaded();let h=e.id;if(this.getLayer(h))return void this.fire(new s.j(new Error(`Layer "${h}" already exists on this map.`)));let m;if(e.type==="custom"){if(Xr(this,s.aD(e)))return;m=s.aA(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(h,e.source),e=s.aB(e),e=s.e(e,{source:h})),this._validate(s.u.layer,`layers.${h}`,e,{arrayIndex:-1},u))return;m=s.aA(e),this._validateLayer(m),m.setEventedParent(this,{layer:{id:h}})}let x=a?this._order.indexOf(a):this._order.length;if(a&&x===-1)this.fire(new s.j(new Error(`Cannot add layer "${h}" before non-existing layer "${a}".`)));else{if(this._order.splice(x,0,h),this._layerOrderChanged=!0,this._layers[h]=m,this._removedLayers[h]&&m.source&&m.type!=="custom"){let b=this._removedLayers[h];delete this._removedLayers[h],b.type!==m.type?this._updatedSources[m.source]="clear":(this._updatedSources[m.source]="reload",this.sourceCaches[m.source].pause())}this._updateLayer(m),m.onAdd&&m.onAdd(this.map)}}moveLayer(e,a){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new s.j(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===a)return;let u=this._order.indexOf(e);this._order.splice(u,1);let h=a?this._order.indexOf(a):this._order.length;a&&h===-1?this.fire(new s.j(new Error(`Cannot move layer "${e}" before non-existing layer "${a}".`))):(this._order.splice(h,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();let a=this._layers[e];if(!a)return void this.fire(new s.j(new Error(`Cannot remove non-existing layer "${e}".`)));a.setEventedParent(null);let u=this._order.indexOf(e);this._order.splice(u,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=a,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],a.onRemove&&a.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,a,u){this._checkLoaded();let h=this.getLayer(e);h?h.minzoom===a&&h.maxzoom===u||(a!=null&&(h.minzoom=a),u!=null&&(h.maxzoom=u),this._updateLayer(h)):this.fire(new s.j(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,a,u={}){this._checkLoaded();let h=this.getLayer(e);if(h){if(!s.aE(h.filter,a))return a==null?(h.filter=void 0,void this._updateLayer(h)):void(this._validate(s.u.filter,`layers.${h.id}.filter`,a,null,u)||(h.filter=s.aB(a),this._updateLayer(h)))}else this.fire(new s.j(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return s.aB(this.getLayer(e).filter)}setLayoutProperty(e,a,u,h={}){this._checkLoaded();let m=this.getLayer(e);m?s.aE(m.getLayoutProperty(a),u)||(m.setLayoutProperty(a,u,h),this._updateLayer(m)):this.fire(new s.j(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,a){let u=this.getLayer(e);if(u)return u.getLayoutProperty(a);this.fire(new s.j(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,a,u,h={}){this._checkLoaded();let m=this.getLayer(e);m?s.aE(m.getPaintProperty(a),u)||(m.setPaintProperty(a,u,h)&&this._updateLayer(m),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new s.j(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,a){return this.getLayer(e).getPaintProperty(a)}setFeatureState(e,a){this._checkLoaded();let u=e.source,h=e.sourceLayer,m=this.sourceCaches[u];if(m===void 0)return void this.fire(new s.j(new Error(`The source '${u}' does not exist in the map's style.`)));let x=m.getSource().type;x==="geojson"&&h?this.fire(new s.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||h?(e.id===void 0&&this.fire(new s.j(new Error("The feature id parameter must be provided."))),m.setFeatureState(h,e.id,a)):this.fire(new s.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,a){this._checkLoaded();let u=e.source,h=this.sourceCaches[u];if(h===void 0)return void this.fire(new s.j(new Error(`The source '${u}' does not exist in the map's style.`)));let m=h.getSource().type,x=m==="vector"?e.sourceLayer:void 0;m!=="vector"||x?a&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new s.j(new Error("A feature id is required to remove its specific state property."))):h.removeFeatureState(x,e.id,a):this.fire(new s.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();let a=e.source,u=e.sourceLayer,h=this.sourceCaches[a];if(h!==void 0)return h.getSource().type!=="vector"||u?(e.id===void 0&&this.fire(new s.j(new Error("The feature id parameter must be provided."))),h.getFeatureState(u,e.id)):void this.fire(new s.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new s.j(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return s.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let e=s.aF(this.sourceCaches,m=>m.serialize()),a=this._serializeByIds(this._order,!0),u=this.map.getTerrain()||void 0,h=this.stylesheet;return s.aG({version:h.version,name:h.name,metadata:h.metadata,light:h.light,sky:h.sky,center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch,sprite:h.sprite,glyphs:h.glyphs,transition:h.transition,sources:e,layers:a,terrain:u},m=>m!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){let a=x=>this._layers[x].type==="fill-extrusion",u={},h=[];for(let x=this._order.length-1;x>=0;x--){let b=this._order[x];if(a(b)){u[b]=x;for(let k of e){let C=k[b];if(C)for(let I of C)h.push(I)}}}h.sort((x,b)=>b.intersectionZ-x.intersectionZ);let m=[];for(let x=this._order.length-1;x>=0;x--){let b=this._order[x];if(a(b))for(let k=h.length-1;k>=0;k--){let C=h[k].feature;if(u[C.layer.id]<x)break;m.push(C),h.pop()}else for(let k of e){let C=k[b];if(C)for(let I of C)m.push(I.feature)}}return m}queryRenderedFeatures(e,a,u){a&&a.filter&&this._validate(s.u.filter,"queryRenderedFeatures.filter",a.filter,null,a);let h={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new s.j(new Error("parameters.layers must be an Array."))),[];for(let b of a.layers){let k=this._layers[b];if(!k)return this.fire(new s.j(new Error(`The layer '${b}' does not exist in the map's style and cannot be queried for features.`))),[];h[k.source]=!0}}let m=[];a.availableImages=this._availableImages;let x=this._serializedAllLayers();for(let b in this.sourceCaches)a.layers&&!h[b]||m.push(io(this.sourceCaches[b],this._layers,x,e,a,u));return this.placement&&m.push(function(b,k,C,I,P,F,U){let $={},W=F.queryRenderedSymbols(I),J=[];for(let Y of Object.keys(W).map(Number))J.push(U[Y]);J.sort(ro);for(let Y of J){let te=Y.featureIndex.lookupSymbolFeatures(W[Y.bucketInstanceId],k,Y.bucketIndex,Y.sourceLayerIndex,P.filter,P.layers,P.availableImages,b);for(let Z in te){let oe=$[Z]=$[Z]||[],le=te[Z];le.sort((pe,ke)=>{let ze=Y.featureSortOrder;if(ze){let Ne=ze.indexOf(pe.featureIndex);return ze.indexOf(ke.featureIndex)-Ne}return ke.featureIndex-pe.featureIndex});for(let pe of le)oe.push(pe)}}for(let Y in $)$[Y].forEach(te=>{let Z=te.feature,oe=C[b[Y].source].getFeatureState(Z.layer["source-layer"],Z.id);Z.source=Z.layer.source,Z.layer["source-layer"]&&(Z.sourceLayer=Z.layer["source-layer"]),Z.state=oe});return $}(this._layers,x,this.sourceCaches,e,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(m)}querySourceFeatures(e,a){a&&a.filter&&this._validate(s.u.filter,"querySourceFeatures.filter",a.filter,null,a);let u=this.sourceCaches[e];return u?function(h,m){let x=h.getRenderableIds().map(C=>h.getTileByID(C)),b=[],k={};for(let C=0;C<x.length;C++){let I=x[C],P=I.tileID.canonical.key;k[P]||(k[P]=!0,I.querySourceFeatures(b,m))}return b}(u,a):[]}getLight(){return this.light.getLight()}setLight(e,a={}){this._checkLoaded();let u=this.light.getLight(),h=!1;for(let x in e)if(!s.aE(e[x],u[x])){h=!0;break}if(!h)return;let m={now:B.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,a),this.light.updateTransitions(m)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,a={}){let u=this.getSky(),h=!1;if(!e&&!u)return;if(e&&!u)h=!0;else if(!e&&u)h=!0;else for(let x in e)if(!s.aE(e[x],u[x])){h=!0;break}if(!h)return;let m={now:B.now(),transition:s.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,a),this.sky.updateTransitions(m)}_validate(e,a,u,h,m={}){return(!m||m.validate!==!1)&&Xr(this,e.call(s.u,s.e({key:a,style:this.serialize(),value:u,styleSpec:s.v},h)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),yn().off(Pe,this._rtlPluginLoaded);for(let a in this._layers)this._layers[a].setEventedParent(null);for(let a in this.sourceCaches){let u=this.sourceCaches[a];u.setEventedParent(null),u.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(let a in this.sourceCaches)this.sourceCaches[a].update(e,this.map.terrain)}_generateCollisionBoxes(){for(let e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,a,u,h,m=!1){let x=!1,b=!1,k={};for(let C of this._order){let I=this._layers[C];if(I.type!=="symbol")continue;if(!k[I.source]){let F=this.sourceCaches[I.source];k[I.source]=F.getRenderableIds(!0).map(U=>F.getTileByID(U)).sort((U,$)=>$.tileID.overscaledZ-U.tileID.overscaledZ||(U.tileID.isLessThan($.tileID)?-1:1))}let P=this.crossTileSymbolIndex.addLayer(I,k[I.source],e.center.lng);x=x||P}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((m=m||this._layerOrderChanged||u===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(B.now(),e.zoom))&&(this.pauseablePlacement=new _s(e,this.map.terrain,this._order,m,a,u,h,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(B.now()),b=!0),x&&this.pauseablePlacement.placement.setStale()),b||x)for(let C of this._order){let I=this._layers[C];I.type==="symbol"&&this.placement.updateLayerOpacities(I,k[I.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(B.now())}_releaseSymbolFadeTiles(){for(let e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,a){return s._(this,void 0,void 0,function*(){let u=yield this.imageManager.getImages(a.icons);this._updateTilesForChangedImages();let h=this.sourceCaches[a.source];return h&&h.setDependencies(a.tileID.key,a.type,a.icons),u})}getGlyphs(e,a){return s._(this,void 0,void 0,function*(){let u=yield this.glyphManager.getGlyphs(a.stacks),h=this.sourceCaches[a.source];return h&&h.setDependencies(a.tileID.key,a.type,[""]),u})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,a={}){this._checkLoaded(),e&&this._validate(s.u.glyphs,"glyphs",e,null,a)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,a,u={},h){this._checkLoaded();let m=[{id:e,url:a}],x=[...Ge(this.stylesheet.sprite),...m];this._validate(s.u.sprite,"sprite",x,null,u)||(this.stylesheet.sprite=x,this._loadSprite(m,!0,h))}removeSprite(e){this._checkLoaded();let a=Ge(this.stylesheet.sprite);if(a.find(u=>u.id===e)){if(this._spritesImagesIds[e])for(let u of this._spritesImagesIds[e])this.imageManager.removeImage(u),this._changedImages[u]=!0;a.splice(a.findIndex(u=>u.id===e),1),this.stylesheet.sprite=a.length>0?a:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new s.k("data",{dataType:"style"}))}else this.fire(new s.j(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return Ge(this.stylesheet.sprite)}setSprite(e,a={},u){this._checkLoaded(),e&&this._validate(s.u.sprite,"sprite",e,null,a)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,u):(this._unloadSprite(),u&&u(null)))}}var Po=s.Y([{name:"a_pos",type:"Int16",components:2}]);let so={prelude:It(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:It(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:It(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:It(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:It("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:It(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}`),heatmapTexture:It(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:It("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:It("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:It("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:It(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:It(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:It(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:It(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:It(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:It(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:It(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:It(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:It(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:It(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:It(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:It(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:It(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:It(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:It(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:It(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:It("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:It("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:It("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:It("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function It(g,e){let a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,u=e.match(/attribute ([\w]+) ([\w]+)/g),h=g.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),m=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=m?m.concat(h):h,b={};return{fragmentSource:g=g.replace(a,(k,C,I,P,F)=>(b[F]=!0,C==="define"?`
#ifndef HAS_UNIFORM_u_${F}
varying ${I} ${P} ${F};
#else
uniform ${I} ${P} u_${F};
#endif
`:`
#ifdef HAS_UNIFORM_u_${F}
    ${I} ${P} ${F} = u_${F};
#endif
`)),vertexSource:e=e.replace(a,(k,C,I,P,F)=>{let U=P==="float"?"vec2":"vec4",$=F.match(/color/)?"color":U;return b[F]?C==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${I} ${U} a_${F};
varying ${I} ${P} ${F};
#else
uniform ${I} ${P} u_${F};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = a_${F};
#else
    ${I} ${P} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = unpack_mix_${$}(a_${F}, u_${F}_t);
#else
    ${I} ${P} ${F} = u_${F};
#endif
`:C==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${I} ${U} a_${F};
#else
uniform ${I} ${P} u_${F};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${I} ${P} ${F} = a_${F};
#else
    ${I} ${P} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${I} ${P} ${F} = unpack_mix_${$}(a_${F}, u_${F}_t);
#else
    ${I} ${P} ${F} = u_${F};
#endif
`}),staticAttributes:u,staticUniforms:x}}class Zc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,a,u,h,m,x,b,k,C){this.context=e;let I=this.boundPaintVertexBuffers.length!==h.length;for(let P=0;!I&&P<h.length;P++)this.boundPaintVertexBuffers[P]!==h[P]&&(I=!0);!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==u||I||this.boundIndexBuffer!==m||this.boundVertexOffset!==x||this.boundDynamicVertexBuffer!==b||this.boundDynamicVertexBuffer2!==k||this.boundDynamicVertexBuffer3!==C?this.freshBind(a,u,h,m,x,b,k,C):(e.bindVertexArray.set(this.vao),b&&b.bind(),m&&m.dynamicDraw&&m.bind(),k&&k.bind(),C&&C.bind())}freshBind(e,a,u,h,m,x,b,k){let C=e.numAttributes,I=this.context,P=I.gl;this.vao&&this.destroy(),this.vao=I.createVertexArray(),I.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=u,this.boundIndexBuffer=h,this.boundVertexOffset=m,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=b,this.boundDynamicVertexBuffer3=k,a.enableAttributes(P,e);for(let F of u)F.enableAttributes(P,e);x&&x.enableAttributes(P,e),b&&b.enableAttributes(P,e),k&&k.enableAttributes(P,e),a.bind(),a.setVertexAttribPointers(P,e,m);for(let F of u)F.bind(),F.setVertexAttribPointers(P,e,m);x&&(x.bind(),x.setVertexAttribPointers(P,e,m)),h&&h.bind(),b&&(b.bind(),b.setVertexAttribPointers(P,e,m)),k&&(k.bind(),k.setVertexAttribPointers(P,e,m)),I.currentNumAttributes=C}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}let Hc=(g,e,a,u,h)=>({u_matrix:g,u_texture:0,u_ele_delta:e,u_fog_matrix:a,u_fog_color:u?u.properties.get("fog-color"):s.aM.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:u?u.calculateFogBlendOpacity(h):0,u_horizon_color:u?u.properties.get("horizon-color"):s.aM.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1});function ua(g){let e=[];for(let a=0;a<g.length;a++){if(g[a]===null)continue;let u=g[a].split(" ");e.push(u.pop())}return e}class Gc{constructor(e,a,u,h,m,x){let b=e.gl;this.program=b.createProgram();let k=ua(a.staticAttributes),C=u?u.getBinderAttributes():[],I=k.concat(C),P=so.prelude.staticUniforms?ua(so.prelude.staticUniforms):[],F=a.staticUniforms?ua(a.staticUniforms):[],U=u?u.getBinderUniforms():[],$=P.concat(F).concat(U),W=[];for(let pe of $)W.indexOf(pe)<0&&W.push(pe);let J=u?u.defines():[];m&&J.push("#define OVERDRAW_INSPECTOR;"),x&&J.push("#define TERRAIN3D;");let Y=J.concat(so.prelude.fragmentSource,a.fragmentSource).join(`
`),te=J.concat(so.prelude.vertexSource,a.vertexSource).join(`
`),Z=b.createShader(b.FRAGMENT_SHADER);if(b.isContextLost())return void(this.failedToCreate=!0);if(b.shaderSource(Z,Y),b.compileShader(Z),!b.getShaderParameter(Z,b.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${b.getShaderInfoLog(Z)}`);b.attachShader(this.program,Z);let oe=b.createShader(b.VERTEX_SHADER);if(b.isContextLost())return void(this.failedToCreate=!0);if(b.shaderSource(oe,te),b.compileShader(oe),!b.getShaderParameter(oe,b.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${b.getShaderInfoLog(oe)}`);b.attachShader(this.program,oe),this.attributes={};let le={};this.numAttributes=I.length;for(let pe=0;pe<this.numAttributes;pe++)I[pe]&&(b.bindAttribLocation(this.program,pe,I[pe]),this.attributes[I[pe]]=pe);if(b.linkProgram(this.program),!b.getProgramParameter(this.program,b.LINK_STATUS))throw new Error(`Program failed to link: ${b.getProgramInfoLog(this.program)}`);b.deleteShader(oe),b.deleteShader(Z);for(let pe=0;pe<W.length;pe++){let ke=W[pe];if(ke&&!le[ke]){let ze=b.getUniformLocation(this.program,ke);ze&&(le[ke]=ze)}}this.fixedUniforms=h(e,le),this.terrainUniforms=((pe,ke)=>({u_depth:new s.aH(pe,ke.u_depth),u_terrain:new s.aH(pe,ke.u_terrain),u_terrain_dim:new s.aI(pe,ke.u_terrain_dim),u_terrain_matrix:new s.aJ(pe,ke.u_terrain_matrix),u_terrain_unpack:new s.aK(pe,ke.u_terrain_unpack),u_terrain_exaggeration:new s.aI(pe,ke.u_terrain_exaggeration)}))(e,le),this.binderUniforms=u?u.getUniforms(e,le):[]}draw(e,a,u,h,m,x,b,k,C,I,P,F,U,$,W,J,Y,te){let Z=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(u),e.setStencilMode(h),e.setColorMode(m),e.setCullFace(x),k){e.activeTexture.set(Z.TEXTURE2),Z.bindTexture(Z.TEXTURE_2D,k.depthTexture),e.activeTexture.set(Z.TEXTURE3),Z.bindTexture(Z.TEXTURE_2D,k.texture);for(let le in this.terrainUniforms)this.terrainUniforms[le].set(k[le])}for(let le in this.fixedUniforms)this.fixedUniforms[le].set(b[le]);W&&W.setUniforms(e,this.binderUniforms,U,{zoom:$});let oe=0;switch(a){case Z.LINES:oe=2;break;case Z.TRIANGLES:oe=3;break;case Z.LINE_STRIP:oe=1}for(let le of F.get()){let pe=le.vaos||(le.vaos={});(pe[C]||(pe[C]=new Zc)).bind(e,this,I,W?W.getPaintVertexBuffers():[],P,le.vertexOffset,J,Y,te),Z.drawElements(a,le.primitiveLength*oe,Z.UNSIGNED_SHORT,le.primitiveOffset*oe*2)}}}function hl(g,e,a){let u=1/_t(a,1,e.transform.tileZoom),h=Math.pow(2,a.tileID.overscaledZ),m=a.tileSize*Math.pow(2,e.transform.tileZoom)/h,x=m*(a.tileID.canonical.x+a.tileID.wrap*h),b=m*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[u,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[x>>16,b>>16],u_pixel_coord_lower:[65535&x,65535&b]}}let vs=(g,e,a,u)=>{let h=e.style.light,m=h.properties.get("position"),x=[m.x,m.y,m.z],b=function(){var C=new s.A(9);return s.A!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[5]=0,C[6]=0,C[7]=0),C[0]=1,C[4]=1,C[8]=1,C}();h.properties.get("anchor")==="viewport"&&function(C,I){var P=Math.sin(I),F=Math.cos(I);C[0]=F,C[1]=P,C[2]=0,C[3]=-P,C[4]=F,C[5]=0,C[6]=0,C[7]=0,C[8]=1}(b,-e.transform.angle),function(C,I,P){var F=I[0],U=I[1],$=I[2];C[0]=F*P[0]+U*P[3]+$*P[6],C[1]=F*P[1]+U*P[4]+$*P[7],C[2]=F*P[2]+U*P[5]+$*P[8]}(x,x,b);let k=h.properties.get("color");return{u_matrix:g,u_lightpos:x,u_lightintensity:h.properties.get("intensity"),u_lightcolor:[k.r,k.g,k.b],u_vertical_gradient:+a,u_opacity:u}},dl=(g,e,a,u,h,m,x)=>s.e(vs(g,e,a,u),hl(m,e,x),{u_height_factor:-Math.pow(2,h.overscaledZ)/x.tileSize/8}),ha=g=>({u_matrix:g}),td=(g,e,a,u)=>s.e(ha(g),hl(a,e,u)),Kf=(g,e)=>({u_matrix:g,u_world:e}),id=(g,e,a,u,h)=>s.e(td(g,e,a,u),{u_world:h}),Jf=(g,e,a,u)=>{let h=g.transform,m,x;if(u.paint.get("circle-pitch-alignment")==="map"){let b=_t(a,1,h.zoom);m=!0,x=[b,b]}else m=!1,x=h.pixelsToGLUnits;return{u_camera_to_center_distance:h.cameraToCenterDistance,u_scale_with_map:+(u.paint.get("circle-pitch-scale")==="map"),u_matrix:g.translatePosMatrix(e.posMatrix,a,u.paint.get("circle-translate"),u.paint.get("circle-translate-anchor")),u_pitch_with_map:+m,u_device_pixel_ratio:g.pixelRatio,u_extrude_scale:x}},Mo=(g,e,a)=>({u_matrix:g,u_inv_matrix:e,u_camera_to_center_distance:a.cameraToCenterDistance,u_viewport_size:[a.width,a.height]}),xs=(g,e,a=1)=>({u_matrix:g,u_color:e,u_overlay:0,u_overlay_scale:a}),Qi=g=>({u_matrix:g}),er=(g,e,a,u)=>({u_matrix:g,u_extrude_scale:_t(e,1,a),u_intensity:u}),pl=(g,e,a,u)=>{let h=s.H();s.aP(h,0,g.width,g.height,0,0,1);let m=g.context.gl;return{u_matrix:h,u_world:[m.drawingBufferWidth,m.drawingBufferHeight],u_image:a,u_color_ramp:u,u_opacity:e.paint.get("heatmap-opacity")}};function fl(g,e){let a=Math.pow(2,e.canonical.z),u=e.canonical.y;return[new s.Z(0,u/a).toLngLat().lat,new s.Z(0,(u+1)/a).toLngLat().lat]}let ml=(g,e,a,u)=>{let h=g.transform;return{u_matrix:od(g,e,a,u),u_ratio:1/_t(e,1,h.zoom),u_device_pixel_ratio:g.pixelRatio,u_units_to_pixels:[1/h.pixelsToGLUnits[0],1/h.pixelsToGLUnits[1]]}},rd=(g,e,a,u,h)=>s.e(ml(g,e,a,h),{u_image:0,u_image_height:u}),da=(g,e,a,u,h)=>{let m=g.transform,x=nd(e,m);return{u_matrix:od(g,e,a,h),u_texsize:e.imageAtlasTexture.size,u_ratio:1/_t(e,1,m.zoom),u_device_pixel_ratio:g.pixelRatio,u_image:0,u_scale:[x,u.fromScale,u.toScale],u_fade:u.t,u_units_to_pixels:[1/m.pixelsToGLUnits[0],1/m.pixelsToGLUnits[1]]}},Yf=(g,e,a,u,h,m)=>{let x=g.lineAtlas,b=nd(e,g.transform),k=a.layout.get("line-cap")==="round",C=x.getDash(u.from,k),I=x.getDash(u.to,k),P=C.width*h.fromScale,F=I.width*h.toScale;return s.e(ml(g,e,a,m),{u_patternscale_a:[b/P,-C.height/2],u_patternscale_b:[b/F,-I.height/2],u_sdfgamma:x.width/(256*Math.min(P,F)*g.pixelRatio)/2,u_image:0,u_tex_y_a:C.y,u_tex_y_b:I.y,u_mix:h.t})};function nd(g,e){return 1/_t(g,1,e.tileZoom)}function od(g,e,a,u){return g.translatePosMatrix(u?u.posMatrix:e.tileID.posMatrix,e,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}let Qf=(g,e,a,u,h)=>{return{u_matrix:g,u_tl_parent:e,u_scale_parent:a,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*h.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:h.paint.get("raster-brightness-min"),u_brightness_high:h.paint.get("raster-brightness-max"),u_saturation_factor:(x=h.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(m=h.paint.get("raster-contrast"),m>0?1/(1-m):1+m),u_spin_weights:em(h.paint.get("raster-hue-rotate"))};var m,x};function em(g){g*=Math.PI/180;let e=Math.sin(g),a=Math.cos(g);return[(2*a+1)/3,(-Math.sqrt(3)*e-a+1)/3,(Math.sqrt(3)*e-a+1)/3]}let ad=(g,e,a,u,h,m,x,b,k,C,I,P,F,U)=>{let $=x.transform;return{u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:$.cameraToCenterDistance,u_pitch:$.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:$.width/$.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:k,u_coord_matrix:C,u_is_text:+P,u_pitch_with_map:+u,u_is_along_line:h,u_is_variable_anchor:m,u_texsize:F,u_texture:0,u_translation:I,u_pitched_scale:U}},ws=(g,e,a,u,h,m,x,b,k,C,I,P,F,U,$)=>{let W=x.transform;return s.e(ad(g,e,a,u,h,m,x,b,k,C,I,P,F,$),{u_gamma_scale:u?Math.cos(W._pitch)*W.cameraToCenterDistance:1,u_device_pixel_ratio:x.pixelRatio,u_is_halo:+U})},Wc=(g,e,a,u,h,m,x,b,k,C,I,P,F,U)=>s.e(ws(g,e,a,u,h,m,x,b,k,C,I,!0,P,!0,U),{u_texsize_icon:F,u_texture_icon:1}),gl=(g,e,a)=>({u_matrix:g,u_opacity:e,u_color:a}),Xc=(g,e,a,u,h,m)=>s.e(function(x,b,k,C){let I=k.imageManager.getPattern(x.from.toString()),P=k.imageManager.getPattern(x.to.toString()),{width:F,height:U}=k.imageManager.getPixelSize(),$=Math.pow(2,C.tileID.overscaledZ),W=C.tileSize*Math.pow(2,k.transform.tileZoom)/$,J=W*(C.tileID.canonical.x+C.tileID.wrap*$),Y=W*C.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:I.tl,u_pattern_br_a:I.br,u_pattern_tl_b:P.tl,u_pattern_br_b:P.br,u_texsize:[F,U],u_mix:b.t,u_pattern_size_a:I.displaySize,u_pattern_size_b:P.displaySize,u_scale_a:b.fromScale,u_scale_b:b.toScale,u_tile_units_to_pixels:1/_t(C,1,k.transform.tileZoom),u_pixel_coord_upper:[J>>16,Y>>16],u_pixel_coord_lower:[65535&J,65535&Y]}}(u,m,a,h),{u_matrix:g,u_opacity:e}),Kc={fillExtrusion:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_lightpos:new s.aN(g,e.u_lightpos),u_lightintensity:new s.aI(g,e.u_lightintensity),u_lightcolor:new s.aN(g,e.u_lightcolor),u_vertical_gradient:new s.aI(g,e.u_vertical_gradient),u_opacity:new s.aI(g,e.u_opacity)}),fillExtrusionPattern:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_lightpos:new s.aN(g,e.u_lightpos),u_lightintensity:new s.aI(g,e.u_lightintensity),u_lightcolor:new s.aN(g,e.u_lightcolor),u_vertical_gradient:new s.aI(g,e.u_vertical_gradient),u_height_factor:new s.aI(g,e.u_height_factor),u_image:new s.aH(g,e.u_image),u_texsize:new s.aO(g,e.u_texsize),u_pixel_coord_upper:new s.aO(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new s.aO(g,e.u_pixel_coord_lower),u_scale:new s.aN(g,e.u_scale),u_fade:new s.aI(g,e.u_fade),u_opacity:new s.aI(g,e.u_opacity)}),fill:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix)}),fillPattern:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_image:new s.aH(g,e.u_image),u_texsize:new s.aO(g,e.u_texsize),u_pixel_coord_upper:new s.aO(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new s.aO(g,e.u_pixel_coord_lower),u_scale:new s.aN(g,e.u_scale),u_fade:new s.aI(g,e.u_fade)}),fillOutline:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_world:new s.aO(g,e.u_world)}),fillOutlinePattern:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_world:new s.aO(g,e.u_world),u_image:new s.aH(g,e.u_image),u_texsize:new s.aO(g,e.u_texsize),u_pixel_coord_upper:new s.aO(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new s.aO(g,e.u_pixel_coord_lower),u_scale:new s.aN(g,e.u_scale),u_fade:new s.aI(g,e.u_fade)}),circle:(g,e)=>({u_camera_to_center_distance:new s.aI(g,e.u_camera_to_center_distance),u_scale_with_map:new s.aH(g,e.u_scale_with_map),u_pitch_with_map:new s.aH(g,e.u_pitch_with_map),u_extrude_scale:new s.aO(g,e.u_extrude_scale),u_device_pixel_ratio:new s.aI(g,e.u_device_pixel_ratio),u_matrix:new s.aJ(g,e.u_matrix)}),collisionBox:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_pixel_extrude_scale:new s.aO(g,e.u_pixel_extrude_scale)}),collisionCircle:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_inv_matrix:new s.aJ(g,e.u_inv_matrix),u_camera_to_center_distance:new s.aI(g,e.u_camera_to_center_distance),u_viewport_size:new s.aO(g,e.u_viewport_size)}),debug:(g,e)=>({u_color:new s.aL(g,e.u_color),u_matrix:new s.aJ(g,e.u_matrix),u_overlay:new s.aH(g,e.u_overlay),u_overlay_scale:new s.aI(g,e.u_overlay_scale)}),clippingMask:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix)}),heatmap:(g,e)=>({u_extrude_scale:new s.aI(g,e.u_extrude_scale),u_intensity:new s.aI(g,e.u_intensity),u_matrix:new s.aJ(g,e.u_matrix)}),heatmapTexture:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_world:new s.aO(g,e.u_world),u_image:new s.aH(g,e.u_image),u_color_ramp:new s.aH(g,e.u_color_ramp),u_opacity:new s.aI(g,e.u_opacity)}),hillshade:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_image:new s.aH(g,e.u_image),u_latrange:new s.aO(g,e.u_latrange),u_light:new s.aO(g,e.u_light),u_shadow:new s.aL(g,e.u_shadow),u_highlight:new s.aL(g,e.u_highlight),u_accent:new s.aL(g,e.u_accent)}),hillshadePrepare:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_image:new s.aH(g,e.u_image),u_dimension:new s.aO(g,e.u_dimension),u_zoom:new s.aI(g,e.u_zoom),u_unpack:new s.aK(g,e.u_unpack)}),line:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_ratio:new s.aI(g,e.u_ratio),u_device_pixel_ratio:new s.aI(g,e.u_device_pixel_ratio),u_units_to_pixels:new s.aO(g,e.u_units_to_pixels)}),lineGradient:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_ratio:new s.aI(g,e.u_ratio),u_device_pixel_ratio:new s.aI(g,e.u_device_pixel_ratio),u_units_to_pixels:new s.aO(g,e.u_units_to_pixels),u_image:new s.aH(g,e.u_image),u_image_height:new s.aI(g,e.u_image_height)}),linePattern:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_texsize:new s.aO(g,e.u_texsize),u_ratio:new s.aI(g,e.u_ratio),u_device_pixel_ratio:new s.aI(g,e.u_device_pixel_ratio),u_image:new s.aH(g,e.u_image),u_units_to_pixels:new s.aO(g,e.u_units_to_pixels),u_scale:new s.aN(g,e.u_scale),u_fade:new s.aI(g,e.u_fade)}),lineSDF:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_ratio:new s.aI(g,e.u_ratio),u_device_pixel_ratio:new s.aI(g,e.u_device_pixel_ratio),u_units_to_pixels:new s.aO(g,e.u_units_to_pixels),u_patternscale_a:new s.aO(g,e.u_patternscale_a),u_patternscale_b:new s.aO(g,e.u_patternscale_b),u_sdfgamma:new s.aI(g,e.u_sdfgamma),u_image:new s.aH(g,e.u_image),u_tex_y_a:new s.aI(g,e.u_tex_y_a),u_tex_y_b:new s.aI(g,e.u_tex_y_b),u_mix:new s.aI(g,e.u_mix)}),raster:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_tl_parent:new s.aO(g,e.u_tl_parent),u_scale_parent:new s.aI(g,e.u_scale_parent),u_buffer_scale:new s.aI(g,e.u_buffer_scale),u_fade_t:new s.aI(g,e.u_fade_t),u_opacity:new s.aI(g,e.u_opacity),u_image0:new s.aH(g,e.u_image0),u_image1:new s.aH(g,e.u_image1),u_brightness_low:new s.aI(g,e.u_brightness_low),u_brightness_high:new s.aI(g,e.u_brightness_high),u_saturation_factor:new s.aI(g,e.u_saturation_factor),u_contrast_factor:new s.aI(g,e.u_contrast_factor),u_spin_weights:new s.aN(g,e.u_spin_weights)}),symbolIcon:(g,e)=>({u_is_size_zoom_constant:new s.aH(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new s.aH(g,e.u_is_size_feature_constant),u_size_t:new s.aI(g,e.u_size_t),u_size:new s.aI(g,e.u_size),u_camera_to_center_distance:new s.aI(g,e.u_camera_to_center_distance),u_pitch:new s.aI(g,e.u_pitch),u_rotate_symbol:new s.aH(g,e.u_rotate_symbol),u_aspect_ratio:new s.aI(g,e.u_aspect_ratio),u_fade_change:new s.aI(g,e.u_fade_change),u_matrix:new s.aJ(g,e.u_matrix),u_label_plane_matrix:new s.aJ(g,e.u_label_plane_matrix),u_coord_matrix:new s.aJ(g,e.u_coord_matrix),u_is_text:new s.aH(g,e.u_is_text),u_pitch_with_map:new s.aH(g,e.u_pitch_with_map),u_is_along_line:new s.aH(g,e.u_is_along_line),u_is_variable_anchor:new s.aH(g,e.u_is_variable_anchor),u_texsize:new s.aO(g,e.u_texsize),u_texture:new s.aH(g,e.u_texture),u_translation:new s.aO(g,e.u_translation),u_pitched_scale:new s.aI(g,e.u_pitched_scale)}),symbolSDF:(g,e)=>({u_is_size_zoom_constant:new s.aH(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new s.aH(g,e.u_is_size_feature_constant),u_size_t:new s.aI(g,e.u_size_t),u_size:new s.aI(g,e.u_size),u_camera_to_center_distance:new s.aI(g,e.u_camera_to_center_distance),u_pitch:new s.aI(g,e.u_pitch),u_rotate_symbol:new s.aH(g,e.u_rotate_symbol),u_aspect_ratio:new s.aI(g,e.u_aspect_ratio),u_fade_change:new s.aI(g,e.u_fade_change),u_matrix:new s.aJ(g,e.u_matrix),u_label_plane_matrix:new s.aJ(g,e.u_label_plane_matrix),u_coord_matrix:new s.aJ(g,e.u_coord_matrix),u_is_text:new s.aH(g,e.u_is_text),u_pitch_with_map:new s.aH(g,e.u_pitch_with_map),u_is_along_line:new s.aH(g,e.u_is_along_line),u_is_variable_anchor:new s.aH(g,e.u_is_variable_anchor),u_texsize:new s.aO(g,e.u_texsize),u_texture:new s.aH(g,e.u_texture),u_gamma_scale:new s.aI(g,e.u_gamma_scale),u_device_pixel_ratio:new s.aI(g,e.u_device_pixel_ratio),u_is_halo:new s.aH(g,e.u_is_halo),u_translation:new s.aO(g,e.u_translation),u_pitched_scale:new s.aI(g,e.u_pitched_scale)}),symbolTextAndIcon:(g,e)=>({u_is_size_zoom_constant:new s.aH(g,e.u_is_size_zoom_constant),u_is_size_feature_constant:new s.aH(g,e.u_is_size_feature_constant),u_size_t:new s.aI(g,e.u_size_t),u_size:new s.aI(g,e.u_size),u_camera_to_center_distance:new s.aI(g,e.u_camera_to_center_distance),u_pitch:new s.aI(g,e.u_pitch),u_rotate_symbol:new s.aH(g,e.u_rotate_symbol),u_aspect_ratio:new s.aI(g,e.u_aspect_ratio),u_fade_change:new s.aI(g,e.u_fade_change),u_matrix:new s.aJ(g,e.u_matrix),u_label_plane_matrix:new s.aJ(g,e.u_label_plane_matrix),u_coord_matrix:new s.aJ(g,e.u_coord_matrix),u_is_text:new s.aH(g,e.u_is_text),u_pitch_with_map:new s.aH(g,e.u_pitch_with_map),u_is_along_line:new s.aH(g,e.u_is_along_line),u_is_variable_anchor:new s.aH(g,e.u_is_variable_anchor),u_texsize:new s.aO(g,e.u_texsize),u_texsize_icon:new s.aO(g,e.u_texsize_icon),u_texture:new s.aH(g,e.u_texture),u_texture_icon:new s.aH(g,e.u_texture_icon),u_gamma_scale:new s.aI(g,e.u_gamma_scale),u_device_pixel_ratio:new s.aI(g,e.u_device_pixel_ratio),u_is_halo:new s.aH(g,e.u_is_halo),u_translation:new s.aO(g,e.u_translation),u_pitched_scale:new s.aI(g,e.u_pitched_scale)}),background:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_opacity:new s.aI(g,e.u_opacity),u_color:new s.aL(g,e.u_color)}),backgroundPattern:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_opacity:new s.aI(g,e.u_opacity),u_image:new s.aH(g,e.u_image),u_pattern_tl_a:new s.aO(g,e.u_pattern_tl_a),u_pattern_br_a:new s.aO(g,e.u_pattern_br_a),u_pattern_tl_b:new s.aO(g,e.u_pattern_tl_b),u_pattern_br_b:new s.aO(g,e.u_pattern_br_b),u_texsize:new s.aO(g,e.u_texsize),u_mix:new s.aI(g,e.u_mix),u_pattern_size_a:new s.aO(g,e.u_pattern_size_a),u_pattern_size_b:new s.aO(g,e.u_pattern_size_b),u_scale_a:new s.aI(g,e.u_scale_a),u_scale_b:new s.aI(g,e.u_scale_b),u_pixel_coord_upper:new s.aO(g,e.u_pixel_coord_upper),u_pixel_coord_lower:new s.aO(g,e.u_pixel_coord_lower),u_tile_units_to_pixels:new s.aI(g,e.u_tile_units_to_pixels)}),terrain:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_texture:new s.aH(g,e.u_texture),u_ele_delta:new s.aI(g,e.u_ele_delta),u_fog_matrix:new s.aJ(g,e.u_fog_matrix),u_fog_color:new s.aL(g,e.u_fog_color),u_fog_ground_blend:new s.aI(g,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new s.aI(g,e.u_fog_ground_blend_opacity),u_horizon_color:new s.aL(g,e.u_horizon_color),u_horizon_fog_blend:new s.aI(g,e.u_horizon_fog_blend)}),terrainDepth:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_ele_delta:new s.aI(g,e.u_ele_delta)}),terrainCoords:(g,e)=>({u_matrix:new s.aJ(g,e.u_matrix),u_texture:new s.aH(g,e.u_texture),u_terrain_coords_id:new s.aI(g,e.u_terrain_coords_id),u_ele_delta:new s.aI(g,e.u_ele_delta)}),sky:(g,e)=>({u_sky_color:new s.aL(g,e.u_sky_color),u_horizon_color:new s.aL(g,e.u_horizon_color),u_horizon:new s.aI(g,e.u_horizon),u_sky_horizon_blend:new s.aI(g,e.u_sky_horizon_blend)})};class xn{constructor(e,a,u){this.context=e;let h=e.gl;this.buffer=h.createBuffer(),this.dynamicDraw=!!u,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),h.bufferData(h.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?h.DYNAMIC_DRAW:h.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){let a=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let tm={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Jc{constructor(e,a,u,h){this.length=a.length,this.attributes=u,this.itemSize=a.bytesPerElement,this.dynamicDraw=h,this.context=e;let m=e.gl;this.buffer=m.createBuffer(),e.bindVertexBuffer.set(this.buffer),m.bufferData(m.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?m.DYNAMIC_DRAW:m.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);let a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,a){for(let u=0;u<this.attributes.length;u++){let h=a.attributes[this.attributes[u].name];h!==void 0&&e.enableVertexAttribArray(h)}}setVertexAttribPointers(e,a,u){for(let h=0;h<this.attributes.length;h++){let m=this.attributes[h],x=a.attributes[m.name];x!==void 0&&e.vertexAttribPointer(x,m.components,e[tm[m.type]],!1,this.itemSize,m.offset+this.itemSize*(u||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let Ao=new WeakMap;function lo(g){var e;if(Ao.has(g))return Ao.get(g);{let a=(e=g.getParameter(g.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Ao.set(g,a),a}}class Pt{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class yl extends Pt{getDefault(){return s.aM.transparent}set(e){let a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class im extends Pt{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class pa extends Pt{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class rm extends Pt{getDefault(){return[!0,!0,!0,!0]}set(e){let a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class sd extends Pt{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class nm extends Pt{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class ld extends Pt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){let a=this.current;(e.func!==a.func||e.ref!==a.ref||e.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Yc extends Pt{getDefault(){let e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){let a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class cd extends Pt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let a=this.gl;e?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=e,this.dirty=!1}}class ud extends Pt{getDefault(){return[0,1]}set(e){let a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class hd extends Pt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let a=this.gl;e?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=e,this.dirty=!1}}class dd extends Pt{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class Lo extends Pt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let a=this.gl;e?a.enable(a.BLEND):a.disable(a.BLEND),this.current=e,this.dirty=!1}}class pd extends Pt{getDefault(){let e=this.gl;return[e.ONE,e.ZERO]}set(e){let a=this.current;(e[0]!==a[0]||e[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class om extends Pt{getDefault(){return s.aM.transparent}set(e){let a=this.current;(e.r!==a.r||e.g!==a.g||e.b!==a.b||e.a!==a.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class fd extends Pt{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class bs extends Pt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let a=this.gl;e?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=e,this.dirty=!1}}class am extends Pt{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class _l extends Pt{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class sm extends Pt{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class lm extends Pt{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class md extends Pt{getDefault(){let e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){let a=this.current;(e[0]!==a[0]||e[1]!==a[1]||e[2]!==a[2]||e[3]!==a[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class gd extends Pt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class yd extends Pt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Qc extends Pt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let a=this.gl;a.bindTexture(a.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class _d extends Pt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;let a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class vl extends Pt{getDefault(){return null}set(e){let a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Nn extends Pt{getDefault(){return null}set(e){var a;if(e===this.current&&!this.dirty)return;let u=this.gl;lo(u)?u.bindVertexArray(e):(a=u.getExtension("OES_vertex_array_object"))===null||a===void 0||a.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class eu extends Pt{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;let a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class tu extends Pt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class iu extends Pt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;let a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class xl extends Pt{constructor(e,a){super(e),this.context=e,this.parent=a}getDefault(){return null}}class ru extends xl{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Do extends xl{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class nu extends xl{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class cm{constructor(e,a,u,h,m){this.context=e,this.width=a,this.height=u;let x=e.gl,b=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new ru(e,b),h)this.depthAttachment=m?new nu(e,b):new Do(e,b);else if(m)throw new Error("Stencil cannot be set without depth");if(x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){let e=this.context.gl,a=this.colorAttachment.get();if(a&&e.deleteTexture(a),this.depthAttachment){let u=this.depthAttachment.get();u&&e.deleteRenderbuffer(u)}e.deleteFramebuffer(this.framebuffer)}}class ri{constructor(e,a,u){this.blendFunction=e,this.blendColor=a,this.mask=u}}ri.Replace=[1,0],ri.disabled=new ri(ri.Replace,s.aM.transparent,[!1,!1,!1,!1]),ri.unblended=new ri(ri.Replace,s.aM.transparent,[!0,!0,!0,!0]),ri.alphaBlended=new ri([1,771],s.aM.transparent,[!0,!0,!0,!0]);class um{constructor(e){var a,u;if(this.gl=e,this.clearColor=new yl(this),this.clearDepth=new im(this),this.clearStencil=new pa(this),this.colorMask=new rm(this),this.depthMask=new sd(this),this.stencilMask=new nm(this),this.stencilFunc=new ld(this),this.stencilOp=new Yc(this),this.stencilTest=new cd(this),this.depthRange=new ud(this),this.depthTest=new hd(this),this.depthFunc=new dd(this),this.blend=new Lo(this),this.blendFunc=new pd(this),this.blendColor=new om(this),this.blendEquation=new fd(this),this.cullFace=new bs(this),this.cullFaceSide=new am(this),this.frontFace=new _l(this),this.program=new sm(this),this.activeTexture=new lm(this),this.viewport=new md(this),this.bindFramebuffer=new gd(this),this.bindRenderbuffer=new yd(this),this.bindTexture=new Qc(this),this.bindVertexBuffer=new _d(this),this.bindElementBuffer=new vl(this),this.bindVertexArray=new Nn(this),this.pixelStoreUnpack=new eu(this),this.pixelStoreUnpackPremultiplyAlpha=new tu(this),this.pixelStoreUnpackFlipY=new iu(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),lo(e)){this.HALF_FLOAT=e.HALF_FLOAT;let h=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(a=e.RGBA16F)!==null&&a!==void 0?a:h?.RGBA16F_EXT,this.RGB16F=(u=e.RGB16F)!==null&&u!==void 0?u:h?.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");let h=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=h?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,a){return new xn(this,e,a)}createVertexBuffer(e,a,u){return new Jc(this,e,a,u)}createRenderbuffer(e,a,u){let h=this.gl,m=h.createRenderbuffer();return this.bindRenderbuffer.set(m),h.renderbufferStorage(h.RENDERBUFFER,e,a,u),this.bindRenderbuffer.set(null),m}createFramebuffer(e,a,u,h){return new cm(this,e,a,u,h)}clear({color:e,depth:a,stencil:u}){let h=this.gl,m=0;e&&(m|=h.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(m|=h.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),u!==void 0&&(m|=h.STENCIL_BUFFER_BIT,this.clearStencil.set(u),this.stencilMask.set(255)),h.clear(m)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){s.aE(e.blendFunction,ri.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return lo(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var a;return lo(this.gl)?this.gl.deleteVertexArray(e):(a=this.gl.getExtension("OES_vertex_array_object"))===null||a===void 0?void 0:a.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}class yt{constructor(e,a,u){this.func=e,this.mask=a,this.range=u}}yt.ReadOnly=!1,yt.ReadWrite=!0,yt.disabled=new yt(519,yt.ReadOnly,[0,1]);let wl=7680;class Nt{constructor(e,a,u,h,m,x){this.test=e,this.ref=a,this.mask=u,this.fail=h,this.depthFail=m,this.pass=x}}Nt.disabled=new Nt({func:519,mask:0},0,0,wl,wl,wl);class Dt{constructor(e,a,u){this.enable=e,this.mode=a,this.frontFace=u}}let Ro;function ks(g,e,a,u,h){let m=g.context,x=m.gl,b=g.useProgram("collisionBox"),k=[],C=0,I=0;for(let Y=0;Y<u.length;Y++){let te=u[Y],Z=e.getTile(te).getBucket(a);if(!Z)continue;let oe=h?Z.textCollisionBox:Z.iconCollisionBox,le=Z.collisionCircleArray;if(le.length>0){let pe=s.H();s.aQ(pe,Z.placementInvProjMatrix,g.transform.glCoordMatrix),s.aQ(pe,pe,Z.placementViewportMatrix),k.push({circleArray:le,circleOffset:I,transform:te.posMatrix,invTransform:pe,coord:te}),C+=le.length/4,I=C}oe&&b.draw(m,x.LINES,yt.disabled,Nt.disabled,g.colorModeForRenderPass(),Dt.disabled,{u_matrix:te.posMatrix,u_pixel_extrude_scale:[1/(P=g.transform).width,1/P.height]},g.style.map.terrain&&g.style.map.terrain.getTerrainData(te),a.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,null,g.transform.zoom,null,null,oe.collisionVertexBuffer)}var P;if(!h||!k.length)return;let F=g.useProgram("collisionCircle"),U=new s.aR;U.resize(4*C),U._trim();let $=0;for(let Y of k)for(let te=0;te<Y.circleArray.length/4;te++){let Z=4*te,oe=Y.circleArray[Z+0],le=Y.circleArray[Z+1],pe=Y.circleArray[Z+2],ke=Y.circleArray[Z+3];U.emplace($++,oe,le,pe,ke,0),U.emplace($++,oe,le,pe,ke,1),U.emplace($++,oe,le,pe,ke,2),U.emplace($++,oe,le,pe,ke,3)}(!Ro||Ro.length<2*C)&&(Ro=function(Y){let te=2*Y,Z=new s.aT;Z.resize(te),Z._trim();for(let oe=0;oe<te;oe++){let le=6*oe;Z.uint16[le+0]=4*oe+0,Z.uint16[le+1]=4*oe+1,Z.uint16[le+2]=4*oe+2,Z.uint16[le+3]=4*oe+2,Z.uint16[le+4]=4*oe+3,Z.uint16[le+5]=4*oe+0}return Z}(C));let W=m.createIndexBuffer(Ro,!0),J=m.createVertexBuffer(U,s.aS.members,!0);for(let Y of k){let te=Mo(Y.transform,Y.invTransform,g.transform);F.draw(m,x.TRIANGLES,yt.disabled,Nt.disabled,g.colorModeForRenderPass(),Dt.disabled,te,g.style.map.terrain&&g.style.map.terrain.getTerrainData(Y.coord),a.id,J,W,s.a0.simpleSegment(0,2*Y.circleOffset,Y.circleArray.length,Y.circleArray.length/2),null,g.transform.zoom,null,null,null)}J.destroy(),W.destroy()}Dt.disabled=new Dt(!1,1029,2305),Dt.backCCW=new Dt(!0,1029,2305);let Ss=s.an(new Float32Array(16));function ou(g,e,a,u,h,m){let{horizontalAlign:x,verticalAlign:b}=s.au(g);return new s.P((-(x-.5)*e/h+u[0])*m,(-(b-.5)*a/h+u[1])*m)}function Fo(g,e,a,u,h,m){let x=e.tileAnchorPoint.add(new s.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let b=u.mult(m);a||(b=b.rotate(-h));let k=x.add(b);return X(k.x,k.y,e.labelPlaneMatrix,e.getElevation).point}if(a){let b=ve(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(g),k=Math.atan(b.y/b.x)+(b.x<0?Math.PI:0);return g.add(u.rotate(k))}return g.add(u)}function fa(g,e,a,u,h,m,x,b,k,C,I,P,F,U){let $=g.text.placedSymbolArray,W=g.text.dynamicLayoutVertexArray,J=g.icon.dynamicLayoutVertexArray,Y={};W.clear();for(let te=0;te<$.length;te++){let Z=$.get(te),oe=Z.hidden||!Z.crossTileID||g.allowVerticalPlacement&&!Z.placedOrientation?null:u[Z.crossTileID];if(oe){let le=new s.P(Z.anchorX,Z.anchorY),pe={getElevation:U,width:h.width,height:h.height,labelPlaneMatrix:m,lineVertexArray:null,pitchWithMap:a,projection:I,projectionCache:null,tileAnchorPoint:le,translation:P,unwrappedTileID:F},ke=a?X(le.x,le.y,x,U):ve(le.x,le.y,pe),ze=D(h.cameraToCenterDistance,ke.signedDistanceFromCamera),Ne=s.ai(g.textSizeData,k,Z)*ze/s.ap;a&&(Ne*=g.tilePixelRatio/b);let{width:qe,height:Re,anchor:De,textOffset:Xe,textBoxScale:ut}=oe,Be=ou(De,qe,Re,Xe,ut,Ne),Ve=I.getPitchedTextCorrection(h,le.add(new s.P(P[0],P[1])),F),st=Fo(ke.point,pe,e,Be,h.angle,Ve),qt=g.allowVerticalPlacement&&Z.placedOrientation===s.ah.vertical?Math.PI/2:0;for(let ft=0;ft<Z.numGlyphs;ft++)s.aj(W,st,qt);C&&Z.associatedIconIndex>=0&&(Y[Z.associatedIconIndex]={shiftedAnchor:st,angle:qt})}else it(Z.numGlyphs,W)}if(C){J.clear();let te=g.icon.placedSymbolArray;for(let Z=0;Z<te.length;Z++){let oe=te.get(Z);if(oe.hidden)it(oe.numGlyphs,J);else{let le=Y[Z];if(le)for(let pe=0;pe<oe.numGlyphs;pe++)s.aj(J,le.shiftedAnchor,le.angle);else it(oe.numGlyphs,J)}}g.icon.dynamicLayoutVertexBuffer.updateData(J)}g.text.dynamicLayoutVertexBuffer.updateData(W)}function Pr(g,e,a){return a.iconsInText&&e?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function au(g,e,a,u,h,m,x,b,k,C,I,P){let F=g.context,U=F.gl,$=g.transform,W=Io(),J=b==="map",Y=k==="map",te=b!=="viewport"&&a.layout.get("symbol-placement")!=="point",Z=J&&!Y&&!te,oe=!Y&&te,le=!a.layout.get("symbol-sort-key").isConstant(),pe=!1,ke=g.depthModeForSublayer(0,yt.ReadOnly),ze=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Ne=[],qe=W.getCircleRadiusCorrection($);for(let Re of u){let De=e.getTile(Re),Xe=De.getBucket(a);if(!Xe)continue;let ut=h?Xe.text:Xe.icon;if(!ut||!ut.segments.get().length||!ut.hasVisibleVertices)continue;let Be=ut.programConfigurations.get(a.id),Ve=h||Xe.sdfIcons,st=h?Xe.textSizeData:Xe.iconSizeData,qt=Y||$.pitch!==0,ft=g.useProgram(Pr(Ve,h,Xe),Be),vt=s.ag(st,$.zoom),$t=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Re),Li,Yr,Zt,tr,$i=[0,0],Di=null;if(h)Yr=De.glyphAtlasTexture,Zt=U.LINEAR,Li=De.glyphAtlasTexture.size,Xe.iconsInText&&($i=De.imageAtlasTexture.size,Di=De.imageAtlasTexture,tr=qt||g.options.rotating||g.options.zooming||st.kind==="composite"||st.kind==="camera"?U.LINEAR:U.NEAREST);else{let wt=a.layout.get("icon-size").constantOr(0)!==1||Xe.iconsNeedLinear;Yr=De.imageAtlasTexture,Zt=Ve||g.options.rotating||g.options.zooming||wt||qt?U.LINEAR:U.NEAREST,Li=De.imageAtlasTexture.size}let Zi=_t(De,1,g.transform.zoom),kn=oe?Re.posMatrix:Ss,Pa=ao(kn,Y,J,g.transform,Zi),jl=vn(kn,Y,J,g.transform,Zi),Ma=vn(Re.posMatrix,Y,J,g.transform,Zi),Lr=W.translatePosition(g.transform,De,m,x),Vl=ze&&Xe.hasTextData(),Mu=a.layout.get("icon-text-fit")!=="none"&&Vl&&Xe.hasIconData();if(te){let wt=g.style.map.terrain?(Aa,La)=>g.style.map.terrain.getElevation(Re,Aa,La):null,Vo=a.layout.get("text-rotation-alignment")==="map";q(Xe,Re.posMatrix,g,h,Pa,Ma,Y,C,Vo,W,Re.toUnwrapped(),$.width,$.height,Lr,wt)}let Dr=Re.posMatrix,Rr=h&&ze||Mu,co=te||Rr?Ss:Pa,Qr=jl,Ci=Ve&&a.paint.get(h?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Ri;Ri=Ve?Xe.iconsInText?Wc(st.kind,vt,Z,Y,te,Rr,g,Dr,co,Qr,Lr,Li,$i,qe):ws(st.kind,vt,Z,Y,te,Rr,g,Dr,co,Qr,Lr,h,Li,!0,qe):ad(st.kind,vt,Z,Y,te,Rr,g,Dr,co,Qr,Lr,h,Li,qe);let xr={program:ft,buffers:ut,uniformValues:Ri,atlasTexture:Yr,atlasTextureIcon:Di,atlasInterpolation:Zt,atlasInterpolationIcon:tr,isSDF:Ve,hasHalo:Ci};if(le&&Xe.canOverlap){pe=!0;let wt=ut.segments.get();for(let Vo of wt)Ne.push({segments:new s.a0([Vo]),sortKey:Vo.sortKey,state:xr,terrainData:$t})}else Ne.push({segments:ut.segments,sortKey:0,state:xr,terrainData:$t})}pe&&Ne.sort((Re,De)=>Re.sortKey-De.sortKey);for(let Re of Ne){let De=Re.state;if(F.activeTexture.set(U.TEXTURE0),De.atlasTexture.bind(De.atlasInterpolation,U.CLAMP_TO_EDGE),De.atlasTextureIcon&&(F.activeTexture.set(U.TEXTURE1),De.atlasTextureIcon&&De.atlasTextureIcon.bind(De.atlasInterpolationIcon,U.CLAMP_TO_EDGE)),De.isSDF){let Xe=De.uniformValues;De.hasHalo&&(Xe.u_is_halo=1,su(De.buffers,Re.segments,a,g,De.program,ke,I,P,Xe,Re.terrainData)),Xe.u_is_halo=0}su(De.buffers,Re.segments,a,g,De.program,ke,I,P,De.uniformValues,Re.terrainData)}}function su(g,e,a,u,h,m,x,b,k,C){let I=u.context;h.draw(I,I.gl.TRIANGLES,m,x,b,Dt.disabled,k,C,a.id,g.layoutVertexBuffer,g.indexBuffer,e,a.paint,u.transform.zoom,g.programConfigurations.get(a.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function lu(g,e,a,u){let h=g.context,m=h.gl,x=Nt.disabled,b=new ri([m.ONE,m.ONE],s.aM.transparent,[!0,!0,!0,!0]),k=e.getBucket(a);if(!k)return;let C=u.key,I=a.heatmapFbos.get(C);I||(I=Es(h,e.tileSize,e.tileSize),a.heatmapFbos.set(C,I)),h.bindFramebuffer.set(I.framebuffer),h.viewport.set([0,0,e.tileSize,e.tileSize]),h.clear({color:s.aM.transparent});let P=k.programConfigurations.get(a.id),F=g.useProgram("heatmap",P),U=g.style.map.terrain.getTerrainData(u);F.draw(h,m.TRIANGLES,yt.disabled,x,b,Dt.disabled,er(u.posMatrix,e,g.transform.zoom,a.paint.get("heatmap-intensity")),U,a.id,k.layoutVertexBuffer,k.indexBuffer,k.segments,a.paint,g.transform.zoom,P)}function Bo(g,e,a){let u=g.context,h=u.gl;u.setColorMode(g.colorModeForRenderPass());let m=Ts(u,e),x=a.key,b=e.heatmapFbos.get(x);b&&(u.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,b.colorAttachment.get()),u.activeTexture.set(h.TEXTURE1),m.bind(h.LINEAR,h.CLAMP_TO_EDGE),g.useProgram("heatmapTexture").draw(u,h.TRIANGLES,yt.disabled,Nt.disabled,g.colorModeForRenderPass(),Dt.disabled,pl(g,e,0,1),null,e.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments,e.paint,g.transform.zoom),b.destroy(),e.heatmapFbos.delete(x))}function Es(g,e,a){var u,h;let m=g.gl,x=m.createTexture();m.bindTexture(m.TEXTURE_2D,x),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.CLAMP_TO_EDGE),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR);let b=(u=g.HALF_FLOAT)!==null&&u!==void 0?u:m.UNSIGNED_BYTE,k=(h=g.RGBA16F)!==null&&h!==void 0?h:m.RGBA;m.texImage2D(m.TEXTURE_2D,0,k,e,a,0,m.RGBA,b,null);let C=g.createFramebuffer(e,a,!1,!1);return C.colorAttachment.set(x),C}function Ts(g,e){return e.colorRampTexture||(e.colorRampTexture=new ct(g,e.colorRamp,g.gl.RGBA)),e.colorRampTexture}function ma(g,e,a,u,h){if(!a||!u||!u.imageAtlas)return;let m=u.imageAtlas.patternPositions,x=m[a.to.toString()],b=m[a.from.toString()];if(!x&&b&&(x=b),!b&&x&&(b=x),!x||!b){let k=h.getPaintProperty(e);x=m[k],b=m[k]}x&&b&&g.setConstantPatternPositions(x,b)}function Cs(g,e,a,u,h,m,x){let b=g.context.gl,k="fill-pattern",C=a.paint.get(k),I=C&&C.constantOr(1),P=a.getCrossfadeParameters(),F,U,$,W,J;x?(U=I&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=b.LINES):(U=I?"fillPattern":"fill",F=b.TRIANGLES);let Y=C.constantOr(null);for(let te of u){let Z=e.getTile(te);if(I&&!Z.patternsLoaded())continue;let oe=Z.getBucket(a);if(!oe)continue;let le=oe.programConfigurations.get(a.id),pe=g.useProgram(U,le),ke=g.style.map.terrain&&g.style.map.terrain.getTerrainData(te);I&&(g.context.activeTexture.set(b.TEXTURE0),Z.imageAtlasTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),le.updatePaintBuffers(P)),ma(le,k,Y,Z,a);let ze=ke?te:null,Ne=g.translatePosMatrix(ze?ze.posMatrix:te.posMatrix,Z,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(x){W=oe.indexBuffer2,J=oe.segments2;let qe=[b.drawingBufferWidth,b.drawingBufferHeight];$=U==="fillOutlinePattern"&&I?id(Ne,g,P,Z,qe):Kf(Ne,qe)}else W=oe.indexBuffer,J=oe.segments,$=I?td(Ne,g,P,Z):ha(Ne);pe.draw(g.context,F,h,g.stencilModeForClipping(te),m,Dt.disabled,$,ke,a.id,oe.layoutVertexBuffer,W,J,a.paint,g.transform.zoom,le)}}function bl(g,e,a,u,h,m,x){let b=g.context,k=b.gl,C="fill-extrusion-pattern",I=a.paint.get(C),P=I.constantOr(1),F=a.getCrossfadeParameters(),U=a.paint.get("fill-extrusion-opacity"),$=I.constantOr(null);for(let W of u){let J=e.getTile(W),Y=J.getBucket(a);if(!Y)continue;let te=g.style.map.terrain&&g.style.map.terrain.getTerrainData(W),Z=Y.programConfigurations.get(a.id),oe=g.useProgram(P?"fillExtrusionPattern":"fillExtrusion",Z);P&&(g.context.activeTexture.set(k.TEXTURE0),J.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),Z.updatePaintBuffers(F)),ma(Z,C,$,J,a);let le=g.translatePosMatrix(W.posMatrix,J,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),pe=a.paint.get("fill-extrusion-vertical-gradient"),ke=P?dl(le,g,pe,U,W,F,J):vs(le,g,pe,U);oe.draw(b,b.gl.TRIANGLES,h,m,x,Dt.backCCW,ke,te,a.id,Y.layoutVertexBuffer,Y.indexBuffer,Y.segments,a.paint,g.transform.zoom,Z,g.style.map.terrain&&Y.centroidVertexBuffer)}}function ga(g,e,a,u,h,m,x){let b=g.context,k=b.gl,C=a.fbo;if(!C)return;let I=g.useProgram("hillshade"),P=g.style.map.terrain&&g.style.map.terrain.getTerrainData(e);b.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,C.colorAttachment.get()),I.draw(b,k.TRIANGLES,h,m,x,Dt.disabled,((F,U,$,W)=>{let J=$.paint.get("hillshade-shadow-color"),Y=$.paint.get("hillshade-highlight-color"),te=$.paint.get("hillshade-accent-color"),Z=$.paint.get("hillshade-illumination-direction")*(Math.PI/180);$.paint.get("hillshade-illumination-anchor")==="viewport"&&(Z-=F.transform.angle);let oe=!F.options.moving;return{u_matrix:W?W.posMatrix:F.transform.calculatePosMatrix(U.tileID.toUnwrapped(),oe),u_image:0,u_latrange:fl(0,U.tileID),u_light:[$.paint.get("hillshade-exaggeration"),Z],u_shadow:J,u_highlight:Y,u_accent:te}})(g,a,u,P?e:null),P,u.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}function ya(g,e,a,u,h,m){let x=g.context,b=x.gl,k=e.dem;if(k&&k.data){let C=k.dim,I=k.stride,P=k.getPixels();if(x.activeTexture.set(b.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||g.getTileTexture(I),e.demTexture){let U=e.demTexture;U.update(P,{premultiply:!1}),U.bind(b.NEAREST,b.CLAMP_TO_EDGE)}else e.demTexture=new ct(x,P,b.RGBA,{premultiply:!1}),e.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);x.activeTexture.set(b.TEXTURE0);let F=e.fbo;if(!F){let U=new ct(x,{width:C,height:C,data:null},b.RGBA);U.bind(b.LINEAR,b.CLAMP_TO_EDGE),F=e.fbo=x.createFramebuffer(C,C,!0,!1),F.colorAttachment.set(U.texture)}x.bindFramebuffer.set(F.framebuffer),x.viewport.set([0,0,C,C]),g.useProgram("hillshadePrepare").draw(x,b.TRIANGLES,u,h,m,Dt.disabled,((U,$)=>{let W=$.stride,J=s.H();return s.aP(J,0,s.X,-s.X,0,0,1),s.J(J,J,[0,-s.X,0]),{u_matrix:J,u_image:1,u_dimension:[W,W],u_zoom:U.overscaledZ,u_unpack:$.getUnpackVector()}})(e.tileID,k),null,a.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments),e.needsHillshadePrepare=!1}}function vd(g,e,a,u,h,m){let x=u.paint.get("raster-fade-duration");if(!m&&x>0){let b=B.now(),k=(b-g.timeAdded)/x,C=e?(b-e.timeAdded)/x:-1,I=a.getSource(),P=h.coveringZoomLevel({tileSize:I.tileSize,roundZoom:I.roundZoom}),F=!e||Math.abs(e.tileID.overscaledZ-P)>Math.abs(g.tileID.overscaledZ-P),U=F&&g.refreshedUponExpiration?1:s.ac(F?k:1-C,0,1);return g.refreshedUponExpiration&&k>=1&&(g.refreshedUponExpiration=!1),e?{opacity:1,mix:1-U}:{opacity:U,mix:0}}return{opacity:1,mix:0}}let cu=new s.aM(1,0,0,1),Tt=new s.aM(0,1,0,1),kl=new s.aM(0,0,1,1),hm=new s.aM(1,0,1,1),xd=new s.aM(0,1,1,1);function _a(g,e,a,u){Sl(g,0,e+a/2,g.transform.width,a,u)}function wd(g,e,a,u){Sl(g,e-a/2,0,a,g.transform.height,u)}function Sl(g,e,a,u,h,m){let x=g.context,b=x.gl;b.enable(b.SCISSOR_TEST),b.scissor(e*g.pixelRatio,a*g.pixelRatio,u*g.pixelRatio,h*g.pixelRatio),x.clear({color:m}),b.disable(b.SCISSOR_TEST)}function bd(g,e,a){let u=g.context,h=u.gl,m=a.posMatrix,x=g.useProgram("debug"),b=yt.disabled,k=Nt.disabled,C=g.colorModeForRenderPass(),I="$debug",P=g.style.map.terrain&&g.style.map.terrain.getTerrainData(a);u.activeTexture.set(h.TEXTURE0);let F=e.getTileByID(a.key).latestRawTileData,U=Math.floor((F&&F.byteLength||0)/1024),$=e.getTile(a).tileSize,W=512/Math.min($,512)*(a.overscaledZ/g.transform.zoom)*.5,J=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(J+=` => ${a.overscaledZ}`),function(Y,te){Y.initDebugOverlayCanvas();let Z=Y.debugOverlayCanvas,oe=Y.context.gl,le=Y.debugOverlayCanvas.getContext("2d");le.clearRect(0,0,Z.width,Z.height),le.shadowColor="white",le.shadowBlur=2,le.lineWidth=1.5,le.strokeStyle="white",le.textBaseline="top",le.font="bold 36px Open Sans, sans-serif",le.fillText(te,5,5),le.strokeText(te,5,5),Y.debugOverlayTexture.update(Z),Y.debugOverlayTexture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE)}(g,`${J} ${U}kB`),x.draw(u,h.TRIANGLES,b,k,ri.alphaBlended,Dt.disabled,xs(m,s.aM.transparent,W),null,I,g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments),x.draw(u,h.LINE_STRIP,b,k,C,Dt.disabled,xs(m,s.aM.red),P,I,g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments)}function kd(g,e,a){let u=g.context,h=u.gl,m=g.colorModeForRenderPass(),x=new yt(h.LEQUAL,yt.ReadWrite,g.depthRangeFor3D),b=g.useProgram("terrain"),k=e.getTerrainMesh();u.bindFramebuffer.set(null),u.viewport.set([0,0,g.width,g.height]);for(let C of a){let I=g.renderToTexture.getTexture(C),P=e.getTerrainData(C.tileID);u.activeTexture.set(h.TEXTURE0),h.bindTexture(h.TEXTURE_2D,I.texture);let F=g.transform.calculatePosMatrix(C.tileID.toUnwrapped()),U=e.getMeshFrameDelta(g.transform.zoom),$=g.transform.calculateFogMatrix(C.tileID.toUnwrapped()),W=Hc(F,U,$,g.style.sky,g.transform.pitch);b.draw(u,h.TRIANGLES,x,Nt.disabled,m,Dt.backCCW,W,P,"terrain",k.vertexBuffer,k.indexBuffer,k.segments)}}class El{constructor(e,a,u){this.vertexBuffer=e,this.indexBuffer=a,this.segments=u}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class Tl{constructor(e,a){this.context=new um(e),this.transform=a,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:s.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=at.maxUnderzooming+at.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new $c}resize(e,a,u){if(this.width=Math.floor(e*u),this.height=Math.floor(a*u),this.pixelRatio=u,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let h of this.style._order)this.style._layers[h].resize()}setup(){let e=this.context,a=new s.aX;a.emplaceBack(0,0),a.emplaceBack(s.X,0),a.emplaceBack(0,s.X),a.emplaceBack(s.X,s.X),this.tileExtentBuffer=e.createVertexBuffer(a,Po.members),this.tileExtentSegments=s.a0.simpleSegment(0,0,4,2);let u=new s.aX;u.emplaceBack(0,0),u.emplaceBack(s.X,0),u.emplaceBack(0,s.X),u.emplaceBack(s.X,s.X),this.debugBuffer=e.createVertexBuffer(u,Po.members),this.debugSegments=s.a0.simpleSegment(0,0,4,5);let h=new s.$;h.emplaceBack(0,0,0,0),h.emplaceBack(s.X,0,s.X,0),h.emplaceBack(0,s.X,0,s.X),h.emplaceBack(s.X,s.X,s.X,s.X),this.rasterBoundsBuffer=e.createVertexBuffer(h,no.members),this.rasterBoundsSegments=s.a0.simpleSegment(0,0,4,2);let m=new s.aX;m.emplaceBack(0,0),m.emplaceBack(1,0),m.emplaceBack(0,1),m.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(m,Po.members),this.viewportSegments=s.a0.simpleSegment(0,0,4,2);let x=new s.aZ;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(x);let b=new s.aY;b.emplaceBack(0,1,2),b.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(b);let k=this.context.gl;this.stencilClearMode=new Nt({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO)}clearStencil(){let e=this.context,a=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let u=s.H();s.aP(u,0,this.width,this.height,0,0,1),s.K(u,u,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,a.TRIANGLES,yt.disabled,this.stencilClearMode,ri.disabled,Dt.disabled,Qi(u),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,a){if(this.currentStencilSource===e.source||!e.isTileClipped()||!a||!a.length)return;this.currentStencilSource=e.source;let u=this.context,h=u.gl;this.nextStencilID+a.length>256&&this.clearStencil(),u.setColorMode(ri.disabled),u.setDepthMode(yt.disabled);let m=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(let x of a){let b=this._tileClippingMaskIDs[x.key]=this.nextStencilID++,k=this.style.map.terrain&&this.style.map.terrain.getTerrainData(x);m.draw(u,h.TRIANGLES,yt.disabled,new Nt({func:h.ALWAYS,mask:0},b,255,h.KEEP,h.KEEP,h.REPLACE),ri.disabled,Dt.disabled,Qi(x.posMatrix),k,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let e=this.nextStencilID++,a=this.context.gl;return new Nt({func:a.NOTEQUAL,mask:255},e,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(e){let a=this.context.gl;return new Nt({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(e){let a=this.context.gl,u=e.sort((x,b)=>b.overscaledZ-x.overscaledZ),h=u[u.length-1].overscaledZ,m=u[0].overscaledZ-h+1;if(m>1){this.currentStencilSource=void 0,this.nextStencilID+m>256&&this.clearStencil();let x={};for(let b=0;b<m;b++)x[b+h]=new Nt({func:a.GEQUAL,mask:255},b+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=m,[x,u]}return[{[h]:Nt.disabled},u]}colorModeForRenderPass(){let e=this.context.gl;return this._showOverdrawInspector?new ri([e.CONSTANT_COLOR,e.ONE],new s.aM(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ri.unblended:ri.alphaBlended}depthModeForSublayer(e,a,u){if(!this.opaquePassEnabledForLayer())return yt.disabled;let h=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new yt(u||this.context.gl.LEQUAL,a,[h,h])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,a){this.style=e,this.options=a,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(B.now()),this.imageManager.beginFrame();let u=this.style._order,h=this.style.sourceCaches,m={},x={},b={};for(let k in h){let C=h[k];C.used&&C.prepare(this.context),m[k]=C.getVisibleCoordinates(),x[k]=m[k].slice().reverse(),b[k]=C.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let k=0;k<u.length;k++)if(this.style._layers[u[k]].is3D()){this.opaquePassCutoff=k;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(let k of u){let C=this.style._layers[k];if(!C.hasOffscreenPass()||C.isHidden(this.transform.zoom))continue;let I=x[C.source];(C.type==="custom"||I.length)&&this.renderLayer(this,h[C.source],C,I)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?s.aM.black:s.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(k,C){let I=k.context,P=I.gl,F=((Y,te,Z)=>({u_sky_color:Y.properties.get("sky-color"),u_horizon_color:Y.properties.get("horizon-color"),u_horizon:(te.height/2+te.getHorizon())*Z,u_sky_horizon_blend:Y.properties.get("sky-horizon-blend")*te.height/2*Z}))(C,k.style.map.transform,k.pixelRatio),U=new yt(P.LEQUAL,yt.ReadWrite,[0,1]),$=Nt.disabled,W=k.colorModeForRenderPass(),J=k.useProgram("sky");if(!C.mesh){let Y=new s.aX;Y.emplaceBack(-1,-1),Y.emplaceBack(1,-1),Y.emplaceBack(1,1),Y.emplaceBack(-1,1);let te=new s.aY;te.emplaceBack(0,1,2),te.emplaceBack(0,2,3),C.mesh=new El(I.createVertexBuffer(Y,Po.members),I.createIndexBuffer(te),s.a0.simpleSegment(0,0,Y.length,te.length))}J.draw(I,P.TRIANGLES,U,$,W,Dt.disabled,F,void 0,"sky",C.mesh.vertexBuffer,C.mesh.indexBuffer,C.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=u.length-1;this.currentLayer>=0;this.currentLayer--){let k=this.style._layers[u[this.currentLayer]],C=h[k.source],I=m[k.source];this._renderTileClippingMasks(k,I),this.renderLayer(this,C,k,I)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<u.length;this.currentLayer++){let k=this.style._layers[u[this.currentLayer]],C=h[k.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(k))continue;let I=(k.type==="symbol"?b:x)[k.source];this._renderTileClippingMasks(k,m[k.source]),this.renderLayer(this,C,k,I)}if(this.options.showTileBoundaries){let k=function(C,I){let P=null,F=Object.values(C._layers).flatMap(J=>J.source&&!J.isHidden(I)?[C.sourceCaches[J.source]]:[]),U=F.filter(J=>J.getSource().type==="vector"),$=F.filter(J=>J.getSource().type!=="vector"),W=J=>{(!P||P.getSource().maxzoom<J.getSource().maxzoom)&&(P=J)};return U.forEach(J=>W(J)),P||$.forEach(J=>W(J)),P}(this.style,this.transform.zoom);k&&function(C,I,P){for(let F=0;F<P.length;F++)bd(C,I,P[F])}(this,k,k.getVisibleCoordinates())}this.options.showPadding&&function(k){let C=k.transform.padding;_a(k,k.transform.height-(C.top||0),3,cu),_a(k,C.bottom||0,3,Tt),wd(k,C.left||0,3,kl),wd(k,k.transform.width-(C.right||0),3,hm);let I=k.transform.centerPoint;(function(P,F,U,$){Sl(P,F-1,U-10,2,20,$),Sl(P,F-10,U-1,20,2,$)})(k,I.x,k.transform.height-I.y,xd)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;let a=this.terrainFacilitator.matrix,u=this.transform.modelViewProjectionMatrix,h=this.terrainFacilitator.dirty;h||(h=e?!s.a_(a,u):!s.a$(a,u)),h||(h=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),h&&(s.b0(a,u),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(m,x){let b=m.context,k=b.gl,C=ri.unblended,I=new yt(k.LEQUAL,yt.ReadWrite,[0,1]),P=x.getTerrainMesh(),F=x.sourceCache.getRenderableTiles(),U=m.useProgram("terrainDepth");b.bindFramebuffer.set(x.getFramebuffer("depth").framebuffer),b.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),b.clear({color:s.aM.transparent,depth:1});for(let $ of F){let W=x.getTerrainData($.tileID),J={u_matrix:m.transform.calculatePosMatrix($.tileID.toUnwrapped()),u_ele_delta:x.getMeshFrameDelta(m.transform.zoom)};U.draw(b,k.TRIANGLES,I,Nt.disabled,C,Dt.backCCW,J,W,"terrain",P.vertexBuffer,P.indexBuffer,P.segments)}b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain),function(m,x){let b=m.context,k=b.gl,C=ri.unblended,I=new yt(k.LEQUAL,yt.ReadWrite,[0,1]),P=x.getTerrainMesh(),F=x.getCoordsTexture(),U=x.sourceCache.getRenderableTiles(),$=m.useProgram("terrainCoords");b.bindFramebuffer.set(x.getFramebuffer("coords").framebuffer),b.viewport.set([0,0,m.width/devicePixelRatio,m.height/devicePixelRatio]),b.clear({color:s.aM.transparent,depth:1}),x.coordsIndex=[];for(let W of U){let J=x.getTerrainData(W.tileID);b.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,F.texture);let Y={u_matrix:m.transform.calculatePosMatrix(W.tileID.toUnwrapped()),u_terrain_coords_id:(255-x.coordsIndex.length)/255,u_texture:0,u_ele_delta:x.getMeshFrameDelta(m.transform.zoom)};$.draw(b,k.TRIANGLES,I,Nt.disabled,C,Dt.backCCW,Y,J,"terrain",P.vertexBuffer,P.indexBuffer,P.segments),x.coordsIndex.push(W.tileID.key)}b.bindFramebuffer.set(null),b.viewport.set([0,0,m.width,m.height])}(this,this.style.map.terrain))}renderLayer(e,a,u,h){if(!u.isHidden(this.transform.zoom)&&(u.type==="background"||u.type==="custom"||(h||[]).length))switch(this.id=u.id,u.type){case"symbol":(function(m,x,b,k,C){if(m.renderPass!=="translucent")return;let I=Nt.disabled,P=m.colorModeForRenderPass();(b._unevaluatedLayout.hasValue("text-variable-anchor")||b._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(F,U,$,W,J,Y,te,Z,oe){let le=U.transform,pe=Io(),ke=J==="map",ze=Y==="map";for(let Ne of F){let qe=W.getTile(Ne),Re=qe.getBucket($);if(!Re||!Re.text||!Re.text.segments.get().length)continue;let De=s.ag(Re.textSizeData,le.zoom),Xe=_t(qe,1,U.transform.zoom),ut=ao(Ne.posMatrix,ze,ke,U.transform,Xe),Be=$.layout.get("icon-text-fit")!=="none"&&Re.hasIconData();if(De){let Ve=Math.pow(2,le.zoom-qe.tileID.overscaledZ),st=U.style.map.terrain?(ft,vt)=>U.style.map.terrain.getElevation(Ne,ft,vt):null,qt=pe.translatePosition(le,qe,te,Z);fa(Re,ke,ze,oe,le,ut,Ne.posMatrix,Ve,De,Be,pe,qt,Ne.toUnwrapped(),st)}}}(k,m,b,x,b.layout.get("text-rotation-alignment"),b.layout.get("text-pitch-alignment"),b.paint.get("text-translate"),b.paint.get("text-translate-anchor"),C),b.paint.get("icon-opacity").constantOr(1)!==0&&au(m,x,b,k,!1,b.paint.get("icon-translate"),b.paint.get("icon-translate-anchor"),b.layout.get("icon-rotation-alignment"),b.layout.get("icon-pitch-alignment"),b.layout.get("icon-keep-upright"),I,P),b.paint.get("text-opacity").constantOr(1)!==0&&au(m,x,b,k,!0,b.paint.get("text-translate"),b.paint.get("text-translate-anchor"),b.layout.get("text-rotation-alignment"),b.layout.get("text-pitch-alignment"),b.layout.get("text-keep-upright"),I,P),x.map.showCollisionBoxes&&(ks(m,x,b,k,!0),ks(m,x,b,k,!1))})(e,a,u,h,this.style.placement.variableOffsets);break;case"circle":(function(m,x,b,k){if(m.renderPass!=="translucent")return;let C=b.paint.get("circle-opacity"),I=b.paint.get("circle-stroke-width"),P=b.paint.get("circle-stroke-opacity"),F=!b.layout.get("circle-sort-key").isConstant();if(C.constantOr(1)===0&&(I.constantOr(1)===0||P.constantOr(1)===0))return;let U=m.context,$=U.gl,W=m.depthModeForSublayer(0,yt.ReadOnly),J=Nt.disabled,Y=m.colorModeForRenderPass(),te=[];for(let Z=0;Z<k.length;Z++){let oe=k[Z],le=x.getTile(oe),pe=le.getBucket(b);if(!pe)continue;let ke=pe.programConfigurations.get(b.id),ze=m.useProgram("circle",ke),Ne=pe.layoutVertexBuffer,qe=pe.indexBuffer,Re=m.style.map.terrain&&m.style.map.terrain.getTerrainData(oe),De={programConfiguration:ke,program:ze,layoutVertexBuffer:Ne,indexBuffer:qe,uniformValues:Jf(m,oe,le,b),terrainData:Re};if(F){let Xe=pe.segments.get();for(let ut of Xe)te.push({segments:new s.a0([ut]),sortKey:ut.sortKey,state:De})}else te.push({segments:pe.segments,sortKey:0,state:De})}F&&te.sort((Z,oe)=>Z.sortKey-oe.sortKey);for(let Z of te){let{programConfiguration:oe,program:le,layoutVertexBuffer:pe,indexBuffer:ke,uniformValues:ze,terrainData:Ne}=Z.state;le.draw(U,$.TRIANGLES,W,J,Y,Dt.disabled,ze,Ne,b.id,pe,ke,Z.segments,b.paint,m.transform.zoom,oe)}})(e,a,u,h);break;case"heatmap":(function(m,x,b,k){if(b.paint.get("heatmap-opacity")===0)return;let C=m.context;if(m.style.map.terrain){for(let I of k){let P=x.getTile(I);x.hasRenderableParent(I)||(m.renderPass==="offscreen"?lu(m,P,b,I):m.renderPass==="translucent"&&Bo(m,b,I))}C.viewport.set([0,0,m.width,m.height])}else m.renderPass==="offscreen"?function(I,P,F,U){let $=I.context,W=$.gl,J=Nt.disabled,Y=new ri([W.ONE,W.ONE],s.aM.transparent,[!0,!0,!0,!0]);(function(te,Z,oe){let le=te.gl;te.activeTexture.set(le.TEXTURE1),te.viewport.set([0,0,Z.width/4,Z.height/4]);let pe=oe.heatmapFbos.get(s.aU);pe?(le.bindTexture(le.TEXTURE_2D,pe.colorAttachment.get()),te.bindFramebuffer.set(pe.framebuffer)):(pe=Es(te,Z.width/4,Z.height/4),oe.heatmapFbos.set(s.aU,pe))})($,I,F),$.clear({color:s.aM.transparent});for(let te=0;te<U.length;te++){let Z=U[te];if(P.hasRenderableParent(Z))continue;let oe=P.getTile(Z),le=oe.getBucket(F);if(!le)continue;let pe=le.programConfigurations.get(F.id),ke=I.useProgram("heatmap",pe),{zoom:ze}=I.transform;ke.draw($,W.TRIANGLES,yt.disabled,J,Y,Dt.disabled,er(Z.posMatrix,oe,ze,F.paint.get("heatmap-intensity")),null,F.id,le.layoutVertexBuffer,le.indexBuffer,le.segments,F.paint,I.transform.zoom,pe)}$.viewport.set([0,0,I.width,I.height])}(m,x,b,k):m.renderPass==="translucent"&&function(I,P){let F=I.context,U=F.gl;F.setColorMode(I.colorModeForRenderPass());let $=P.heatmapFbos.get(s.aU);$&&(F.activeTexture.set(U.TEXTURE0),U.bindTexture(U.TEXTURE_2D,$.colorAttachment.get()),F.activeTexture.set(U.TEXTURE1),Ts(F,P).bind(U.LINEAR,U.CLAMP_TO_EDGE),I.useProgram("heatmapTexture").draw(F,U.TRIANGLES,yt.disabled,Nt.disabled,I.colorModeForRenderPass(),Dt.disabled,pl(I,P,0,1),null,P.id,I.viewportBuffer,I.quadTriangleIndexBuffer,I.viewportSegments,P.paint,I.transform.zoom))}(m,b)})(e,a,u,h);break;case"line":(function(m,x,b,k){if(m.renderPass!=="translucent")return;let C=b.paint.get("line-opacity"),I=b.paint.get("line-width");if(C.constantOr(1)===0||I.constantOr(1)===0)return;let P=m.depthModeForSublayer(0,yt.ReadOnly),F=m.colorModeForRenderPass(),U=b.paint.get("line-dasharray"),$=b.paint.get("line-pattern"),W=$.constantOr(1),J=b.paint.get("line-gradient"),Y=b.getCrossfadeParameters(),te=W?"linePattern":U?"lineSDF":J?"lineGradient":"line",Z=m.context,oe=Z.gl,le=!0;for(let pe of k){let ke=x.getTile(pe);if(W&&!ke.patternsLoaded())continue;let ze=ke.getBucket(b);if(!ze)continue;let Ne=ze.programConfigurations.get(b.id),qe=m.context.program.get(),Re=m.useProgram(te,Ne),De=le||Re.program!==qe,Xe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(pe),ut=$.constantOr(null);if(ut&&ke.imageAtlas){let st=ke.imageAtlas,qt=st.patternPositions[ut.to.toString()],ft=st.patternPositions[ut.from.toString()];qt&&ft&&Ne.setConstantPatternPositions(qt,ft)}let Be=Xe?pe:null,Ve=W?da(m,ke,b,Y,Be):U?Yf(m,ke,b,U,Y,Be):J?rd(m,ke,b,ze.lineClipsArray.length,Be):ml(m,ke,b,Be);if(W)Z.activeTexture.set(oe.TEXTURE0),ke.imageAtlasTexture.bind(oe.LINEAR,oe.CLAMP_TO_EDGE),Ne.updatePaintBuffers(Y);else if(U&&(De||m.lineAtlas.dirty))Z.activeTexture.set(oe.TEXTURE0),m.lineAtlas.bind(Z);else if(J){let st=ze.gradients[b.id],qt=st.texture;if(b.gradientVersion!==st.version){let ft=256;if(b.stepInterpolant){let vt=x.getSource().maxzoom,$t=pe.canonical.z===vt?Math.ceil(1<<m.transform.maxZoom-pe.canonical.z):1;ft=s.ac(s.aV(ze.maxLineLength/s.X*1024*$t),256,Z.maxTextureSize)}st.gradient=s.aW({expression:b.gradientExpression(),evaluationKey:"lineProgress",resolution:ft,image:st.gradient||void 0,clips:ze.lineClipsArray}),st.texture?st.texture.update(st.gradient):st.texture=new ct(Z,st.gradient,oe.RGBA),st.version=b.gradientVersion,qt=st.texture}Z.activeTexture.set(oe.TEXTURE0),qt.bind(b.stepInterpolant?oe.NEAREST:oe.LINEAR,oe.CLAMP_TO_EDGE)}Re.draw(Z,oe.TRIANGLES,P,m.stencilModeForClipping(pe),F,Dt.disabled,Ve,Xe,b.id,ze.layoutVertexBuffer,ze.indexBuffer,ze.segments,b.paint,m.transform.zoom,Ne,ze.layoutVertexBuffer2),le=!1}})(e,a,u,h);break;case"fill":(function(m,x,b,k){let C=b.paint.get("fill-color"),I=b.paint.get("fill-opacity");if(I.constantOr(1)===0)return;let P=m.colorModeForRenderPass(),F=b.paint.get("fill-pattern"),U=m.opaquePassEnabledForLayer()&&!F.constantOr(1)&&C.constantOr(s.aM.transparent).a===1&&I.constantOr(0)===1?"opaque":"translucent";if(m.renderPass===U){let $=m.depthModeForSublayer(1,m.renderPass==="opaque"?yt.ReadWrite:yt.ReadOnly);Cs(m,x,b,k,$,P,!1)}if(m.renderPass==="translucent"&&b.paint.get("fill-antialias")){let $=m.depthModeForSublayer(b.getPaintProperty("fill-outline-color")?2:0,yt.ReadOnly);Cs(m,x,b,k,$,P,!0)}})(e,a,u,h);break;case"fill-extrusion":(function(m,x,b,k){let C=b.paint.get("fill-extrusion-opacity");if(C!==0&&m.renderPass==="translucent"){let I=new yt(m.context.gl.LEQUAL,yt.ReadWrite,m.depthRangeFor3D);if(C!==1||b.paint.get("fill-extrusion-pattern").constantOr(1))bl(m,x,b,k,I,Nt.disabled,ri.disabled),bl(m,x,b,k,I,m.stencilModeFor3D(),m.colorModeForRenderPass());else{let P=m.colorModeForRenderPass();bl(m,x,b,k,I,Nt.disabled,P)}}})(e,a,u,h);break;case"hillshade":(function(m,x,b,k){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent")return;let C=m.context,I=m.depthModeForSublayer(0,yt.ReadOnly),P=m.colorModeForRenderPass(),[F,U]=m.renderPass==="translucent"?m.stencilConfigForOverlap(k):[{},k];for(let $ of U){let W=x.getTile($);W.needsHillshadePrepare!==void 0&&W.needsHillshadePrepare&&m.renderPass==="offscreen"?ya(m,W,b,I,Nt.disabled,P):m.renderPass==="translucent"&&ga(m,$,W,b,I,F[$.overscaledZ],P)}C.viewport.set([0,0,m.width,m.height])})(e,a,u,h);break;case"raster":(function(m,x,b,k){if(m.renderPass!=="translucent"||b.paint.get("raster-opacity")===0||!k.length)return;let C=m.context,I=C.gl,P=x.getSource(),F=m.useProgram("raster"),U=m.colorModeForRenderPass(),[$,W]=P instanceof Bn?[{},k]:m.stencilConfigForOverlap(k),J=W[W.length-1].overscaledZ,Y=!m.options.moving;for(let te of W){let Z=m.depthModeForSublayer(te.overscaledZ-J,b.paint.get("raster-opacity")===1?yt.ReadWrite:yt.ReadOnly,I.LESS),oe=x.getTile(te);oe.registerFadeDuration(b.paint.get("raster-fade-duration"));let le=x.findLoadedParent(te,0),pe=x.findLoadedSibling(te),ke=vd(oe,le||pe||null,x,b,m.transform,m.style.map.terrain),ze,Ne,qe=b.paint.get("raster-resampling")==="nearest"?I.NEAREST:I.LINEAR;C.activeTexture.set(I.TEXTURE0),oe.texture.bind(qe,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),C.activeTexture.set(I.TEXTURE1),le?(le.texture.bind(qe,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),ze=Math.pow(2,le.tileID.overscaledZ-oe.tileID.overscaledZ),Ne=[oe.tileID.canonical.x*ze%1,oe.tileID.canonical.y*ze%1]):oe.texture.bind(qe,I.CLAMP_TO_EDGE,I.LINEAR_MIPMAP_NEAREST),oe.texture.useMipmap&&C.extTextureFilterAnisotropic&&m.transform.pitch>20&&I.texParameterf(I.TEXTURE_2D,C.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,C.extTextureFilterAnisotropicMax);let Re=m.style.map.terrain&&m.style.map.terrain.getTerrainData(te),De=Re?te:null,Xe=De?De.posMatrix:m.transform.calculatePosMatrix(te.toUnwrapped(),Y),ut=Qf(Xe,Ne||[0,0],ze||1,ke,b);P instanceof Bn?F.draw(C,I.TRIANGLES,Z,Nt.disabled,U,Dt.disabled,ut,Re,b.id,P.boundsBuffer,m.quadTriangleIndexBuffer,P.boundsSegments):F.draw(C,I.TRIANGLES,Z,$[te.overscaledZ],U,Dt.disabled,ut,Re,b.id,m.rasterBoundsBuffer,m.quadTriangleIndexBuffer,m.rasterBoundsSegments)}})(e,a,u,h);break;case"background":(function(m,x,b,k){let C=b.paint.get("background-color"),I=b.paint.get("background-opacity");if(I===0)return;let P=m.context,F=P.gl,U=m.transform,$=U.tileSize,W=b.paint.get("background-pattern");if(m.isPatternMissing(W))return;let J=!W&&C.a===1&&I===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==J)return;let Y=Nt.disabled,te=m.depthModeForSublayer(0,J==="opaque"?yt.ReadWrite:yt.ReadOnly),Z=m.colorModeForRenderPass(),oe=m.useProgram(W?"backgroundPattern":"background"),le=k||U.coveringTiles({tileSize:$,terrain:m.style.map.terrain});W&&(P.activeTexture.set(F.TEXTURE0),m.imageManager.bind(m.context));let pe=b.getCrossfadeParameters();for(let ke of le){let ze=k?ke.posMatrix:m.transform.calculatePosMatrix(ke.toUnwrapped()),Ne=W?Xc(ze,I,m,W,{tileID:ke,tileSize:$},pe):gl(ze,I,C),qe=m.style.map.terrain&&m.style.map.terrain.getTerrainData(ke);oe.draw(P,F.TRIANGLES,te,Y,Z,Dt.disabled,Ne,qe,b.id,m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}})(e,0,u,h);break;case"custom":(function(m,x,b){let k=m.context,C=b.implementation;if(m.renderPass==="offscreen"){let I=C.prerender;I&&(m.setCustomLayerDefaults(),k.setColorMode(m.colorModeForRenderPass()),I.call(C,k.gl,m.transform.customLayerMatrix()),k.setDirty(),m.setBaseState())}else if(m.renderPass==="translucent"){m.setCustomLayerDefaults(),k.setColorMode(m.colorModeForRenderPass()),k.setStencilMode(Nt.disabled);let I=C.renderingMode==="3d"?new yt(m.context.gl.LEQUAL,yt.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,yt.ReadOnly);k.setDepthMode(I),C.render(k.gl,m.transform.customLayerMatrix(),{farZ:m.transform.farZ,nearZ:m.transform.nearZ,fov:m.transform._fov,modelViewProjectionMatrix:m.transform.modelViewProjectionMatrix,projectionMatrix:m.transform.projectionMatrix}),k.setDirty(),m.setBaseState(),k.bindFramebuffer.set(null)}})(e,0,u)}}translatePosMatrix(e,a,u,h,m){if(!u[0]&&!u[1])return e;let x=m?h==="map"?this.transform.angle:0:h==="viewport"?-this.transform.angle:0;if(x){let C=Math.sin(x),I=Math.cos(x);u=[u[0]*I-u[1]*C,u[0]*C+u[1]*I]}let b=[m?u[0]:_t(a,u[0],this.transform.zoom),m?u[1]:_t(a,u[1],this.transform.zoom),0],k=new Float32Array(16);return s.J(k,e,b),k}saveTileTexture(e){let a=this._tileTextures[e.size[0]];a?a.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){let a=this._tileTextures[e];return a&&a.length>0?a.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;let a=this.imageManager.getPattern(e.from.toString()),u=this.imageManager.getPattern(e.to.toString());return!a||!u}useProgram(e,a){this.cache=this.cache||{};let u=e+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[u]||(this.cache[u]=new Gc(this.context,so[e],a,Kc[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[u]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new ct(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:e,drawingBufferHeight:a}=this.context.gl;return this.width!==e||this.height!==a}}class va{constructor(e,a){this.points=e,this.planes=a}static fromInvProjectionMatrix(e,a,u){let h=Math.pow(2,u),m=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(b=>{let k=1/(b=s.af([],b,e))[3]/a*h;return s.b1(b,b,[k,k,1/b[3],k])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(b=>{let k=function(F,U){var $=U[0],W=U[1],J=U[2],Y=$*$+W*W+J*J;return Y>0&&(Y=1/Math.sqrt(Y)),F[0]=U[0]*Y,F[1]=U[1]*Y,F[2]=U[2]*Y,F}([],function(F,U,$){var W=U[0],J=U[1],Y=U[2],te=$[0],Z=$[1],oe=$[2];return F[0]=J*oe-Y*Z,F[1]=Y*te-W*oe,F[2]=W*Z-J*te,F}([],Ie([],m[b[0]],m[b[1]]),Ie([],m[b[2]],m[b[1]]))),C=-((I=k)[0]*(P=m[b[1]])[0]+I[1]*P[1]+I[2]*P[2]);var I,P;return k.concat(C)});return new va(m,x)}}class xa{constructor(e,a){this.min=e,this.max=a,this.center=function(u,h,m){return u[0]=.5*h[0],u[1]=.5*h[1],u[2]=.5*h[2],u}([],function(u,h,m){return u[0]=h[0]+m[0],u[1]=h[1]+m[1],u[2]=h[2]+m[2],u}([],this.min,this.max))}quadrant(e){let a=[e%2==0,e<2],u=ae(this.min),h=ae(this.max);for(let m=0;m<a.length;m++)u[m]=a[m]?this.min[m]:this.center[m],h[m]=a[m]?this.center[m]:this.max[m];return h[2]=this.max[2],new xa(u,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){let a=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]],u=!0;for(let h=0;h<e.planes.length;h++){let m=e.planes[h],x=0;for(let b=0;b<a.length;b++)s.b2(m,a[b])>=0&&x++;if(x===0)return 0;x!==a.length&&(u=!1)}if(u)return 2;for(let h=0;h<3;h++){let m=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let b=0;b<e.points.length;b++){let k=e.points[b][h]-this.min[h];m=Math.min(m,k),x=Math.max(x,k)}if(x<0||m>this.max[h]-this.min[h])return 0}return 1}}class wa{constructor(e=0,a=0,u=0,h=0){if(isNaN(e)||e<0||isNaN(a)||a<0||isNaN(u)||u<0||isNaN(h)||h<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=a,this.left=u,this.right=h}interpolate(e,a,u){return a.top!=null&&e.top!=null&&(this.top=s.y.number(e.top,a.top,u)),a.bottom!=null&&e.bottom!=null&&(this.bottom=s.y.number(e.bottom,a.bottom,u)),a.left!=null&&e.left!=null&&(this.left=s.y.number(e.left,a.left,u)),a.right!=null&&e.right!=null&&(this.right=s.y.number(e.right,a.right,u)),this}getCenter(e,a){let u=s.ac((this.left+e-this.right)/2,0,e),h=s.ac((this.top+a-this.bottom)/2,0,a);return new s.P(u,h)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new wa(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}let uu=85.051129;class ba{constructor(e,a,u,h,m){this.tileSize=512,this._renderWorldCopies=m===void 0||!!m,this._minZoom=e||0,this._maxZoom=a||22,this._minPitch=u??0,this._maxPitch=h??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new s.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new wa,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){let e=new ba(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.lngRange=e.lngRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){let a=-s.b3(e,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=function(){var u=new s.A(4);return s.A!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u}(),function(u,h,m){var x=h[0],b=h[1],k=h[2],C=h[3],I=Math.sin(m),P=Math.cos(m);u[0]=x*P+k*I,u[1]=b*P+C*I,u[2]=x*-I+k*P,u[3]=b*-I+C*P}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){let a=s.ac(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){let a=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.tileZoom=Math.max(0,Math.floor(a)),this.scale=this.zoomScale(a),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,a,u){this._unmodified=!1,this._edgeInsets.interpolate(e,a,u),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){let a=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(e){let a=[new s.b4(0,e)];if(this._renderWorldCopies){let u=this.pointCoordinate(new s.P(0,0)),h=this.pointCoordinate(new s.P(this.width,0)),m=this.pointCoordinate(new s.P(this.width,this.height)),x=this.pointCoordinate(new s.P(0,this.height)),b=Math.floor(Math.min(u.x,h.x,m.x,x.x)),k=Math.floor(Math.max(u.x,h.x,m.x,x.x)),C=1;for(let I=b-C;I<=k+C;I++)I!==0&&a.push(new s.b4(I,e))}return a}coveringTiles(e){var a,u;let h=this.coveringZoomLevel(e),m=h;if(e.minzoom!==void 0&&h<e.minzoom)return[];e.maxzoom!==void 0&&h>e.maxzoom&&(h=e.maxzoom);let x=this.pointCoordinate(this.getCameraPoint()),b=s.Z.fromLngLat(this.center),k=Math.pow(2,h),C=[k*x.x,k*x.y,0],I=[k*b.x,k*b.y,0],P=va.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,h),F=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(F=h);let U=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,$=Z=>({aabb:new xa([Z*k,0,0],[(Z+1)*k,k,0]),zoom:0,x:0,y:0,wrap:Z,fullyVisible:!1}),W=[],J=[],Y=h,te=e.reparseOverscaled?m:h;if(this._renderWorldCopies)for(let Z=1;Z<=3;Z++)W.push($(-Z)),W.push($(Z));for(W.push($(0));W.length>0;){let Z=W.pop(),oe=Z.x,le=Z.y,pe=Z.fullyVisible;if(!pe){let Re=Z.aabb.intersects(P);if(Re===0)continue;pe=Re===2}let ke=e.terrain?C:I,ze=Z.aabb.distanceX(ke),Ne=Z.aabb.distanceY(ke),qe=Math.max(Math.abs(ze),Math.abs(Ne));if(Z.zoom===Y||qe>U+(1<<Y-Z.zoom)-2&&Z.zoom>=F){let Re=Y-Z.zoom,De=C[0]-.5-(oe<<Re),Xe=C[1]-.5-(le<<Re);J.push({tileID:new s.S(Z.zoom===Y?te:Z.zoom,Z.wrap,Z.zoom,oe,le),distanceSq:Ye([I[0]-.5-oe,I[1]-.5-le]),tileDistanceToCamera:Math.sqrt(De*De+Xe*Xe)})}else for(let Re=0;Re<4;Re++){let De=(oe<<1)+Re%2,Xe=(le<<1)+(Re>>1),ut=Z.zoom+1,Be=Z.aabb.quadrant(Re);if(e.terrain){let Ve=new s.S(ut,Z.wrap,ut,De,Xe),st=e.terrain.getMinMaxElevation(Ve),qt=(a=st.minElevation)!==null&&a!==void 0?a:this.elevation,ft=(u=st.maxElevation)!==null&&u!==void 0?u:this.elevation;Be=new xa([Be.min[0],Be.min[1],qt],[Be.max[0],Be.max[1],ft])}W.push({aabb:Be,zoom:ut,x:De,y:Xe,wrap:Z.wrap,fullyVisible:pe})}}return J.sort((Z,oe)=>Z.distanceSq-oe.distanceSq).map(Z=>Z.tileID)}resize(e,a){this.width=e,this.height=a,this.pixelsToGLUnits=[2/e,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){let a=s.ac(e.lat,-85.051129,uu);return new s.P(s.O(e.lng)*this.worldSize,s.Q(a)*this.worldSize)}unproject(e){return new s.Z(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(e){let a=this.elevation,u=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,h=this.pointLocation(this.centerPoint,e),m=e.getElevationForLngLatZoom(h,this.tileZoom);if(!(this.elevation-m))return;let x=u+a-m,b=Math.cos(this._pitch)*this.cameraToCenterDistance/x/s.b5(1,h.lat),k=this.scaleZoom(b/this.tileSize);this._elevation=m,this._center=h,this.zoom=k}setLocationAtPoint(e,a){let u=this.pointCoordinate(a),h=this.pointCoordinate(this.centerPoint),m=this.locationCoordinate(e),x=new s.Z(m.x-(u.x-h.x),m.y-(u.y-h.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,a){return a?this.coordinatePoint(this.locationCoordinate(e),a.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,a){return this.coordinateLocation(this.pointCoordinate(e,a))}locationCoordinate(e){return s.Z.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,a){if(a){let F=a.pointCoordinate(e);if(F!=null)return F}let u=[e.x,e.y,0,1],h=[e.x,e.y,1,1];s.af(u,u,this.pixelMatrixInverse),s.af(h,h,this.pixelMatrixInverse);let m=u[3],x=h[3],b=u[1]/m,k=h[1]/x,C=u[2]/m,I=h[2]/x,P=C===I?0:(0-C)/(I-C);return new s.Z(s.y.number(u[0]/m,h[0]/x,P)/this.worldSize,s.y.number(b,k,P)/this.worldSize)}coordinatePoint(e,a=0,u=this.pixelMatrix){let h=[e.x*this.worldSize,e.y*this.worldSize,a,1];return s.af(h,h,u),new s.P(h[0]/h[3],h[1]/h[3])}getBounds(){let e=Math.max(0,this.height/2-this.getHorizon());return new ye().extend(this.pointLocation(new s.P(0,e))).extend(this.pointLocation(new s.P(this.width,e))).extend(this.pointLocation(new s.P(this.width,this.height))).extend(this.pointLocation(new s.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new ye([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,uu])}calculateTileMatrix(e){let a=e.canonical,u=this.worldSize/this.zoomScale(a.z),h=a.x+Math.pow(2,a.z)*e.wrap,m=s.an(new Float64Array(16));return s.J(m,m,[h*u,a.y*u,0]),s.K(m,m,[u/s.X,u/s.X,1]),m}calculatePosMatrix(e,a=!1){let u=e.key,h=a?this._alignedPosMatrixCache:this._posMatrixCache;if(h[u])return h[u];let m=this.calculateTileMatrix(e);return s.L(m,a?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,m),h[u]=new Float32Array(m),h[u]}calculateFogMatrix(e){let a=e.key,u=this._fogMatrixCache;if(u[a])return u[a];let h=this.calculateTileMatrix(e);return s.L(h,this.fogMatrix,h),u[a]=new Float32Array(h),u[a]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,a){a=s.ac(+a,this.minZoom,this.maxZoom);let u={center:new s.N(e.lng,e.lat),zoom:a},h=this.lngRange;if(!this._renderWorldCopies&&h===null){let Z=179.9999999999;h=[-Z,Z]}let m=this.tileSize*this.zoomScale(u.zoom),x=0,b=m,k=0,C=m,I=0,P=0,{x:F,y:U}=this.size;if(this.latRange){let Z=this.latRange;x=s.Q(Z[1])*m,b=s.Q(Z[0])*m,b-x<U&&(I=U/(b-x))}h&&(k=s.b3(s.O(h[0])*m,0,m),C=s.b3(s.O(h[1])*m,0,m),C<k&&(C+=m),C-k<F&&(P=F/(C-k)));let{x:$,y:W}=this.project.call({worldSize:m},e),J,Y,te=Math.max(P||0,I||0);if(te){let Z=new s.P(P?(C+k)/2:$,I?(b+x)/2:W);return u.center=this.unproject.call({worldSize:m},Z).wrap(),u.zoom+=this.scaleZoom(te),u}if(this.latRange){let Z=U/2;W-Z<x&&(Y=x+Z),W+Z>b&&(Y=b-Z)}if(h){let Z=(k+C)/2,oe=$;this._renderWorldCopies&&(oe=s.b3($,Z-m/2,Z+m/2));let le=F/2;oe-le<k&&(J=k+le),oe+le>C&&(J=C-le)}if(J!==void 0||Y!==void 0){let Z=new s.P(J??$,Y??W);u.center=this.unproject.call({worldSize:m},Z).wrap()}return u}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let e=this._unmodified,{center:a,zoom:u}=this.getConstrained(this.center,this.zoom);this.center=a,this.zoom=u,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;let e=this.centerOffset,a=this.point.x,u=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=s.b5(1,this.center.lat)*this.worldSize;let h=s.an(new Float64Array(16));s.K(h,h,[this.width/2,-this.height/2,1]),s.J(h,h,[1,-1,0]),this.labelPlaneMatrix=h,h=s.an(new Float64Array(16)),s.K(h,h,[1,-1,1]),s.J(h,h,[-1,-1,0]),s.K(h,h,[2/this.width,2/this.height,1]),this.glCoordMatrix=h;let m=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),x=Math.min(this.elevation,this.minElevationForCurrentTile),b=m-x*this._pixelPerMeter/Math.cos(this._pitch),k=x<0?b:m,C=Math.PI/2+this._pitch,I=this._fov*(.5+e.y/this.height),P=Math.sin(I)*k/Math.sin(s.ac(Math.PI-C-I,.01,Math.PI-.01)),F=this.getHorizon(),U=2*Math.atan(F/this.cameraToCenterDistance)*(.5+e.y/(2*F)),$=Math.sin(U)*k/Math.sin(s.ac(Math.PI-C-U,.01,Math.PI-.01)),W=Math.min(P,$);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*W+k),this.nearZ=this.height/50,h=new Float64Array(16),s.b6(h,this._fov,this.width/this.height,this.nearZ,this.farZ),h[8]=2*-e.x/this.width,h[9]=2*e.y/this.height,this.projectionMatrix=s.ae(h),s.K(h,h,[1,-1,1]),s.J(h,h,[0,0,-this.cameraToCenterDistance]),s.b7(h,h,this._pitch),s.ad(h,h,this.angle),s.J(h,h,[-a,-u,0]),this.mercatorMatrix=s.K([],h,[this.worldSize,this.worldSize,this.worldSize]),s.K(h,h,[1,1,this._pixelPerMeter]),this.pixelMatrix=s.L(new Float64Array(16),this.labelPlaneMatrix,h),s.J(h,h,[0,0,-this.elevation]),this.modelViewProjectionMatrix=h,this.invModelViewProjectionMatrix=s.as([],h),this.fogMatrix=new Float64Array(16),s.b6(this.fogMatrix,this._fov,this.width/this.height,m,this.farZ),this.fogMatrix[8]=2*-e.x/this.width,this.fogMatrix[9]=2*e.y/this.height,s.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),s.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),s.b7(this.fogMatrix,this.fogMatrix,this._pitch),s.ad(this.fogMatrix,this.fogMatrix,this.angle),s.J(this.fogMatrix,this.fogMatrix,[-a,-u,0]),s.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),s.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=s.L(new Float64Array(16),this.labelPlaneMatrix,h);let J=this.width%2/2,Y=this.height%2/2,te=Math.cos(this.angle),Z=Math.sin(this.angle),oe=a-Math.round(a)+te*J+Z*Y,le=u-Math.round(u)+te*Y+Z*J,pe=new Float64Array(h);if(s.J(pe,pe,[oe>.5?oe-1:oe,le>.5?le-1:le,0]),this.alignedModelViewProjectionMatrix=pe,h=s.as(new Float64Array(16),this.pixelMatrix),!h)throw new Error("failed to invert matrix");this.pixelMatrixInverse=h,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;let e=this.pointCoordinate(new s.P(0,0)),a=[e.x*this.worldSize,e.y*this.worldSize,0,1];return s.af(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){let e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(0,e))}getCameraQueryGeometry(e){let a=this.getCameraPoint();if(e.length===1)return[e[0],a];{let u=a.x,h=a.y,m=a.x,x=a.y;for(let b of e)u=Math.min(u,b.x),h=Math.min(h,b.y),m=Math.max(m,b.x),x=Math.max(x,b.y);return[new s.P(u,h),new s.P(m,h),new s.P(m,x),new s.P(u,x),new s.P(u,h)]}}lngLatToCameraDepth(e,a){let u=this.locationCoordinate(e),h=[u.x*this.worldSize,u.y*this.worldSize,a,1];return s.af(h,h,this.modelViewProjectionMatrix),h[2]/h[3]}}function zs(g,e){let a,u=!1,h=null,m=null,x=()=>{h=null,u&&(g.apply(m,a),h=setTimeout(x,e),u=!1)};return(...b)=>(u=!0,m=this,a=b,h||x(),h)}class Cl{constructor(e){this._getCurrentHash=()=>{let a=window.location.hash.replace("#","");if(this._hashName){let u;return a.split("&").map(h=>h.split("=")).forEach(h=>{h[0]===this._hashName&&(u=h)}),(u&&u[1]||"").split("/")}return a.split("/")},this._onHashChange=()=>{let a=this._getCurrentHash();if(a.length>=3&&!a.some(u=>isNaN(u))){let u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(a[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:u,pitch:+(a[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{let a=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,a)},this._removeHash=()=>{let a=this._getCurrentHash();if(a.length===0)return;let u=a.join("/"),h=u;h.split("&").length>0&&(h=h.split("&")[0]),this._hashName&&(h=`${this._hashName}=${u}`);let m=window.location.hash.replace(h,"");m.startsWith("#&")?m=m.slice(0,1)+m.slice(2):m==="#"&&(m="");let x=window.location.href.replace(/(#.+)?$/,m);x=x.replace("&&","&"),window.history.replaceState(window.history.state,null,x)},this._updateHash=zs(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){let a=this._map.getCenter(),u=Math.round(100*this._map.getZoom())/100,h=Math.ceil((u*Math.LN2+Math.log(512/360/.5))/Math.LN10),m=Math.pow(10,h),x=Math.round(a.lng*m)/m,b=Math.round(a.lat*m)/m,k=this._map.getBearing(),C=this._map.getPitch(),I="";if(I+=e?`/${x}/${b}/${u}`:`${u}/${b}/${x}`,(k||C)&&(I+="/"+Math.round(10*k)/10),C&&(I+=`/${Math.round(C)}`),this._hashName){let P=this._hashName,F=!1,U=window.location.hash.slice(1).split("&").map($=>{let W=$.split("=")[0];return W===P?(F=!0,`${W}=${I}`):$}).filter($=>$);return F||U.push(`${P}=${I}`),`#${U.join("&")}`}return`#${I}`}}let zl={linearity:.3,easing:s.b8(0,0,.3,1)},hu=s.e({deceleration:2500,maxSpeed:1400},zl),dm=s.e({deceleration:20,maxSpeed:1400},zl),Sd=s.e({deceleration:1e3,maxSpeed:360},zl),Il=s.e({deceleration:1e3,maxSpeed:90},zl);class du{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:B.now(),settings:e})}_drainInertiaBuffer(){let e=this._inertiaBuffer,a=B.now();for(;e.length>0&&a-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let a={zoom:0,bearing:0,pitch:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:m}of this._inertiaBuffer)a.zoom+=m.zoomDelta||0,a.bearing+=m.bearingDelta||0,a.pitch+=m.pitchDelta||0,m.panDelta&&a.pan._add(m.panDelta),m.around&&(a.around=m.around),m.pinchAround&&(a.pinchAround=m.pinchAround);let u=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,h={};if(a.pan.mag()){let m=Ps(a.pan.mag(),u,s.e({},hu,e||{}));h.offset=a.pan.mult(m.amount/a.pan.mag()),h.center=this._map.transform.center,Is(h,m)}if(a.zoom){let m=Ps(a.zoom,u,dm);h.zoom=this._map.transform.zoom+m.amount,Is(h,m)}if(a.bearing){let m=Ps(a.bearing,u,Sd);h.bearing=this._map.transform.bearing+s.ac(m.amount,-179,179),Is(h,m)}if(a.pitch){let m=Ps(a.pitch,u,Il);h.pitch=this._map.transform.pitch+m.amount,Is(h,m)}if(h.zoom||h.bearing){let m=a.pinchAround===void 0?a.around:a.pinchAround;h.around=m?this._map.unproject(m):this._map.getCenter()}return this.clear(),s.e(h,{noMoveStart:!0})}}function Is(g,e){(!g.duration||g.duration<e.duration)&&(g.duration=e.duration,g.easing=e.easing)}function Ps(g,e,a){let{maxSpeed:u,linearity:h,deceleration:m}=a,x=s.ac(g*h/(e/1e3),-u,u),b=Math.abs(x)/(m*h);return{easing:a.easing,duration:1e3*b,amount:x*(b/2)}}class Ai extends s.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,u,h={}){let m=j.mousePos(a.getCanvas(),u),x=a.unproject(m);super(e,s.e({point:m,lngLat:x,originalEvent:u},h)),this._defaultPrevented=!1,this.target=a}}class Oo extends s.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,u){let h=e==="touchend"?u.changedTouches:u.touches,m=j.touchPos(a.getCanvasContainer(),h),x=m.map(k=>a.unproject(k)),b=m.reduce((k,C,I,P)=>k.add(C.div(P.length)),new s.P(0,0));super(e,{points:m,point:b,lngLats:x,lngLat:a.unproject(b),originalEvent:u}),this._defaultPrevented=!1}}class Ed extends s.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,a,u){super(e,{originalEvent:u}),this._defaultPrevented=!1}}class Td{constructor(e,a){this._map=e,this._clickTolerance=a.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Ed(e.type,this._map,e))}mousedown(e,a){return this._mousedownPos=a,this._firePreventable(new Ai(e.type,this._map,e))}mouseup(e){this._map.fire(new Ai(e.type,this._map,e))}click(e,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new Ai(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Ai(e.type,this._map,e))}mouseover(e){this._map.fire(new Ai(e.type,this._map,e))}mouseout(e){this._map.fire(new Ai(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Oo(e.type,this._map,e))}touchmove(e){this._map.fire(new Oo(e.type,this._map,e))}touchend(e){this._map.fire(new Oo(e.type,this._map,e))}touchcancel(e){this._map.fire(new Oo(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ni{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Ai(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ai("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Ai(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Kr{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(s.P.convert(e),this._map.terrain)}}class _r{constructor(e,a){this._map=e,this._tr=new Kr(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,a){this.isEnabled()&&e.shiftKey&&e.button===0&&(j.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(e,a){if(!this._active)return;let u=a;if(this._lastPos.equals(u)||!this._box&&u.dist(this._startPos)<this._clickTolerance)return;let h=this._startPos;this._lastPos=u,this._box||(this._box=j.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));let m=Math.min(h.x,u.x),x=Math.max(h.x,u.x),b=Math.min(h.y,u.y),k=Math.max(h.y,u.y);j.setTransform(this._box,`translate(${m}px,${b}px)`),this._box.style.width=x-m+"px",this._box.style.height=k-b+"px"}mouseupWindow(e,a){if(!this._active||e.button!==0)return;let u=this._startPos,h=a;if(this.reset(),j.suppressClick(),u.x!==h.x||u.y!==h.y)return this._map.fire(new s.k("boxzoomend",{originalEvent:e})),{cameraAnimation:m=>m.fitScreenCoordinates(u,h,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(j.remove(this._box),this._box=null),j.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,a){return this._map.fire(new s.k(e,{originalEvent:a}))}}function Ms(g,e){if(g.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${g.length}, points ${e.length}`);let a={};for(let u=0;u<g.length;u++)a[g[u].identifier]=e[u];return a}class pu{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,a,u){(this.centroid||u.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),u.length===this.numTouches&&(this.centroid=function(h){let m=new s.P(0,0);for(let x of h)m._add(x);return m.div(h.length)}(a),this.touches=Ms(u,a)))}touchmove(e,a,u){if(this.aborted||!this.centroid)return;let h=Ms(u,a);for(let m in this.touches){let x=h[m];(!x||x.dist(this.touches[m])>30)&&(this.aborted=!0)}}touchend(e,a,u){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),u.length===0){let h=!this.aborted&&this.centroid;if(this.reset(),h)return h}}}class Pl{constructor(e){this.singleTap=new pu(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,a,u){this.singleTap.touchstart(e,a,u)}touchmove(e,a,u){this.singleTap.touchmove(e,a,u)}touchend(e,a,u){let h=this.singleTap.touchend(e,a,u);if(h){let m=e.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(h)<30;if(m&&x||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=h,this.count===this.numTaps)return this.reset(),h}}}class ka{constructor(e){this._tr=new Kr(e),this._zoomIn=new Pl({numTouches:1,numTaps:2}),this._zoomOut=new Pl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,a,u){this._zoomIn.touchstart(e,a,u),this._zoomOut.touchstart(e,a,u)}touchmove(e,a,u){this._zoomIn.touchmove(e,a,u),this._zoomOut.touchmove(e,a,u)}touchend(e,a,u){let h=this._zoomIn.touchend(e,a,u),m=this._zoomOut.touchend(e,a,u),x=this._tr;return h?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:x.zoom+1,around:x.unproject(h)},{originalEvent:e})}):m?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:b=>b.easeTo({duration:300,zoom:x.zoom-1,around:x.unproject(m)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class jn{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){let a=this._moveFunction(...e);if(a.bearingDelta||a.pitchDelta||a.around||a.panDelta)return this._active=!0,a}dragStart(e,a){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=a.length?a[0]:a,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,a){if(!this.isEnabled())return;let u=this._lastPoint;if(!u)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);let h=a.length?a[0]:a;return!this._moved&&h.dist(u)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=h,this._move(u,h))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&j.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}let fu={0:1,2:2};class Ml{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){let a=j.mouseButton(e);this._eventButton=a}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(a,u){let h=fu[u];return a.buttons===void 0||(a.buttons&h)!==h}(e,this._eventButton)}isValidEndEvent(e){return j.mouseButton(e)===this._eventButton}}class mu{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}let Al=g=>{g.mousedown=g.dragStart,g.mousemoveWindow=g.dragMove,g.mouseup=g.dragEnd,g.contextmenu=e=>{e.preventDefault()}},gu=({enable:g,clickTolerance:e,bearingDegreesPerPixelMoved:a=.8})=>{let u=new Ml({checkCorrectEvent:h=>j.mouseButton(h)===0&&h.ctrlKey||j.mouseButton(h)===2});return new jn({clickTolerance:e,move:(h,m)=>({bearingDelta:(m.x-h.x)*a}),moveStateManager:u,enable:g,assignEvents:Al})},yu=({enable:g,clickTolerance:e,pitchDegreesPerPixelMoved:a=-.5})=>{let u=new Ml({checkCorrectEvent:h=>j.mouseButton(h)===0&&h.ctrlKey||j.mouseButton(h)===2});return new jn({clickTolerance:e,move:(h,m)=>({pitchDelta:(m.y-h.y)*a}),moveStateManager:u,enable:g,assignEvents:Al})};class No{constructor(e,a){this._clickTolerance=e.clickTolerance||1,this._map=a,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,a,u){return this._calculateTransform(e,a,u)}touchmove(e,a,u){if(this._active){if(!this._shouldBePrevented(u.length))return e.preventDefault(),this._calculateTransform(e,a,u);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,a,u){this._calculateTransform(e,a,u),this._active&&this._shouldBePrevented(u.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,a,u){u.length>0&&(this._active=!0);let h=Ms(u,a),m=new s.P(0,0),x=new s.P(0,0),b=0;for(let C in h){let I=h[C],P=this._touches[C];P&&(m._add(I),x._add(I.sub(P)),b++,h[C]=I)}if(this._touches=h,this._shouldBePrevented(b)||!x.mag())return;let k=x.div(b);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:m.div(b),panDelta:k}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ll{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,a,u){this._firstTwoTouches||u.length<2||(this._firstTwoTouches=[u[0].identifier,u[1].identifier],this._start([a[0],a[1]]))}touchmove(e,a,u){if(!this._firstTwoTouches)return;e.preventDefault();let[h,m]=this._firstTwoTouches,x=As(u,a,h),b=As(u,a,m);if(!x||!b)return;let k=this._aroundCenter?null:x.add(b).div(2);return this._move([x,b],k,e)}touchend(e,a,u){if(!this._firstTwoTouches)return;let[h,m]=this._firstTwoTouches,x=As(u,a,h),b=As(u,a,m);x&&b||(this._active&&j.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function As(g,e,a){for(let u=0;u<g.length;u++)if(g[u].identifier===a)return e[u]}function _u(g,e){return Math.log(g/e)/Math.LN2}class vu extends Ll{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,a){let u=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(_u(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:_u(this._distance,u),pinchAround:a}}}function xu(g,e){return 180*g.angleWith(e)/Math.PI}class wu extends Ll{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,a,u){let h=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:xu(this._vector,h),pinchAround:a}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());let a=25/(Math.PI*this._minDiameter)*360,u=xu(e,this._startVector);return Math.abs(u)<a}}function Dl(g){return Math.abs(g.y)>Math.abs(g.x)}class Sa extends Ll{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,a,u){super.touchstart(e,a,u),this._currentTouchCount=u.length}_start(e){this._lastPoints=e,Dl(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,a,u){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;let h=e[0].sub(this._lastPoints[0]),m=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(h,m,u.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(h.y+m.y)/2*-.5}):void 0}gestureBeginsVertically(e,a,u){if(this._valid!==void 0)return this._valid;let h=e.mag()>=2,m=a.mag()>=2;if(!h&&!m)return;if(!h||!m)return this._firstMove===void 0&&(this._firstMove=u),u-this._firstMove<100&&void 0;let x=e.y>0==a.y>0;return Dl(e)&&Dl(a)&&x}}let Cd={panStep:100,bearingStep:15,pitchStep:10};class Mr{constructor(e){this._tr=new Kr(e);let a=Cd;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let a=0,u=0,h=0,m=0,x=0;switch(e.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:e.shiftKey?u=-1:(e.preventDefault(),m=-1);break;case 39:e.shiftKey?u=1:(e.preventDefault(),m=1);break;case 38:e.shiftKey?h=1:(e.preventDefault(),x=-1);break;case 40:e.shiftKey?h=-1:(e.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(u=0,h=0),{cameraAnimation:b=>{let k=this._tr;b.easeTo({duration:300,easeId:"keyboardHandler",easing:wn,zoom:a?Math.round(k.zoom)+a*(e.shiftKey?2:1):k.zoom,bearing:k.bearing+u*this._bearingStep,pitch:k.pitch+h*this._pitchStep,offset:[-m*this._panStep,-x*this._panStep],center:k.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function wn(g){return g*(2-g)}let bu=4.000244140625;class Jr{constructor(e,a){this._onTimeout=u=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(u)},this._map=e,this._tr=new Kr(e),this._triggerRenderFrame=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let a=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY,u=B.now(),h=u-(this._lastWheelEventTime||0);this._lastWheelEventTime=u,a!==0&&a%bu==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":h>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(h*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),e.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=e,this._delta-=a,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let a=j.mousePos(this._map.getCanvas(),e),u=this._tr;this._around=a.y>u.transform.height/2-u.transform.getHorizon()?s.N.convert(this._aroundCenter?u.center:u.unproject(a)):s.N.convert(u.center),this._aroundPoint=u.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let e=this._tr.transform;if(this._delta!==0){let k=this._type==="wheel"&&Math.abs(this._delta)>bu?this._wheelZoomRate:this._defaultZoomRate,C=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&C!==0&&(C=1/C);let I=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(I*C))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let a=typeof this._targetZoom=="number"?this._targetZoom:e.zoom,u=this._startZoom,h=this._easing,m,x=!1,b=B.now()-this._lastWheelEventTime;if(this._type==="wheel"&&u&&h&&b){let k=Math.min(b/200,1),C=h(k);m=s.y.number(u,a,C),k<1?this._frameId||(this._frameId=!0):x=!0}else m=a,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!x,zoomDelta:m-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let a=s.b9;if(this._prevEase){let u=this._prevEase,h=(B.now()-u.start)/u.duration,m=u.easing(h+.01)-u.easing(h),x=.27/Math.sqrt(m*m+1e-4)*.01,b=Math.sqrt(.0729-x*x);a=s.b8(x,b,.25,1)}return this._prevEase={start:B.now(),duration:e,easing:a},a}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class jo{constructor(e,a){this._clickZoom=e,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class pm{constructor(e){this._tr=new Kr(e),this.reset()}reset(){this._active=!1}dblclick(e,a){return e.preventDefault(),{cameraAnimation:u=>{u.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(a)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fm{constructor(){this._tap=new Pl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,a,u){if(!this._swipePoint)if(this._tapTime){let h=a[0],m=e.timeStamp-this._tapTime<500,x=this._tapPoint.dist(h)<30;m&&x?u.length>0&&(this._swipePoint=h,this._swipeTouch=u[0].identifier):this.reset()}else this._tap.touchstart(e,a,u)}touchmove(e,a,u){if(this._tapTime){if(this._swipePoint){if(u[0].identifier!==this._swipeTouch)return;let h=a[0],m=h.y-this._swipePoint.y;return this._swipePoint=h,e.preventDefault(),this._active=!0,{zoomDelta:m/128}}}else this._tap.touchmove(e,a,u)}touchend(e,a,u){if(this._tapTime)this._swipePoint&&u.length===0&&this.reset();else{let h=this._tap.touchend(e,a,u);h&&(this._tapTime=e.timeStamp,this._tapPoint=h)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zd{constructor(e,a,u){this._el=e,this._mousePan=a,this._touchPan=u}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Id{constructor(e,a,u){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=a,this._mousePitch=u}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ku{constructor(e,a,u,h){this._el=e,this._touchZoom=a,this._touchRotate=u,this._tapDragZoom=h,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class Ea{constructor(e,a){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=a,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;let e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=j.create("div","maplibregl-cooperative-gesture-screen",e);let a=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(a=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));let u=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),h=document.createElement("div");h.className="maplibregl-desktop-message",h.textContent=a,this._container.appendChild(h);let m=document.createElement("div");m.className="maplibregl-mobile-message",m.textContent=u,this._container.appendChild(m),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(j.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,a){this._enabled&&(this._map.fire(new s.k("cooperativegestureprevented",{gestureType:e,originalEvent:a})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}let Ar=g=>g.zoom||g.drag||g.pitch||g.rotate;class Ze extends s.k{}function Rl(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class Su{constructor(e,a){this.handleWindowEvent=h=>{this.handleEvent(h,`${h.type}Window`)},this.handleEvent=(h,m)=>{if(h.type==="blur")return void this.stop(!0);this._updatingCamera=!0;let x=h.type==="renderFrame"?void 0:h,b={needsRenderFrame:!1},k={},C={},I=h.touches,P=I?this._getMapTouches(I):void 0,F=P?j.touchPos(this._map.getCanvas(),P):j.mousePos(this._map.getCanvas(),h);for(let{handlerName:W,handler:J,allowed:Y}of this._handlers){if(!J.isEnabled())continue;let te;this._blockedByActive(C,Y,W)?J.reset():J[m||h.type]&&(te=J[m||h.type](h,F,P),this.mergeHandlerResult(b,k,te,W,x),te&&te.needsRenderFrame&&this._triggerRenderFrame()),(te||J.isActive())&&(C[W]=J)}let U={};for(let W in this._previousActiveHandlers)C[W]||(U[W]=x);this._previousActiveHandlers=C,(Object.keys(U).length||Rl(b))&&(this._changes.push([b,k,U]),this._triggerRenderFrame()),(Object.keys(C).length||Rl(b))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:$}=b;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new du(e),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a);let u=this._el;this._listeners=[[u,"touchstart",{passive:!0}],[u,"touchmove",{passive:!1}],[u,"touchend",void 0],[u,"touchcancel",void 0],[u,"mousedown",void 0],[u,"mousemove",void 0],[u,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[u,"mouseover",void 0],[u,"mouseout",void 0],[u,"dblclick",void 0],[u,"click",void 0],[u,"keydown",{capture:!1}],[u,"keyup",void 0],[u,"wheel",{passive:!1}],[u,"contextmenu",void 0],[window,"blur",void 0]];for(let[h,m,x]of this._listeners)j.addEventListener(h,m,h===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(let[e,a,u]of this._listeners)j.removeEventListener(e,a,e===document?this.handleWindowEvent:this.handleEvent,u)}_addDefaultHandlers(e){let a=this._map,u=a.getCanvasContainer();this._add("mapEvent",new Td(a,e));let h=a.boxZoom=new _r(a,e);this._add("boxZoom",h),e.interactive&&e.boxZoom&&h.enable();let m=a.cooperativeGestures=new Ea(a,e.cooperativeGestures);this._add("cooperativeGestures",m),e.cooperativeGestures&&m.enable();let x=new ka(a),b=new pm(a);a.doubleClickZoom=new jo(b,x),this._add("tapZoom",x),this._add("clickZoom",b),e.interactive&&e.doubleClickZoom&&a.doubleClickZoom.enable();let k=new fm;this._add("tapDragZoom",k);let C=a.touchPitch=new Sa(a);this._add("touchPitch",C),e.interactive&&e.touchPitch&&a.touchPitch.enable(e.touchPitch);let I=gu(e),P=yu(e);a.dragRotate=new Id(e,I,P),this._add("mouseRotate",I,["mousePitch"]),this._add("mousePitch",P,["mouseRotate"]),e.interactive&&e.dragRotate&&a.dragRotate.enable();let F=(({enable:te,clickTolerance:Z})=>{let oe=new Ml({checkCorrectEvent:le=>j.mouseButton(le)===0&&!le.ctrlKey});return new jn({clickTolerance:Z,move:(le,pe)=>({around:pe,panDelta:pe.sub(le)}),activateOnStart:!0,moveStateManager:oe,enable:te,assignEvents:Al})})(e),U=new No(e,a);a.dragPan=new zd(u,F,U),this._add("mousePan",F),this._add("touchPan",U,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&a.dragPan.enable(e.dragPan);let $=new wu,W=new vu;a.touchZoomRotate=new ku(u,W,$,k),this._add("touchRotate",$,["touchPan","touchZoom"]),this._add("touchZoom",W,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&a.touchZoomRotate.enable(e.touchZoomRotate);let J=a.scrollZoom=new Jr(a,()=>this._triggerRenderFrame());this._add("scrollZoom",J,["mousePan"]),e.interactive&&e.scrollZoom&&a.scrollZoom.enable(e.scrollZoom);let Y=a.keyboard=new Mr(a);this._add("keyboard",Y),e.interactive&&e.keyboard&&a.keyboard.enable(),this._add("blockableMapEvent",new ni(a))}_add(e,a,u){this._handlers.push({handlerName:e,handler:a,allowed:u}),this._handlersById[e]=a}stop(e){if(!this._updatingCamera){for(let{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(let{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ar(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,a,u){for(let h in e)if(h!==u&&(!a||a.indexOf(h)<0))return!0;return!1}_getMapTouches(e){let a=[];for(let u of e)this._el.contains(u.target)&&a.push(u);return a}mergeHandlerResult(e,a,u,h,m){if(!u)return;s.e(e,u);let x={handlerName:h,originalEvent:u.originalEvent||m};u.zoomDelta!==void 0&&(a.zoom=x),u.panDelta!==void 0&&(a.drag=x),u.pitchDelta!==void 0&&(a.pitch=x),u.bearingDelta!==void 0&&(a.rotate=x)}_applyChanges(){let e={},a={},u={};for(let[h,m,x]of this._changes)h.panDelta&&(e.panDelta=(e.panDelta||new s.P(0,0))._add(h.panDelta)),h.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+h.zoomDelta),h.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+h.bearingDelta),h.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+h.pitchDelta),h.around!==void 0&&(e.around=h.around),h.pinchAround!==void 0&&(e.pinchAround=h.pinchAround),h.noInertia&&(e.noInertia=h.noInertia),s.e(a,m),s.e(u,x);this._updateMapTransform(e,a,u),this._changes=[]}_updateMapTransform(e,a,u){let h=this._map,m=h._getTransformForUpdate(),x=h.terrain;if(!(Rl(e)||x&&this._terrainMovement))return this._fireEvents(a,u,!0);let{panDelta:b,zoomDelta:k,bearingDelta:C,pitchDelta:I,around:P,pinchAround:F}=e;F!==void 0&&(P=F),h._stop(!0),P=P||h.transform.centerPoint;let U=m.pointLocation(b?P.sub(b):P);C&&(m.bearing+=C),I&&(m.pitch+=I),k&&(m.zoom+=k),x?this._terrainMovement||!a.drag&&!a.zoom?a.drag&&this._terrainMovement?m.center=m.pointLocation(m.centerPoint.sub(b)):m.setLocationAtPoint(U,P):(this._terrainMovement=!0,this._map._elevationFreeze=!0,m.setLocationAtPoint(U,P)):m.setLocationAtPoint(U,P),h._applyUpdatedTransform(m),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(a,u,!0)}_fireEvents(e,a,u){let h=Ar(this._eventsInProgress),m=Ar(e),x={};for(let P in e){let{originalEvent:F}=e[P];this._eventsInProgress[P]||(x[`${P}start`]=F),this._eventsInProgress[P]=e[P]}!h&&m&&this._fireEvent("movestart",m.originalEvent);for(let P in x)this._fireEvent(P,x[P]);m&&this._fireEvent("move",m.originalEvent);for(let P in e){let{originalEvent:F}=e[P];this._fireEvent(P,F)}let b={},k;for(let P in this._eventsInProgress){let{handlerName:F,originalEvent:U}=this._eventsInProgress[P];this._handlersById[F].isActive()||(delete this._eventsInProgress[P],k=a[F]||U,b[`${P}end`]=k)}for(let P in b)this._fireEvent(P,b[P]);let C=Ar(this._eventsInProgress),I=(h||m)&&!C;if(I&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;let P=this._map._getTransformForUpdate();P.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(P)}if(u&&I){this._updatingCamera=!0;let P=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),F=U=>U!==0&&-this._bearingSnap<U&&U<this._bearingSnap;!P||!P.essential&&B.prefersReducedMotion?(this._map.fire(new s.k("moveend",{originalEvent:k})),F(this._map.getBearing())&&this._map.resetNorth()):(F(P.bearing||this._map.getBearing())&&(P.bearing=0),P.freezeElevation=!0,this._map.easeTo(P,{originalEvent:k})),this._updatingCamera=!1}}_fireEvent(e,a){this._map.fire(new s.k(e,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new Ze("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Pd extends s.E{constructor(e,a){super(),this._renderFrameCallback=()=>{let u=Math.min((B.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(u)),u<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=a.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new s.N(this.transform.center.lng,this.transform.center.lat)}setCenter(e,a){return this.jumpTo({center:e},a)}panBy(e,a,u){return e=s.P.convert(e).mult(-1),this.panTo(this.transform.center,s.e({offset:e},a),u)}panTo(e,a,u){return this.easeTo(s.e({center:e},a),u)}getZoom(){return this.transform.zoom}setZoom(e,a){return this.jumpTo({zoom:e},a),this}zoomTo(e,a,u){return this.easeTo(s.e({zoom:e},a),u)}zoomIn(e,a){return this.zoomTo(this.getZoom()+1,e,a),this}zoomOut(e,a){return this.zoomTo(this.getZoom()-1,e,a),this}getBearing(){return this.transform.bearing}setBearing(e,a){return this.jumpTo({bearing:e},a),this}getPadding(){return this.transform.padding}setPadding(e,a){return this.jumpTo({padding:e},a),this}rotateTo(e,a,u){return this.easeTo(s.e({bearing:e},a),u)}resetNorth(e,a){return this.rotateTo(0,s.e({duration:1e3},e),a),this}resetNorthPitch(e,a){return this.easeTo(s.e({bearing:0,pitch:0,duration:1e3},e),a),this}snapToNorth(e,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,a):this}getPitch(){return this.transform.pitch}setPitch(e,a){return this.jumpTo({pitch:e},a),this}cameraForBounds(e,a){e=ye.convert(e).adjustAntiMeridian();let u=a&&a.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),u,a)}_cameraForBoxAndBearing(e,a,u,h){let m={top:0,bottom:0,right:0,left:0};if(typeof(h=s.e({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){let Re=h.padding;h.padding={top:Re,bottom:Re,right:Re,left:Re}}h.padding=s.e(m,h.padding);let x=this.transform,b=x.padding,k=new ye(e,a),C=x.project(k.getNorthWest()),I=x.project(k.getNorthEast()),P=x.project(k.getSouthEast()),F=x.project(k.getSouthWest()),U=s.ba(-u),$=C.rotate(U),W=I.rotate(U),J=P.rotate(U),Y=F.rotate(U),te=new s.P(Math.max($.x,W.x,Y.x,J.x),Math.max($.y,W.y,Y.y,J.y)),Z=new s.P(Math.min($.x,W.x,Y.x,J.x),Math.min($.y,W.y,Y.y,J.y)),oe=te.sub(Z),le=(x.width-(b.left+b.right+h.padding.left+h.padding.right))/oe.x,pe=(x.height-(b.top+b.bottom+h.padding.top+h.padding.bottom))/oe.y;if(pe<0||le<0)return void s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");let ke=Math.min(x.scaleZoom(x.scale*Math.min(le,pe)),h.maxZoom),ze=s.P.convert(h.offset),Ne=new s.P((h.padding.left-h.padding.right)/2,(h.padding.top-h.padding.bottom)/2).rotate(s.ba(u)),qe=ze.add(Ne).mult(x.scale/x.zoomScale(ke));return{center:x.unproject(C.add(P).div(2).sub(qe)),zoom:ke,bearing:u}}fitBounds(e,a,u){return this._fitInternal(this.cameraForBounds(e,a),a,u)}fitScreenCoordinates(e,a,u,h,m){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(s.P.convert(e)),this.transform.pointLocation(s.P.convert(a)),u,h),h,m)}_fitInternal(e,a,u){return e?(delete(a=s.e(e,a)).padding,a.linear?this.easeTo(a,u):this.flyTo(a,u)):this}jumpTo(e,a){this.stop();let u=this._getTransformForUpdate(),h=!1,m=!1,x=!1;return"zoom"in e&&u.zoom!==+e.zoom&&(h=!0,u.zoom=+e.zoom),e.center!==void 0&&(u.center=s.N.convert(e.center)),"bearing"in e&&u.bearing!==+e.bearing&&(m=!0,u.bearing=+e.bearing),"pitch"in e&&u.pitch!==+e.pitch&&(x=!0,u.pitch=+e.pitch),e.padding==null||u.isPaddingEqual(e.padding)||(u.padding=e.padding),this._applyUpdatedTransform(u),this.fire(new s.k("movestart",a)).fire(new s.k("move",a)),h&&this.fire(new s.k("zoomstart",a)).fire(new s.k("zoom",a)).fire(new s.k("zoomend",a)),m&&this.fire(new s.k("rotatestart",a)).fire(new s.k("rotate",a)).fire(new s.k("rotateend",a)),x&&this.fire(new s.k("pitchstart",a)).fire(new s.k("pitch",a)).fire(new s.k("pitchend",a)),this.fire(new s.k("moveend",a))}calculateCameraOptionsFromTo(e,a,u,h=0){let m=s.Z.fromLngLat(e,a),x=s.Z.fromLngLat(u,h),b=x.x-m.x,k=x.y-m.y,C=x.z-m.z,I=Math.hypot(b,k,C);if(I===0)throw new Error("Can't calculate camera options with same From and To");let P=Math.hypot(b,k),F=this.transform.scaleZoom(this.transform.cameraToCenterDistance/I/this.transform.tileSize),U=180*Math.atan2(b,-k)/Math.PI,$=180*Math.acos(P/I)/Math.PI;return $=C<0?90-$:90+$,{center:x.toLngLat(),zoom:F,pitch:$,bearing:U}}easeTo(e,a){var u;this._stop(!1,e.easeId),((e=s.e({offset:[0,0],duration:500,easing:s.b9},e)).animate===!1||!e.essential&&B.prefersReducedMotion)&&(e.duration=0);let h=this._getTransformForUpdate(),m=h.zoom,x=h.bearing,b=h.pitch,k=h.padding,C="bearing"in e?this._normalizeBearing(e.bearing,x):x,I="pitch"in e?+e.pitch:b,P="padding"in e?e.padding:h.padding,F=s.P.convert(e.offset),U=h.centerPoint.add(F),$=h.pointLocation(U),{center:W,zoom:J}=h.getConstrained(s.N.convert(e.center||$),(u=e.zoom)!==null&&u!==void 0?u:m);this._normalizeCenter(W,h);let Y=h.project($),te=h.project(W).sub(Y),Z=h.zoomScale(J-m),oe,le;e.around&&(oe=s.N.convert(e.around),le=h.locationPoint(oe));let pe={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||J!==m,this._rotating=this._rotating||x!==C,this._pitching=this._pitching||I!==b,this._padding=!h.isPaddingEqual(P),this._easeId=e.easeId,this._prepareEase(a,e.noMoveStart,pe),this.terrain&&this._prepareElevation(W),this._ease(ke=>{if(this._zooming&&(h.zoom=s.y.number(m,J,ke)),this._rotating&&(h.bearing=s.y.number(x,C,ke)),this._pitching&&(h.pitch=s.y.number(b,I,ke)),this._padding&&(h.interpolatePadding(k,P,ke),U=h.centerPoint.add(F)),this.terrain&&!e.freezeElevation&&this._updateElevation(ke),oe)h.setLocationAtPoint(oe,le);else{let ze=h.zoomScale(h.zoom-m),Ne=J>m?Math.min(2,Z):Math.max(.5,Z),qe=Math.pow(Ne,1-ke),Re=h.unproject(Y.add(te.mult(ke*qe)).mult(ze));h.setLocationAtPoint(h.renderWorldCopies?Re.wrap():Re,U)}this._applyUpdatedTransform(h),this._fireMoveEvents(a)},ke=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a,ke)},e),this}_prepareEase(e,a,u={}){this._moving=!0,a||u.moving||this.fire(new s.k("movestart",e)),this._zooming&&!u.zooming&&this.fire(new s.k("zoomstart",e)),this._rotating&&!u.rotating&&this.fire(new s.k("rotatestart",e)),this._pitching&&!u.pitching&&this.fire(new s.k("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);let a=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&a!==this._elevationTarget){let u=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(u-(a-(u*e+this._elevationStart))/(1-e)),this._elevationTarget=a}this.transform.elevation=s.y.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){let a=e.getCameraPosition(),u=this.terrain.getElevationForLngLatZoom(a.lngLat,e.zoom);if(a.altitude<u){let h=this.calculateCameraOptionsFromTo(a.lngLat,u,e.center,e.elevation);return{pitch:h.pitch,zoom:h.zoom}}return{}}_applyUpdatedTransform(e){let a=[];if(this.terrain&&a.push(h=>this._elevateCameraIfInsideTerrain(h)),this.transformCameraUpdate&&a.push(h=>this.transformCameraUpdate(h)),!a.length)return;let u=e.clone();for(let h of a){let m=u.clone(),{center:x,zoom:b,pitch:k,bearing:C,elevation:I}=h(m);x&&(m.center=x),b!==void 0&&(m.zoom=b),k!==void 0&&(m.pitch=k),C!==void 0&&(m.bearing=C),I!==void 0&&(m.elevation=I),u.apply(m)}this.transform.apply(u)}_fireMoveEvents(e){this.fire(new s.k("move",e)),this._zooming&&this.fire(new s.k("zoom",e)),this._rotating&&this.fire(new s.k("rotate",e)),this._pitching&&this.fire(new s.k("pitch",e))}_afterEase(e,a){if(this._easeId&&a&&this._easeId===a)return;delete this._easeId;let u=this._zooming,h=this._rotating,m=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,u&&this.fire(new s.k("zoomend",e)),h&&this.fire(new s.k("rotateend",e)),m&&this.fire(new s.k("pitchend",e)),this.fire(new s.k("moveend",e))}flyTo(e,a){var u;if(!e.essential&&B.prefersReducedMotion){let Ve=s.M(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ve,a)}this.stop(),e=s.e({offset:[0,0],speed:1.2,curve:1.42,easing:s.b9},e);let h=this._getTransformForUpdate(),m=h.zoom,x=h.bearing,b=h.pitch,k=h.padding,C="bearing"in e?this._normalizeBearing(e.bearing,x):x,I="pitch"in e?+e.pitch:b,P="padding"in e?e.padding:h.padding,F=s.P.convert(e.offset),U=h.centerPoint.add(F),$=h.pointLocation(U),{center:W,zoom:J}=h.getConstrained(s.N.convert(e.center||$),(u=e.zoom)!==null&&u!==void 0?u:m);this._normalizeCenter(W,h);let Y=h.zoomScale(J-m),te=h.project($),Z=h.project(W).sub(te),oe=e.curve,le=Math.max(h.width,h.height),pe=le/Y,ke=Z.mag();if("minZoom"in e){let Ve=s.ac(Math.min(e.minZoom,m,J),h.minZoom,h.maxZoom),st=le/h.zoomScale(Ve-m);oe=Math.sqrt(st/ke*2)}let ze=oe*oe;function Ne(Ve){let st=(pe*pe-le*le+(Ve?-1:1)*ze*ze*ke*ke)/(2*(Ve?pe:le)*ze*ke);return Math.log(Math.sqrt(st*st+1)-st)}function qe(Ve){return(Math.exp(Ve)-Math.exp(-Ve))/2}function Re(Ve){return(Math.exp(Ve)+Math.exp(-Ve))/2}let De=Ne(!1),Xe=function(Ve){return Re(De)/Re(De+oe*Ve)},ut=function(Ve){return le*((Re(De)*(qe(st=De+oe*Ve)/Re(st))-qe(De))/ze)/ke;var st},Be=(Ne(!0)-De)/oe;if(Math.abs(ke)<1e-6||!isFinite(Be)){if(Math.abs(le-pe)<1e-6)return this.easeTo(e,a);let Ve=pe<le?-1:1;Be=Math.abs(Math.log(pe/le))/oe,ut=()=>0,Xe=st=>Math.exp(Ve*oe*st)}return e.duration="duration"in e?+e.duration:1e3*Be/("screenSpeed"in e?+e.screenSpeed/oe:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=x!==C,this._pitching=I!==b,this._padding=!h.isPaddingEqual(P),this._prepareEase(a,!1),this.terrain&&this._prepareElevation(W),this._ease(Ve=>{let st=Ve*Be,qt=1/Xe(st);h.zoom=Ve===1?J:m+h.scaleZoom(qt),this._rotating&&(h.bearing=s.y.number(x,C,Ve)),this._pitching&&(h.pitch=s.y.number(b,I,Ve)),this._padding&&(h.interpolatePadding(k,P,Ve),U=h.centerPoint.add(F)),this.terrain&&!e.freezeElevation&&this._updateElevation(Ve);let ft=Ve===1?W:h.unproject(te.add(Z.mult(ut(st))).mult(qt));h.setLocationAtPoint(h.renderWorldCopies?ft.wrap():ft,U),this._applyUpdatedTransform(h),this._fireMoveEvents(a)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(a)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,a){var u;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let h=this._onEaseEnd;delete this._onEaseEnd,h.call(this,a)}return e||(u=this.handlers)===null||u===void 0||u.stop(!1),this}_ease(e,a,u){u.animate===!1||u.duration===0?(e(1),a()):(this._easeStart=B.now(),this._easeOptions=u,this._onEaseFrame=e,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,a){e=s.b3(e,-180,180);let u=Math.abs(e-a);return Math.abs(e-360-a)<u&&(e-=360),Math.abs(e+360-a)<u&&(e+=360),e}_normalizeCenter(e,a){if(!a.renderWorldCopies||a.lngRange)return;let u=e.lng-a.center.lng;e.lng+=u>180?-360:u<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(s.N.convert(e),this.transform.tileZoom)-this.transform.elevation:null}}let Ta={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Ca{constructor(e=Ta){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=a=>{!a||a.sourceDataType!=="metadata"&&a.sourceDataType!=="visibility"&&a.dataType!=="style"&&a.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=j.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=j.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=j.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){j.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,a){let u=this._map._getUIString(`AttributionControl.${a}`);e.title=u,e.setAttribute("aria-label",u)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(h=>typeof h!="string"?"":h)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){let h=this._map.style.stylesheet;this.styleOwner=h.owner,this.styleId=h.id}let a=this._map.style.sourceCaches;for(let h in a){let m=a[h];if(m.used||m.usedForTerrain){let x=m.getSource();x.attribution&&e.indexOf(x.attribution)<0&&e.push(x.attribution)}}e=e.filter(h=>String(h).trim()),e.sort((h,m)=>h.length-m.length),e=e.filter((h,m)=>{for(let x=m+1;x<e.length;x++)if(e[x].indexOf(h)>=0)return!1;return!0});let u=e.join(" | ");u!==this._attribHTML&&(this._attribHTML=u,e.length?(this._innerContainer.innerHTML=u,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Eu{constructor(e={}){this._updateCompact=()=>{let a=this._container.children;if(a.length){let u=a[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&u.classList.add("maplibregl-compact"):u.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=j.create("div","maplibregl-ctrl");let a=j.create("a","maplibregl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://maplibre.org/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){j.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class xt{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){let a=++this._id;return this._queue.push({callback:e,id:a,cancelled:!1}),a}remove(e){let a=this._currentlyRunning,u=a?this._queue.concat(a):this._queue;for(let h of u)if(h.id===e)return void(h.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let a=this._currentlyRunning=this._queue;this._queue=[];for(let u of a)if(!u.cancelled&&(u.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Tu=s.Y([{name:"a_pos3d",type:"Int16",components:3}]);class mm extends s.E{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,a){this.sourceCache.update(e,a),this._renderableTilesKeys=[];let u={};for(let h of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:a}))u[h.key]=!0,this._renderableTilesKeys.push(h.key),this._tiles[h.key]||(h.posMatrix=new Float64Array(16),s.aP(h.posMatrix,0,s.X,0,s.X,0,1),this._tiles[h.key]=new oo(h,this.tileSize));for(let h in this._tiles)u[h]||delete this._tiles[h]}freeRtt(e){for(let a in this._tiles){let u=this._tiles[a];(!e||u.tileID.equals(e)||u.tileID.isChildOf(e)||e.isChildOf(u.tileID))&&(u.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){let a={};for(let u of this._renderableTilesKeys){let h=this._tiles[u].tileID;if(h.canonical.equals(e.canonical)){let m=e.clone();m.posMatrix=new Float64Array(16),s.aP(m.posMatrix,0,s.X,0,s.X,0,1),a[u]=m}else if(h.canonical.isChildOf(e.canonical)){let m=e.clone();m.posMatrix=new Float64Array(16);let x=h.canonical.z-e.canonical.z,b=h.canonical.x-(h.canonical.x>>x<<x),k=h.canonical.y-(h.canonical.y>>x<<x),C=s.X>>x;s.aP(m.posMatrix,0,C,0,C,0,1),s.J(m.posMatrix,m.posMatrix,[-b*C,-k*C,0]),a[u]=m}else if(e.canonical.isChildOf(h.canonical)){let m=e.clone();m.posMatrix=new Float64Array(16);let x=e.canonical.z-h.canonical.z,b=e.canonical.x-(e.canonical.x>>x<<x),k=e.canonical.y-(e.canonical.y>>x<<x),C=s.X>>x;s.aP(m.posMatrix,0,s.X,0,s.X,0,1),s.J(m.posMatrix,m.posMatrix,[b*C,k*C,0]),s.K(m.posMatrix,m.posMatrix,[1/2**x,1/2**x,0]),a[u]=m}}return a}getSourceTile(e,a){let u=this.sourceCache._source,h=e.overscaledZ-this.deltaZoom;if(h>u.maxzoom&&(h=u.maxzoom),h<u.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(h).key);let m=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!m||!m.dem)&&a)for(;h>=u.minzoom&&(!m||!m.dem);)m=this.sourceCache.getTileByID(e.scaledTo(h--).key);return m}tilesAfterTime(e=Date.now()){return Object.values(this._tiles).filter(a=>a.timeAdded>=e)}}class Cu{constructor(e,a,u){this.painter=e,this.sourceCache=new mm(a),this.options=u,this.exaggeration=typeof u.exaggeration=="number"?u.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,a,u,h=s.X){var m;if(!(a>=0&&a<h&&u>=0&&u<h))return 0;let x=this.getTerrainData(e),b=(m=x.tile)===null||m===void 0?void 0:m.dem;if(!b)return 0;let k=function($,W,J){var Y=W[0],te=W[1];return $[0]=J[0]*Y+J[4]*te+J[12],$[1]=J[1]*Y+J[5]*te+J[13],$}([],[a/h*s.X,u/h*s.X],x.u_terrain_matrix),C=[k[0]*b.dim,k[1]*b.dim],I=Math.floor(C[0]),P=Math.floor(C[1]),F=C[0]-I,U=C[1]-P;return b.get(I,P)*(1-F)*(1-U)+b.get(I+1,P)*F*(1-U)+b.get(I,P+1)*(1-F)*U+b.get(I+1,P+1)*F*U}getElevationForLngLatZoom(e,a){if(!s.bb(a,e.wrap()))return 0;let{tileID:u,mercatorX:h,mercatorY:m}=this._getOverscaledTileIDFromLngLatZoom(e,a);return this.getElevation(u,h%s.X,m%s.X,s.X)}getElevation(e,a,u,h=s.X){return this.getDEMElevation(e,a,u,h)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){let h=this.painter.context,m=new s.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new ct(h,m,h.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new ct(h,new s.R({width:1,height:1}),h.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=s.an([])}let a=this.sourceCache.getSourceTile(e,!0);if(a&&a.dem&&(!a.demTexture||a.needsTerrainPrepare)){let h=this.painter.context;a.demTexture=this.painter.getTileTexture(a.dem.stride),a.demTexture?a.demTexture.update(a.dem.getPixels(),{premultiply:!1}):a.demTexture=new ct(h,a.dem.getPixels(),h.gl.RGBA,{premultiply:!1}),a.demTexture.bind(h.gl.NEAREST,h.gl.CLAMP_TO_EDGE),a.needsTerrainPrepare=!1}let u=a&&a+a.tileID.key+e.key;if(u&&!this._demMatrixCache[u]){let h=this.sourceCache.sourceCache._source.maxzoom,m=e.canonical.z-a.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=h?m=e.canonical.z-h:s.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let x=e.canonical.x-(e.canonical.x>>m<<m),b=e.canonical.y-(e.canonical.y>>m<<m),k=s.bc(new Float64Array(16),[1/(s.X<<m),1/(s.X<<m),0]);s.J(k,k,[x*s.X,b*s.X,0]),this._demMatrixCache[e.key]={matrix:k,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:a&&a.dem&&a.dem.dim||1,u_terrain_matrix:u?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:a&&a.dem&&a.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(a&&a.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:a}}getFramebuffer(e){let a=this.painter,u=a.width/devicePixelRatio,h=a.height/devicePixelRatio;return!this._fbo||this._fbo.width===u&&this._fbo.height===h||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new ct(a.context,{width:u,height:h,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new ct(a.context,{width:u,height:h,data:null},a.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(a.context.gl.NEAREST,a.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=a.context.createFramebuffer(u,h,!0,!1),this._fbo.depthAttachment.set(a.context.createRenderbuffer(a.context.gl.DEPTH_COMPONENT16,u,h))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let a=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let m=0,x=0;m<this._coordsTextureSize;m++)for(let b=0;b<this._coordsTextureSize;b++,x+=4)a[x+0]=255&b,a[x+1]=255&m,a[x+2]=b>>8<<4|m>>8,a[x+3]=0;let u=new s.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(a.buffer)),h=new ct(e,u,e.gl.RGBA,{premultiply:!1});return h.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=h,h}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);let a=new Uint8Array(4),u=this.painter.context,h=u.gl,m=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),x=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),b=Math.round(this.painter.height/devicePixelRatio);u.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),h.readPixels(m,b-x-1,1,1,h.RGBA,h.UNSIGNED_BYTE,a),u.bindFramebuffer.set(null);let k=a[0]+(a[2]>>4<<8),C=a[1]+((15&a[2])<<8),I=this.coordsIndex[255-a[3]],P=I&&this.sourceCache.getTileByID(I);if(!P)return null;let F=this._coordsTextureSize,U=(1<<P.tileID.canonical.z)*F;return new s.Z((P.tileID.canonical.x*F+k)/U+P.tileID.wrap,(P.tileID.canonical.y*F+C)/U,this.getElevation(P.tileID,k,C,F))}depthAtPoint(e){let a=new Uint8Array(4),u=this.painter.context,h=u.gl;return u.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),h.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,h.RGBA,h.UNSIGNED_BYTE,a),u.bindFramebuffer.set(null),(a[0]/16777216+a[1]/65536+a[2]/256+a[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;let e=this.painter.context,a=new s.bd,u=new s.aY,h=this.meshSize,m=s.X/h,x=h*h;for(let P=0;P<=h;P++)for(let F=0;F<=h;F++)a.emplaceBack(F*m,P*m,0);for(let P=0;P<x;P+=h+1)for(let F=0;F<h;F++)u.emplaceBack(F+P,h+F+P+1,h+F+P+2),u.emplaceBack(F+P,h+F+P+2,F+P+1);let b=a.length,k=b+2*(h+1);for(let P of[0,1])for(let F=0;F<=h;F++)for(let U of[0,1])a.emplaceBack(F*m,P*s.X,U);for(let P=0;P<2*h;P+=2)u.emplaceBack(k+P,k+P+1,k+P+3),u.emplaceBack(k+P,k+P+3,k+P+2),u.emplaceBack(b+P,b+P+3,b+P+1),u.emplaceBack(b+P,b+P+2,b+P+3);let C=a.length,I=C+2*(h+1);for(let P of[0,1])for(let F=0;F<=h;F++)for(let U of[0,1])a.emplaceBack(P*s.X,F*m,U);for(let P=0;P<2*h;P+=2)u.emplaceBack(C+P,C+P+1,C+P+3),u.emplaceBack(C+P,C+P+3,C+P+2),u.emplaceBack(I+P,I+P+3,I+P+1),u.emplaceBack(I+P,I+P+2,I+P+3);return this._mesh=new El(e.createVertexBuffer(a,Tu.members),e.createIndexBuffer(u),s.a0.simpleSegment(0,0,a.length,u.length)),this._mesh}getMeshFrameDelta(e){return 2*Math.PI*s.be/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,a){var u;let{tileID:h}=this._getOverscaledTileIDFromLngLatZoom(e,a);return(u=this.getMinMaxElevation(h).minElevation)!==null&&u!==void 0?u:0}getMinMaxElevation(e){let a=this.getTerrainData(e).tile,u={minElevation:null,maxElevation:null};return a&&a.dem&&(u.minElevation=a.dem.min*this.exaggeration,u.maxElevation=a.dem.max*this.exaggeration),u}_getOverscaledTileIDFromLngLatZoom(e,a){let u=s.Z.fromLngLat(e.wrap()),h=(1<<a)*s.X,m=u.x*h,x=u.y*h,b=Math.floor(m/s.X),k=Math.floor(x/s.X);return{tileID:new s.S(a,0,a,b,k),mercatorX:m,mercatorY:x}}}class gm{constructor(e,a,u){this._context=e,this._size=a,this._tileSize=u,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){let a=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),u=new ct(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return u.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),a.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),a.colorAttachment.set(u.texture),{id:e,fbo:a,texture:u,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(a=>e.id!==a),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(let a of this._recentlyUsed)if(!this._objects[a].inUse)return this._objects[a];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(let e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}let za={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Md{constructor(e,a){this.painter=e,this.terrain=a,this.pool=new gm(e.context,30,a.sourceCache.tileSize*a.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,a){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(u=>!e._layers[u].isHidden(a)),this._coordsDescendingInv={};for(let u in e.sourceCaches){this._coordsDescendingInv[u]={};let h=e.sourceCaches[u].getVisibleCoordinates();for(let m of h){let x=this.terrain.sourceCache.getTerrainCoords(m);for(let b in x)this._coordsDescendingInv[u][b]||(this._coordsDescendingInv[u][b]=[]),this._coordsDescendingInv[u][b].push(x[b])}}this._coordsDescendingInvStr={};for(let u of e._order){let h=e._layers[u],m=h.source;if(za[h.type]&&!this._coordsDescendingInvStr[m]){this._coordsDescendingInvStr[m]={};for(let x in this._coordsDescendingInv[m])this._coordsDescendingInvStr[m][x]=this._coordsDescendingInv[m][x].map(b=>b.key).sort().join()}}for(let u of this._renderableTiles)for(let h in this._coordsDescendingInvStr){let m=this._coordsDescendingInvStr[h][u.tileID.key];m&&m!==u.rttCoords[h]&&(u.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;let a=e.type,u=this.painter,h=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(za[a]&&(this._prevType&&za[this._prevType]||this._stacks.push([]),this._prevType=a,this._stacks[this._stacks.length-1].push(e.id),!h))return!0;if(za[this._prevType]||za[a]&&h){this._prevType=a;let m=this._stacks.length-1,x=this._stacks[m]||[];for(let b of this._renderableTiles){if(this.pool.isFull()&&(kd(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(b),b.rtt[m]){let C=this.pool.getObjectForId(b.rtt[m].id);if(C.stamp===b.rtt[m].stamp){this.pool.useObject(C);continue}}let k=this.pool.getOrCreateFreeObject();this.pool.useObject(k),this.pool.stampObject(k),b.rtt[m]={id:k.id,stamp:k.stamp},u.context.bindFramebuffer.set(k.fbo.framebuffer),u.context.clear({color:s.aM.transparent,stencil:0}),u.currentStencilSource=void 0;for(let C=0;C<x.length;C++){let I=u.style._layers[x[C]],P=I.source?this._coordsDescendingInv[I.source][b.tileID.key]:[b.tileID];u.context.viewport.set([0,0,k.fbo.width,k.fbo.height]),u._renderTileClippingMasks(I,P),u.renderLayer(u,u.style.sourceCaches[I.source],I,P),I.source&&(b.rttCoords[I.source]=this._coordsDescendingInvStr[I.source][b.tileID.key])}}return kd(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),za[a]}return!1}}let zu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use \u2318 + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Ad=E,ym={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Ta,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:s.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Iu=g=>{g.touchstart=g.dragStart,g.touchmoveWindow=g.dragMove,g.touchend=g.dragEnd},_m={showCompass:!0,showZoom:!0,visualizePitch:!1};class vm{constructor(e,a,u=!1){this.mousedown=x=>{this.startMouse(s.e({},x,{ctrlKey:!0,preventDefault:()=>x.preventDefault()}),j.mousePos(this.element,x)),j.addEventListener(window,"mousemove",this.mousemove),j.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.moveMouse(x,j.mousePos(this.element,x))},this.mouseup=x=>{this.mouseRotate.dragEnd(x),this.mousePitch&&this.mousePitch.dragEnd(x),this.offTemp()},this.touchstart=x=>{x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=j.touchPos(this.element,x.targetTouches)[0],this.startTouch(x,this._startPos),j.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),j.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{x.targetTouches.length!==1?this.reset():(this._lastPos=j.touchPos(this.element,x.targetTouches)[0],this.moveTouch(x,this._lastPos))},this.touchend=x=>{x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;let h=e.dragRotate._mouseRotate.getClickTolerance(),m=e.dragRotate._mousePitch.getClickTolerance();this.element=a,this.mouseRotate=gu({clickTolerance:h,enable:!0}),this.touchRotate=(({enable:x,clickTolerance:b,bearingDegreesPerPixelMoved:k=.8})=>{let C=new mu;return new jn({clickTolerance:b,move:(I,P)=>({bearingDelta:(P.x-I.x)*k}),moveStateManager:C,enable:x,assignEvents:Iu})})({clickTolerance:h,enable:!0}),this.map=e,u&&(this.mousePitch=yu({clickTolerance:m,enable:!0}),this.touchPitch=(({enable:x,clickTolerance:b,pitchDegreesPerPixelMoved:k=-.5})=>{let C=new mu;return new jn({clickTolerance:b,move:(I,P)=>({pitchDelta:(P.y-I.y)*k}),moveStateManager:C,enable:x,assignEvents:Iu})})({clickTolerance:m,enable:!0})),j.addEventListener(a,"mousedown",this.mousedown),j.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),j.addEventListener(a,"touchcancel",this.reset)}startMouse(e,a){this.mouseRotate.dragStart(e,a),this.mousePitch&&this.mousePitch.dragStart(e,a),j.disableDrag()}startTouch(e,a){this.touchRotate.dragStart(e,a),this.touchPitch&&this.touchPitch.dragStart(e,a),j.disableDrag()}moveMouse(e,a){let u=this.map,{bearingDelta:h}=this.mouseRotate.dragMove(e,a)||{};if(h&&u.setBearing(u.getBearing()+h),this.mousePitch){let{pitchDelta:m}=this.mousePitch.dragMove(e,a)||{};m&&u.setPitch(u.getPitch()+m)}}moveTouch(e,a){let u=this.map,{bearingDelta:h}=this.touchRotate.dragMove(e,a)||{};if(h&&u.setBearing(u.getBearing()+h),this.touchPitch){let{pitchDelta:m}=this.touchPitch.dragMove(e,a)||{};m&&u.setPitch(u.getPitch()+m)}}off(){let e=this.element;j.removeEventListener(e,"mousedown",this.mousedown),j.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),j.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),j.removeEventListener(window,"touchend",this.touchend),j.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){j.enableDrag(),j.removeEventListener(window,"mousemove",this.mousemove),j.removeEventListener(window,"mouseup",this.mouseup),j.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),j.removeEventListener(window,"touchend",this.touchend)}}let vr;function Ut(g,e,a){let u=new s.N(g.lng,g.lat);if(g=new s.N(g.lng,g.lat),e){let h=new s.N(g.lng-360,g.lat),m=new s.N(g.lng+360,g.lat),x=a.locationPoint(g).distSqr(e);a.locationPoint(h).distSqr(e)<x?g=h:a.locationPoint(m).distSqr(e)<x&&(g=m)}for(;Math.abs(g.lng-a.center.lng)>180;){let h=a.locationPoint(g);if(h.x>=0&&h.y>=0&&h.x<=a.width&&h.y<=a.height)break;g.lng>a.center.lng?g.lng-=360:g.lng+=360}return g.lng!==u.lng&&a.locationPoint(g).y>a.height/2-a.getHorizon()?g:u}let Ia={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Fl(g,e,a){let u=g.classList;for(let h in Ia)u.remove(`maplibregl-${a}-anchor-${h}`);u.add(`maplibregl-${a}-anchor-${e}`)}class Bl extends s.E{constructor(e){if(super(),this._onKeyPress=a=>{let u=a.code,h=a.charCode||a.keyCode;u!=="Space"&&u!=="Enter"&&h!==32&&h!==13||this.togglePopup()},this._onMapClick=a=>{let u=a.originalEvent.target,h=this._element;this._popup&&(u===h||h.contains(u))&&this.togglePopup()},this._update=a=>{var u;if(!this._map)return;let h=this._map.loaded()&&!this._map.isMoving();(a?.type==="terrain"||a?.type==="render"&&!h)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Ut(this._lngLat,this._flatPos,this._map.transform):(u=this._lngLat)===null||u===void 0?void 0:u.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let m="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?m=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(m=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let x="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?x="rotateX(0deg)":this._pitchAlignment==="map"&&(x=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||a&&a.type!=="moveend"||(this._pos=this._pos.round()),j.setTransform(this._element,`${Ia[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${x} ${m}`),B.frameAsync(new AbortController).then(()=>{this._updateOpacity(a&&a.type==="moveend")}).catch(()=>{})},this._onMove=a=>{if(!this._isDragging){let u=this._clickTolerance||this._map._clickTolerance;this._isDragging=a.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.k("dragstart"))),this.fire(new s.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new s.k("dragend")),this._state="inactive"},this._addDragHandler=a=>{this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._pointerdownPos=a.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e?.opacity,e?.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=s.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=j.create("div");let a=j.createNS("http://www.w3.org/2000/svg","svg"),u=41,h=27;a.setAttributeNS(null,"display","block"),a.setAttributeNS(null,"height",`${u}px`),a.setAttributeNS(null,"width",`${h}px`),a.setAttributeNS(null,"viewBox",`0 0 ${h} ${u}`);let m=j.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"stroke","none"),m.setAttributeNS(null,"stroke-width","1"),m.setAttributeNS(null,"fill","none"),m.setAttributeNS(null,"fill-rule","evenodd");let x=j.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");let b=j.createNS("http://www.w3.org/2000/svg","g");b.setAttributeNS(null,"transform","translate(3.0, 29.0)"),b.setAttributeNS(null,"fill","#000000");let k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let Y of k){let te=j.createNS("http://www.w3.org/2000/svg","ellipse");te.setAttributeNS(null,"opacity","0.04"),te.setAttributeNS(null,"cx","10.5"),te.setAttributeNS(null,"cy","5.80029008"),te.setAttributeNS(null,"rx",Y.rx),te.setAttributeNS(null,"ry",Y.ry),b.appendChild(te)}let C=j.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"fill",this._color);let I=j.createNS("http://www.w3.org/2000/svg","path");I.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),C.appendChild(I);let P=j.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"opacity","0.25"),P.setAttributeNS(null,"fill","#000000");let F=j.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),P.appendChild(F);let U=j.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"transform","translate(6.0, 7.0)"),U.setAttributeNS(null,"fill","#FFFFFF");let $=j.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(8.0, 8.0)");let W=j.createNS("http://www.w3.org/2000/svg","circle");W.setAttributeNS(null,"fill","#000000"),W.setAttributeNS(null,"opacity","0.25"),W.setAttributeNS(null,"cx","5.5"),W.setAttributeNS(null,"cy","5.5"),W.setAttributeNS(null,"r","5.4999962");let J=j.createNS("http://www.w3.org/2000/svg","circle");J.setAttributeNS(null,"fill","#FFFFFF"),J.setAttributeNS(null,"cx","5.5"),J.setAttributeNS(null,"cy","5.5"),J.setAttributeNS(null,"r","5.4999962"),$.appendChild(W),$.appendChild(J),x.appendChild(b),x.appendChild(C),x.appendChild(P),x.appendChild(U),x.appendChild($),a.appendChild(x),a.setAttributeNS(null,"height",u*this._scale+"px"),a.setAttributeNS(null,"width",h*this._scale+"px"),this._element.appendChild(a),this._offset=s.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",a=>{a.preventDefault()}),this._element.addEventListener("mousedown",a=>{a.preventDefault()}),Fl(this._element,this._anchor,"marker"),e&&e.className)for(let a of e.className.split(" "))this._element.classList.add(a);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),j.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=s.N.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){let h=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[h,-1*(38.1-13.5+h)],"bottom-right":[-h,-1*(38.1-13.5+h)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){let e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var a,u;if(!(!((a=this._map)===null||a===void 0)&&a.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}let h=this._map,m=h.terrain.depthAtPoint(this._pos),x=h.terrain.getElevationForLngLatZoom(this._lngLat,h.transform.tileZoom);if(h.transform.lngLatToCameraDepth(this._lngLat,x)-m<.006)return void(this._element.style.opacity=this._opacity);let b=-this._offset.y/h.transform._pixelPerMeter,k=Math.sin(h.getPitch()*Math.PI/180)*b,C=h.terrain.depthAtPoint(new s.P(this._pos.x,this._pos.y-this._offset.y)),I=h.transform.lngLatToCameraDepth(this._lngLat,x+k)-C>.006;!((u=this._popup)===null||u===void 0)&&u.isOpen()&&I&&this._popup.remove(),this._element.style.opacity=I?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=s.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,a){return e===void 0&&a===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),a!==void 0&&(this._opacityWhenCovered=a),this._map&&this._updateOpacity(!0),this}}let Ld={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Ls=0,Ds=!1,bn={maxWidth:100,unit:"metric"};function Rs(g,e,a){let u=a&&a.maxWidth||100,h=g._container.clientHeight/2,m=g.unproject([0,h]),x=g.unproject([u,h]),b=m.distanceTo(x);if(a&&a.unit==="imperial"){let k=3.2808*b;k>5280?We(e,u,k/5280,g._getUIString("ScaleControl.Miles")):We(e,u,k,g._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?We(e,u,b/1852,g._getUIString("ScaleControl.NauticalMiles")):b>=1e3?We(e,u,b/1e3,g._getUIString("ScaleControl.Kilometers")):We(e,u,b,g._getUIString("ScaleControl.Meters"))}function We(g,e,a,u){let h=function(m){let x=Math.pow(10,`${Math.floor(m)}`.length-1),b=m/x;return b=b>=10?10:b>=5?5:b>=3?3:b>=2?2:b>=1?1:function(k){let C=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*C)/C}(b),x*b}(a);g.style.width=e*(h/a)+"px",g.innerHTML=`${h}&nbsp;${u}`}let ot={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Ol=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Nl(g){if(g){if(typeof g=="number"){let e=Math.round(Math.abs(g)/Math.SQRT2);return{center:new s.P(0,0),top:new s.P(0,g),"top-left":new s.P(e,e),"top-right":new s.P(-e,e),bottom:new s.P(0,-g),"bottom-left":new s.P(e,-e),"bottom-right":new s.P(-e,-e),left:new s.P(g,0),right:new s.P(-g,0)}}if(g instanceof s.P||Array.isArray(g)){let e=s.P.convert(g);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:s.P.convert(g.center||[0,0]),top:s.P.convert(g.top||[0,0]),"top-left":s.P.convert(g["top-left"]||[0,0]),"top-right":s.P.convert(g["top-right"]||[0,0]),bottom:s.P.convert(g.bottom||[0,0]),"bottom-left":s.P.convert(g["bottom-left"]||[0,0]),"bottom-right":s.P.convert(g["bottom-right"]||[0,0]),left:s.P.convert(g.left||[0,0]),right:s.P.convert(g.right||[0,0])}}return Nl(new s.P(0,0))}let Pu=E;f.AJAXError=s.bh,f.Evented=s.E,f.LngLat=s.N,f.MercatorCoordinate=s.Z,f.Point=s.P,f.addProtocol=s.bi,f.config=s.a,f.removeProtocol=s.bj,f.AttributionControl=Ca,f.BoxZoomHandler=_r,f.CanvasSource=zr,f.CooperativeGesturesHandler=Ea,f.DoubleClickZoomHandler=jo,f.DragPanHandler=zd,f.DragRotateHandler=Id,f.EdgeInsets=wa,f.FullscreenControl=class extends s.E{constructor(g={}){super(),this._onFullscreenChange=()=>{var e;let a=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=a?.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)a=a.shadowRoot.fullscreenElement;a===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,g&&g.container&&(g.container instanceof HTMLElement?this._container=g.container:s.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=j.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){j.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let g=this._fullscreenButton=j.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);j.create("span","maplibregl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new s.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new s.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},f.GeoJSONSource=ms,f.GeolocateControl=class extends s.E{constructor(g){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new s.k("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new s.k("geolocate",e)),this._finish()}},this._updateCamera=e=>{let a=new s.N(e.coords.longitude,e.coords.latitude),u=e.coords.accuracy,h=this._map.getBearing(),m=s.e({bearing:h},this.options.fitBoundsOptions),x=ye.fromLngLat(a,u);this._map.fitBounds(x,m,{geolocateSource:!0})},this._updateMarker=e=>{if(e){let a=new s.N(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Ds)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new s.k("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=j.create("button","maplibregl-ctrl-geolocate",this._container),j.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");let a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}else{let a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=a,this._geolocateButton.setAttribute("aria-label",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=j.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Bl({element:this._dotElement}),this._circleElement=j.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Bl({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||this._watchState!=="ACTIVE_LOCK"||a.originalEvent&&a.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new s.k("trackuserlocationend")),this.fire(new s.k("userlocationlostfocus")))})}},this.options=s.e({},Ld,g)}onAdd(g){return this._map=g,this._container=j.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return s._(this,arguments,void 0,function*(e=!1){if(vr!==void 0&&!e)return vr;if(window.navigator.permissions===void 0)return vr=!!window.navigator.geolocation,vr;try{vr=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{vr=!!window.navigator.geolocation}return vr})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),j.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ls=0,Ds=!1}_isOutOfMapMaxBounds(g){let e=this._map.getMaxBounds(),a=g.coords;return e&&(a.longitude<e.getWest()||a.longitude>e.getEast()||a.latitude<e.getSouth()||a.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){let g=this._map.getBounds(),e=g.getSouthEast(),a=g.getNorthEast(),u=e.distanceTo(a),h=Math.ceil(this._accuracy/(u/this._map._container.clientHeight)*2);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ls--,Ds=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new s.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.k("trackuserlocationstart")),this.fire(new s.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ls++,Ls>1?(g={maximumAge:6e5,timeout:0},Ds=!0):(g=this.options.positionOptions,Ds=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},f.Hash=Cl,f.ImageSource=Bn,f.KeyboardHandler=Mr,f.LngLatBounds=ye,f.LogoControl=Eu,f.Map=class extends Pd{constructor(g){s.bf.mark(s.bg.create);let e=Object.assign(Object.assign({},ym),g);if(e.minZoom!=null&&e.maxZoom!=null&&e.minZoom>e.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(e.minPitch!=null&&e.maxPitch!=null&&e.minPitch>e.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(e.minPitch!=null&&e.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(e.maxPitch!=null&&e.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new ba(e.minZoom,e.maxZoom,e.minPitch,e.maxPitch,e.renderWorldCopies),{bearingSnap:e.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new xt,this._controls=[],this._mapId=s.a4(),this._contextLost=a=>{a.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new s.k("webglcontextlost",{originalEvent:a}))},this._contextRestored=a=>{this._setupPainter(),this.resize(),this._update(),this.fire(new s.k("webglcontextrestored",{originalEvent:a}))},this._onMapScroll=a=>{if(a.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=e.interactive,this._maxTileCacheSize=e.maxTileCacheSize,this._maxTileCacheZoomLevels=e.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=e.failIfMajorPerformanceCaveat===!0,this._preserveDrawingBuffer=e.preserveDrawingBuffer===!0,this._antialias=e.antialias===!0,this._trackResize=e.trackResize===!0,this._bearingSnap=e.bearingSnap,this._refreshExpiredTiles=e.refreshExpiredTiles===!0,this._fadeDuration=e.fadeDuration,this._crossSourceCollisions=e.crossSourceCollisions===!0,this._collectResourceTiming=e.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},zu),e.locale),this._clickTolerance=e.clickTolerance,this._overridePixelRatio=e.pixelRatio,this._maxCanvasSize=e.maxCanvasSize,this.transformCameraUpdate=e.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=e.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=ne.addThrottleControl(()=>this.isMoving()),this._requestManager=new ee(e.transformRequest),typeof e.container=="string"){if(this._container=document.getElementById(e.container),!this._container)throw new Error(`Container '${e.container}' not found.`)}else{if(!(e.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=e.container}if(e.maxBounds&&this.setMaxBounds(e.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let a=!1,u=zs(h=>{this._trackResize&&!this._removed&&(this.resize(h),this.redraw())},50);this._resizeObserver=new ResizeObserver(h=>{a?u(h):a=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Su(this,e),this._hash=e.hash&&new Cl(typeof e.hash=="string"&&e.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:e.center,zoom:e.zoom,bearing:e.bearing,pitch:e.pitch}),e.bounds&&(this.resize(),this.fitBounds(e.bounds,s.e({},e.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=e.localIdeographFontFamily,this._validateStyle=e.validateStyle,e.style&&this.setStyle(e.style,{localIdeographFontFamily:e.localIdeographFontFamily}),e.attributionControl&&this.addControl(new Ca(typeof e.attributionControl=="boolean"?void 0:e.attributionControl)),e.maplibreLogo&&this.addControl(new Eu,e.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update(a.dataType==="style"),this.fire(new s.k(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new s.k(`${a.dataType}dataloading`,a))}),this.on("dataabort",a=>{this.fire(new s.k("sourcedataabort",a))})}_getMapId(){return this._mapId}addControl(g,e){if(e===void 0&&(e=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new s.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let a=g.onAdd(this);this._controls.push(g);let u=this._controlPositions[e];return e.indexOf("bottom")!==-1?u.insertBefore(a,u.firstChild):u.appendChild(a),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new s.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let e=this._controls.indexOf(g);return e>-1&&this._controls.splice(e,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}calculateCameraOptionsFromTo(g,e,a,u){return u==null&&this.terrain&&(u=this.terrain.getElevationForLngLatZoom(a,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(g,e,a,u)}resize(g){var e;let a=this._containerDimensions(),u=a[0],h=a[1],m=this._getClampedPixelRatio(u,h);if(this._resizeCanvas(u,h,m),this.painter.resize(u,h,m),this.painter.overLimit()){let b=this.painter.context.gl;this._maxCanvasSize=[b.drawingBufferWidth,b.drawingBufferHeight];let k=this._getClampedPixelRatio(u,h);this._resizeCanvas(u,h,k),this.painter.resize(u,h,k)}this.transform.resize(u,h),(e=this._requestedCameraState)===null||e===void 0||e.resize(u,h);let x=!this._moving;return x&&(this.stop(),this.fire(new s.k("movestart",g)).fire(new s.k("move",g))),this.fire(new s.k("resize",g)),x&&this.fire(new s.k("moveend",g)),this}_getClampedPixelRatio(g,e){let{0:a,1:u}=this._maxCanvasSize,h=this.getPixelRatio(),m=g*h,x=e*h;return Math.min(m>a?a/m:1,x>u?u/x:1)*h}getPixelRatio(){var g;return(g=this._overridePixelRatio)!==null&&g!==void 0?g:devicePixelRatio}setPixelRatio(g){this._overridePixelRatio=g,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(ye.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this._update()}project(g){return this.transform.locationPoint(s.N.convert(g),this.style&&this.terrain)}unproject(g){return this.transform.pointLocation(s.P.convert(g),this.terrain)}isMoving(){var g;return this._moving||((g=this.handlers)===null||g===void 0?void 0:g.isMoving())}isZooming(){var g;return this._zooming||((g=this.handlers)===null||g===void 0?void 0:g.isZooming())}isRotating(){var g;return this._rotating||((g=this.handlers)===null||g===void 0?void 0:g.isRotating())}_createDelegatedListener(g,e,a){if(g==="mouseenter"||g==="mouseover"){let u=!1;return{layers:e,listener:a,delegates:{mousemove:m=>{let x=e.filter(k=>this.getLayer(k)),b=x.length!==0?this.queryRenderedFeatures(m.point,{layers:x}):[];b.length?u||(u=!0,a.call(this,new Ai(g,this,m.originalEvent,{features:b}))):u=!1},mouseout:()=>{u=!1}}}}if(g==="mouseleave"||g==="mouseout"){let u=!1;return{layers:e,listener:a,delegates:{mousemove:x=>{let b=e.filter(k=>this.getLayer(k));(b.length!==0?this.queryRenderedFeatures(x.point,{layers:b}):[]).length?u=!0:u&&(u=!1,a.call(this,new Ai(g,this,x.originalEvent)))},mouseout:x=>{u&&(u=!1,a.call(this,new Ai(g,this,x.originalEvent)))}}}}{let u=h=>{let m=e.filter(b=>this.getLayer(b)),x=m.length!==0?this.queryRenderedFeatures(h.point,{layers:m}):[];x.length&&(h.features=x,a.call(this,h),delete h.features)};return{layers:e,listener:a,delegates:{[g]:u}}}}_saveDelegatedListener(g,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(e)}_removeDelegatedListener(g,e,a){if(!this._delegatedListeners||!this._delegatedListeners[g])return;let u=this._delegatedListeners[g];for(let h=0;h<u.length;h++){let m=u[h];if(m.listener===a&&m.layers.length===e.length&&m.layers.every(x=>e.includes(x))){for(let x in m.delegates)this.off(x,m.delegates[x]);return void u.splice(h,1)}}}on(g,e,a){if(a===void 0)return super.on(g,e);let u=this._createDelegatedListener(g,typeof e=="string"?[e]:e,a);this._saveDelegatedListener(g,u);for(let h in u.delegates)this.on(h,u.delegates[h]);return this}once(g,e,a){if(a===void 0)return super.once(g,e);let u=typeof e=="string"?[e]:e,h=this._createDelegatedListener(g,u,a);for(let m in h.delegates){let x=h.delegates[m];h.delegates[m]=(...b)=>{this._removeDelegatedListener(g,u,a),x(...b)}}this._saveDelegatedListener(g,h);for(let m in h.delegates)this.once(m,h.delegates[m]);return this}off(g,e,a){return a===void 0?super.off(g,e):(this._removeDelegatedListener(g,typeof e=="string"?[e]:e,a),this)}queryRenderedFeatures(g,e){if(!this.style)return[];let a,u=g instanceof s.P||Array.isArray(g),h=u?g:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(u?{}:g)||{},h instanceof s.P||typeof h[0]=="number")a=[s.P.convert(h)];else{let m=s.P.convert(h[0]),x=s.P.convert(h[1]);a=[m,new s.P(x.x,m.y),x,new s.P(m.x,x.y),m]}return this.style.queryRenderedFeatures(a,e,this.transform)}querySourceFeatures(g,e){return this.style.querySourceFeatures(g,e)}setStyle(g,e){return(e=s.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&g?(this._diffStyle(g,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(g,e))}setTransformRequest(g){return this._requestManager.setTransformRequest(g),this}_getUIString(g){let e=this._locale[g];if(e==null)throw new Error(`Missing UI string '${g}'`);return e}_updateStyle(g,e){if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(g,e));let a=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!g)),g?(this.style=new ul(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g,e,a):this.style.loadJSON(g,e,a),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ul(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,e){if(typeof g=="string"){let a=this._requestManager.transformRequest(g,"Style");s.h(a,new AbortController).then(u=>{this._updateDiff(u.data,e)}).catch(u=>{u&&this.fire(new s.j(u))})}else typeof g=="object"&&this._updateDiff(g,e)}_updateDiff(g,e){try{this.style.setState(g,e)&&this._update(!0)}catch(a){s.w(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(g,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():s.w("There is no style added to the map.")}addSource(g,e){return this._lazyInitEmptyStyle(),this.style.addSource(g,e),this._update(!0)}isSourceLoaded(g){let e=this.style&&this.style.sourceCaches[g];if(e!==void 0)return e.loaded();this.fire(new s.j(new Error(`There is no source with ID '${g}'`)))}setTerrain(g){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),g){let e=this.style.sourceCaches[g.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${g.source}`);this.terrain===null&&e.reload();for(let a in this.style._layers){let u=this.style._layers[a];u.type==="hillshade"&&u.source===g.source&&s.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Cu(this.painter,e,g),this.painter.renderToTexture=new Md(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=a=>{a.dataType==="style"?this.terrain.sourceCache.freeRtt():a.dataType==="source"&&a.tile&&(a.sourceId!==g.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(a.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new s.k("terrain",{terrain:g})),this}getTerrain(){var g,e;return(e=(g=this.terrain)===null||g===void 0?void 0:g.options)!==null&&e!==void 0?e:null}areTilesLoaded(){let g=this.style&&this.style.sourceCaches;for(let e in g){let a=g[e]._tiles;for(let u in a){let h=a[u];if(h.state!=="loaded"&&h.state!=="errored")return!1}}return!0}removeSource(g){return this.style.removeSource(g),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,e,a={}){let{pixelRatio:u=1,sdf:h=!1,stretchX:m,stretchY:x,content:b,textFitWidth:k,textFitHeight:C}=a;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||s.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new s.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:I,height:P,data:F}=e,U=e;return this.style.addImage(g,{data:new s.R({width:I,height:P},new Uint8Array(F)),pixelRatio:u,stretchX:m,stretchY:x,content:b,textFitWidth:k,textFitHeight:C,sdf:h,version:0,userImage:U}),U.onAdd&&U.onAdd(this,g),this}}{let{width:I,height:P,data:F}=B.getImageData(e);this.style.addImage(g,{data:new s.R({width:I,height:P},F),pixelRatio:u,stretchX:m,stretchY:x,content:b,textFitWidth:k,textFitHeight:C,sdf:h,version:0})}}updateImage(g,e){let a=this.style.getImage(g);if(!a)return this.fire(new s.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let u=e instanceof HTMLImageElement||s.b(e)?B.getImageData(e):e,{width:h,height:m,data:x}=u;if(h===void 0||m===void 0)return this.fire(new s.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(h!==a.data.width||m!==a.data.height)return this.fire(new s.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));let b=!(e instanceof HTMLImageElement||s.b(e));return a.data.replace(x,b),this.style.updateImage(g,a),this}getImage(g){return this.style.getImage(g)}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new s.j(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g){return ne.getImage(this._requestManager.transformRequest(g,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(g,e){return this._lazyInitEmptyStyle(),this.style.addLayer(g,e),this._update(!0)}moveLayer(g,e){return this.style.moveLayer(g,e),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(g,e,a){return this.style.setLayerZoomRange(g,e,a),this._update(!0)}setFilter(g,e,a={}){return this.style.setFilter(g,e,a),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,e,a,u={}){return this.style.setPaintProperty(g,e,a,u),this._update(!0)}getPaintProperty(g,e){return this.style.getPaintProperty(g,e)}setLayoutProperty(g,e,a,u={}){return this.style.setLayoutProperty(g,e,a,u),this._update(!0)}getLayoutProperty(g,e){return this.style.getLayoutProperty(g,e)}setGlyphs(g,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(g,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(g,e,a={}){return this._lazyInitEmptyStyle(),this.style.addSprite(g,e,a,u=>{u||this._update(!0)}),this}removeSprite(g){return this._lazyInitEmptyStyle(),this.style.removeSprite(g),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(g,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(g,e,a=>{a||this._update(!0)}),this}setLight(g,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(g){return this._lazyInitEmptyStyle(),this.style.setSky(g),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(g,e){return this.style.setFeatureState(g,e),this._update()}removeFeatureState(g,e){return this.style.removeFeatureState(g,e),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let g=0,e=0;return this._container&&(g=this._container.clientWidth||400,e=this._container.clientHeight||300),[g,e]}_setupContainer(){let g=this._container;g.classList.add("maplibregl-map");let e=this._canvasContainer=j.create("div","maplibregl-canvas-container",g);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=j.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");let a=this._containerDimensions(),u=this._getClampedPixelRatio(a[0],a[1]);this._resizeCanvas(a[0],a[1],u);let h=this._controlContainer=j.create("div","maplibregl-control-container",g),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{m[x]=j.create("div",`maplibregl-ctrl-${x} `,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,e,a){this._canvas.width=Math.floor(a*g),this._canvas.height=Math.floor(a*e),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${e}px`}_setupPainter(){let g={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1},e=null;this._canvas.addEventListener("webglcontextcreationerror",u=>{e={requestedAttributes:g},u&&(e.statusMessage=u.statusMessage,e.type=u.type)},{once:!0});let a=this._canvas.getContext("webgl2",g)||this._canvas.getContext("webgl",g);if(!a){let u="Failed to initialize WebGL";throw e?(e.message=u,new Error(JSON.stringify(e))):new Error(u)}this.painter=new Tl(a,this.transform),de.testSupport(a)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_render(g){let e=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._removed)return;let a=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let h=this.transform.zoom,m=B.now();this.style.zoomHistory.update(h,m);let x=new s.z(h,{now:m,fadeDuration:e,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),b=x.crossFadingFactor();b===1&&b===this._crossFadingFactor||(a=!0,this._crossFadingFactor=b),this.style.update(x)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,e,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:e,showPadding:this.showPadding}),this.fire(new s.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,s.bf.mark(s.bg.load),this.fire(new s.k("load"))),this.style&&(this.style.hasTransitions()||a)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let u=this._sourcesDirty||this._styleDirty||this._placementDirty;return u||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new s.k("idle")),!this._loaded||this._fullyLoaded||u||(this._fullyLoaded=!0,s.bf.mark(s.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var g;this._hash&&this._hash.remove();for(let a of this._controls)a.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),ne.removeThrottleControl(this._imageQueueHandle),(g=this._resizeObserver)===null||g===void 0||g.disconnect();let e=this.painter.context.gl.getExtension("WEBGL_lose_context");e?.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),j.remove(this._canvasContainer),j.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),s.bf.clearMetrics(),this._removed=!0,this.fire(new s.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,B.frameAsync(this._frameRequest).then(g=>{s.bf.frame(g),this._frameRequest=null,this._render(g)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get version(){return Ad}getCameraTargetElevation(){return this.transform.elevation}},f.MapMouseEvent=Ai,f.MapTouchEvent=Oo,f.MapWheelEvent=Ed,f.Marker=Bl,f.NavigationControl=class{constructor(g){this._updateZoomButtons=()=>{let e=this._map.getZoom(),a=e===this._map.getMaxZoom(),u=e===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())},this._rotateCompassArrow=()=>{let e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=e},this._setButtonTitle=(e,a)=>{let u=this._map._getUIString(`NavigationControl.${a}`);e.title=u,e.setAttribute("aria-label",u)},this.options=s.e({},_m,g),this._container=j.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),j.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),j.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=j.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new vm(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){j.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,e){let a=j.create("button",g,this._container);return a.type="button",a.addEventListener("click",e),a}},f.Popup=class extends s.E{constructor(g){super(),this.remove=()=>(this._content&&j.remove(this._content),this._container&&(j.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new s.k("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var a;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=j.create("div","maplibregl-popup",this._map.getContainer()),this._tip=j.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let b of this.options.className.split(" "))this._container.classList.add(b);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Ut(this._lngLat,this._flatPos,this._map.transform):(a=this._lngLat)===null||a===void 0?void 0:a.wrap(),this._trackPointer&&!e)return;let u=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationPoint(this._lngLat));let h=this.options.anchor,m=Nl(this.options.offset);if(!h){let b=this._container.offsetWidth,k=this._container.offsetHeight,C;C=u.y+m.bottom.y<k?["top"]:u.y>this._map.transform.height-k?["bottom"]:[],u.x<b/2?C.push("left"):u.x>this._map.transform.width-b/2&&C.push("right"),h=C.length===0?"bottom":C.join("-")}let x=u.add(m[h]);this.options.subpixelPositioning||(x=x.round()),j.setTransform(this._container,`${Ia[h]} translate(${x.x}px,${x.y}px)`),Fl(this._container,h,"popup")},this._onClose=()=>{this.remove()},this.options=s.e(Object.create(ot),g)}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new s.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=s.N.convert(g),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(document.createTextNode(g))}setHTML(g){let e=document.createDocumentFragment(),a=document.createElement("body"),u;for(a.innerHTML=g;u=a.firstChild,u;)e.appendChild(u);return this.setDOMContent(e)}getMaxWidth(){var g;return(g=this._container)===null||g===void 0?void 0:g.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=j.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._container&&this._container.classList.add(g),this}removeClassName(g){return this._container&&this._container.classList.remove(g),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){if(this._container)return this._container.classList.toggle(g)}setSubpixelPositioning(g){this.options.subpixelPositioning=g}_createCloseButton(){this.options.closeButton&&(this._closeButton=j.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let g=this._container.querySelector(Ol);g&&g.focus()}},f.RasterDEMTileSource=Yt,f.RasterTileSource=zt,f.ScaleControl=class{constructor(g){this._onMove=()=>{Rs(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Rs(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},bn),g)}getDefaultPosition(){return"bottom-left"}onAdd(g){return this._map=g,this._container=j.create("div","maplibregl-ctrl maplibregl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){j.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},f.ScrollZoomHandler=Jr,f.Style=ul,f.TerrainControl=class{constructor(g){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=g}onAdd(g){return this._map=g,this._container=j.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=j.create("button","maplibregl-ctrl-terrain",this._container),j.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){j.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},f.TwoFingersTouchPitchHandler=Sa,f.TwoFingersTouchRotateHandler=wu,f.TwoFingersTouchZoomHandler=vu,f.TwoFingersTouchZoomRotateHandler=ku,f.VectorTileSource=fs,f.VideoSource=sa,f.addSourceType=(g,e)=>s._(void 0,void 0,void 0,function*(){if(ys(g))throw new Error(`A source type called "${g}" already exists.`);((a,u)=>{gs[a]=u})(g,e)}),f.clearPrewarmedResources=function(){let g=fr;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(to),fr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},f.getMaxParallelImageRequests=function(){return s.a.MAX_PARALLEL_IMAGE_REQUESTS},f.getRTLTextPluginStatus=function(){return yn().getRTLTextPluginStatus()},f.getVersion=function(){return Pu},f.getWorkerCount=function(){return mn.workerCount},f.getWorkerUrl=function(){return s.a.WORKER_URL},f.importScriptInWorkers=function(g){return ps().broadcast("IS",g)},f.prewarm=function(){To().acquire(to)},f.setMaxParallelImageRequests=function(g){s.a.MAX_PARALLEL_IMAGE_REQUESTS=g},f.setRTLTextPlugin=function(g,e){return yn().setRTLTextPlugin(g,e)},f.setWorkerCount=function(g){mn.workerCount=g},f.setWorkerUrl=function(g){s.a.WORKER_URL=g}});var p=i;return p})});var LI=Bt(Gt()),Ob=Bt(Cw()),Nb=Bt(Gt()),RI=Bt(Uh());var pr=Bt(Gt());function qh(i,n){return function(){return i.apply(n,arguments)}}var{toString:i6}=Object.prototype,{getPrototypeOf:M0}=Object,Cf=(i=>n=>{let c=i6.call(n);return i[c]||(i[c]=c.slice(8,-1).toLowerCase())})(Object.create(null)),Yn=i=>(i=i.toLowerCase(),n=>Cf(n)===i),zf=i=>n=>typeof n===i,{isArray:Lc}=Array,$h=zf("undefined");function r6(i){return i!==null&&!$h(i)&&i.constructor!==null&&!$h(i.constructor)&&dn(i.constructor.isBuffer)&&i.constructor.isBuffer(i)}var Pw=Yn("ArrayBuffer");function n6(i){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(i):n=i&&i.buffer&&Pw(i.buffer),n}var o6=zf("string"),dn=zf("function"),Mw=zf("number"),If=i=>i!==null&&typeof i=="object",a6=i=>i===!0||i===!1,Tf=i=>{if(Cf(i)!=="object")return!1;let n=M0(i);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(Symbol.toStringTag in i)&&!(Symbol.iterator in i)},s6=Yn("Date"),l6=Yn("File"),c6=Yn("Blob"),u6=Yn("FileList"),h6=i=>If(i)&&dn(i.pipe),d6=i=>{let n;return i&&(typeof FormData=="function"&&i instanceof FormData||dn(i.append)&&((n=Cf(i))==="formdata"||n==="object"&&dn(i.toString)&&i.toString()==="[object FormData]"))},p6=Yn("URLSearchParams"),[f6,m6,g6,y6]=["ReadableStream","Request","Response","Headers"].map(Yn),_6=i=>i.trim?i.trim():i.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Zh(i,n,{allOwnKeys:c=!1}={}){if(i===null||typeof i>"u")return;let p,f;if(typeof i!="object"&&(i=[i]),Lc(i))for(p=0,f=i.length;p<f;p++)n.call(null,i[p],p,i);else{let s=c?Object.getOwnPropertyNames(i):Object.keys(i),E=s.length,A;for(p=0;p<E;p++)A=s[p],n.call(null,i[A],A,i)}}function Aw(i,n){n=n.toLowerCase();let c=Object.keys(i),p=c.length,f;for(;p-- >0;)if(f=c[p],n===f.toLowerCase())return f;return null}var ol=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Lw=i=>!$h(i)&&i!==ol;function P0(){let{caseless:i}=Lw(this)&&this||{},n={},c=(p,f)=>{let s=i&&Aw(n,f)||f;Tf(n[s])&&Tf(p)?n[s]=P0(n[s],p):Tf(p)?n[s]=P0({},p):Lc(p)?n[s]=p.slice():n[s]=p};for(let p=0,f=arguments.length;p<f;p++)arguments[p]&&Zh(arguments[p],c);return n}var v6=(i,n,c,{allOwnKeys:p}={})=>(Zh(n,(f,s)=>{c&&dn(f)?i[s]=qh(f,c):i[s]=f},{allOwnKeys:p}),i),x6=i=>(i.charCodeAt(0)===65279&&(i=i.slice(1)),i),w6=(i,n,c,p)=>{i.prototype=Object.create(n.prototype,p),i.prototype.constructor=i,Object.defineProperty(i,"super",{value:n.prototype}),c&&Object.assign(i.prototype,c)},b6=(i,n,c,p)=>{let f,s,E,A={};if(n=n||{},i==null)return n;do{for(f=Object.getOwnPropertyNames(i),s=f.length;s-- >0;)E=f[s],(!p||p(E,i,n))&&!A[E]&&(n[E]=i[E],A[E]=!0);i=c!==!1&&M0(i)}while(i&&(!c||c(i,n))&&i!==Object.prototype);return n},k6=(i,n,c)=>{i=String(i),(c===void 0||c>i.length)&&(c=i.length),c-=n.length;let p=i.indexOf(n,c);return p!==-1&&p===c},S6=i=>{if(!i)return null;if(Lc(i))return i;let n=i.length;if(!Mw(n))return null;let c=new Array(n);for(;n-- >0;)c[n]=i[n];return c},E6=(i=>n=>i&&n instanceof i)(typeof Uint8Array<"u"&&M0(Uint8Array)),T6=(i,n)=>{let p=(i&&i[Symbol.iterator]).call(i),f;for(;(f=p.next())&&!f.done;){let s=f.value;n.call(i,s[0],s[1])}},C6=(i,n)=>{let c,p=[];for(;(c=i.exec(n))!==null;)p.push(c);return p},z6=Yn("HTMLFormElement"),I6=i=>i.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(c,p,f){return p.toUpperCase()+f}),zw=(({hasOwnProperty:i})=>(n,c)=>i.call(n,c))(Object.prototype),P6=Yn("RegExp"),Dw=(i,n)=>{let c=Object.getOwnPropertyDescriptors(i),p={};Zh(c,(f,s)=>{let E;(E=n(f,s,i))!==!1&&(p[s]=E||f)}),Object.defineProperties(i,p)},M6=i=>{Dw(i,(n,c)=>{if(dn(i)&&["arguments","caller","callee"].indexOf(c)!==-1)return!1;let p=i[c];if(dn(p)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+c+"'")})}})},A6=(i,n)=>{let c={},p=f=>{f.forEach(s=>{c[s]=!0})};return Lc(i)?p(i):p(String(i).split(n)),c},L6=()=>{},D6=(i,n)=>i!=null&&Number.isFinite(i=+i)?i:n,I0="abcdefghijklmnopqrstuvwxyz",Iw="0123456789",Rw={DIGIT:Iw,ALPHA:I0,ALPHA_DIGIT:I0+I0.toUpperCase()+Iw},R6=(i=16,n=Rw.ALPHA_DIGIT)=>{let c="",{length:p}=n;for(;i--;)c+=n[Math.random()*p|0];return c};function F6(i){return!!(i&&dn(i.append)&&i[Symbol.toStringTag]==="FormData"&&i[Symbol.iterator])}var B6=i=>{let n=new Array(10),c=(p,f)=>{if(If(p)){if(n.indexOf(p)>=0)return;if(!("toJSON"in p)){n[f]=p;let s=Lc(p)?[]:{};return Zh(p,(E,A)=>{let N=c(E,f+1);!$h(N)&&(s[A]=N)}),n[f]=void 0,s}}return p};return c(i,0)},O6=Yn("AsyncFunction"),N6=i=>i&&(If(i)||dn(i))&&dn(i.then)&&dn(i.catch),Fw=((i,n)=>i?setImmediate:n?((c,p)=>(ol.addEventListener("message",({source:f,data:s})=>{f===ol&&s===c&&p.length&&p.shift()()},!1),f=>{p.push(f),ol.postMessage(c,"*")}))(`axios@${Math.random()}`,[]):c=>setTimeout(c))(typeof setImmediate=="function",dn(ol.postMessage)),j6=typeof queueMicrotask<"u"?queueMicrotask.bind(ol):typeof process<"u"&&process.nextTick||Fw,fe={isArray:Lc,isArrayBuffer:Pw,isBuffer:r6,isFormData:d6,isArrayBufferView:n6,isString:o6,isNumber:Mw,isBoolean:a6,isObject:If,isPlainObject:Tf,isReadableStream:f6,isRequest:m6,isResponse:g6,isHeaders:y6,isUndefined:$h,isDate:s6,isFile:l6,isBlob:c6,isRegExp:P6,isFunction:dn,isStream:h6,isURLSearchParams:p6,isTypedArray:E6,isFileList:u6,forEach:Zh,merge:P0,extend:v6,trim:_6,stripBOM:x6,inherits:w6,toFlatObject:b6,kindOf:Cf,kindOfTest:Yn,endsWith:k6,toArray:S6,forEachEntry:T6,matchAll:C6,isHTMLForm:z6,hasOwnProperty:zw,hasOwnProp:zw,reduceDescriptors:Dw,freezeMethods:M6,toObjectSet:A6,toCamelCase:I6,noop:L6,toFiniteNumber:D6,findKey:Aw,global:ol,isContextDefined:Lw,ALPHABET:Rw,generateString:R6,isSpecCompliantForm:F6,toJSONObject:B6,isAsyncFn:O6,isThenable:N6,setImmediate:Fw,asap:j6};function Dc(i,n,c,p,f){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=i,this.name="AxiosError",n&&(this.code=n),c&&(this.config=c),p&&(this.request=p),f&&(this.response=f,this.status=f.status?f.status:null)}fe.inherits(Dc,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:fe.toJSONObject(this.config),code:this.code,status:this.status}}});var Bw=Dc.prototype,Ow={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(i=>{Ow[i]={value:i}});Object.defineProperties(Dc,Ow);Object.defineProperty(Bw,"isAxiosError",{value:!0});Dc.from=(i,n,c,p,f,s)=>{let E=Object.create(Bw);return fe.toFlatObject(i,E,function(N){return N!==Error.prototype},A=>A!=="isAxiosError"),Dc.call(E,i.message,n,c,p,f),E.cause=i,E.name=i.name,s&&Object.assign(E,s),E};var pt=Dc;var Pf=null;function A0(i){return fe.isPlainObject(i)||fe.isArray(i)}function jw(i){return fe.endsWith(i,"[]")?i.slice(0,-2):i}function Nw(i,n,c){return i?i.concat(n).map(function(f,s){return f=jw(f),!c&&s?"["+f+"]":f}).join(c?".":""):n}function V6(i){return fe.isArray(i)&&!i.some(A0)}var U6=fe.toFlatObject(fe,{},null,function(n){return/^is[A-Z]/.test(n)});function q6(i,n,c){if(!fe.isObject(i))throw new TypeError("target must be an object");n=n||new(Pf||FormData),c=fe.toFlatObject(c,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Se,Ae){return!fe.isUndefined(Ae[Se])});let p=c.metaTokens,f=c.visitor||j,s=c.dots,E=c.indexes,N=(c.Blob||typeof Blob<"u"&&Blob)&&fe.isSpecCompliantForm(n);if(!fe.isFunction(f))throw new TypeError("visitor must be a function");function B(xe){if(xe===null)return"";if(fe.isDate(xe))return xe.toISOString();if(!N&&fe.isBlob(xe))throw new pt("Blob is not supported. Use a Buffer instead.");return fe.isArrayBuffer(xe)||fe.isTypedArray(xe)?N&&typeof Blob=="function"?new Blob([xe]):Buffer.from(xe):xe}function j(xe,Se,Ae){let ne=xe;if(xe&&!Ae&&typeof xe=="object"){if(fe.endsWith(Se,"{}"))Se=p?Se:Se.slice(0,-2),xe=JSON.stringify(xe);else if(fe.isArray(xe)&&V6(xe)||(fe.isFileList(xe)||fe.endsWith(Se,"[]"))&&(ne=fe.toArray(xe)))return Se=jw(Se),ne.forEach(function(ae,be){!(fe.isUndefined(ae)||ae===null)&&n.append(E===!0?Nw([Se],be,s):E===null?Se:Se+"[]",B(ae))}),!1}return A0(xe)?!0:(n.append(Nw(Ae,Se,s),B(xe)),!1)}let de=[],ge=Object.assign(U6,{defaultVisitor:j,convertValue:B,isVisitable:A0});function Te(xe,Se){if(!fe.isUndefined(xe)){if(de.indexOf(xe)!==-1)throw Error("Circular reference detected in "+Se.join("."));de.push(xe),fe.forEach(xe,function(ne,ee){(!(fe.isUndefined(ne)||ne===null)&&f.call(n,ne,fe.isString(ee)?ee.trim():ee,Se,ge))===!0&&Te(ne,Se?Se.concat(ee):[ee])}),de.pop()}}if(!fe.isObject(i))throw new TypeError("data must be an object");return Te(i),n}var us=q6;function Vw(i){let n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(i).replace(/[!'()~]|%20|%00/g,function(p){return n[p]})}function Uw(i,n){this._pairs=[],i&&us(i,this,n)}var qw=Uw.prototype;qw.append=function(n,c){this._pairs.push([n,c])};qw.toString=function(n){let c=n?function(p){return n.call(this,p,Vw)}:Vw;return this._pairs.map(function(f){return c(f[0])+"="+c(f[1])},"").join("&")};var Mf=Uw;function $6(i){return encodeURIComponent(i).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Hh(i,n,c){if(!n)return i;let p=c&&c.encode||$6,f=c&&c.serialize,s;if(f?s=f(n,c):s=fe.isURLSearchParams(n)?n.toString():new Mf(n,c).toString(p),s){let E=i.indexOf("#");E!==-1&&(i=i.slice(0,E)),i+=(i.indexOf("?")===-1?"?":"&")+s}return i}var L0=class{constructor(){this.handlers=[]}use(n,c,p){return this.handlers.push({fulfilled:n,rejected:c,synchronous:p?p.synchronous:!1,runWhen:p?p.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){fe.forEach(this.handlers,function(p){p!==null&&n(p)})}},D0=L0;var Af={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};var $w=typeof URLSearchParams<"u"?URLSearchParams:Mf;var Zw=typeof FormData<"u"?FormData:null;var Hw=typeof Blob<"u"?Blob:null;var Gw={isBrowser:!0,classes:{URLSearchParams:$w,FormData:Zw,Blob:Hw},protocols:["http","https","file","blob","url","data"]};var B0={};B3(B0,{hasBrowserEnv:()=>F0,hasStandardBrowserEnv:()=>Z6,hasStandardBrowserWebWorkerEnv:()=>H6,navigator:()=>R0,origin:()=>G6});var F0=typeof window<"u"&&typeof document<"u",R0=typeof navigator=="object"&&navigator||void 0,Z6=F0&&(!R0||["ReactNative","NativeScript","NS"].indexOf(R0.product)<0),H6=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",G6=F0&&window.location.href||"http://localhost";var _i={...B0,...Gw};function O0(i,n){return us(i,new _i.classes.URLSearchParams,Object.assign({visitor:function(c,p,f,s){return _i.isNode&&fe.isBuffer(c)?(this.append(p,c.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},n))}function W6(i){return fe.matchAll(/\w+|\[(\w*)]/g,i).map(n=>n[0]==="[]"?"":n[1]||n[0])}function X6(i){let n={},c=Object.keys(i),p,f=c.length,s;for(p=0;p<f;p++)s=c[p],n[s]=i[s];return n}function K6(i){function n(c,p,f,s){let E=c[s++];if(E==="__proto__")return!0;let A=Number.isFinite(+E),N=s>=c.length;return E=!E&&fe.isArray(f)?f.length:E,N?(fe.hasOwnProp(f,E)?f[E]=[f[E],p]:f[E]=p,!A):((!f[E]||!fe.isObject(f[E]))&&(f[E]=[]),n(c,p,f[E],s)&&fe.isArray(f[E])&&(f[E]=X6(f[E])),!A)}if(fe.isFormData(i)&&fe.isFunction(i.entries)){let c={};return fe.forEachEntry(i,(p,f)=>{n(W6(p),f,c,0)}),c}return null}var Lf=K6;function J6(i,n,c){if(fe.isString(i))try{return(n||JSON.parse)(i),fe.trim(i)}catch(p){if(p.name!=="SyntaxError")throw p}return(c||JSON.stringify)(i)}var N0={transitional:Af,adapter:["xhr","http","fetch"],transformRequest:[function(n,c){let p=c.getContentType()||"",f=p.indexOf("application/json")>-1,s=fe.isObject(n);if(s&&fe.isHTMLForm(n)&&(n=new FormData(n)),fe.isFormData(n))return f?JSON.stringify(Lf(n)):n;if(fe.isArrayBuffer(n)||fe.isBuffer(n)||fe.isStream(n)||fe.isFile(n)||fe.isBlob(n)||fe.isReadableStream(n))return n;if(fe.isArrayBufferView(n))return n.buffer;if(fe.isURLSearchParams(n))return c.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let A;if(s){if(p.indexOf("application/x-www-form-urlencoded")>-1)return O0(n,this.formSerializer).toString();if((A=fe.isFileList(n))||p.indexOf("multipart/form-data")>-1){let N=this.env&&this.env.FormData;return us(A?{"files[]":n}:n,N&&new N,this.formSerializer)}}return s||f?(c.setContentType("application/json",!1),J6(n)):n}],transformResponse:[function(n){let c=this.transitional||N0.transitional,p=c&&c.forcedJSONParsing,f=this.responseType==="json";if(fe.isResponse(n)||fe.isReadableStream(n))return n;if(n&&fe.isString(n)&&(p&&!this.responseType||f)){let E=!(c&&c.silentJSONParsing)&&f;try{return JSON.parse(n)}catch(A){if(E)throw A.name==="SyntaxError"?pt.from(A,pt.ERR_BAD_RESPONSE,this,null,this.response):A}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:_i.classes.FormData,Blob:_i.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};fe.forEach(["delete","get","head","post","put","patch"],i=>{N0.headers[i]={}});var Rc=N0;var Y6=fe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Ww=i=>{let n={},c,p,f;return i&&i.split(`
`).forEach(function(E){f=E.indexOf(":"),c=E.substring(0,f).trim().toLowerCase(),p=E.substring(f+1).trim(),!(!c||n[c]&&Y6[c])&&(c==="set-cookie"?n[c]?n[c].push(p):n[c]=[p]:n[c]=n[c]?n[c]+", "+p:p)}),n};var Xw=Symbol("internals");function Gh(i){return i&&String(i).trim().toLowerCase()}function Df(i){return i===!1||i==null?i:fe.isArray(i)?i.map(Df):String(i)}function Q6(i){let n=Object.create(null),c=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g,p;for(;p=c.exec(i);)n[p[1]]=p[2];return n}var eS=i=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(i.trim());function j0(i,n,c,p,f){if(fe.isFunction(p))return p.call(this,n,c);if(f&&(n=c),!!fe.isString(n)){if(fe.isString(p))return n.indexOf(p)!==-1;if(fe.isRegExp(p))return p.test(n)}}function tS(i){return i.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,c,p)=>c.toUpperCase()+p)}function iS(i,n){let c=fe.toCamelCase(" "+n);["get","set","has"].forEach(p=>{Object.defineProperty(i,p+c,{value:function(f,s,E){return this[p].call(this,n,f,s,E)},configurable:!0})})}var Fc=class{constructor(n){n&&this.set(n)}set(n,c,p){let f=this;function s(A,N,B){let j=Gh(N);if(!j)throw new Error("header name must be a non-empty string");let de=fe.findKey(f,j);(!de||f[de]===void 0||B===!0||B===void 0&&f[de]!==!1)&&(f[de||N]=Df(A))}let E=(A,N)=>fe.forEach(A,(B,j)=>s(B,j,N));if(fe.isPlainObject(n)||n instanceof this.constructor)E(n,c);else if(fe.isString(n)&&(n=n.trim())&&!eS(n))E(Ww(n),c);else if(fe.isHeaders(n))for(let[A,N]of n.entries())s(N,A,p);else n!=null&&s(c,n,p);return this}get(n,c){if(n=Gh(n),n){let p=fe.findKey(this,n);if(p){let f=this[p];if(!c)return f;if(c===!0)return Q6(f);if(fe.isFunction(c))return c.call(this,f,p);if(fe.isRegExp(c))return c.exec(f);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,c){if(n=Gh(n),n){let p=fe.findKey(this,n);return!!(p&&this[p]!==void 0&&(!c||j0(this,this[p],p,c)))}return!1}delete(n,c){let p=this,f=!1;function s(E){if(E=Gh(E),E){let A=fe.findKey(p,E);A&&(!c||j0(p,p[A],A,c))&&(delete p[A],f=!0)}}return fe.isArray(n)?n.forEach(s):s(n),f}clear(n){let c=Object.keys(this),p=c.length,f=!1;for(;p--;){let s=c[p];(!n||j0(this,this[s],s,n,!0))&&(delete this[s],f=!0)}return f}normalize(n){let c=this,p={};return fe.forEach(this,(f,s)=>{let E=fe.findKey(p,s);if(E){c[E]=Df(f),delete c[s];return}let A=n?tS(s):String(s).trim();A!==s&&delete c[s],c[A]=Df(f),p[A]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){let c=Object.create(null);return fe.forEach(this,(p,f)=>{p!=null&&p!==!1&&(c[f]=n&&fe.isArray(p)?p.join(", "):p)}),c}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,c])=>n+": "+c).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...c){let p=new this(n);return c.forEach(f=>p.set(f)),p}static accessor(n){let p=(this[Xw]=this[Xw]={accessors:{}}).accessors,f=this.prototype;function s(E){let A=Gh(E);p[A]||(iS(f,E),p[A]=!0)}return fe.isArray(n)?n.forEach(s):s(n),this}};Fc.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);fe.reduceDescriptors(Fc.prototype,({value:i},n)=>{let c=n[0].toUpperCase()+n.slice(1);return{get:()=>i,set(p){this[c]=p}}});fe.freezeMethods(Fc);var Mi=Fc;function Wh(i,n){let c=this||Rc,p=n||c,f=Mi.from(p.headers),s=p.data;return fe.forEach(i,function(A){s=A.call(c,s,f.normalize(),n?n.status:void 0)}),f.normalize(),s}function Xh(i){return!!(i&&i.__CANCEL__)}function Kw(i,n,c){pt.call(this,i??"canceled",pt.ERR_CANCELED,n,c),this.name="CanceledError"}fe.inherits(Kw,pt,{__CANCEL__:!0});var bo=Kw;function Kh(i,n,c){let p=c.config.validateStatus;!c.status||!p||p(c.status)?i(c):n(new pt("Request failed with status code "+c.status,[pt.ERR_BAD_REQUEST,pt.ERR_BAD_RESPONSE][Math.floor(c.status/100)-4],c.config,c.request,c))}function V0(i){let n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(i);return n&&n[1]||""}function rS(i,n){i=i||10;let c=new Array(i),p=new Array(i),f=0,s=0,E;return n=n!==void 0?n:1e3,function(N){let B=Date.now(),j=p[s];E||(E=B),c[f]=N,p[f]=B;let de=s,ge=0;for(;de!==f;)ge+=c[de++],de=de%i;if(f=(f+1)%i,f===s&&(s=(s+1)%i),B-E<n)return;let Te=j&&B-j;return Te?Math.round(ge*1e3/Te):void 0}}var Jw=rS;function nS(i,n){let c=0,p=1e3/n,f,s,E=(B,j=Date.now())=>{c=j,f=null,s&&(clearTimeout(s),s=null),i.apply(null,B)};return[(...B)=>{let j=Date.now(),de=j-c;de>=p?E(B,j):(f=B,s||(s=setTimeout(()=>{s=null,E(f)},p-de)))},()=>f&&E(f)]}var Yw=nS;var Bc=(i,n,c=3)=>{let p=0,f=Jw(50,250);return Yw(s=>{let E=s.loaded,A=s.lengthComputable?s.total:void 0,N=E-p,B=f(N),j=E<=A;p=E;let de={loaded:E,total:A,progress:A?E/A:void 0,bytes:N,rate:B||void 0,estimated:B&&A&&j?(A-E)/B:void 0,event:s,lengthComputable:A!=null,[n?"download":"upload"]:!0};i(de)},c)},U0=(i,n)=>{let c=i!=null;return[p=>n[0]({lengthComputable:c,total:i,loaded:p}),n[1]]},q0=i=>(...n)=>fe.asap(()=>i(...n));var Qw=_i.hasStandardBrowserEnv?function(){let n=_i.navigator&&/(msie|trident)/i.test(_i.navigator.userAgent),c=document.createElement("a"),p;function f(s){let E=s;return n&&(c.setAttribute("href",E),E=c.href),c.setAttribute("href",E),{href:c.href,protocol:c.protocol?c.protocol.replace(/:$/,""):"",host:c.host,search:c.search?c.search.replace(/^\?/,""):"",hash:c.hash?c.hash.replace(/^#/,""):"",hostname:c.hostname,port:c.port,pathname:c.pathname.charAt(0)==="/"?c.pathname:"/"+c.pathname}}return p=f(window.location.href),function(E){let A=fe.isString(E)?f(E):E;return A.protocol===p.protocol&&A.host===p.host}}():function(){return function(){return!0}}();var eb=_i.hasStandardBrowserEnv?{write(i,n,c,p,f,s){let E=[i+"="+encodeURIComponent(n)];fe.isNumber(c)&&E.push("expires="+new Date(c).toGMTString()),fe.isString(p)&&E.push("path="+p),fe.isString(f)&&E.push("domain="+f),s===!0&&E.push("secure"),document.cookie=E.join("; ")},read(i){let n=document.cookie.match(new RegExp("(^|;\\s*)("+i+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(i){this.write(i,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function $0(i){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(i)}function Z0(i,n){return n?i.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):i}function Jh(i,n){return i&&!$0(n)?Z0(i,n):n}var tb=i=>i instanceof Mi?{...i}:i;function Qn(i,n){n=n||{};let c={};function p(B,j,de){return fe.isPlainObject(B)&&fe.isPlainObject(j)?fe.merge.call({caseless:de},B,j):fe.isPlainObject(j)?fe.merge({},j):fe.isArray(j)?j.slice():j}function f(B,j,de){if(fe.isUndefined(j)){if(!fe.isUndefined(B))return p(void 0,B,de)}else return p(B,j,de)}function s(B,j){if(!fe.isUndefined(j))return p(void 0,j)}function E(B,j){if(fe.isUndefined(j)){if(!fe.isUndefined(B))return p(void 0,B)}else return p(void 0,j)}function A(B,j,de){if(de in n)return p(B,j);if(de in i)return p(void 0,B)}let N={url:s,method:s,data:s,baseURL:E,transformRequest:E,transformResponse:E,paramsSerializer:E,timeout:E,timeoutMessage:E,withCredentials:E,withXSRFToken:E,adapter:E,responseType:E,xsrfCookieName:E,xsrfHeaderName:E,onUploadProgress:E,onDownloadProgress:E,decompress:E,maxContentLength:E,maxBodyLength:E,beforeRedirect:E,transport:E,httpAgent:E,httpsAgent:E,cancelToken:E,socketPath:E,responseEncoding:E,validateStatus:A,headers:(B,j)=>f(tb(B),tb(j),!0)};return fe.forEach(Object.keys(Object.assign({},i,n)),function(j){let de=N[j]||f,ge=de(i[j],n[j],j);fe.isUndefined(ge)&&de!==A||(c[j]=ge)}),c}var Rf=i=>{let n=Qn({},i),{data:c,withXSRFToken:p,xsrfHeaderName:f,xsrfCookieName:s,headers:E,auth:A}=n;n.headers=E=Mi.from(E),n.url=Hh(Jh(n.baseURL,n.url),i.params,i.paramsSerializer),A&&E.set("Authorization","Basic "+btoa((A.username||"")+":"+(A.password?unescape(encodeURIComponent(A.password)):"")));let N;if(fe.isFormData(c)){if(_i.hasStandardBrowserEnv||_i.hasStandardBrowserWebWorkerEnv)E.setContentType(void 0);else if((N=E.getContentType())!==!1){let[B,...j]=N?N.split(";").map(de=>de.trim()).filter(Boolean):[];E.setContentType([B||"multipart/form-data",...j].join("; "))}}if(_i.hasStandardBrowserEnv&&(p&&fe.isFunction(p)&&(p=p(n)),p||p!==!1&&Qw(n.url))){let B=f&&s&&eb.read(s);B&&E.set(f,B)}return n};var oS=typeof XMLHttpRequest<"u",ib=oS&&function(i){return new Promise(function(c,p){let f=Rf(i),s=f.data,E=Mi.from(f.headers).normalize(),{responseType:A,onUploadProgress:N,onDownloadProgress:B}=f,j,de,ge,Te,xe;function Se(){Te&&Te(),xe&&xe(),f.cancelToken&&f.cancelToken.unsubscribe(j),f.signal&&f.signal.removeEventListener("abort",j)}let Ae=new XMLHttpRequest;Ae.open(f.method.toUpperCase(),f.url,!0),Ae.timeout=f.timeout;function ne(){if(!Ae)return;let ae=Mi.from("getAllResponseHeaders"in Ae&&Ae.getAllResponseHeaders()),Ie={data:!A||A==="text"||A==="json"?Ae.responseText:Ae.response,status:Ae.status,statusText:Ae.statusText,headers:ae,config:i,request:Ae};Kh(function(Ge){c(Ge),Se()},function(Ge){p(Ge),Se()},Ie),Ae=null}"onloadend"in Ae?Ae.onloadend=ne:Ae.onreadystatechange=function(){!Ae||Ae.readyState!==4||Ae.status===0&&!(Ae.responseURL&&Ae.responseURL.indexOf("file:")===0)||setTimeout(ne)},Ae.onabort=function(){Ae&&(p(new pt("Request aborted",pt.ECONNABORTED,i,Ae)),Ae=null)},Ae.onerror=function(){p(new pt("Network Error",pt.ERR_NETWORK,i,Ae)),Ae=null},Ae.ontimeout=function(){let be=f.timeout?"timeout of "+f.timeout+"ms exceeded":"timeout exceeded",Ie=f.transitional||Af;f.timeoutErrorMessage&&(be=f.timeoutErrorMessage),p(new pt(be,Ie.clarifyTimeoutError?pt.ETIMEDOUT:pt.ECONNABORTED,i,Ae)),Ae=null},s===void 0&&E.setContentType(null),"setRequestHeader"in Ae&&fe.forEach(E.toJSON(),function(be,Ie){Ae.setRequestHeader(Ie,be)}),fe.isUndefined(f.withCredentials)||(Ae.withCredentials=!!f.withCredentials),A&&A!=="json"&&(Ae.responseType=f.responseType),B&&([ge,xe]=Bc(B,!0),Ae.addEventListener("progress",ge)),N&&Ae.upload&&([de,Te]=Bc(N),Ae.upload.addEventListener("progress",de),Ae.upload.addEventListener("loadend",Te)),(f.cancelToken||f.signal)&&(j=ae=>{Ae&&(p(!ae||ae.type?new bo(null,i,Ae):ae),Ae.abort(),Ae=null)},f.cancelToken&&f.cancelToken.subscribe(j),f.signal&&(f.signal.aborted?j():f.signal.addEventListener("abort",j)));let ee=V0(f.url);if(ee&&_i.protocols.indexOf(ee)===-1){p(new pt("Unsupported protocol "+ee+":",pt.ERR_BAD_REQUEST,i));return}Ae.send(s||null)})};var aS=(i,n)=>{let{length:c}=i=i?i.filter(Boolean):[];if(n||c){let p=new AbortController,f,s=function(B){if(!f){f=!0,A();let j=B instanceof Error?B:this.reason;p.abort(j instanceof pt?j:new bo(j instanceof Error?j.message:j))}},E=n&&setTimeout(()=>{E=null,s(new pt(`timeout ${n} of ms exceeded`,pt.ETIMEDOUT))},n),A=()=>{i&&(E&&clearTimeout(E),E=null,i.forEach(B=>{B.unsubscribe?B.unsubscribe(s):B.removeEventListener("abort",s)}),i=null)};i.forEach(B=>B.addEventListener("abort",s));let{signal:N}=p;return N.unsubscribe=()=>fe.asap(A),N}},rb=aS;var sS=function*(i,n){let c=i.byteLength;if(!n||c<n){yield i;return}let p=0,f;for(;p<c;)f=p+n,yield i.slice(p,f),p=f},lS=async function*(i,n){for await(let c of cS(i))yield*sS(c,n)},cS=async function*(i){if(i[Symbol.asyncIterator]){yield*i;return}let n=i.getReader();try{for(;;){let{done:c,value:p}=await n.read();if(c)break;yield p}}finally{await n.cancel()}},H0=(i,n,c,p)=>{let f=lS(i,n),s=0,E,A=N=>{E||(E=!0,p&&p(N))};return new ReadableStream({async pull(N){try{let{done:B,value:j}=await f.next();if(B){A(),N.close();return}let de=j.byteLength;if(c){let ge=s+=de;c(ge)}N.enqueue(new Uint8Array(j))}catch(B){throw A(B),B}},cancel(N){return A(N),f.return()}},{highWaterMark:2})};var Bf=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",ob=Bf&&typeof ReadableStream=="function",uS=Bf&&(typeof TextEncoder=="function"?(i=>n=>i.encode(n))(new TextEncoder):async i=>new Uint8Array(await new Response(i).arrayBuffer())),ab=(i,...n)=>{try{return!!i(...n)}catch{return!1}},hS=ob&&ab(()=>{let i=!1,n=new Request(_i.origin,{body:new ReadableStream,method:"POST",get duplex(){return i=!0,"half"}}).headers.has("Content-Type");return i&&!n}),nb=64*1024,G0=ob&&ab(()=>fe.isReadableStream(new Response("").body)),Ff={stream:G0&&(i=>i.body)};Bf&&(i=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!Ff[n]&&(Ff[n]=fe.isFunction(i[n])?c=>c[n]():(c,p)=>{throw new pt(`Response type '${n}' is not supported`,pt.ERR_NOT_SUPPORT,p)})})})(new Response);var dS=async i=>{if(i==null)return 0;if(fe.isBlob(i))return i.size;if(fe.isSpecCompliantForm(i))return(await new Request(_i.origin,{method:"POST",body:i}).arrayBuffer()).byteLength;if(fe.isArrayBufferView(i)||fe.isArrayBuffer(i))return i.byteLength;if(fe.isURLSearchParams(i)&&(i=i+""),fe.isString(i))return(await uS(i)).byteLength},pS=async(i,n)=>{let c=fe.toFiniteNumber(i.getContentLength());return c??dS(n)},sb=Bf&&(async i=>{let{url:n,method:c,data:p,signal:f,cancelToken:s,timeout:E,onDownloadProgress:A,onUploadProgress:N,responseType:B,headers:j,withCredentials:de="same-origin",fetchOptions:ge}=Rf(i);B=B?(B+"").toLowerCase():"text";let Te=rb([f,s&&s.toAbortSignal()],E),xe,Se=Te&&Te.unsubscribe&&(()=>{Te.unsubscribe()}),Ae;try{if(N&&hS&&c!=="get"&&c!=="head"&&(Ae=await pS(j,p))!==0){let Ie=new Request(n,{method:"POST",body:p,duplex:"half"}),Ye;if(fe.isFormData(p)&&(Ye=Ie.headers.get("content-type"))&&j.setContentType(Ye),Ie.body){let[Ge,rt]=U0(Ae,Bc(q0(N)));p=H0(Ie.body,nb,Ge,rt)}}fe.isString(de)||(de=de?"include":"omit");let ne="credentials"in Request.prototype;xe=new Request(n,{...ge,signal:Te,method:c.toUpperCase(),headers:j.normalize().toJSON(),body:p,duplex:"half",credentials:ne?de:void 0});let ee=await fetch(xe),ae=G0&&(B==="stream"||B==="response");if(G0&&(A||ae&&Se)){let Ie={};["status","statusText","headers"].forEach(ct=>{Ie[ct]=ee[ct]});let Ye=fe.toFiniteNumber(ee.headers.get("content-length")),[Ge,rt]=A&&U0(Ye,Bc(q0(A),!0))||[];ee=new Response(H0(ee.body,nb,Ge,()=>{rt&&rt(),Se&&Se()}),Ie)}B=B||"text";let be=await Ff[fe.findKey(Ff,B)||"text"](ee,i);return!ae&&Se&&Se(),await new Promise((Ie,Ye)=>{Kh(Ie,Ye,{data:be,headers:Mi.from(ee.headers),status:ee.status,statusText:ee.statusText,config:i,request:xe})})}catch(ne){throw Se&&Se(),ne&&ne.name==="TypeError"&&/fetch/i.test(ne.message)?Object.assign(new pt("Network Error",pt.ERR_NETWORK,i,xe),{cause:ne.cause||ne}):pt.from(ne,ne&&ne.code,i,xe)}});var W0={http:Pf,xhr:ib,fetch:sb};fe.forEach(W0,(i,n)=>{if(i){try{Object.defineProperty(i,"name",{value:n})}catch{}Object.defineProperty(i,"adapterName",{value:n})}});var lb=i=>`- ${i}`,fS=i=>fe.isFunction(i)||i===null||i===!1,Of={getAdapter:i=>{i=fe.isArray(i)?i:[i];let{length:n}=i,c,p,f={};for(let s=0;s<n;s++){c=i[s];let E;if(p=c,!fS(c)&&(p=W0[(E=String(c)).toLowerCase()],p===void 0))throw new pt(`Unknown adapter '${E}'`);if(p)break;f[E||"#"+s]=p}if(!p){let s=Object.entries(f).map(([A,N])=>`adapter ${A} `+(N===!1?"is not supported by the environment":"is not available in the build")),E=n?s.length>1?`since :
`+s.map(lb).join(`
`):" "+lb(s[0]):"as no adapter specified";throw new pt("There is no suitable adapter to dispatch the request "+E,"ERR_NOT_SUPPORT")}return p},adapters:W0};function X0(i){if(i.cancelToken&&i.cancelToken.throwIfRequested(),i.signal&&i.signal.aborted)throw new bo(null,i)}function Nf(i){return X0(i),i.headers=Mi.from(i.headers),i.data=Wh.call(i,i.transformRequest),["post","put","patch"].indexOf(i.method)!==-1&&i.headers.setContentType("application/x-www-form-urlencoded",!1),Of.getAdapter(i.adapter||Rc.adapter)(i).then(function(p){return X0(i),p.data=Wh.call(i,i.transformResponse,p),p.headers=Mi.from(p.headers),p},function(p){return Xh(p)||(X0(i),p&&p.response&&(p.response.data=Wh.call(i,i.transformResponse,p.response),p.response.headers=Mi.from(p.response.headers))),Promise.reject(p)})}var jf="1.7.7";var K0={};["object","boolean","number","function","string","symbol"].forEach((i,n)=>{K0[i]=function(p){return typeof p===i||"a"+(n<1?"n ":" ")+i}});var cb={};K0.transitional=function(n,c,p){function f(s,E){return"[Axios v"+jf+"] Transitional option '"+s+"'"+E+(p?". "+p:"")}return(s,E,A)=>{if(n===!1)throw new pt(f(E," has been removed"+(c?" in "+c:"")),pt.ERR_DEPRECATED);return c&&!cb[E]&&(cb[E]=!0,console.warn(f(E," has been deprecated since v"+c+" and will be removed in the near future"))),n?n(s,E,A):!0}};function mS(i,n,c){if(typeof i!="object")throw new pt("options must be an object",pt.ERR_BAD_OPTION_VALUE);let p=Object.keys(i),f=p.length;for(;f-- >0;){let s=p[f],E=n[s];if(E){let A=i[s],N=A===void 0||E(A,s,i);if(N!==!0)throw new pt("option "+s+" must be "+N,pt.ERR_BAD_OPTION_VALUE);continue}if(c!==!0)throw new pt("Unknown option "+s,pt.ERR_BAD_OPTION)}}var Vf={assertOptions:mS,validators:K0};var hs=Vf.validators,Oc=class{constructor(n){this.defaults=n,this.interceptors={request:new D0,response:new D0}}async request(n,c){try{return await this._request(n,c)}catch(p){if(p instanceof Error){let f;Error.captureStackTrace?Error.captureStackTrace(f={}):f=new Error;let s=f.stack?f.stack.replace(/^.+\n/,""):"";try{p.stack?s&&!String(p.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(p.stack+=`
`+s):p.stack=s}catch{}}throw p}}_request(n,c){typeof n=="string"?(c=c||{},c.url=n):c=n||{},c=Qn(this.defaults,c);let{transitional:p,paramsSerializer:f,headers:s}=c;p!==void 0&&Vf.assertOptions(p,{silentJSONParsing:hs.transitional(hs.boolean),forcedJSONParsing:hs.transitional(hs.boolean),clarifyTimeoutError:hs.transitional(hs.boolean)},!1),f!=null&&(fe.isFunction(f)?c.paramsSerializer={serialize:f}:Vf.assertOptions(f,{encode:hs.function,serialize:hs.function},!0)),c.method=(c.method||this.defaults.method||"get").toLowerCase();let E=s&&fe.merge(s.common,s[c.method]);s&&fe.forEach(["delete","get","head","post","put","patch","common"],xe=>{delete s[xe]}),c.headers=Mi.concat(E,s);let A=[],N=!0;this.interceptors.request.forEach(function(Se){typeof Se.runWhen=="function"&&Se.runWhen(c)===!1||(N=N&&Se.synchronous,A.unshift(Se.fulfilled,Se.rejected))});let B=[];this.interceptors.response.forEach(function(Se){B.push(Se.fulfilled,Se.rejected)});let j,de=0,ge;if(!N){let xe=[Nf.bind(this),void 0];for(xe.unshift.apply(xe,A),xe.push.apply(xe,B),ge=xe.length,j=Promise.resolve(c);de<ge;)j=j.then(xe[de++],xe[de++]);return j}ge=A.length;let Te=c;for(de=0;de<ge;){let xe=A[de++],Se=A[de++];try{Te=xe(Te)}catch(Ae){Se.call(this,Ae);break}}try{j=Nf.call(this,Te)}catch(xe){return Promise.reject(xe)}for(de=0,ge=B.length;de<ge;)j=j.then(B[de++],B[de++]);return j}getUri(n){n=Qn(this.defaults,n);let c=Jh(n.baseURL,n.url);return Hh(c,n.params,n.paramsSerializer)}};fe.forEach(["delete","get","head","options"],function(n){Oc.prototype[n]=function(c,p){return this.request(Qn(p||{},{method:n,url:c,data:(p||{}).data}))}});fe.forEach(["post","put","patch"],function(n){function c(p){return function(s,E,A){return this.request(Qn(A||{},{method:n,headers:p?{"Content-Type":"multipart/form-data"}:{},url:s,data:E}))}}Oc.prototype[n]=c(),Oc.prototype[n+"Form"]=c(!0)});var Yh=Oc;var J0=class i{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let c;this.promise=new Promise(function(s){c=s});let p=this;this.promise.then(f=>{if(!p._listeners)return;let s=p._listeners.length;for(;s-- >0;)p._listeners[s](f);p._listeners=null}),this.promise.then=f=>{let s,E=new Promise(A=>{p.subscribe(A),s=A}).then(f);return E.cancel=function(){p.unsubscribe(s)},E},n(function(s,E,A){p.reason||(p.reason=new bo(s,E,A),c(p.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;let c=this._listeners.indexOf(n);c!==-1&&this._listeners.splice(c,1)}toAbortSignal(){let n=new AbortController,c=p=>{n.abort(p)};return this.subscribe(c),n.signal.unsubscribe=()=>this.unsubscribe(c),n.signal}static source(){let n;return{token:new i(function(f){n=f}),cancel:n}}},ub=J0;function Y0(i){return function(c){return i.apply(null,c)}}function Q0(i){return fe.isObject(i)&&i.isAxiosError===!0}var ey={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ey).forEach(([i,n])=>{ey[n]=i});var hb=ey;function db(i){let n=new Yh(i),c=qh(Yh.prototype.request,n);return fe.extend(c,Yh.prototype,n,{allOwnKeys:!0}),fe.extend(c,n,null,{allOwnKeys:!0}),c.create=function(f){return db(Qn(i,f))},c}var Si=db(Rc);Si.Axios=Yh;Si.CanceledError=bo;Si.CancelToken=ub;Si.isCancel=Xh;Si.VERSION=jf;Si.toFormData=us;Si.AxiosError=pt;Si.Cancel=Si.CanceledError;Si.all=function(n){return Promise.all(n)};Si.spread=Y0;Si.isAxiosError=Q0;Si.mergeConfig=Qn;Si.AxiosHeaders=Mi;Si.formToJSON=i=>Lf(fe.isHTMLForm(i)?new FormData(i):i);Si.getAdapter=Of.getAdapter;Si.HttpStatusCode=hb;Si.default=Si;var Uf=Si;var{Axios:l8,AxiosError:c8,CanceledError:u8,isCancel:h8,CancelToken:d8,VERSION:p8,all:f8,Cancel:m8,isAxiosError:g8,spread:y8,toFormData:_8,AxiosHeaders:v8,HttpStatusCode:x8,formToJSON:w8,getAdapter:b8,mergeConfig:k8}=Uf;var al=Bt(Gt());function gS(){return al.default.createElement("div",{className:"welcome"},al.default.createElement("h1",null,"Hello from ",al.default.createElement("span",{style:{color:"yellow"}},"TAXI")),al.default.createElement("h2",null,"Whatsapp / call"),al.default.createElement("a",{href:"tel:+358408611006"},al.default.createElement("h2",null,"+358 40 8611006")))}var pb=gS;var Ln=Bt(Gt());function yS({onShift:i,isAvailable:n,availableIn:c,loading:p}){return p?Ln.default.createElement("div",{className:"loader"}):i&&n?Ln.default.createElement("div",{className:"status"},Ln.default.createElement("h1",null,"Currently I am working and I am ",Ln.default.createElement("span",{style:{color:"green"}},"AVAILABLE!"))):i&&!n&&c!==null?Ln.default.createElement("div",{className:"status"},Ln.default.createElement("h1",null," Currently I am working and will be ",Ln.default.createElement("span",{style:{color:"green"}},"AVAILABLE!")," in ",c," minutes!")):i&&!n&&c==null?Ln.default.createElement("div",{className:"status"},Ln.default.createElement("h1",null,"Currently I am on shift but unfortunately unavailable...")):Ln.default.createElement("div",{className:"status"},Ln.default.createElement("h1",null,"Currently I am not working"))}var fb=yS;var ds=Bt(Gt());var Pb=Bt(Gt());var Nc=Bt(Gt()),pn=Bt(Gt());var ty=Bt(Gt()),qf=Bt(Gt());var mb=ty.createContext(null);function gb(i,n){let c=Array.isArray(i)?i[0]:i?i.x:0,p=Array.isArray(i)?i[1]:i?i.y:0,f=Array.isArray(n)?n[0]:n?n.x:0,s=Array.isArray(n)?n[1]:n?n.y:0;return c===f&&p===s}function Ur(i,n){if(i===n)return!0;if(!i||!n)return!1;if(Array.isArray(i)){if(!Array.isArray(n)||i.length!==n.length)return!1;for(let c=0;c<i.length;c++)if(!Ur(i[c],n[c]))return!1;return!0}else if(Array.isArray(n))return!1;if(typeof i=="object"&&typeof n=="object"){let c=Object.keys(i),p=Object.keys(n);if(c.length!==p.length)return!1;for(let f of c)if(!n.hasOwnProperty(f)||!Ur(i[f],n[f]))return!1;return!0}return!1}function yb(i){let n=i.clone();return n.pixelsToGLUnits=i.pixelsToGLUnits,n}function iy(i,n){if(!i.getProjection)return;let c=i.getProjection(),p=n.getProjection();Ur(c,p)||n.setProjection(c)}function ry(i){return{longitude:i.center.lng,latitude:i.center.lat,zoom:i.zoom,pitch:i.pitch,bearing:i.bearing,padding:i.padding}}function ny(i,n){let c=n.viewState||n,p=!1;if("longitude"in c&&"latitude"in c){let f=i.center;i.center=new f.constructor(c.longitude,c.latitude),p=p||f!==i.center}if("zoom"in c){let f=i.zoom;i.zoom=c.zoom,p=p||f!==i.zoom}if("bearing"in c){let f=i.bearing;i.bearing=c.bearing,p=p||f!==i.bearing}if("pitch"in c){let f=i.pitch;i.pitch=c.pitch,p=p||f!==i.pitch}return c.padding&&!i.isPaddingEqual(c.padding)&&(p=!0,i.padding=c.padding),p}var _S=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function oy(i){if(!i)return null;if(typeof i=="string"||("toJS"in i&&(i=i.toJS()),!i.layers))return i;let n={};for(let p of i.layers)n[p.id]=p;let c=i.layers.map(p=>{let f=null;"interactive"in p&&(f=Object.assign({},p),delete f.interactive);let s=n[p.ref];if(s){f=f||Object.assign({},p),delete f.ref;for(let E of _S)E in s&&(f[E]=s[E])}return f||p});return{...i,layers:c}}var _b={version:8,sources:{},layers:[]},vb={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},ay={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},xb={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},vS=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],xS=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"],sl=class i{constructor(n,c,p){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=f=>{let s=this.props[xb[f.type]];s?s(f):f.type==="error"&&console.error(f.error)},this._onPointerEvent=f=>{(f.type==="mousemove"||f.type==="mouseout")&&this._updateHover(f);let s=this.props[vb[f.type]];s&&(this.props.interactiveLayerIds&&f.type!=="mouseover"&&f.type!=="mouseout"&&(f.features=this._hoveredFeatures||this._queryRenderedFeatures(f.point)),s(f),delete f.features)},this._onCameraEvent=f=>{if(!this._internalUpdate){let s=this.props[ay[f.type]];s&&s(f)}f.type in this._deferredEvents&&(this._deferredEvents[f.type]=!1)},this._MapClass=n,this.props=c,this._initialize(p)}get map(){return this._map}get transform(){return this._renderTransform}setProps(n){let c=this.props;this.props=n;let p=this._updateSettings(n,c);p&&this._createShadowTransform(this._map);let f=this._updateSize(n),s=this._updateViewState(n,!0);this._updateStyle(n,c),this._updateStyleComponents(n,c),this._updateHandlers(n,c),(p||f||s&&!this._map.isMoving())&&this.redraw()}static reuse(n,c){let p=i.savedMaps.pop();if(!p)return null;let f=p.map,s=f.getContainer();for(c.className=s.className;s.childNodes.length>0;)c.appendChild(s.childNodes[0]);f._container=c;let E=f._resizeObserver;E&&(E.disconnect(),E.observe(c)),p.setProps({...n,styleDiffing:!1}),f.resize();let{initialViewState:A}=n;return A&&(A.bounds?f.fitBounds(A.bounds,{...A.fitBoundsOptions,duration:0}):p._updateViewState(A,!1)),f.isStyleLoaded()?f.fire("load"):f.once("styledata",()=>f.fire("load")),f._update(),p}_initialize(n){let{props:c}=this,{mapStyle:p=_b}=c,f={...c,...c.initialViewState,accessToken:c.mapboxAccessToken||wS()||null,container:n,style:oy(p)},s=f.initialViewState||f.viewState||f;if(Object.assign(f,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),c.gl){let j=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=j,c.gl)}let E=new this._MapClass(f);s.padding&&E.setPadding(s.padding),c.cursor&&(E.getCanvas().style.cursor=c.cursor),this._createShadowTransform(E);let A=E._render;E._render=j=>{this._inRender=!0,A.call(E,j),this._inRender=!1};let N=E._renderTaskQueue.run;E._renderTaskQueue.run=j=>{N.call(E._renderTaskQueue,j),this._onBeforeRepaint()},E.on("render",()=>this._onAfterRepaint());let B=E.fire;E.fire=this._fireEvent.bind(this,B),E.on("resize",()=>{this._renderTransform.resize(E.transform.width,E.transform.height)}),E.on("styledata",()=>{this._updateStyleComponents(this.props,{}),iy(E.transform,this._renderTransform)}),E.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(let j in vb)E.on(j,this._onPointerEvent);for(let j in ay)E.on(j,this._onCameraEvent);for(let j in xb)E.on(j,this._onEvent);this._map=E}recycle(){let c=this.map.getContainer().querySelector("[mapboxgl-children]");c?.remove(),i.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){let n=this._map;!this._inRender&&n.style&&(n._frame&&(n._frame.cancel(),n._frame=null),n._render())}_createShadowTransform(n){let c=yb(n.transform);n.painter.transform=c,this._renderTransform=c}_updateSize(n){let{viewState:c}=n;if(c){let p=this._map;if(c.width!==p.transform.width||c.height!==p.transform.height)return p.resize(),!0}return!1}_updateViewState(n,c){if(this._internalUpdate)return!1;let p=this._map,f=this._renderTransform,{zoom:s,pitch:E,bearing:A}=f,N=p.isMoving();N&&(f.cameraElevationReference="sea");let B=ny(f,{...ry(p.transform),...n});if(N&&(f.cameraElevationReference="ground"),B&&c){let j=this._deferredEvents;j.move=!0,j.zoom||(j.zoom=s!==f.zoom),j.rotate||(j.rotate=A!==f.bearing),j.pitch||(j.pitch=E!==f.pitch)}return N||ny(p.transform,n),B}_updateSettings(n,c){let p=this._map,f=!1;for(let s of vS)if(s in n&&!Ur(n[s],c[s])){f=!0;let E=p[`set${s[0].toUpperCase()}${s.slice(1)}`];E?.call(p,n[s])}return f}_updateStyle(n,c){if(n.cursor!==c.cursor&&(this._map.getCanvas().style.cursor=n.cursor||""),n.mapStyle!==c.mapStyle){let{mapStyle:p=_b,styleDiffing:f=!0}=n,s={diff:f};return"localIdeographFontFamily"in n&&(s.localIdeographFontFamily=n.localIdeographFontFamily),this._map.setStyle(oy(p),s),!0}return!1}_updateStyleComponents(n,c){let p=this._map,f=!1;return p.isStyleLoaded()&&("light"in n&&p.setLight&&!Ur(n.light,c.light)&&(f=!0,p.setLight(n.light)),"fog"in n&&p.setFog&&!Ur(n.fog,c.fog)&&(f=!0,p.setFog(n.fog)),"terrain"in n&&p.setTerrain&&!Ur(n.terrain,c.terrain)&&(!n.terrain||p.getSource(n.terrain.source))&&(f=!0,p.setTerrain(n.terrain))),f}_updateHandlers(n,c){var p,f;let s=this._map,E=!1;for(let A of xS){let N=(p=n[A])!==null&&p!==void 0?p:!0,B=(f=c[A])!==null&&f!==void 0?f:!0;Ur(N,B)||(E=!0,N?s[A].enable(N):s[A].disable())}return E}_queryRenderedFeatures(n){let c=this._map,p=c.transform,{interactiveLayerIds:f=[]}=this.props;try{return c.transform=this._renderTransform,c.queryRenderedFeatures(n,{layers:f.filter(c.getLayer.bind(c))})}catch{return[]}finally{c.transform=p}}_updateHover(n){var c;let{props:p}=this;if(p.interactiveLayerIds&&(p.onMouseMove||p.onMouseEnter||p.onMouseLeave)){let s=n.type,E=((c=this._hoveredFeatures)===null||c===void 0?void 0:c.length)>0,A=this._queryRenderedFeatures(n.point),N=A.length>0;!N&&E&&(n.type="mouseleave",this._onPointerEvent(n)),this._hoveredFeatures=A,N&&!E&&(n.type="mouseenter",this._onPointerEvent(n)),n.type=s}else this._hoveredFeatures=null}_fireEvent(n,c,p){let f=this._map,s=f.transform,E=typeof c=="string"?c:c.type;return E==="move"&&this._updateViewState(this.props,!1),E in ay&&(typeof c=="object"&&(c.viewState=ry(s)),this._map.isMoving())?(f.transform=this._renderTransform,n.call(f,c,p),f.transform=s,f):(n.call(f,c,p),f)}_onBeforeRepaint(){let n=this._map;this._internalUpdate=!0;for(let p in this._deferredEvents)this._deferredEvents[p]&&n.fire(p);this._internalUpdate=!1;let c=this._map.transform;n.transform=this._renderTransform,this._onAfterRepaint=()=>{iy(this._renderTransform,c),n.transform=c}}};sl.savedMaps=[];function wS(){let i=null;if(typeof location<"u"){let n=/access_token=([^&\/]*)/.exec(location.search);i=n&&n[1]}try{i=i||process.env.MapboxAccessToken}catch{}try{i=i||process.env.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return i}var bS=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function sy(i){if(!i)return null;let n=i.map,c={getMap:()=>n,getCenter:()=>i.transform.center,getZoom:()=>i.transform.zoom,getBearing:()=>i.transform.bearing,getPitch:()=>i.transform.pitch,getPadding:()=>i.transform.padding,getBounds:()=>i.transform.getBounds(),project:p=>{let f=n.transform;n.transform=i.transform;let s=n.project(p);return n.transform=f,s},unproject:p=>{let f=n.transform;n.transform=i.transform;let s=n.unproject(p);return n.transform=f,s},queryTerrainElevation:(p,f)=>{let s=n.transform;n.transform=i.transform;let E=n.queryTerrainElevation(p,f);return n.transform=s,E},queryRenderedFeatures:(p,f)=>{let s=n.transform;n.transform=i.transform;let E=n.queryRenderedFeatures(p,f);return n.transform=s,E}};for(let p of kS(n))!(p in c)&&!bS.includes(p)&&(c[p]=n[p].bind(n));return c}function kS(i){let n=new Set,c=i;for(;c;){for(let p of Object.getOwnPropertyNames(c))p[0]!=="_"&&typeof i[p]=="function"&&p!=="fire"&&p!=="setEventedParent"&&n.add(p);c=Object.getPrototypeOf(c)}return Array.from(n)}var $f=Bt(Gt()),SS=typeof document<"u"?$f.useLayoutEffect:$f.useEffect,wb=SS;var ES=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function ly(i,n){for(let p of ES)p in n&&(i[p]=n[p]);let{RTLTextPlugin:c="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=n;c&&i.getRTLTextPluginStatus&&i.getRTLTextPluginStatus()==="unavailable"&&i.setRTLTextPlugin(c,p=>{p&&console.error(p)},!0)}var ko=Nc.createContext(null);function cy(i,n,c){let p=(0,pn.useContext)(mb),[f,s]=(0,pn.useState)(null),E=(0,pn.useRef)(),{current:A}=(0,pn.useRef)({mapLib:null,map:null});(0,pn.useEffect)(()=>{let j=i.mapLib,de=!0,ge;return Promise.resolve(j||c).then(Te=>{if(!de)return;if(!Te)throw new Error("Invalid mapLib");let xe="Map"in Te?Te:Te.default;if(!xe.Map)throw new Error("Invalid mapLib");if(ly(xe,i),!xe.supported||xe.supported(i))i.reuseMaps&&(ge=sl.reuse(i,E.current)),ge||(ge=new sl(xe.Map,i,E.current)),A.map=sy(ge),A.mapLib=xe,s(ge),p?.onMapMount(A.map,i.id);else throw new Error("Map is not supported by this browser")}).catch(Te=>{let{onError:xe}=i;xe?xe({type:"error",target:null,originalEvent:null,error:Te}):console.error(Te)}),()=>{de=!1,ge&&(p?.onMapUnmount(i.id),i.reuseMaps?ge.recycle():ge.destroy())}},[]),wb(()=>{f&&f.setProps(i)}),(0,pn.useImperativeHandle)(n,()=>A.map,[f]);let N=(0,pn.useMemo)(()=>({position:"relative",width:"100%",height:"100%",...i.style}),[i.style]),B={height:"100%"};return Nc.createElement("div",{id:i.id,ref:E,style:N},f&&Nc.createElement(ko.Provider,{value:A},Nc.createElement("div",{"mapboxgl-children":"",style:B},i.children)))}var bb=Bt(Gt()),kb=Bt(Uh()),Cr=Bt(Gt());var TS=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function qr(i,n){if(!i||!n)return;let c=i.style;for(let p in n){let f=n[p];Number.isFinite(f)&&!TS.test(p)?c[p]=`${f}px`:c[p]=f}}function CS(i,n){let{map:c,mapLib:p}=(0,Cr.useContext)(ko),f=(0,Cr.useRef)({props:i});f.current.props=i;let s=(0,Cr.useMemo)(()=>{let Se=!1;bb.Children.forEach(i.children,ee=>{ee&&(Se=!0)});let Ae={...i,element:Se?document.createElement("div"):null},ne=new p.Marker(Ae);return ne.setLngLat([i.longitude,i.latitude]),ne.getElement().addEventListener("click",ee=>{var ae,be;(be=(ae=f.current.props).onClick)===null||be===void 0||be.call(ae,{type:"click",target:ne,originalEvent:ee})}),ne.on("dragstart",ee=>{var ae,be;let Ie=ee;Ie.lngLat=s.getLngLat(),(be=(ae=f.current.props).onDragStart)===null||be===void 0||be.call(ae,Ie)}),ne.on("drag",ee=>{var ae,be;let Ie=ee;Ie.lngLat=s.getLngLat(),(be=(ae=f.current.props).onDrag)===null||be===void 0||be.call(ae,Ie)}),ne.on("dragend",ee=>{var ae,be;let Ie=ee;Ie.lngLat=s.getLngLat(),(be=(ae=f.current.props).onDragEnd)===null||be===void 0||be.call(ae,Ie)}),ne},[]);(0,Cr.useEffect)(()=>(s.addTo(c.getMap()),()=>{s.remove()}),[]);let{longitude:E,latitude:A,offset:N,style:B,draggable:j=!1,popup:de=null,rotation:ge=0,rotationAlignment:Te="auto",pitchAlignment:xe="auto"}=i;return(0,Cr.useEffect)(()=>{qr(s.getElement(),B)},[B]),(0,Cr.useImperativeHandle)(n,()=>s,[]),(s.getLngLat().lng!==E||s.getLngLat().lat!==A)&&s.setLngLat([E,A]),N&&!gb(s.getOffset(),N)&&s.setOffset(N),s.isDraggable()!==j&&s.setDraggable(j),s.getRotation()!==ge&&s.setRotation(ge),s.getRotationAlignment()!==Te&&s.setRotationAlignment(Te),s.getPitchAlignment()!==xe&&s.setPitchAlignment(xe),s.getPopup()!==de&&s.setPopup(de),(0,kb.createPortal)(i.children,s.getElement())}var Sb=(0,Cr.memo)((0,Cr.forwardRef)(CS));var Tb=Bt(Uh()),dr=Bt(Gt());function Eb(i){return new Set(i?i.trim().split(/\s+/):[])}function zS(i,n){let{map:c,mapLib:p}=(0,dr.useContext)(ko),f=(0,dr.useMemo)(()=>document.createElement("div"),[]),s=(0,dr.useRef)({props:i});s.current.props=i;let E=(0,dr.useMemo)(()=>{let A={...i},N=new p.Popup(A);return N.setLngLat([i.longitude,i.latitude]),N.once("open",B=>{var j,de;(de=(j=s.current.props).onOpen)===null||de===void 0||de.call(j,B)}),N},[]);if((0,dr.useEffect)(()=>{let A=N=>{var B,j;(j=(B=s.current.props).onClose)===null||j===void 0||j.call(B,N)};return E.on("close",A),E.setDOMContent(f).addTo(c.getMap()),()=>{E.off("close",A),E.isOpen()&&E.remove()}},[]),(0,dr.useEffect)(()=>{qr(E.getElement(),i.style)},[i.style]),(0,dr.useImperativeHandle)(n,()=>E,[]),E.isOpen()&&((E.getLngLat().lng!==i.longitude||E.getLngLat().lat!==i.latitude)&&E.setLngLat([i.longitude,i.latitude]),i.offset&&!Ur(E.options.offset,i.offset)&&E.setOffset(i.offset),(E.options.anchor!==i.anchor||E.options.maxWidth!==i.maxWidth)&&(E.options.anchor=i.anchor,E.setMaxWidth(i.maxWidth)),E.options.className!==i.className)){let A=Eb(E.options.className),N=Eb(i.className);for(let B of A)N.has(B)||E.removeClassName(B);for(let B of N)A.has(B)||E.addClassName(B);E.options.className=i.className}return(0,Tb.createPortal)(i.children,f)}var IS=(0,dr.memo)((0,dr.forwardRef)(zS));var Zf=Bt(Gt());var jc=Bt(Gt());function PS(i,n,c,p){let f=(0,jc.useContext)(ko),s=(0,jc.useMemo)(()=>i(f),[]);return(0,jc.useEffect)(()=>{let E=p||c||n,A=typeof n=="function"&&typeof c=="function"?n:null,N=typeof c=="function"?c:typeof n=="function"?n:null,{map:B}=f;return B.hasControl(s)||(B.addControl(s,E?.position),A&&A(f)),()=>{N&&N(f),B.hasControl(s)&&B.removeControl(s)}},[]),s}var eo=PS;function MS(i){let n=eo(({mapLib:c})=>new c.AttributionControl(i),{position:i.position});return(0,Zf.useEffect)(()=>{qr(n._container,i.style)},[i.style]),null}var AS=(0,Zf.memo)(MS);var Hf=Bt(Gt());function LS(i){let n=eo(({mapLib:c})=>new c.FullscreenControl({container:i.containerId&&document.getElementById(i.containerId)}),{position:i.position});return(0,Hf.useEffect)(()=>{qr(n._controlContainer,i.style)},[i.style]),null}var DS=(0,Hf.memo)(LS);var So=Bt(Gt());function RS(i,n){let c=(0,So.useRef)({props:i}),p=eo(({mapLib:f})=>{let s=new f.GeolocateControl(i),E=s._setupUI;return s._setupUI=A=>{s._container.hasChildNodes()||E(A)},s.on("geolocate",A=>{var N,B;(B=(N=c.current.props).onGeolocate)===null||B===void 0||B.call(N,A)}),s.on("error",A=>{var N,B;(B=(N=c.current.props).onError)===null||B===void 0||B.call(N,A)}),s.on("outofmaxbounds",A=>{var N,B;(B=(N=c.current.props).onOutOfMaxBounds)===null||B===void 0||B.call(N,A)}),s.on("trackuserlocationstart",A=>{var N,B;(B=(N=c.current.props).onTrackUserLocationStart)===null||B===void 0||B.call(N,A)}),s.on("trackuserlocationend",A=>{var N,B;(B=(N=c.current.props).onTrackUserLocationEnd)===null||B===void 0||B.call(N,A)}),s},{position:i.position});return c.current.props=i,(0,So.useImperativeHandle)(n,()=>p,[]),(0,So.useEffect)(()=>{qr(p._container,i.style)},[i.style]),null}var FS=(0,So.memo)((0,So.forwardRef)(RS));var Gf=Bt(Gt());function BS(i){let n=eo(({mapLib:c})=>new c.NavigationControl(i),{position:i.position});return(0,Gf.useEffect)(()=>{qr(n._container,i.style)},[i.style]),null}var Cb=(0,Gf.memo)(BS);var Vc=Bt(Gt());function OS(i){let n=eo(({mapLib:s})=>new s.ScaleControl(i),{position:i.position}),c=(0,Vc.useRef)(i),p=c.current;c.current=i;let{style:f}=i;return i.maxWidth!==void 0&&i.maxWidth!==p.maxWidth&&(n.options.maxWidth=i.maxWidth),i.unit!==void 0&&i.unit!==p.unit&&n.setUnit(i.unit),(0,Vc.useEffect)(()=>{qr(n._container,f)},[f]),null}var NS=(0,Vc.memo)(OS);var Qh=Bt(Gt());var VS=Bt(Gt()),ed=Bt(Gt()),US=Bt(Gt());var qS=Promise.resolve().then(()=>Bt(Ib())),$S=Pb.forwardRef(function(n,c){return cy(n,c,qS)}),Mb=Sb;var Ab=Cb;var Lb=$S;var Db={version:8,name:"NLS Basemap",center:[21.645,63.101],zoom:11.35,sources:{taustakartta:{type:"vector",url:"https://avoin-karttakuva.maanmittauslaitos.fi/vectortiles/tilejson/taustakartta/1.0.0/taustakartta/default/v21/WGS84_Pseudo-Mercator/tilejson.json?api-key=c8e1dd5c-1ada-4f75-80a2-899c6fa8fba7"}},glyphs:"https://avoin-karttakuva.maanmittauslaitos.fi/vectortiles/glyphs/{fontstack}/{range}.pbf?api-key=c8e1dd5c-1ada-4f75-80a2-899c6fa8fba7",layers:[{id:"background",type:"background",paint:{"background-color":"#ffffff"}},{id:"maasto_alue",type:"fill",source:"taustakartta","source-layer":"maasto_alue",filter:["match",["get","kohdeluokka"],[35411,35412,35421,35422,34300,34100,34700,38300,38700,39110,39120,39130,33e3,38400,35401,35402],!0,!1],paint:{"fill-color":["match",["get","kohdeluokka"],[35421,35422,35401],"hsla(200, 80%, 90%, 0.7)",[34700,38600],"hsla(208, 11%, 75%, 0.76)",[38300,38700],"hsl(207, 100%, 94%)",[39120],"hsla(44, 100%, 83%, 0.84)","hsla(360, 100%, 100%, 0)"]}},{id:"taajamaalue",type:"fill",source:"taustakartta","source-layer":"maankaytto",minzoom:6,maxzoom:14,filter:["==","kohdeluokka",40200],paint:{"fill-color":"rgba(220,199,199,0.4)"}},{id:"maankaytto",type:"fill",source:"taustakartta","source-layer":"maankaytto",filter:["match",["get","kohdeluokka"],[32611,32200,32612,32800,32900,33100,34300],!0,!1],paint:{"fill-color":["match",["get","kohdeluokka"],32611,"#fffcd6",32200,"#eef6e0",32612,"#eef6e0",32900,"#eef6e0",33100,"#EEF6E0",34300,"#fffcf0",32800,"#fffceb","hsla(360, 100%, 100%, 0)"]}},{id:"lentokentta_alue",type:"fill",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"Polygon"],["match",["get","kohdeluokka"],[32411,32412,32413,32414,32415,32416,32417,32418,32441,32442],!0,!1]],layout:{},paint:{"fill-color":["match",["get","kohdeluokka"],[32411,23412],"#fde9db",[32413,32415,32416,32441,32442],"#f7f7f3",[32414,32417,32418],"#fffcf4","hsl(0,0%,80%)"],"fill-outline-color":["match",["get","kohdeluokka"],[32441,32442],"#c8c4c5","hsla(360, 100%, 100%, 0)"]}},{id:"lentokentta_viiva",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["any",["==","kohdeluokka",32431],["==","kohdeluokka",32432]],paint:{"line-width":7,"line-color":"#c8c4c5"}},{id:"lentokentta_viiva2",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["any",["==","kohdeluokka",32431],["==","kohdeluokka",32432]],paint:{"line-width":6,"line-color":"#fde9db"}},{id:"vesisto_alue_reuna",type:"line",source:"taustakartta","source-layer":"vesisto_alue",paint:{"line-color":"#9ec9e8","line-width":.5}},{id:"vesisto_alue",type:"fill",source:"taustakartta","source-layer":"vesisto_alue",paint:{"fill-color":"#caedfb"}},{id:"maastoaluereuna",type:"line",source:"taustakartta","source-layer":"maastoaluereuna",filter:["all",["in","kartografinenluokka",32200,32300,32411,32412,32413,32414,32415,32416,32417,32418,33100],["==","kohdeluokka",30211]],paint:{"line-color":"#c8c4c5","line-width":.5}},{id:"keinotekoinen_rantaviiva",type:"line",source:"taustakartta","source-layer":"maastoaluereuna",filter:["==","kohdeluokka",30100],paint:{"line-color":"#c8c4c5","line-width":.5}},{id:"vesisto_viiva",type:"line",source:"taustakartta","source-layer":"vesisto_viiva",paint:{"line-color":"#caedfb","line-width":["interpolate",["exponential",1.55],["zoom"],6,.75,20,30]}},{id:"rakennus",type:"fill",source:"taustakartta","source-layer":"rakennus",paint:{"fill-color":"#e6e6e6","fill-outline-color":"#adb0b3"}},{id:"tiet tunnelissa",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12141,12132,12131,12122,12121,12112,12111,12313,12314,12136],!0,!1],["match",["get","tasosijainti"],[-11],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[32,16],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"ajotie, pinnan alla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12141],!0,!1],["match",["get","tasosijainti"],[-1],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"ajopolku, pinnan alla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12316],!0,!1],["match",["get","tasosijainti"],[-1],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[12,2],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"polku, pinnan alla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12313],!0,!1],["match",["get","tasosijainti"],[-1],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[2,1.5],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"kavely- ja pyoratie, paallystamaton, pinnan alla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12314],!0,!1],["match",["get","paallyste"],[1],!0,!1],["match",["get","tasosijainti"],[-1],!0,!1]],layout:{},paint:{"line-color":"#90ca6f","line-dasharray":[3,1.5],"line-width":["interpolate",["exponential",1.55],["zoom"],6,.5,20,15]}},{id:"kavely- ja pyoratie, paallystetty, pinnan alla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12314],!0,!1],["match",["get","paallyste"],[2],!0,!1],["match",["get","tasosijainti"],[-1],!0,!1]],layout:{},paint:{"line-color":"#90ca6f","line-width":["interpolate",["exponential",1.55],["zoom"],6,.5,20,15]}},{id:"tiet_1a_1b_reuna, pinnan alla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12111,12112],!0,!1],["match",["get","tasosijainti"],[-1],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,6,20,84]}},{id:"tiet_2a_2b_reuna, pinnan alla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12121,12122],!0,!1],["match",["get","tasosijainti"],[-1],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,4,20,63]}},{id:"tiet_3a_3b_reuna, pinnan alla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12131,12132],!0,!1],["match",["get","tasosijainti"],[-1],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,3,20,30]}},{id:"rautatie_reuna, pinnan alla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[14111,14110,14112,14131,14151,14152,14121],!0,!1],["match",["get","tasosijainti"],[-1],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,2,20,40]}},{id:"tiet_1a_1b_taytto, pinnan alla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12111,12112],!0,!1],["match",["get","tasosijainti"],[-1],!0,!1]],layout:{},paint:{"line-color":"#eeeeee","line-width":["interpolate",["exponential",1.55],["zoom"],6,4,20,80]}},{id:"tiet_2a_2b_taytto, pinnan alla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12121,12122],!0,!1],["match",["get","tasosijainti"],[-1],!0,!1]],layout:{},paint:{"line-color":"#eeeeee","line-width":["interpolate",["exponential",1.55],["zoom"],6,2.5,20,60]}},{id:"tiet_3a_3b_taytto, pinnan alla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12131,12132],!0,!1],["match",["get","tasosijainti"],[-1],!0,!1]],layout:{},paint:{"line-color":"#eeeeee","line-width":["interpolate",["exponential",1.55],["zoom"],6,1.5,20,30]}},{id:"rautatie_taytto, pinnan alla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[14111,14110,14112,14131,14151,14152,14121],!0,!1],["match",["get","tasosijainti"],[-1],!0,!1]],layout:{},paint:{"line-color":"#eeeeee","line-dasharray":[2,2],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1.5,20,30]}},{id:"ajotie, pinnalla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12141],!0,!1],["match",["get","tasosijainti"],[0],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"ajopolku, pinnalla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12316],!0,!1],["match",["get","tasosijainti"],[0],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[12,2],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"polku, pinnalla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12313],!0,!1],["match",["get","tasosijainti"],[0],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[2,1.5],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"kavely- ja pyoratie, paallystamaton, pinnalla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12314],!0,!1],["match",["get","paallyste"],[1],!0,!1],["match",["get","tasosijainti"],[0],!0,!1]],layout:{},paint:{"line-color":"#90ca6f","line-dasharray":[3,1.5],"line-width":["interpolate",["exponential",1.55],["zoom"],6,.5,20,15]}},{id:"kavely- ja pyoratie, paallystetty, pinnalla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12314],!0,!1],["match",["get","paallyste"],[2],!0,!1],["match",["get","tasosijainti"],[0],!0,!1]],layout:{},paint:{"line-color":"#90ca6f","line-width":["interpolate",["exponential",1.55],["zoom"],6,.5,20,15]}},{id:"tiet_1a_1b_reuna, pinnalla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12111,12112],!0,!1],["match",["get","tasosijainti"],[0],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,6,20,84]}},{id:"tiet_2a_2b_reuna, pinnalla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12121,12122],!0,!1],["match",["get","tasosijainti"],[0],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,4,20,63]}},{id:"tiet_3a_3b_reuna, pinnalla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12131,12132],!0,!1],["match",["get","tasosijainti"],[0],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,3,20,30]}},{id:"rautatie_reuna, pinnalla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[14111,14110,14112,14131,14151,14152,14121],!0,!1],["match",["get","tasosijainti"],[0],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,2,20,40]}},{id:"tiet_1a_1b_taytto, pinnalla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12111,12112],!0,!1],["match",["get","tasosijainti"],[0],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,4,20,80]}},{id:"tiet_2a_2b_taytto, pinnalla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12121,12122],!0,!1],["match",["get","tasosijainti"],[0],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,2.5,20,60]}},{id:"tiet_3a_3b_taytto, pinnalla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12131,12132],!0,!1],["match",["get","tasosijainti"],[0],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,1.5,20,30]}},{id:"rautatie_taytto, pinnalla",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[14111,14110,14112,14131,14151,14152,14121],!0,!1],["match",["get","tasosijainti"],[0],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-dasharray":[2,2],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1.5,20,30]}},{id:"ajotie, sillalla 1",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12141],!0,!1],["match",["get","tasosijainti"],[1],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"ajopolku, sillalla 1",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12316],!0,!1],["match",["get","tasosijainti"],[1],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[12,2],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"polku, sillalla 1",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12313],!0,!1],["match",["get","tasosijainti"],[1],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[2,1.5],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"kavely- ja pyoratie, paallystamaton, sillalla 1",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12314],!0,!1],["match",["get","paallyste"],[1],!0,!1],["match",["get","tasosijainti"],[1],!0,!1]],layout:{},paint:{"line-color":"#90ca6f","line-dasharray":[3,1.5],"line-width":["interpolate",["exponential",1.55],["zoom"],6,.5,20,15]}},{id:"kavely- ja pyoratie, paallystetty, sillalla 1",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12314],!0,!1],["match",["get","paallyste"],[2],!0,!1],["match",["get","tasosijainti"],[1],!0,!1]],layout:{},paint:{"line-color":"#90ca6f","line-width":["interpolate",["exponential",1.55],["zoom"],6,.5,20,15]}},{id:"tiet_1a_1b_reuna, sillalla 1",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12111,12112],!0,!1],["match",["get","tasosijainti"],[1],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,6,20,84]}},{id:"tiet_2a_2b_reuna, sillalla 1",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12121,12122],!0,!1],["match",["get","tasosijainti"],[1],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,4,20,63]}},{id:"tiet_3a_3b_reuna, sillalla 1",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12131,12132],!0,!1],["match",["get","tasosijainti"],[1],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,3,20,30]}},{id:"rautatie_reuna, sillalla 1",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[14111,14110,14112,14131,14151,14152,14121],!0,!1],["match",["get","tasosijainti"],[1],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,2,20,40]}},{id:"tiet_1a_1b_taytto, sillalla 1",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12111,12112],!0,!1],["match",["get","tasosijainti"],[1],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,4,20,80]}},{id:"tiet_2a_2b_taytto, sillalla 1",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12121,12122],!0,!1],["match",["get","tasosijainti"],[1],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,2.5,20,60]}},{id:"tiet_3a_3b_taytto, sillalla 1",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12131,12132],!0,!1],["match",["get","tasosijainti"],[1],!0,!1]],layout:{},paint:{"line-color":"#eeeeee","line-width":["interpolate",["exponential",1.55],["zoom"],6,1.5,20,30]}},{id:"rautatie_taytto, sillalla 1",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[14111,14110,14112,14131,14151,14152,14121],!0,!1],["match",["get","tasosijainti"],[1],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-dasharray":[2,2],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1.5,20,30]}},{id:"ajotie, sillalla 2",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12141],!0,!1],["match",["get","tasosijainti"],[2],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"ajopolku, sillalla 2",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12316],!0,!1],["match",["get","tasosijainti"],[2],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[12,2],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"polku, sillalla 2",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12313],!0,!1],["match",["get","tasosijainti"],[2],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[2,1.5],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"kavely- ja pyoratie, paallystamaton, sillalla 2",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12314],!0,!1],["match",["get","paallyste"],[1],!0,!1],["match",["get","tasosijainti"],[2],!0,!1]],layout:{},paint:{"line-color":"#90ca6f","line-dasharray":[3,1.5],"line-width":["interpolate",["exponential",1.55],["zoom"],6,.5,20,15]}},{id:"kavely- ja pyoratie, paallystetty, sillalla 2",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12314],!0,!1],["match",["get","paallyste"],[2],!0,!1],["match",["get","tasosijainti"],[2],!0,!1]],layout:{},paint:{"line-color":"#90ca6f","line-width":["interpolate",["exponential",1.55],["zoom"],6,.5,20,15]}},{id:"tiet_1a_1b_reuna, sillalla 2",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12111,12112],!0,!1],["match",["get","tasosijainti"],[2],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,6,20,84]}},{id:"tiet_2a_2b_reuna, sillalla 2",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12121,12122],!0,!1],["match",["get","tasosijainti"],[2],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,4,20,63]}},{id:"tiet_3a_3b_reuna, sillalla 2",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12131,12132],!0,!1],["match",["get","tasosijainti"],[2],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,3,20,30]}},{id:"rautatie_reuna, sillalla 2",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[14111,14110,14112,14131,14151,14152,14121],!0,!1],["match",["get","tasosijainti"],[2],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,2,20,40]}},{id:"tiet_1a_1b_taytto, sillalla 2",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12111,12112],!0,!1],["match",["get","tasosijainti"],[2],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,4,20,80]}},{id:"tiet_2a_2b_taytto, sillalla 2",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12121,12122],!0,!1],["match",["get","tasosijainti"],[2],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,2.5,20,60]}},{id:"tiet_3a_3b_taytto, sillalla 2",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12131,12132],!0,!1],["match",["get","tasosijainti"],[2],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,1.5,20,30]}},{id:"rautatie_taytto, sillalla 2",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[14111,14110,14112,14131,14151,14152,14121],!0,!1],["match",["get","tasosijainti"],[2],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-dasharray":[2,2],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1.5,20,30]}},{id:"ajotie, sillalla 3",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12141],!0,!1],["match",["get","tasosijainti"],[3],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"ajopolku, sillalla 3",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12316],!0,!1],["match",["get","tasosijainti"],[3],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[12,2],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"polku, sillalla 3",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12313],!0,!1],["match",["get","tasosijainti"],[3],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[2,1.5],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"kavely- ja pyoratie, paallystamaton, sillalla 3",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12314],!0,!1],["match",["get","paallyste"],[1],!0,!1],["match",["get","tasosijainti"],[3],!0,!1]],layout:{},paint:{"line-color":"#90ca6f","line-dasharray":[3,1.5],"line-width":["interpolate",["exponential",1.55],["zoom"],6,.5,20,15]}},{id:"kavely- ja pyoratie, paallystetty, sillalla 3",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12314],!0,!1],["match",["get","paallyste"],[2],!0,!1],["match",["get","tasosijainti"],[3],!0,!1]],layout:{},paint:{"line-color":"#90ca6f","line-width":["interpolate",["exponential",1.55],["zoom"],6,.5,20,15]}},{id:"tiet_1a_1b_reuna, sillalla 3",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12111,12112],!0,!1],["match",["get","tasosijainti"],[3],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,6,20,84]}},{id:"tiet_2a_2b_reuna, sillalla 3",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12121,12122],!0,!1],["match",["get","tasosijainti"],[3],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,4,20,63]}},{id:"tiet_3a_3b_reuna, sillalla 3",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12131,12132],!0,!1],["match",["get","tasosijainti"],[3],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,3,20,30]}},{id:"rautatie_reuna, sillalla 3",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[14111,14110,14112,14131,14151,14152,14121],!0,!1],["match",["get","tasosijainti"],[3],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,2,20,40]}},{id:"tiet_1a_1b_taytto, sillalla 3",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12111,12112],!0,!1],["match",["get","tasosijainti"],[3],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,4,20,80]}},{id:"tiet_2a_2b_taytto, sillalla 3",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12121,12122],!0,!1],["match",["get","tasosijainti"],[3],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,2.5,20,60]}},{id:"tiet_3a_3b_taytto, sillalla 3",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12131,12132],!0,!1],["match",["get","tasosijainti"],[3],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,1.5,20,30]}},{id:"rautatie_taytto, sillalla 3",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[14111,14110,14112,14131,14151,14152,14121],!0,!1],["match",["get","tasosijainti"],[3],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-dasharray":[2,2],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1.5,20,30]}},{id:"ajotie, sillalla 4",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12141],!0,!1],["match",["get","tasosijainti"],[4],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"ajopolku, sillalla 4",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12316],!0,!1],["match",["get","tasosijainti"],[4],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[12,2],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"polku, sillalla 4",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12313],!0,!1],["match",["get","tasosijainti"],[4],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[2,1.5],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"kavely- ja pyoratie, paallystamaton, sillalla 4",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12314],!0,!1],["match",["get","paallyste"],[1],!0,!1],["match",["get","tasosijainti"],[4],!0,!1]],layout:{},paint:{"line-color":"#90ca6f","line-dasharray":[3,1.5],"line-width":["interpolate",["exponential",1.55],["zoom"],6,.5,20,15]}},{id:"kavely- ja pyoratie, paallystetty, sillalla 4",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12314],!0,!1],["match",["get","paallyste"],[2],!0,!1],["match",["get","tasosijainti"],[4],!0,!1]],layout:{},paint:{"line-color":"#90ca6f","line-width":["interpolate",["exponential",1.55],["zoom"],6,.5,20,15]}},{id:"tiet_1a_1b_reuna, sillalla 4",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12111,12112],!0,!1],["match",["get","tasosijainti"],[4],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,6,20,84]}},{id:"tiet_2a_2b_reuna, sillalla 4",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12121,12122],!0,!1],["match",["get","tasosijainti"],[4],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,4,20,63]}},{id:"tiet_3a_3b_reuna, sillalla 4",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12131,12132],!0,!1],["match",["get","tasosijainti"],[4],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,3,20,30]}},{id:"rautatie_reuna, sillalla 4",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[14111,14110,14112,14131,14151,14152,14121],!0,!1],["match",["get","tasosijainti"],[4],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,2,20,40]}},{id:"tiet_1a_1b_taytto, sillalla 4",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12111,12112],!0,!1],["match",["get","tasosijainti"],[4],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,4,20,80]}},{id:"tiet_2a_2b_taytto, sillalla 4",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12121,12122],!0,!1],["match",["get","tasosijainti"],[4],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,2.5,20,60]}},{id:"tiet_3a_3b_taytto, sillalla 4",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12131,12132],!0,!1],["match",["get","tasosijainti"],[4],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,1.5,20,30]}},{id:"rautatie_taytto, sillalla 4",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[14111,14110,14112,14131,14151,14152,14121],!0,!1],["match",["get","tasosijainti"],[4],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-dasharray":[2,2],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1.5,20,30]}},{id:"ajotie, sillalla 5",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12141],!0,!1],["match",["get","tasosijainti"],[5],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"ajopolku, sillalla 5",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12316],!0,!1],["match",["get","tasosijainti"],[5],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[12,2],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"polku, sillalla 5",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12313],!0,!1],["match",["get","tasosijainti"],[5],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[2,1.5],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"kavely- ja pyoratie, paallystamaton, sillalla 5",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12314],!0,!1],["match",["get","paallyste"],[1],!0,!1],["match",["get","tasosijainti"],[5],!0,!1]],layout:{},paint:{"line-color":"#90ca6f","line-dasharray":[3,1.5],"line-width":["interpolate",["exponential",1.55],["zoom"],6,.5,20,15]}},{id:"kavely- ja pyoratie, paallystetty, sillalla 5",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12314],!0,!1],["match",["get","paallyste"],[2],!0,!1],["match",["get","tasosijainti"],[5],!0,!1]],layout:{},paint:{"line-color":"#90ca6f","line-width":["interpolate",["exponential",1.55],["zoom"],6,.5,20,15]}},{id:"tiet_1a_1b_reuna, sillalla 5",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12111,12112],!0,!1],["match",["get","tasosijainti"],[5],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,6,20,84]}},{id:"tiet_2a_2b_reuna, sillalla 5",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12121,12122],!0,!1],["match",["get","tasosijainti"],[5],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,4,20,63]}},{id:"tiet_3a_3b_reuna, sillalla 5",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12131,12132],!0,!1],["match",["get","tasosijainti"],[5],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,3,20,30]}},{id:"rautatie_reuna, sillalla 5",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[14111,14110,14112,14131,14151,14152,14121],!0,!1],["match",["get","tasosijainti"],[5],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-width":["interpolate",["exponential",1.55],["zoom"],6,2,20,40]}},{id:"tiet_1a_1b_taytto, sillalla 5",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12111,12112],!0,!1],["match",["get","tasosijainti"],[5],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,4,20,80]}},{id:"tiet_2a_2b_taytto, sillalla 5",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12121,12122],!0,!1],["match",["get","tasosijainti"],[5],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,2.5,20,60]}},{id:"tiet_3a_3b_taytto, sillalla 5",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12131,12132],!0,!1],["match",["get","tasosijainti"],[5],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-width":["interpolate",["exponential",1.55],["zoom"],6,1.5,20,30]}},{id:"rautatie_taytto, sillalla 5",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[14111,14110,14112,14131,14151,14152,14121],!0,!1],["match",["get","tasosijainti"],[5],!0,!1]],layout:{},paint:{"line-color":"#fcfcfc","line-dasharray":[2,2],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1.5,20,30]}},{id:"lautta ja lossi",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[12151,12152],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[6,8],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1.5,20,30]}},{id:"laiva ja venevaylat",type:"line",source:"taustakartta","source-layer":"liikenne",filter:["all",["==",["geometry-type"],"LineString"],["match",["get","kohdeluokka"],[16511,16512],!0,!1]],layout:{},paint:{"line-color":"#ccc","line-dasharray":[6,8],"line-width":["interpolate",["exponential",1.55],["zoom"],6,1,20,20]}},{id:"hallintorajat",type:"line",source:"taustakartta","source-layer":"hallintoalue",paint:{"line-color":"#8668de","line-width":1,"line-opacity":.5}},{id:"rakennelmat",type:"line",source:"taustakartta","source-layer":"rakennelma",filter:["any",["==","kohdeluokka",45700],["==","kohdeluokka",45111],["==","kohdeluokka",45112],["==","kohdeluokka",44500]],paint:{"line-color":"#918a8c","line-width":.5}},{id:"tienimet",type:"symbol",source:"taustakartta","source-layer":"liikenne",filter:["all",["<","tasosijainti",1]],layout:{"text-field":"{nimi_suomi}        {nimi_ruotsi}","text-font":["Liberation Sans NLSFI"],"symbol-placement":"line","text-size":11},paint:{"text-color":"rgba(69, 86, 71, 1)","text-halo-color":"#fff","text-halo-width":1,"text-halo-blur":1}},{id:"nimisto-maasto-vedet",type:"symbol",source:"taustakartta","source-layer":"nimisto",filter:["match",["get","teema"],["Maasto","Vedet"],!0,!1],layout:{"text-field":["coalesce",["get","nimi_fin"],["get","nimi_swe"],["get","nimi_sme"],["get","nimi_sms"],["get","nimi_smn"]],"text-font":["match",["get","teema"],"Vedet",["literal",["Liberation Sans NLSFI Left"]],"Maasto",["literal",["Liberation Sans NLSFI Right"]],["literal",["Liberation Sans NLSFI"]]],"text-size":["interpolate",["linear"],["zoom"],1,["step",["get","prioriteetti"],20,3,16],10,["step",["get","prioriteetti"],20,4,14],16,["step",["get","prioriteetti"],22,5,12]],visibility:"visible"},paint:{"text-halo-width":2,"text-halo-color":"rgba(255, 255, 255, 1)","text-color":["match",["get","teema"],"Vedet","hsl(251, 71%, 50%)","hsl(0, 0%, 20%)"],"text-halo-blur":1}},{id:"nimisto",type:"symbol",source:"taustakartta","source-layer":"nimisto",filter:["all",["!",["match",["get","teema"],["Maasto","Vedet"],!0,!1]],["!=",["get","alaryhma"],"Hallintoalueet"],["match",["get","laji"],["Kansallispuisto","Luonnonpuisto"],!1,!0]],layout:{"text-transform":["match",["get","alaryhma"],"Rautatieliikennepaikat","uppercase","none"],"text-field":["coalesce",["get","nimi_fin"],["get","nimi_swe"],["get","nimi_sme"],["get","nimi_sms"],["get","nimi_smn"]],"icon-ignore-placement":!0,"icon-allow-overlap":!0,"text-font":["Liberation Sans NLSFI"],"text-size":["interpolate",["linear"],["zoom"],1,["interpolate",["linear"],["get","prioriteetti"],1,20,3,16],10,["interpolate",["linear"],["get","prioriteetti"],5,16,7,13],14,["interpolate",["linear"],["get","prioriteetti"],5,22,10,12]],visibility:"visible"},paint:{"text-halo-width":2,"text-halo-color":"rgba(255, 255, 255, 1)","text-color":["match",["get","teema"],"Vedet","hsl(251, 71%, 50%)","Suojellut kohteet","hsl(117, 79%, 31%)","hsl(0, 0%, 15%)"],"text-halo-blur":1}},{id:"nimisto_luonnopuistot",type:"symbol",source:"taustakartta","source-layer":"nimisto",filter:["match",["get","laji"],["Kansallispuisto","Luonnonpuisto"],!0,!1],layout:{"text-field":["coalesce",["get","nimi_fin"],["get","nimi_swe"],["get","nimi_sme"],["get","nimi_sms"],["get","nimi_smn"]],"icon-ignore-placement":!0,"icon-allow-overlap":!1,"text-font":["Liberation Sans NLSFI"],visibility:"visible"},paint:{"text-halo-width":2,"text-halo-color":"rgba(255, 255, 255, 1)","text-color":"hsl(117, 79%, 31%)","text-halo-blur":1}},{id:"nimisto_kunnat",type:"symbol",source:"taustakartta","source-layer":"nimisto",filter:["all",["==",["get","alaryhma"],"Hallintoalueet"],["==",["get","laji"],"Kunta"]],layout:{"text-field":["coalesce",["get","nimi_fin"],["get","nimi_swe"],["get","nimi_sme"],["get","nimi_sms"],["get","nimi_smn"]],"icon-ignore-placement":!1,"icon-allow-overlap":!1,"text-size":["interpolate",["exponential",1.35],["zoom"],1,16,14,28],"text-font":["step",["zoom"],["literal",["Liberation Sans NLSFI"]],6,["literal",["Liberation Sans NLSFI Bold"]]]},paint:{"text-halo-width":2,"text-halo-color":"rgb(255, 255, 255)","text-color":"hsl(0, 0%, 25%)","text-halo-blur":1}}],id:"NLS-Basemap"};function HS({longitude:i,latitude:n,mapMarker:c}){let p="./assets/"+c+".png",f={scrollZoom:!0,boxZoom:!1,dragRotate:!1,dragPan:!0,keyboard:!1,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!1,minZoom:3,maxZoom:20,minPitch:0,maxPitch:0},[s,E]=(0,ds.useState)({longitude:25.7269,latitude:66.503,zoom:6.41});if(c!="none")return ds.default.createElement("div",{className:"map-container"},ds.default.createElement(Lb,{...s,...f,onMove:A=>E(A.viewState),mapStyle:Db,style:{width:"100%",height:"60dvh"}},ds.default.createElement(Ab,null),ds.default.createElement(Mb,{longitude:i,latitude:n,anchor:"bottom"},ds.default.createElement("img",{style:{height:"50px"},src:p}))))}var Rb=HS;var ia=Bt(Gt());function GS(){return ia.default.createElement("div",{className:"prices"},ia.default.createElement("h3",null,"Prices:"),ia.default.createElement("p",null,"Center - Santa Claus Village 30\u20AC"),ia.default.createElement("p",null,"Center - Airport 35\u20AC"),ia.default.createElement("p",null,"Center - Vaattunki 75\u20AC"),ia.default.createElement("p",null,"Vaattunki - Airport 60\u20AC"),ia.default.createElement("p",null,"Center - Lakituvat 20\u20AC"),ia.default.createElement("p",null,"Center - K\xE4tk\xE4vaara 140\u20AC"))}var Fb=GS;function WS(){let[i,n]=(0,pr.useState)(!1),[c,p]=(0,pr.useState)(null),[f,s]=(0,pr.useState)(null),[E,A]=(0,pr.useState)(""),[N,B]=(0,pr.useState)(""),[j,de]=(0,pr.useState)(""),[ge,Te]=(0,pr.useState)("none");return(0,pr.useEffect)(()=>{let xe=setInterval(()=>{(async()=>{let Ae=await Uf.get("https://taksi.opako.fi/api/status").then(ne=>ne.data).catch(ne=>{console.log(ne)});A(Ae.onshift),B(Ae.isavailable),de(Ae.availablein),p(Ae.longitude),s(Ae.latitude),Te(Ae.mapmarker)})()},1e3);return()=>{clearInterval(xe)}},[]),pr.default.createElement("div",{id:"main"},pr.default.createElement(pb,null),pr.default.createElement(fb,{onShift:E,isAvailable:N,availableIn:j,loading:i}),pr.default.createElement(Rb,{longitude:c,latitude:f,mapMarker:ge}),pr.default.createElement(Fb,null))}var Bb=WS;var XS=document.getElementById("root"),KS=(0,Ob.createRoot)(XS);KS.render(Nb.default.createElement(Bb,null));
/*! Bundled license information:

react/cjs/react.production.min.js:
  (**
   * @license React
   * react.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

scheduler/cjs/scheduler.production.min.js:
  (**
   * @license React
   * scheduler.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

react-dom/cjs/react-dom.production.min.js:
  (**
   * @license React
   * react-dom.production.min.js
   *
   * Copyright (c) Facebook, Inc. and its affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   *)

maplibre-gl/dist/maplibre-gl.js:
  (**
   * MapLibre GL JS
   * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v4.7.1/LICENSE.txt
   *)
*/
